{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./_src/js/app.js","webpack:///./_src/js/modules/admin.js","webpack:///./_src/js/modules/bulk-smush.js","webpack:///./_src/js/modules/modals.js","webpack:///./_src/js/modules/notice.js","webpack:///./node_modules/jqueryfiletree/src/jQueryFileTree.js"],"names":["require","WP_Smush","wp_smush_msgs","progress_bar","cur_ele","txt","state","progress_button","parents","eq","find","html","toggleClass","all_done","hide","membership_validity","data","member_validity_notice","jQuery","show_warning","length","show","remove_element","el","timeout","fadeTo","slideUp","remove","$","remove_dialog","update_image_stats","new_size","attachmentSize","currentSize","contents","filter","nodeType","text","sizeStrongEl","size","WDP","showOverlay","title","quick_setup_title","class","smushAddParams","url","isEmptyObject","indexOf","param","errors","wp_smushit_data","geturlparam","arg","$sPageURL","window","location","search","substring","$sURLVariables","split","i","$sParameterName","Smush","$button","bulk","smush_type","self","skip_resmush","init","is_bulk","ajaxurl","$log","deferred","Deferred","ids","resmush","unsmushed","concat","itm","a","is_bulk_resmush","$status","parent","single_ajax_suffix","bulk_ajax_suffix","action","ajax","$id","$send_url","$getnxt","nonce","attachment_id","get_next","_nonce","type","dataType","start","attr","addClass","bulk_start","single_start","show_loader","removeClass","enable_button","prop","removeAttr","smushing","hide_loader","single_done","request","done","response","stats_div","status","replaceWith","success","error_msg","stats","append","error","sync_stats","message_holder","progress_message","extend","count_images","count_smushed","count_total","count_resize","count_supersmushed","savings_bytes","savings_conversion","savings_resize","size_before","size_after","update_stats","always","bulk_done","is_resolved","free_exceeded","update_remaining_count","update_progress","_res","progress","update_localized_stats","_update_progress","count","width","$progress_bar","css","continue","continue_smush","increment_errors","id","push","call_ajax","nonce_value","current_id","shift","update_smush_ids","nonce_field","val","res","error_class","error_message","ajax_error_message","after","prepend","error_count","image_count","parseInt","unshift","complete","resolve","arguments","run","bind_deferred_events","error_in_bulk","replace","cancel_ajax","on","abort","u_index","splice","index","e","preventDefault","disable_links","c_element","enable_links","process_smush_action","current_button","smush_action","mode","document","params","post","r","button","message","validate_resize_settings","wrapper_div","width_only","height_only","resize_checkbox","width_input","width_error_note","height_input","height_error_note","width_error","height_error","is","resize_sizes","hasClass","height","formatBytes","b","thresh","Math","abs","units","u","toFixed","getSizeFromString","formatted_size","trim","getFormatFromString","precise_round","num","decimals","sign","round","pow","update_progress_bar_resmush","unsmushed_count","smushed_count","run_re_check","process_settings","blur","scan_type","get_ui","wp_smush_options_nonce","get","resmush_ids","count_image","bytes","smush_percent","notices","content","notice","super_smush","enable_lossy","super_smush_stats","resmush_complete","setTimeout","resmush_check","getDirectoryList","list_nonce","async","add_dir","close_dialog","SUI","dialogs","set_accordion","suiAccordion","is_last_element","elements","update_dir_progress","ele","ele_tr","closest","ele_prev_tr","prev","ele_dir_progress","ele_dir_progress_percent","ele_dir_count","ele_exclude_btn","children","total","smushed","percent","unfinished_smush_single","unfinished_smush","add_dir_browser_button","choose_button","clone","add_smush_button","smush_button","add_smush_dir_notice","notice_type","update_smush_progress","in_progress_path","each","in_progress_ele","optimised","set_pro_savings","savings","savings_percent","orig_diff","pro_savings","image_stats","is_lossy","super_savings","is_nextgen","isNaN","smush_conversion_savings","conversion_savings","smush_resize_savings","savings_value","resize_savings","resize_message","smush_pro_savings","pro_savings_percent","pro_savings_bytes","directory_smush_finished","image_ele","remaning","not","smush_all","unprocessed_child","first_child","first","img_progress","parent_tr","dir_progress","exclude_btn","progress_percent","image_id","get_stats","image","getElementById","ele_img_progress","findPos","obj","curtop","offsetParent","offsetTop","goToByScroll","selector","animate","scrollTop","offset","top","disable_buttons","update_cummulative_stats","dir_smush","stats_human","stats_percent","human","span","combined_stats","c_stats","total_count","showDialog","focus","removeSpan","slice","urlparam","decodeURI","slide_symbol","slideToggle","$el","setting_type","setting_input","serialize","submit","keep_exif","smush_original","resize_images","smush_pngjpg","update_button_txt","checked","checking","container","savings_dir_smush","orig_size","image_size","click","keypress","keyCode","settings_wrap","notice_wrap","n","href","left","opts","open","link","membership_valid","membership_invalid","remove_loader","wp_smush_run_re_check","fileTree","script","multiFolder","unbind","spinner","path","abs_path","smush_path","image_list_nonce","wp_smush_dir_image_ids","hash","pause_button","prevAll","next","stats_param","ajax_error","keyup","modal","element","options","elem","defaults","isSingle","msgs","msgClass","fn","wpsmush","stop","beforeSend","insertAfter","reload","form","el_notice","btn_act","btn_dismiss","fadeIn","remove_notice","ev","notify_wordpress","send_dismiss_request"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;;;AC/EA;;AAEA;;;AAGA,mBAAAA,CAAQ,mDAAR,E,CARA;;;;AASA,mBAAAA,CAAQ,6DAAR;AACA,mBAAAA,CAAQ,qDAAR;;AAEA;;;;;;;;;;;AAWA,mBAAAA,CAAQ,qDAAR,E;;;;;;;;;;;;;;;;ACvBA;;;;;;;AAOA,IAAIC,WAAWA,YAAY,EAA3B;;AAEA;;;;;AAKA,IAAKC,aAAL,EAAqB;AACpB,KAAMA,iBAAgBA,cAAtB;AACA;;AAED;;;;;;;AAOA,IAAIC,eAAe,SAAfA,YAAe,CAAWC,OAAX,EAAoBC,GAApB,EAAyBC,KAAzB,EAAiC;AACnD;AACA,KAAIC,kBAAkBH,QAAQI,OAAR,GAAkBC,EAAlB,CAAsB,CAAtB,EAA0BC,IAA1B,CAAgC,oBAAhC,CAAtB;;AAEA,KAAK,WAAWJ,KAAhB,EAAwB;AACvBC,kBAAgBG,IAAhB,CAAsB,MAAtB,EAA+BC,IAA/B,CAAqCN,GAArC;AACAE,kBAAgBK,WAAhB,CAA6B,SAA7B;AACA,EAHD,MAGO;AACN;AACAL,kBAAgBG,IAAhB,CAAsB,MAAtB,EAA+BC,IAA/B,CAAqCT,cAAcW,QAAnD;AACAN,kBAAgBO,IAAhB;AACA;AACD,CAZD;;AAcA;;;;;AAKA,IAAIC,sBAAsB,SAAtBA,mBAAsB,CAAWC,IAAX,EAAkB;AAC3C,KAAMC,yBAAyBC,OAAQ,0BAAR,CAA/B;;AAEA;;AAEA,KAAK,gBAAgB,OAASF,IAAzB,IAAmC,gBAAgB,OAASA,KAAKG,YAAjE,IAAmFF,uBAAuBG,MAAvB,GAAgC,CAAxH,EAA4H;AAC3H,MAAKJ,KAAKG,YAAV,EAAyB;AACxBF,0BAAuBI,IAAvB;AACA,GAFD,MAEO;AACNJ,0BAAuBH,IAAvB;AACA;AACD;AACD,CAZD;;AAcA,IAAIQ,iBAAiB,SAAjBA,cAAiB,CAAWC,EAAX,EAAeC,OAAf,EAAyB;AAC7C,KAAK,OAAOA,OAAP,KAAmB,WAAxB,EAAsC;AACrCA,YAAU,GAAV;AACA;AACDD,IAAGE,MAAH,CAAWD,OAAX,EAAoB,CAApB,EAAuB,YAAY;AAClCD,KAAGG,OAAH,CAAYF,OAAZ,EAAqB,YAAY;AAChCD,MAAGI,MAAH;AACA,GAFD;AAGA,EAJD;AAKA,CATD;;AAWAT,OAAQ,UAAWU,CAAX,EAAe;AACtB;;AAEA;;;;AAGA,UAASC,aAAT,GAAyB;AACxBD,IAAE,0BAAF,EAA8BD,MAA9B;AACA;;AAED;;;;;;;AAOA,UAASG,kBAAT,CAA6BC,QAA7B,EAAwC;AACvC,MAAK,MAAMA,QAAX,EAAsB;AACrB;AACA;;AAED,MAAIC,iBAAiBJ,EAAE,6BAAF,CAArB;AACA,MAAMK,cAAcD,eAAeE,QAAf,GAA0BC,MAA1B,CAAiC,YAAW;AAC/D,UAAO,KAAKC,QAAL,KAAkB,CAAzB;AACA,GAFmB,EAEjBC,IAFiB,EAApB;;AAIA;AACA,MAAKJ,gBAAkB,MAAMF,QAA7B,EAA0C;AACzC,OAAMO,eAAeN,eAAeE,QAAf,GAA0BC,MAA1B,CAAiC,YAAW;AAChE,WAAO,KAAKC,QAAL,KAAkB,CAAzB;AACA,IAFoB,EAEfC,IAFe,EAArB;AAGAL,kBAAerB,IAAf,CAAqB,aAAa2B,YAAb,GAA4B,YAA5B,GAA2CP,QAAhE;AACA;AACD;;AAED;AACA,KAAKH,EAAG,oBAAH,EAA0BW,IAA1B,KAAmC,CAAxC,EAA4C;AAC3C;AACAC,MAAIC,WAAJ,CAAiB,oBAAjB,EAAuC;AACtCC,UAAOxC,cAAcyC,iBADiB;AAEtCC,UAAO;AAF+B,GAAvC;AAIAf;AACA;;AAED,KAAIgB,iBAAiB,SAAjBA,cAAiB,CAAWC,GAAX,EAAgB9B,IAAhB,EAAuB;AAC3C,MAAK,CAACY,EAAEmB,aAAF,CAAiB/B,IAAjB,CAAN,EAAgC;AAC/B8B,UAAO,CAAEA,IAAIE,OAAJ,CAAa,GAAb,KAAsB,CAAtB,GAA0B,GAA1B,GAAgC,GAAlC,IAA0CpB,EAAEqB,KAAF,CAASjC,IAAT,CAAjD;AACA;;AAED,SAAO8B,GAAP;AACA,EAND;;AAQA;AACA7C,UAASiD,MAAT,GAAkB,EAAlB;;AAEA;AACAjD,UAASuB,OAAT,GAAmB2B,gBAAgB3B,OAAnC;;AAEA;;;;;AAKAvB,UAASmD,WAAT,GAAuB,UAAWC,GAAX,EAAiB;AACvC,MAAIC,YAAYC,OAAOC,QAAP,CAAgBC,MAAhB,CAAuBC,SAAvB,CAAkC,CAAlC,CAAhB;AACA,MAAIC,iBAAiBL,UAAUM,KAAV,CAAiB,GAAjB,CAArB;;AAEA,OAAM,IAAIC,IAAI,CAAd,EAAiBA,IAAIF,eAAevC,MAApC,EAA4CyC,GAA5C,EAAkD;AACjD,OAAIC,kBAAkBH,eAAeE,CAAf,EAAkBD,KAAlB,CAAyB,GAAzB,CAAtB;AACA,OAAKE,gBAAgB,CAAhB,KAAsBT,GAA3B,EAAiC;AAChC,WAAOS,gBAAgB,CAAhB,CAAP;AACA;AACD;AACD,EAVD;;AAYA7D,UAAS8D,KAAT,GAAiB,UAAWC,OAAX,EAAoBC,IAApB,EAA0BC,UAA1B,EAAuC;AACvD,MAAIC,OAAO,IAAX;AACA,MAAIC,eAAeJ,QAAQhD,IAAR,CAAc,OAAd,CAAnB;AACA;AACAoD,iBAAmB,QAAOA,YAAP,yCAAOA,YAAP,uCAAF,IAA+CA,gBAAgB,KAAjE,GAA2E,KAA3E,GAAmF,IAAlG;;AAEA,OAAKC,IAAL,GAAY,YAAY;AACvB,QAAKL,OAAL,GAAepC,EAAGoC,QAAQ,CAAR,CAAH,CAAf;AACA,QAAKM,OAAL,GAAe,QAAOL,IAAP,yCAAOA,IAAP,KAAcA,IAAd,GAAqB,KAApC;AACA,QAAKnB,GAAL,GAAWyB,OAAX;AACA,QAAKC,IAAL,GAAY5C,EAAG,kBAAH,CAAZ;AACA,QAAK6C,QAAL,GAAgBvD,OAAOwD,QAAP,EAAhB;AACA,QAAKD,QAAL,CAAcvB,MAAd,GAAuB,EAAvB;;AAEA,OAAIyB,MAAMxB,gBAAgByB,OAAhB,CAAwBxD,MAAxB,GAAiC,CAAjC,IAAsC,CAACgD,YAAvC,GAAwDjB,gBAAgB0B,SAAhB,CAA0BzD,MAA1B,GAAmC,CAAnC,GAAuC+B,gBAAgByB,OAAhB,CAAwBE,MAAxB,CAAgC3B,gBAAgB0B,SAAhD,CAAvC,GAAqG1B,gBAAgByB,OAA7K,GAAyLzB,gBAAgB0B,SAAnN;AACA,OAAK,oBAAmBF,GAAnB,yCAAmBA,GAAnB,EAAL,EAA8B;AAC7B;AACA,SAAKA,GAAL,GAAWA,IAAIxC,MAAJ,CAAY,UAAW4C,GAAX,EAAgBlB,CAAhB,EAAmBmB,CAAnB,EAAuB;AAC7C,YAAOnB,KAAKmB,EAAEhC,OAAF,CAAW+B,GAAX,CAAZ;AACA,KAFU,CAAX;AAGA,IALD,MAKO;AACN,SAAKJ,GAAL,GAAWA,GAAX;AACA;;AAED,QAAKM,eAAL,GAAuB9B,gBAAgByB,OAAhB,CAAwBxD,MAAxB,GAAiC,CAAjC,IAAsC,CAACgD,YAAvC,GAAsD,IAAtD,GAA6D,KAApF;;AAEA,QAAKc,OAAL,GAAe,KAAKlB,OAAL,CAAamB,MAAb,GAAsBzE,IAAtB,CAA4B,eAA5B,CAAf;;AAEA;AACA,QAAKwD,UAAL,GAAkB,eAAe,OAAOA,UAAtB,GAAmCA,UAAnC,GAAgD,OAAlE;AACA,QAAKkB,kBAAL,GAA0B,aAAa,KAAKlB,UAAlB,GAA+B,sBAA/B,GAAwD,mBAAlF;AACA,QAAKmB,gBAAL,GAAwB,aAAa,KAAKnB,UAAlB,GAA+B,yBAA/B,GAA2D,iBAAnF;AACA,QAAKpB,GAAL,GAAW,KAAKwB,OAAL,GAAezB,eAAgB,KAAKC,GAArB,EAA0B,EAACwC,QAAQ,KAAKD,gBAAd,EAA1B,CAAf,GAA6ExC,eAAgB,KAAKC,GAArB,EAA0B,EAACwC,QAAQ,KAAKF,kBAAd,EAA1B,CAAxF;AACA,GA3BD;;AA6BA;AACAnF,WAASsF,IAAT,GAAgB,UAAWN,eAAX,EAA4BO,GAA5B,EAAiCC,SAAjC,EAA4CC,OAA5C,EAAqDC,KAArD,EAA6D;AAC5E;;AACA,OAAI1C,QAAQ;AACXgC,qBAAiBA,eADN;AAEXW,mBAAeJ,GAFJ;AAGXK,cAAUH,OAHC;AAIXI,YAAQH;AAJG,IAAZ;AAMA1C,WAAQ/B,OAAO+B,KAAP,CAAcA,KAAd,CAAR;AACA,UAAOrB,EAAE2D,IAAF,CAAQ;AACdQ,UAAM,KADQ;AAEd/E,UAAMiC,KAFQ;AAGdH,SAAK2C,SAHS;AAIdjE,aAASvB,SAASuB,OAJJ;AAKdwE,cAAU;AALI,IAAR,CAAP;AAOA,GAhBD;;AAkBA;AACA,OAAKC,KAAL,GAAa,YAAY;;AAExB,QAAKjC,OAAL,CAAakC,IAAb,CAAmB,UAAnB,EAA+B,UAA/B;AACA,QAAKlC,OAAL,CAAamC,QAAb,CAAuB,kBAAvB;;AAEA,QAAKC,UAAL;AACA,QAAKC,YAAL;AACA,GAPD;;AASA,OAAKD,UAAL,GAAkB,YAAY;AAC7B,OAAK,CAAC,KAAK9B,OAAX,EAAqB;;AAErB;AACA1C,KAAG,wBAAH,EAA8Bd,IAA9B;;AAEA;AACAc,KAAG,yDAAH,EAA+DP,IAA/D;;AAEA;AACAO,KAAG,iBAAH,EAAuBD,MAAvB;;AAEA;AACAC,KAAG,sCAAH,EAA4CD,MAA5C;AACA;AACA,OAAKC,EAAG,uBAAH,EAA6BR,MAA7B,IAAuC,CAA5C,EAAgD;AAC/CQ,MAAG,qBAAH,EAA2Bd,IAA3B;AACA;AACD,GAlBD;;AAoBA,OAAKuF,YAAL,GAAoB,YAAY;AAC/B,OAAK,KAAK/B,OAAV,EAAoB;AACpB,QAAKgC,WAAL;AACA,QAAKpB,OAAL,CAAaqB,WAAb,CAA0B,OAA1B;AACA,GAJD;;AAMA,OAAKC,aAAL,GAAqB,YAAY;AAChC,QAAKxC,OAAL,CAAayC,IAAb,CAAmB,UAAnB,EAA+B,KAA/B;AACA;AACA7E,KAAG,qBAAH,EAA2B8E,UAA3B,CAAuC,UAAvC;AACA9E,KAAG,4GAAH,EAAkH8E,UAAlH,CAA8H,UAA9H;AACA,GALD;;AAOA,OAAKJ,WAAL,GAAmB,YAAY;AAC9BnG,gBAAc,KAAK6D,OAAnB,EAA4B9D,cAAcyG,QAA1C,EAAoD,MAApD;AACA,GAFD;;AAIA,OAAKC,WAAL,GAAmB,YAAY;AAC9BzG,gBAAc,KAAK6D,OAAnB,EAA4B9D,cAAcyG,QAA1C,EAAoD,MAApD;AACA,GAFD;;AAIA,OAAKE,WAAL,GAAmB,YAAY;AAC9B,OAAK,KAAKvC,OAAV,EAAoB;;AAEpB,QAAKsC,WAAL;;AAEA,QAAKE,OAAL,CAAaC,IAAb,CAAmB,UAAWC,QAAX,EAAsB;AACxC,QAAK,OAAOA,SAAShG,IAAhB,IAAwB,WAA7B,EAA2C;;AAE1C;AACA,SAAImE,SAAShB,KAAKe,OAAL,CAAaC,MAAb,EAAb;AACA,SAAI8B,YAAY9B,OAAOzE,IAAP,CAAY,sBAAZ,CAAhB;;AAEA;AACA,SAAKsG,SAAShG,IAAT,CAAckG,MAAnB,EAA4B;AAC3B;AACA/B,aAAOzE,IAAP,CAAY,qBAAZ,EAAmCiB,MAAnC;AACAwC,WAAKe,OAAL,CAAaiC,WAAb,CAA0BH,SAAShG,IAAT,CAAckG,MAAxC;AACA;;AAED;AACAnG,yBAAqBiG,SAAShG,IAA9B;;AAEA,SAAKgG,SAASI,OAAT,IAAoBJ,SAAShG,IAAT,KAAkB,eAA3C,EAA6D;AAC5DmD,WAAKe,OAAL,CAAaqB,WAAb,CAA0B,YAA1B;AACApC,WAAKH,OAAL,CAAamB,MAAb,GAAsBoB,WAAtB,CAAmC,WAAnC,EAAiDJ,QAAjD,CAA2D,SAA3D;AACAhC,WAAKH,OAAL,CAAarC,MAAb;AACA,MAJD,MAIO;AACNwC,WAAKe,OAAL,CAAaiB,QAAb,CAAuB,OAAvB;AACAhC,WAAKe,OAAL,CAAavE,IAAb,CAAmBqG,SAAShG,IAAT,CAAcqG,SAAjC;AACAlD,WAAKe,OAAL,CAAa7D,IAAb;AACA;AACD,SAAI,eAAe4F,SAAf,IAA4BA,UAAU7F,MAA1C,EAAmD;AAClD6F,gBAAUE,WAAV,CAAuBH,SAAShG,IAAT,CAAcsG,KAArC;AACA,MAFD,MAEO;AACNnC,aAAOoC,MAAP,CAAeP,SAAShG,IAAT,CAAcsG,KAA7B;AACA;;AAED;AACAxF,wBAAmBkF,SAAShG,IAAT,CAAce,QAAjC;AACA;AACDoC,SAAKqC,aAAL;AACA,IApCD,EAoCIgB,KApCJ,CAoCW,UAAWR,QAAX,EAAsB;AAChC7C,SAAKe,OAAL,CAAavE,IAAb,CAAmBqG,SAAShG,IAA5B;AACAmD,SAAKe,OAAL,CAAaiB,QAAb,CAAuB,OAAvB;AACAhC,SAAKqC,aAAL;AACA,IAxCD;AA0CA,GA/CD;;AAiDA,OAAKiB,UAAL,GAAkB,YAAY;AAC7B,OAAIC,iBAAiB9F,EAAG,8DAAH,CAArB;AACA;AACA,OAAI+F,mBAAmBD,eAAe/G,IAAf,EAAvB;AACA+G,kBAAe/G,IAAf,CAAqBT,cAAcuH,UAAnC;;AAEA;AACA7F,KAAE2D,IAAF,CAAQ;AACPQ,UAAM,KADC;AAEPjD,SAAKyB,OAFE;AAGPvD,UAAM;AACL,eAAU;AADL,KAHC;AAMPoG,aAAS,iBAAWJ,QAAX,EAAsB;AAC9B,SAAKA,YAAY,eAAe,OAAOA,QAAvC,EAAkD;AACjDA,iBAAWA,SAAShG,IAApB;AACAY,QAAEgG,MAAF,CAAUzE,eAAV,EAA2B;AAC1B0E,qBAAcb,SAASa,YADG;AAE1BC,sBAAed,SAASc,aAFE;AAG1BC,oBAAaf,SAASe,WAHI;AAI1BC,qBAAchB,SAASgB,YAJG;AAK1BC,2BAAoBjB,SAASiB,kBALH;AAM1BC,sBAAelB,SAASkB,aANE;AAO1BC,2BAAoBnB,SAASmB,kBAPH;AAQ1BC,uBAAgBpB,SAASoB,cARC;AAS1BC,oBAAarB,SAASqB,WATI;AAU1BC,mBAAYtB,SAASsB;AAVK,OAA3B;AAYA;AACAC,mBAAc,KAAKrE,UAAnB;AACA;AACD;AAxBM,IAAR,EAyBIsE,MAzBJ,CAyBY,YAAY;AACtBd,mBAAe/G,IAAf,CAAqBgH,gBAArB;AACA,IA3BF;AA6BA,GApCD;;AAsCA;AACA,OAAKc,SAAL,GAAiB,YAAY;AAC5B,OAAK,CAAC,KAAKnE,OAAX,EAAqB;;AAErB;AACA,QAAKkC,aAAL;;AAEA;AACA,OAAKrC,KAAKQ,GAAL,CAASvD,MAAT,IAAmB,CAAxB,EAA4B;AAC3BQ,MAAG,4EAAH,EAAkFP,IAAlF;AACAO,MAAG,wBAAH,EAA8Bd,IAA9B;AACA,IAHD,MAGO;AACN,QAAKc,EAAG,8CAAH,EAAoDR,MAApD,GAA6D,CAAlE,EAAsE;AACrEQ,OAAG,8CAAH,EAAoDP,IAApD;AACA,KAFD,MAEO;AACNO,OAAG,yCAAH,EAA+CP,IAA/C;AACA;AACDO,MAAG,wBAAH,EAA8BP,IAA9B;AACA;;AAED;AACAO,KAAG,qCAAH,EAA2Cd,IAA3C;;AAEA;AACAc,KAAG,6CAAH,EAAmD8E,UAAnD,CAA+D,UAA/D;;AAEA;AACA,OAAKvC,KAAKQ,GAAL,CAASvD,MAAT,IAAmB,CAAxB,EAA4B;AAC3BQ,MAAG,sCAAH,EAA4CuE,QAA5C,CAAsD,YAAtD;AACA,IAFD,MAEO;AACNvE,MAAG,sCAAH,EAA4C2E,WAA5C,CAAyD,wCAAzD,EAAoGJ,QAApG,CAA8G,2BAA9G;AACA;AACD,GA/BD;;AAiCA,OAAKuC,WAAL,GAAmB,YAAY;AAC9B;;AACA,UAAO,KAAKjE,QAAL,CAAcnE,KAAd,OAA0B,UAAjC;AACA,GAHD;;AAKA,OAAKqI,aAAL,GAAqB,YAAY;AAChC;AACA/G,KAAG,qCAAH,EAA2Cd,IAA3C;;AAEA,OAAKqD,KAAKQ,GAAL,CAASvD,MAAT,GAAkB,CAAvB,EAA2B;AAC1B;AACAQ,MAAG,yBAAH,EAA+BP,IAA/B;AACA,IAHD,MAGO;AACNO,MAAG,wEAAH,EAA8EP,IAA9E;AACA;AACD,GAVD;;AAYA,OAAKuH,sBAAL,GAA8B,YAAY;AACzC,OAAK,KAAK3D,eAAV,EAA4B;AAC3B;AACA,QAAKrD,EAAG,oDAAH,EAA0DR,MAA1D,IAAoE,eAAe,OAAO+C,KAAKQ,GAApG,EAA0G;AACzG/C,OAAG,oDAAH,EAA0DjB,IAA1D,CAAgEwD,KAAKQ,GAAL,CAASvD,MAAzE;AACA;AACD,IALD,MAKO;AACN;AACA,QAAKQ,EAAG,+CAAH,EAAqDR,MAArD,IAA+D,eAAe,OAAO+C,KAAKQ,GAA/F,EAAqG;AACpG/C,OAAG,+CAAH,EAAqDjB,IAArD,CAA2DwD,KAAKQ,GAAL,CAASvD,MAApE;AACA;AACD;;AAED;AACA,OAAKQ,EAAG,0CAAH,EAAgDR,MAAhD,IAA0D,eAAe,OAAO+C,KAAKQ,GAA1F,EAAgG;AAC/F,QAAKR,KAAKQ,GAAL,CAASvD,MAAT,GAAkB,CAAvB,EAA2B;AAC1BQ,OAAG,0CAAH,EAAgDjB,IAAhD,CAAsDwD,KAAKQ,GAAL,CAASvD,MAA/D;AACA,KAFD,MAEO;AACNQ,OAAG,sCAAH,EAA4CuE,QAA5C,CAAsD,YAAtD;AACAvE,OAAG,0CAAH,EAAgD2E,WAAhD,CAA6D,yBAA7D,EAAyF5F,IAAzF,CAA8F,EAA9F;AACA;AACD;AACD,GAtBD;;AAwBA,OAAKkI,eAAL,GAAuB,UAAWC,IAAX,EAAkB;AACxC;AACA,OAAK,CAAC,KAAK7D,eAAN,IAAyB,CAAC,KAAKX,OAApC,EAA8C;AAC7C;AACA;;AAED,OAAIyE,WAAW,EAAf;;AAEA;AACA,OAAKD,SAAU,eAAe,OAAOA,KAAK9H,IAA3B,IAAmC,eAAe,OAAO8H,KAAK9H,IAAL,CAAUsG,KAA7E,CAAL,EAA4F;AAC3F0B,2BAAwBF,KAAK9H,IAAL,CAAUsG,KAAlC,EAAyC,KAAKpD,UAA9C;AACA;;AAED,OAAK,CAAC,KAAKe,eAAX,EAA6B;AAC5B;AACA8D,eAAa5F,gBAAgB2E,aAAhB,GAAgC3E,gBAAgB4E,WAAlD,GAAkE,GAA7E;AACA,IAHD,MAGO;AACN;AACA,QAAKe,KAAK1B,OAAV,EAAoB;AACnB;AACA,SAAKjE,gBAAgByB,OAAhB,CAAwBxD,MAAxB,GAAiC,CAAtC,EAA0C;AACzC;AACAQ,QAAG,4BAAH,EAAkCjB,IAAlC,CAAwCwC,gBAAgByB,OAAhB,CAAwBxD,MAAhE;AACA,MAHD,MAGO,IAAK+B,gBAAgByB,OAAhB,CAAwBxD,MAAxB,IAAkC,CAAlC,IAAuC,KAAKuD,GAAL,CAASvD,MAAT,IAAmB,CAA/D,EAAmE;AACzE;;AAEA;AACAQ,QAAG,8EAAH,EAAoF2E,WAApF,CAAiG,YAAjG;;AAEA;AACA3E,QAAG,6DAAH,EAAmEd,IAAnE;AACA;AACD;;AAED;AACA;AACA,QAAK,gBAAgB,OAAOqD,KAAKQ,GAA5B,IAAmC,gBAAgB,OAAOxB,gBAAgB4E,WAA1E,IAAyF5E,gBAAgB4E,WAAhB,GAA8B,CAA5H,EAAgI;AAC/HgB,gBAAa5F,gBAAgB2E,aAAhB,GAAgC3E,gBAAgB4E,WAAlD,GAAkE,GAA7E;AACA;AACD;;AAED;AACA,OAAK5D,KAAKQ,GAAL,CAASvD,MAAT,IAAmB,CAAxB,EAA4B;AAC3B;AACA,QAAK,aAAa,KAAK8C,UAAvB,EAAoC;AACnC,UAAKuD,UAAL;AACA;AACD7F,MAAG,4EAAH,EAAkFP,IAAlF;AACAO,MAAG,wBAAH,EAA8Bd,IAA9B;AACA;;AAED;AACAqD,QAAKyE,sBAAL;;AAEA;AACA,OAAK,eAAe,OAAOE,KAAK9H,IAAL,CAAUsG,KAArC,EAA6C;;AAE5C;AACA,SAAK2B,gBAAL,CAAuB9F,gBAAgB2E,aAAvC,EAAsDiB,QAAtD;AACA;AACD;AACAR,gBAAc,KAAKrE,UAAnB;AACA,GA9DD;;AAgEA,OAAK+E,gBAAL,GAAwB,UAAWC,KAAX,EAAkBC,KAAlB,EAA0B;AACjD;;AACA,OAAK,CAAC,KAAK7E,OAAN,IAAiB,CAAC,KAAKW,eAA5B,EAA8C;AAC7C;AACA;AACD;AACA;AACA,OAAImE,gBAAgBlI,OAAQ,8CAAR,CAApB;AACA,OAAKkI,cAAchI,MAAd,GAAuB,CAA5B,EAAgC;AAC/B;AACA;AACD;AACAgI,iBAAcC,GAAd,CAAmB,OAAnB,EAA4BF,QAAQ,GAApC;AAEA,GAdD;;AAgBA;AACA,OAAKG,QAAL,GAAgB,YAAY;AAC3B,OAAIC,iBAAiBpF,KAAKH,OAAL,CAAakC,IAAb,CAAmB,gBAAnB,CAArB;;AAEA,OAAK,QAAOqD,cAAP,yCAAOA,cAAP,uCAAL,EAAiD;AAChDA,qBAAiB,IAAjB;AACA;;AAED,OAAK,WAAWA,cAAX,IAA6B,CAACA,cAAnC,EAAoD;AACnDA,qBAAiB,KAAjB;AACA;;AAED,UAAOA,kBAAkB,KAAK5E,GAAL,CAASvD,MAAT,GAAkB,CAApC,IAAyC,KAAKkD,OAArD;AACA,GAZD;;AAcA,OAAKkF,gBAAL,GAAwB,UAAWC,EAAX,EAAgB;AACvCxJ,YAASiD,MAAT,CAAgBwG,IAAhB,CAAsBD,EAAtB;AACA,GAFD;;AAIA;AACA,OAAKE,SAAL,GAAiB,YAAY;AAC5B,OAAIC,cAAc,EAAlB;AACA,QAAKC,UAAL,GAAkB,KAAKvF,OAAL,GAAe,KAAKK,GAAL,CAASmF,KAAT,EAAf,GAAkC,KAAK9F,OAAL,CAAahD,IAAb,CAAmB,IAAnB,CAApD,CAF4B,CAEmD;;AAE/E;AACA,QAAK+I,gBAAL,CAAuB,KAAKF,UAA5B;;AAEA,OAAIG,cAAc,KAAKhG,OAAL,CAAamB,MAAb,GAAsBzE,IAAtB,CAA4B,kBAA5B,CAAlB;AACA,OAAKsJ,WAAL,EAAmB;AAClBJ,kBAAcI,YAAYC,GAAZ,EAAd;AACA;;AAED,QAAKnD,OAAL,GAAe7G,SAASsF,IAAT,CAAe,KAAKN,eAApB,EAAqC,KAAK4E,UAA1C,EAAsD,KAAK/G,GAA3D,EAAgE,CAAhE,EAAmE8G,WAAnE,EACbpC,KADa,CACN,YAAY;AACnBrD,SAAKqF,gBAAL,CAAuBrF,KAAK0F,UAA5B;AACA,IAHa,EAGV9C,IAHU,CAGJ,UAAWmD,GAAX,EAAiB;AAC1B;AACA,QAAK,OAAOA,IAAI9C,OAAX,KAAuB,WAAvB,IAAwC,OAAO8C,IAAI9C,OAAX,KAAuB,WAAvB,IAAsC,OAAO8C,IAAI9C,OAAJ,CAAYpG,IAAnB,KAA4B,WAAlE,IAAiFkJ,IAAI9C,OAAJ,KAAgB,KAAjG,IAA0G8C,IAAIlJ,IAAJ,CAASwG,KAAT,KAAmB,mCAA1K,EAAkN;AACjNrD,UAAKqF,gBAAL,CAAuBrF,KAAK0F,UAA5B;AACA;AACD;AACA,QAAK,CAACK,GAAD,IAAQ,CAACA,IAAI9C,OAAlB,EAA4B;AAC3B;AACA,SAAK,gBAAgB,OAAO8C,GAAvB,IAA8B,gBAAgB,OAAOA,IAAIlJ,IAAzD,IAAiE,OAAOkJ,IAAIlJ,IAAJ,CAASwG,KAAhB,KAA0B,WAAhG,EAA8G;AAC7G,UAAI2C,cAAc,eAAe,OAAOD,IAAIlJ,IAAJ,CAASmJ,WAA/B,GAA6C,yBAAyBD,IAAIlJ,IAAJ,CAASmJ,WAA/E,GAA6F,qBAA/G;AACA,UAAI9C,YAAY,eAAe8C,WAAf,GAA6B,IAA7B,GAAoCD,IAAIlJ,IAAJ,CAASoJ,aAA7C,GAA6D,MAA7E;AACA,UAAK,eAAe,OAAOF,IAAIlJ,IAAJ,CAASwG,KAA/B,IAAwC,uCAAuC0C,IAAIlJ,IAAJ,CAASwG,KAA7F,EAAqG;AACpG,WAAI6C,qBAAqBzI,EAAG,sBAAH,CAAzB;AACA;AACA,WAAKyI,mBAAmBjJ,MAAnB,GAA4B,CAAjC,EAAqC;AACpCiJ,2BAAmBC,KAAnB,CAA0BjD,SAA1B;AACA,QAFD,MAEO;AACN;AACAlD,aAAKK,IAAL,CAAU+F,OAAV,CAAmBlD,SAAnB;AACA;AACD,OATD,MASO,IAAK,eAAe,OAAO6C,IAAIlJ,IAAJ,CAASmJ,WAA/B,IAA8C,MAAMD,IAAIlJ,IAAJ,CAASmJ,WAA7D,IAA4EvI,EAAG,0BAA0BsI,IAAIlJ,IAAJ,CAASmJ,WAAtC,EAAoD/I,MAApD,GAA6D,CAA9I,EAAkJ;AACxJ,WAAIoJ,cAAc5I,EAAG,2BAA2BsI,IAAIlJ,IAAJ,CAASmJ,WAApC,GAAkD,qBAArD,CAAlB;AACA;AACA,WAAIM,cAAcD,YAAY7J,IAAZ,EAAlB;AACA8J,qBAAcC,SAAUD,WAAV,IAA0B,CAAxC;AACA;AACAD,mBAAY7J,IAAZ,CAAkB8J,WAAlB;AACA,OAPM,MAOA;AACN;AACAtG,YAAKK,IAAL,CAAU+C,MAAV,CAAkBF,SAAlB;AACA;AACDlD,WAAKK,IAAL,CAAUnD,IAAV;AACA;AACD;;AAED;AACAN,wBAAqBmJ,IAAIlJ,IAAzB;;AAEA;AACA,QAAK,OAAOkJ,IAAIlJ,IAAX,KAAoB,WAApB,IAAmCkJ,IAAIlJ,IAAJ,CAASwG,KAAT,IAAkB,mCAArD,IAA4F,CAACrD,KAAKuE,WAAL,EAAlG,EAAuH;AACtH;AACAvE,UAAKH,OAAL,CAAakC,IAAb,CAAmB,gBAAnB,EAAqC,KAArC;;AAEA/B,UAAKwE,aAAL;;AAEA;AACAxF,qBAAgB0B,SAAhB,CAA0B8F,OAA1B,CAAmCxG,KAAK0F,UAAxC;;AAEA;AACA1F,UAAKyE,sBAAL;AACA,KAXD,MAWO;;AAEN,SAAKzE,KAAKG,OAAL,IAAgB4F,IAAI9C,OAAzB,EAAmC;AAClCjD,WAAK0E,eAAL,CAAsBqB,GAAtB;AACA,MAFD,MAEM,IAAI/F,KAAKQ,GAAL,CAASvD,MAAT,IAAmB,CAAvB,EAA0B;AAC/B;AACA+C,WAAKsD,UAAL;AACA;AACD;AACDtD,SAAK0C,WAAL;AACA,IA/Da,EA+DV+D,QA/DU,CA+DA,YAAY;AACzB,QAAK,CAACzG,KAAKmF,QAAL,EAAD,IAAoB,CAACnF,KAAKG,OAA/B,EAAyC;AACxC;AACAH,UAAKM,QAAL,CAAcoG,OAAd;AACA,KAHD,MAGO;AACN1G,UAAKwF,SAAL;AACA;AACD,IAtEa,CAAf;;AAwEAxF,QAAKM,QAAL,CAAcvB,MAAd,GAAuBjD,SAASiD,MAAhC;AACA,UAAOiB,KAAKM,QAAZ;AACA,GAtFD;;AAwFA,OAAKJ,IAAL,CAAWyG,SAAX;;AAEA;AACA,OAAKC,GAAL,GAAW,YAAY;;AAEtB;AACA,OAAK,KAAKzG,OAAL,IAAgB,KAAKK,GAAL,CAASvD,MAAT,GAAkB,CAAvC,EAA2C;AAC1C,SAAKuI,SAAL;AACA;;AAED,OAAK,CAAC,KAAKrF,OAAX,EACC,KAAKqF,SAAL;AAED,GAVD;;AAYA;AACA,OAAKqB,oBAAL,GAA4B,YAAY;;AAEvC,QAAKvG,QAAL,CAAcsC,IAAd,CAAoB,YAAY;;AAE/B5C,SAAKH,OAAL,CAAa0C,UAAb,CAAyB,gBAAzB;;AAEA,QAAKzG,SAASiD,MAAT,CAAgB9B,MAArB,EAA8B;AAC7B,SAAIgJ,gBAAgB,sCAAsClK,cAAc+K,aAAd,CAA4BC,OAA5B,CAAqC,YAArC,EAAmDjL,SAASiD,MAAT,CAAgB9B,MAAnE,CAAtC,GAAoH,QAAxI;AACA;AACAQ,OAAG,sBAAH,EAA4BD,MAA5B;AACAwC,UAAKK,IAAL,CAAU+F,OAAV,CAAmBH,aAAnB;AACA;;AAEDjG,SAAKsE,SAAL;;AAEA;AACA7G,MAAG,0DAAH,EAAgE8E,UAAhE,CAA4E,UAA5E;AACA,IAfD;AAiBA,GAnBD;AAoBA;;;;;AAKA,OAAKyE,WAAL,GAAmB,YAAY;AAC9BvJ,KAAG,uBAAH,EAA6BwJ,EAA7B,CAAiC,OAAjC,EAA0C,YAAY;AACrD;AACAjH,SAAKH,OAAL,CAAakC,IAAb,CAAmB,gBAAnB,EAAqC,KAArC;AACA;AACA/B,SAAKsD,UAAL;AACAc,iBAAc,KAAKrE,UAAnB;;AAEAC,SAAK2C,OAAL,CAAauE,KAAb;AACAlH,SAAKqC,aAAL;AACArC,SAAKH,OAAL,CAAauC,WAAb,CAA0B,kBAA1B;AACApD,oBAAgB0B,SAAhB,CAA0B8F,OAA1B,CAAmCxG,KAAK0F,UAAxC;AACAjI,MAAG,wBAAH,EAA8BP,IAA9B;;AAEA;AACAO,MAAG,qCAAH,EAA2Cd,IAA3C;AACA,IAfD;AAgBA,GAjBD;AAkBA;;;;AAIA,OAAKiJ,gBAAL,GAAwB,UAAWF,UAAX,EAAwB;AAC/C,OAAK,gBAAgB,OAAO1G,gBAAgB0B,SAAvC,IAAoD1B,gBAAgB0B,SAAhB,CAA0BzD,MAA1B,GAAmC,CAA5F,EAAgG;AAC/F,QAAIkK,UAAUnI,gBAAgB0B,SAAhB,CAA0B7B,OAA1B,CAAmC6G,UAAnC,CAAd;AACA,QAAKyB,UAAU,CAAC,CAAhB,EAAoB;AACnBnI,qBAAgB0B,SAAhB,CAA0B0G,MAA1B,CAAkCD,OAAlC,EAA2C,CAA3C;AACA;AACD;AACD;AACA,OAAK,gBAAgB,OAAOnI,gBAAgByB,OAAvC,IAAkDzB,gBAAgByB,OAAhB,CAAwBxD,MAAxB,GAAiC,CAAxF,EAA4F;AAC3F,QAAIoK,QAAQrI,gBAAgByB,OAAhB,CAAwB5B,OAAxB,CAAiC6G,UAAjC,CAAZ;AACA,QAAK2B,QAAQ,CAAC,CAAd,EAAkB;AACjBrI,qBAAgByB,OAAhB,CAAwB2G,MAAxB,CAAgCC,KAAhC,EAAuC,CAAvC;AACA;AACD;AACD,GAdD;;AAgBA,OAAKvF,KAAL;AACA,OAAK8E,GAAL;AACA,OAAKC,oBAAL;;AAEA;AACA,OAAKG,WAAL;;AAEA,SAAO,KAAK1G,QAAZ;AACA,EA9hBD;;AAgiBA;;;AAGA7C,GAAG,MAAH,EAAYwJ,EAAZ,CAAgB,OAAhB,EAAyB,qBAAzB,EAAgD,UAAWK,CAAX,EAAe;;AAE9D;AACAA,IAAEC,cAAF;;AAEA9J,IAAG,oCAAH,EAA0CD,MAA1C;;AAEA;AACAC,IAAG,qJAAH,EAA2JsE,IAA3J,CAAiK,UAAjK,EAA6K,UAA7K;;AAEA;AACA,MAAK,OAAO/C,eAAP,IAA0B,WAA1B,IACFA,gBAAgB0B,SAAhB,CAA0BzD,MAA1B,IAAoC,CAApC,IAAyC+B,gBAAgByB,OAAhB,CAAwBxD,MAAxB,IAAkC,CAD9E,EAEE;;AAED,UAAO,KAAP;AAEA;;AAEDQ,IAAG,qBAAH,EAA2Bd,IAA3B;;AAEA;AACAc,IAAG,sCAAH,EAA4C2E,WAA5C,CAAyD,2BAAzD,EAAuFJ,QAAvF,CAAiG,6BAAjG;;AAEA,MAAIlG,SAAS8D,KAAb,CAAoBnC,EAAG,IAAH,CAApB,EAA+B,IAA/B;AAGA,EA3BD;;AA6BA;AACA,KAAI+J,gBAAgB,SAAhBA,aAAgB,CAAWC,SAAX,EAAuB;;AAE1C,MAAIzG,SAASyG,UAAUzG,MAAV,EAAb;AACA;AACAA,SAAOkE,GAAP,CAAY,EAAC,WAAW,KAAZ,EAAZ;AACA;AACAlE,SAAOzE,IAAP,CAAa,GAAb,EAAmBwF,IAAnB,CAAyB,UAAzB,EAAqC,UAArC;AACA,EAPD;;AASA;AACA,KAAI2F,eAAe,SAAfA,YAAe,CAAWD,SAAX,EAAuB;;AAEzC,MAAIzG,SAASyG,UAAUzG,MAAV,EAAb;;AAEA;AACAA,SAAOkE,GAAP,CAAY,EAAC,WAAW,GAAZ,EAAZ;AACA;AACAlE,SAAOzE,IAAP,CAAa,GAAb,EAAmBgG,UAAnB,CAA+B,UAA/B;AACA,EARD;AASA;;;;;;;AAOA,KAAIoF,uBAAuB,SAAvBA,oBAAuB,CAAWL,CAAX,EAAcM,cAAd,EAA8BC,YAA9B,EAA4C1G,MAA5C,EAAqD;;AAE/E;AACA,MAAK,cAAcyG,eAAe7F,IAAf,CAAqB,UAArB,CAAnB,EAAuD;AACtD,UAAO,KAAP;AACA;;AAEDuF,IAAEC,cAAF;;AAEA;AACA9J,IAAG,iBAAH,EAAuBD,MAAvB;;AAEA;AACAC,IAAG,sBAAH,EAA4Bd,IAA5B;;AAEA,MAAImL,OAAO,MAAX;AACA,MAAK,yBAAyBD,YAA9B,EAA6C;AAC5C,OAAKpK,EAAGsK,QAAH,EAAcxL,IAAd,CAAoB,4BAApB,EAAmDU,MAAnD,GAA4D,CAAjE,EAAqE;AACpE6K,WAAO,MAAP;AACA,IAFD,MAEO;AACNA,WAAO1I,OAAOC,QAAP,CAAgBC,MAAhB,CAAuBT,OAAvB,CAAgC,MAAhC,IAA2C,CAAC,CAA5C,GAAgD,MAAhD,GAAyD,MAAhE;AACA;AACD;;AAED;AACA,MAAImJ,SAAS;AACZ7G,WAAQ0G,YADI;AAEZpG,kBAAemG,eAAe/K,IAAf,CAAqB,IAArB,CAFH;AAGZiL,SAAMA,IAHM;AAIZnG,WAAQiG,eAAe/K,IAAf,CAAqB,OAArB;AAJI,GAAb;;AAOA;AACA2K,gBAAeI,cAAf;;AAEA5L,eAAc4L,cAAd,EAA8B7L,cAAcoF,MAAd,CAA9B,EAAqD,MAArD;;AAEA;AACA1D,IAAEwK,IAAF,CAAQ7H,OAAR,EAAiB4H,MAAjB,EAAyB,UAAWE,CAAX,EAAe;;AAEvClM,gBAAc4L,cAAd,EAA8B7L,cAAcoF,MAAd,CAA9B,EAAqD,MAArD;;AAEA;AACAuG,gBAAcE,cAAd;;AAEA,OAAIM,EAAEjF,OAAF,IAAa,eAAe,OAAOiF,EAAErL,IAAF,CAAOsL,MAA9C,EAAuD;AACtD;AACA,QAAI,eAAe,OAAQ,KAAKtL,IAA5B,IAAqC,KAAKA,IAAL,CAAUgC,OAAV,CAAkB,SAAlB,IAA+B,CAAC,CAAzE,EAA4E;AAC3E;AACA+I,oBAAe5G,MAAf,GAAwBxE,IAAxB,CAA6B0L,EAAErL,IAAF,CAAOsL,MAApC;AACA,KAHD,MAGO;AACN;AACAP,oBAAevL,OAAf,GAAyBC,EAAzB,CAA4B,CAA5B,EAA+BE,IAA/B,CAAoC0L,EAAErL,IAAF,CAAOsL,MAA3C;AACA;;AAED,QAAK,eAAe,OAAQD,EAAErL,IAAzB,IAAkC,cAAcsE,MAArD,EAA8D;AAC7DxD,wBAAmBuK,EAAErL,IAAF,CAAOe,QAA1B;AACA;AACD,IAbD,MAaO;AACN,QAAKsK,EAAErL,IAAF,CAAOuL,OAAZ,EAAsB;AACrB;AACAR,oBAAe5G,MAAf,GAAwBoC,MAAxB,CAAgC8E,EAAErL,IAAF,CAAOuL,OAAvC;AACA;AACD;AACD,GA1BD;AA2BA,EAjED;;AAmEA;;;;;;;;;AASA,KAAIC,2BAA2B,SAA3BA,wBAA2B,CAAWC,WAAX,EAAwBC,UAAxB,EAAoCC,WAApC,EAAkD;AAChF,MAAIC,kBAAkBH,YAAY/L,IAAZ,CAAkB,gDAAlB,CAAtB;;AAEA,MAAK,CAACiM,WAAN,EAAoB;AACnB,OAAIE,cAAcJ,YAAY/L,IAAZ,CAAkB,wBAAlB,CAAlB;AACA,OAAIoM,mBAAmBL,YAAY/L,IAAZ,CAAkB,wCAAlB,CAAvB;AACA;AACD,MAAK,CAACgM,UAAN,EAAmB;AAClB,OAAIK,eAAeN,YAAY/L,IAAZ,CAAkB,yBAAlB,CAAnB;AACA,OAAIsM,oBAAoBP,YAAY/L,IAAZ,CAAkB,yCAAlB,CAAxB;AACA;;AAED,MAAIuM,cAAc,KAAlB;AACA,MAAIC,eAAe,KAAnB;;AAEA;AACA,MAAK,CAACN,gBAAgBO,EAAhB,CAAoB,UAApB,CAAN,EAAyC;AACxC,UAAO,IAAP;AACA;;AAED;AACA,MAAK,eAAe,OAAQhK,gBAAgBiK,YAAvC,IAAwD,eAAe,OAAQjK,gBAAgBiK,YAAhB,CAA6BjE,KAAjH,EAA0H;AACzH;AACA,UAAO,IAAP;AACA;;AAED;AACA,MAAK,CAACwD,WAAD,IAAgB,eAAe,OAAOE,WAAtC,IAAqDnC,SAAUvH,gBAAgBiK,YAAhB,CAA6BjE,KAAvC,IAAiDuB,SAAUmC,YAAY5C,GAAZ,EAAV,CAA3G,EAA2I;AAC1I4C,eAAY1H,MAAZ,GAAqBgB,QAArB,CAA8B,sBAA9B;AACA2G,oBAAiBzL,IAAjB,CAAuB,MAAvB;AACA4L,iBAAc,IAAd;AACA,GAJD,MAIO;AACN;AACAJ,eAAY1H,MAAZ,GAAqBoB,WAArB,CAAiC,sBAAjC;AACAuG,oBAAiBhM,IAAjB;AACA,OAAKiM,aAAaM,QAAb,CAAuB,OAAvB,CAAL,EAAwC;AACvCL,sBAAkB3L,IAAlB,CAAwB,MAAxB;AACA;AACD;;AAED;AACA,MAAK,CAACqL,UAAD,IAAe,eAAe,OAAOK,YAArC,IAAqDrC,SAAUvH,gBAAgBiK,YAAhB,CAA6BE,MAAvC,IAAkD5C,SAAUqC,aAAa9C,GAAb,EAAV,CAA5G,EAA6I;AAC5I8C,gBAAa5H,MAAb,GAAsBgB,QAAtB,CAA+B,sBAA/B;AACA;AACA,OAAK,CAAC8G,WAAN,EAAoB;AACnBD,sBAAkB3L,IAAlB,CAAwB,MAAxB;AACA;AACD6L,kBAAe,IAAf;AACA,GAPD,MAOO;AACN;AACAH,gBAAa5H,MAAb,GAAsBoB,WAAtB,CAAkC,sBAAlC;AACAyG,qBAAkBlM,IAAlB;AACA,OAAK+L,YAAYQ,QAAZ,CAAsB,OAAtB,CAAL,EAAuC;AACtCP,qBAAiBzL,IAAjB,CAAuB,MAAvB;AACA;AACD;;AAED,MAAK4L,eAAeC,YAApB,EAAmC;AAClC,UAAO,KAAP;AACA;AACD,SAAO,IAAP;AAEA,EA9DD;;AAgEA;;;;;;AAMA,KAAIK,cAAc,SAAdA,WAAc,CAAWvI,CAAX,EAAcwI,CAAd,EAAkB;AACnC,MAAIC,SAAS,IAAb;AACA,MAAKC,KAAKC,GAAL,CAAU3I,CAAV,IAAgByI,MAArB,EAA8B;AAC7B,UAAOzI,IAAI,IAAX;AACA;AACD,MAAI4I,QAAQ,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,EAAmB,IAAnB,EAAyB,IAAzB,CAAZ;AACA,MAAIC,IAAI,CAAC,CAAT;AACA,KAAG;AACF7I,QAAKyI,MAAL;AACA,KAAEI,CAAF;AACA,GAHD,QAGUH,KAAKC,GAAL,CAAU3I,CAAV,KAAiByI,MAAjB,IAA2BI,IAAID,MAAMxM,MAAN,GAAe,CAHxD;AAIA,SAAO4D,EAAE8I,OAAF,CAAWN,CAAX,IAAiB,GAAjB,GAAuBI,MAAMC,CAAN,CAA9B;AACA,EAZD;;AAcA;;;;;;AAMA,KAAIE,oBAAoB,SAApBA,iBAAoB,CAAWC,cAAX,EAA4B;AACnD,SAAOA,eAAe9C,OAAf,CAAwB,WAAxB,EAAqC,EAArC,EAA0C+C,IAA1C,EAAP;AACA,EAFD;;AAIA;;;;;;AAMA,KAAIC,sBAAsB,SAAtBA,mBAAsB,CAAWF,cAAX,EAA4B;AACrD,SAAOA,eAAe9C,OAAf,CAAwB,SAAxB,EAAmC,EAAnC,EAAwC+C,IAAxC,EAAP;AACA,EAFD;;AAIA;AACA,KAAIE,gBAAgB,SAAhBA,aAAgB,CAAWC,GAAX,EAAgBC,QAAhB,EAA2B;AAC9C,MAAIC,OAAOF,OAAO,CAAP,GAAW,CAAX,GAAe,CAAC,CAA3B;AACA;AACAA,QAAMA,MAAM,GAAN,GAAY,GAAZ,GAAkBA,GAAxB;AACA,SAAQV,KAAKa,KAAL,CAAaH,MAAMV,KAAKc,GAAL,CAAU,EAAV,EAAcH,QAAd,CAAP,GAAoCC,OAAO,KAAvD,IAAkEZ,KAAKc,GAAL,CAAU,EAAV,EAAcH,QAAd,CAA1E;AACA,EALD;;AAOA;;;;;AAKA,KAAII,8BAA8B,SAA9BA,2BAA8B,CAAWC,eAAX,EAA6B;;AAE9D,MAAK,eAAe,OAAOA,eAA3B,EAA6C;AAC5C,UAAO,KAAP;AACA;;AAED,MAAIC,gBAAgBxL,gBAAgB4E,WAAhB,GAA8B2G,eAAlD;;AAEA;AACA;AACA,MAAItF,gBAAgBlI,OAAQ,8CAAR,CAApB;AACA,MAAKkI,cAAchI,MAAd,GAAuB,CAA5B,EAAgC;AAC/B;AACA;;AAED,MAAI+H,QAAUwF,gBAAgBxL,gBAAgB4E,WAAlC,GAAkD,GAA9D;;AAEA;AACAqB,gBAAcC,GAAd,CAAmB,OAAnB,EAA4BF,QAAQ,GAApC;AACA,EAnBD;;AAqBA,KAAIyF,eAAe,SAAfA,YAAe,CAAWtC,MAAX,EAAmBuC,gBAAnB,EAAsC;;AAExD;AACAvC,SAAOjK,IAAP,CAAa,EAAb,EAAkB8D,QAAlB,CAA4B,+CAA5B,EAA8E2I,IAA9E;;AAEA;AACA,MAAIC,YAAYzC,OAAOtL,IAAP,CAAa,MAAb,CAAhB;AACA+N,cAAY,eAAe,OAAOA,SAAtB,GAAkC,OAAlC,GAA4CA,SAAxD;;AAEA;AACAnN,IAAG,qBAAH,EAA2B8E,UAA3B,CAAuC,YAAvC;;AAEA;AACA,MAAInF,KAAKK,EAAG,oCAAH,CAAT;AACAL,KAAGG,OAAH,CAAY,GAAZ,EAAiB,YAAY;AAC5BH,MAAGI,MAAH;AACA,GAFD;;AAIA;AACAC,IAAG,kBAAH,EAAwBsE,IAAxB,CAA8B,UAA9B,EAA0C,UAA1C;;AAEA;AACAtE,IAAG,4BAAH,EAAkCd,IAAlC;;AAEA;AACA,MAAIqL,SAAS;AACZ7G,WAAQ,kBADI;AAEZS,SAAMgJ,SAFM;AAGZC,WAAQ,IAHI;AAIZH,qBAAkBA,gBAJN;AAKZI,2BAAwB/N,OAAQ,yBAAR,EAAoC+I,GAApC;AALZ,GAAb;;AAQA;AACArI,IAAEsN,GAAF,CAAO3K,OAAP,EAAgB4H,MAAhB,EAAwB,UAAWE,CAAX,EAAe;AACtC;AACA,OAAK,eAAe,OAAOA,EAAErL,IAA7B,EAAoC;AACnC;AACA,QAAK,eAAe,OAAOqL,EAAErL,IAAF,CAAOmO,WAAlC,EAAgD;AAC/ChM,qBAAgByB,OAAhB,GAA0ByH,EAAErL,IAAF,CAAOmO,WAAjC;;AAEA;AACA,SAAK,gBAAgB,OAAOhM,eAA5B,EAA8C;AAC7CA,sBAAgB2E,aAAhB,GAAgC,eAAe,OAAOuE,EAAErL,IAAF,CAAO8G,aAA7B,GAA6CuE,EAAErL,IAAF,CAAO8G,aAApD,GAAoE3E,gBAAgB2E,aAApH;AACA3E,sBAAgB8E,kBAAhB,GAAqC,eAAe,OAAOoE,EAAErL,IAAF,CAAOiH,kBAA7B,GAAkDoE,EAAErL,IAAF,CAAOiH,kBAAzD,GAA8E9E,gBAAgB8E,kBAAnI;AACA9E,sBAAgB0E,YAAhB,GAA+B,eAAe,OAAOwE,EAAErL,IAAF,CAAOoO,WAA7B,GAA2C/C,EAAErL,IAAF,CAAOoO,WAAlD,GAAgEjM,gBAAgB0E,YAA/G;AACA1E,sBAAgBkF,WAAhB,GAA8B,eAAe,OAAOgE,EAAErL,IAAF,CAAOqH,WAA7B,GAA2CgE,EAAErL,IAAF,CAAOqH,WAAlD,GAAgElF,gBAAgBkF,WAA9G;AACAlF,sBAAgBmF,UAAhB,GAA6B,eAAe,OAAO+D,EAAErL,IAAF,CAAOsH,UAA7B,GAA0C+D,EAAErL,IAAF,CAAOsH,UAAjD,GAA8DnF,gBAAgBmF,UAA3G;AACAnF,sBAAgBiF,cAAhB,GAAiC,eAAe,OAAOiE,EAAErL,IAAF,CAAOoH,cAA7B,GAA8CiE,EAAErL,IAAF,CAAOoH,cAArD,GAAsEjF,gBAAgBiF,cAAvH;AACAjF,sBAAgBgF,kBAAhB,GAAqC,eAAe,OAAOkE,EAAErL,IAAF,CAAOmH,kBAA7B,GAAkDkE,EAAErL,IAAF,CAAOmH,kBAAzD,GAA8EhF,gBAAgBgF,kBAAnI;AACAhF,sBAAgB6E,YAAhB,GAA+B,eAAe,OAAOqE,EAAErL,IAAF,CAAOgH,YAA7B,GAA4CqE,EAAErL,IAAF,CAAOgH,YAAnD,GAAkE7E,gBAAgB6E,YAAjH;AACA;;AAED,SAAI,aAAa+G,SAAjB,EAA6B;AAC5B5L,sBAAgBkM,KAAhB,GAAwB3E,SAAUvH,gBAAgBkF,WAA1B,IAA0CqC,SAAUvH,gBAAgBmF,UAA1B,CAAlE;AACA;;AAED,SAAIgH,gBAAkBnM,gBAAgB2E,aAAhB,GAAgC3E,gBAAgB4E,WAAlD,GAAkE,GAAtF;AACAuH,qBAAgBnB,cAAemB,aAAf,EAA8B,CAA9B,CAAhB;;AAEA;AACA1N,OAAG,0BAAH,EAAgCjB,IAAhC,CAAsC2O,aAAtC;;AAEA;AACA,SAAIC,UAAU3N,EAAG,iCAAH,CAAd;AACA,SAAK2N,QAAQnO,MAAR,GAAiB,CAAtB,EAA0B;AACzBmO,cAAQzO,IAAR;AACAc,QAAG,oCAAH,EAA0Cd,IAA1C;AACA;AACD;AACAc,OAAG,0BAAH,EAAgCD,MAAhC;;AAEA;AACAC,OAAG,wBAAH,EAA8BP,IAA9B;;AAEA,SAAK,gBAAgB,OAAOgL,EAAErL,IAAF,CAAOkI,KAAnC,EAA2C;AAC1C;AACAuF,kCAA6BpC,EAAErL,IAAF,CAAOkI,KAApC;AACA;AACD;AACD;AACA,QAAK,eAAe,OAAOmD,EAAErL,IAAF,CAAOwO,OAAlC,EAA4C;AAC3C5N,OAAG,mCAAH,EAAyC2I,OAAzC,CAAkD8B,EAAErL,IAAF,CAAOwO,OAAzD;AACA;AACD;AACA,QAAK,eAAe,OAAOnD,EAAErL,IAAF,CAAOyO,MAAlC,EAA2C;AAC1C7N,OAAG,uBAAH,EAA6B0I,KAA7B,CAAoC+B,EAAErL,IAAF,CAAOyO,MAA3C;AACA;AACD;AACA7N,MAAG,qBAAH,EAA2Bd,IAA3B;;AAEA;AACA,QAAK,eAAe,OAAOuL,EAAErL,IAAF,CAAO0O,WAA7B,IAA4CrD,EAAErL,IAAF,CAAO0O,WAAxD,EAAsE;AACrE,SAAIC,eAAezO,OAAQ,wBAAR,CAAnB;AACA,SAAKyO,aAAavO,MAAb,GAAsB,CAA3B,EAA+B;AAC9BuO,mBAAahO,MAAb;AACA;AACD,SAAK,gBAAgB0K,EAAErL,IAAF,CAAO4O,iBAA5B,EAAgD;AAC/ChO,QAAG,0CAAH,EAAgDjB,IAAhD,CAAsD0L,EAAErL,IAAF,CAAO4O,iBAA7D;AACA;AACD;AACDrH,iBAAcwG,SAAd;AACA;AAED,GAtED,EAsEIvG,MAtEJ,CAsEY,YAAY;;AAEvB;AACAtH,UAAQ,yDAAR,EAAoEJ,IAApE;;AAEA;AACAwL,UAAOjK,IAAP,CAAanC,cAAc2P,gBAA3B,EACEtJ,WADF,CACe,+CADf,EAEEJ,QAFF,CAEY,4BAFZ;;AAIA;AACA2J,cAAY,YAAY;AACvBxD,WAAO/F,WAAP,CAAoB,4BAApB,EACElE,IADF,CACQnC,cAAc6P,aADtB;AAEA,IAHD,EAGG,IAHH;;AAKAnO,KAAG,kBAAH,EAAwB8E,UAAxB,CAAoC,UAApC;;AAEA;AACA,OAAK9E,EAAG,4BAAH,EAAkCR,MAAvC,EAAgD;AAC/CE,mBAAgBM,EAAG,4BAAH,CAAhB;AACA;AACD,GA5FD;AA6FA,EA/HD;;AAiIA;;;;;;;AAOA,KAAIoO,mBAAmB,SAAnBA,gBAAmB,CAAW/M,KAAX,EAAmB;AACzCA,QAAMqC,MAAN,GAAe,0BAAf;AACArC,QAAMgN,UAAN,GAAmB/O,OAAQ,0BAAR,EAAqC+I,GAArC,EAAnB;AACA,MAAIC,MAAM,EAAV;AACAtI,IAAE2D,IAAF,CAAQ;AACPQ,SAAM,KADC;AAEPjD,QAAKyB,OAFE;AAGPvD,SAAMiC,KAHC;AAIPmE,YAAS,iBAAWJ,QAAX,EAAsB;AAC9BkD,UAAMlD,QAAN;AACA,IANM;AAOPkJ,UAAO;AAPA,GAAR;AASA;AACAtO,IAAG,4BAAH,EAAkCjB,IAAlC,CAAwCT,cAAciQ,OAAtD;AACA,SAAOjG,GAAP;AACA,EAhBD;AAiBA;;;;AAIA,KAAIkG,eAAe,SAAfA,YAAe,GAAY;;AAE9B;AACAC,MAAIC,OAAJ,CAAY,sBAAZ,EAAoCxP,IAApC;;AAEAc,IAAG,2FAAH,EAAiG8E,UAAjG,CAA6G,UAA7G;;AAEA;AACA9E,IAAG,2DAAH,EAAiEyH,GAAjE,CAAsE,EAAC,WAAW,GAAZ,EAAtE;AACA,EATD;;AAWA;;;;AAIA,KAAIkH,gBAAgB,SAAhBA,aAAgB,GAAY;;AAE/B;AACAF,MAAIG,YAAJ,CAAkB5O,EAAG,oDAAH,CAAlB;AACA,EAJD;;AAMA;;;;;;;;AAQA,KAAI6O,kBAAkB,SAAlBA,eAAkB,CAAWtL,MAAX,EAAoB;AACzC,MAAIuL,WAAWvL,OAAOzE,IAAP,CAAa,yDAAb,CAAf;AACA,MAAKgQ,SAAStP,MAAT,IAAmB,CAAxB,EAA4B;AAC3B,UAAO,IAAP;AACA;AACD,SAAO,KAAP;AACA,EAND;;AAQA;;;;;;AAMA,KAAIuP,sBAAsB,SAAtBA,mBAAsB,CAAWC,GAAX,EAAiB;;AAE1C,MAAIC,SAASD,IAAIE,OAAJ,CAAa,IAAb,CAAb;AACA,MAAIC,cAAcF,OAAOG,IAAP,CAAa,IAAb,CAAlB;AACA,MAAIC,mBAAmBF,YAAYrQ,IAAZ,CAAkB,8BAAlB,CAAvB;AACA,MAAIwQ,2BAA2BH,YAAYrQ,IAAZ,CAAkB,kCAAlB,CAA/B;AACA,MAAIyQ,gBAAgBJ,YAAYrQ,IAAZ,CAAkB,UAAlB,CAApB;AACA,MAAI0Q,kBAAkBL,YAAYrQ,IAAZ,CAAkB,uBAAlB,CAAtB;;AAEA,MAAI2Q,WAAWT,IAAIE,OAAJ,CAAa,IAAb,EAAoBpQ,IAApB,CAA0B,qBAA1B,CAAf;AACA,MAAIyE,SAASyL,IAAIzD,EAAJ,CAAQ,IAAR,IAAiByD,IAAIzL,MAAJ,EAAjB,GAAgC,EAA7C;;AAEA;AACA,MAAKkM,SAASjQ,MAAT,GAAkB,CAAvB,EAA2B;AAC1B,OAAIkQ,QAAQD,SAASjQ,MAArB;AACA,OAAImQ,UAAUF,SAASlP,MAAT,CAAiB,YAAjB,EAAgCf,MAA9C;AACA,OAAKmQ,UAAU,CAAV,IAAeD,QAAQ,CAA5B,EAAgC;AAC/BJ,6BAAyB3K,WAAzB,CAAsC,YAAtC;AACA,QAAIiL,UAAYD,UAAUD,KAAZ,GAAsB,GAApC;AACAE,cAAUrD,cAAeqD,OAAf,EAAwB,CAAxB,CAAV;AACAN,6BAAyBvQ,IAAzB,CAA+B6Q,UAAU,GAAzC;AACA;AACD;;AAED;AACA,MAAK,KAAK5P,EAAG,sCAAH,EAA4CqI,GAA5C,EAAL,IAA0DsH,WAAWD,KAA1E,EAAkF;AACjF;AACAL,oBAAiB9K,QAAjB,CAA2B,6BAA3B;AACA;;AAED,MAAKhB,OAAO/D,MAAP,KAAkB,CAAvB,EAA2B;AAC1B;AACA;;AAED;AACA,MAAKqP,gBAAiBtL,MAAjB,CAAL,EAAiC;AAChC,OAAKoM,UAAUD,KAAf,EAAuB;AACtB,QAAIzM,YAAYyM,QAAQC,OAAxB;AACA,QAAIhF,UAAU,mDAAmD1H,SAAnD,GAA+D,GAA/D,IAAuE,KAAKA,SAAL,GAAiB3E,cAAcuR,uBAA/B,GAAyDvR,cAAcwR,gBAA9I,IAAmK,YAAjL;;AAEA;AACA,QAAIjC,SAAStK,OAAOzE,IAAP,CAAa,gBAAb,CAAb;AACA,QAAK+O,OAAOrO,MAAZ,EAAqB;AACpBqO,YAAO9N,MAAP;AACA;;AAED;AACAwD,WAAOmF,KAAP,CAAciC,OAAd;AACA0E,qBAAiB1K,WAAjB,CAA8B,6BAA9B,EAA8DJ,QAA9D,CAAwE,SAAxE;AACA0K,WAAOnQ,IAAP,CAAa,IAAb,EAAoByF,QAApB,CAA8B,SAA9B;AACA4K,gBAAYrQ,IAAZ,CAAkB,IAAlB,EAAyByF,QAAzB,CAAmC,SAAnC;AACA,IAfD,MAeO;AACN8K,qBAAiB1K,WAAjB,CAA8B,qCAA9B,EAAsEJ,QAAtE,CAAgF,WAAhF;AACA;AACAgL,kBAAc5K,WAAd,CAA2B,iBAA3B,EAA+CJ,QAA/C,CAAyD,kBAAzD;AACAiL,oBAAgBtQ,IAAhB;AACA+P,WAAOnQ,IAAP,CAAa,IAAb,EAAoB6F,WAApB,CAAiC,SAAjC,EAA6CJ,QAA7C,CAAuD,WAAvD;AACA4K,gBAAYrQ,IAAZ,CAAkB,IAAlB,EAAyB6F,WAAzB,CAAsC,SAAtC,EAAkDJ,QAAlD,CAA4D,WAA5D;AACA;AACD;AACA8K,oBAAiB1K,WAAjB,CAA8B,6BAA9B;AACA2K,4BAAyBvQ,IAAzB,CAA+B,EAA/B;AACA;AAED,EAhED;;AAkEA;;;;AAIA,KAAIgR,yBAAyB,SAAzBA,sBAAyB,GAAY;AACxC;AACA,MAAK/P,EAAG,sCAAH,EAA4C0L,MAA5C,KAAuD,IAAvD,IAA+D1L,EAAG,+BAAH,EAAqCR,MAArC,IAA+C,CAAnH,EAAuH;AACtH;AACA;;AAED,MAAIwQ,gBAAgBhQ,EAAG,2BAAH,EAAiCiQ,KAAjC,EAApB;AACAD,gBAAczL,QAAd,CAAwB,KAAxB;AACAvE,IAAG,sCAAH,EAA4C2I,OAA5C,CAAqDqH,aAArD;AACA,EATD;;AAWA,KAAIE,mBAAmB,SAAnBA,gBAAmB,GAAY;AAClC;AACA,MAAKlQ,EAAG,sCAAH,EAA4C0L,MAA5C,KAAuD,IAAvD,IAA+D1L,EAAG,kCAAH,EAAwCR,MAAxC,IAAkD,CAAtH,EAA0H;AACzH;AACA;;AAED,MAAI2Q,eAAenQ,EAAG,qCAAH,EAA2CiQ,KAA3C,EAAnB;AACAE,eAAa5L,QAAb,CAAuB,KAAvB,EAA+BI,WAA/B,CAA4C,QAA5C;AACA3E,IAAG,sCAAH,EAA4C2I,OAA5C,CAAqDwH,YAArD;AAEA,EAVD;;AAYA;;;;;;;;AAQA,KAAIC,uBAAuB,SAAvBA,oBAAuB,CAAWC,WAAX,EAAyB;AACnD;AACA,MAAKrQ,EAAG,sCAAH,EAA4C0L,MAA5C,KAAuD,IAAvD,IAA+D1L,EAAG,6CAAH,EAAmDR,MAAnD,IAA6D,CAAjI,EAAqI;AACpI;AACA;AACD,MAAIqO,SAAS,EAAb;AACA;AACA,MAAK,cAAcwC,WAAnB,EAAiC;AAChCxC,YAAS7N,EAAG,sCAAH,EAA4CiQ,KAA5C,EAAT;AACA,GAFD,MAEO,IAAK,iBAAiBI,WAAtB,EAAoC;AAC1CxC,YAAS7N,EAAG,mCAAH,EAAyCiQ,KAAzC,EAAT;AACA,GAFM,MAEA;AACNpC,YAAS7N,EAAG,uCAAH,EAA6CiQ,KAA7C,EAAT;AACA;;AAED;AACApC,SAAOtJ,QAAP,CAAiB,KAAjB;;AAEA;AACAvE,IAAG,oDAAH,EAA0D0I,KAA1D,CAAiEmF,MAAjE;AACA,EApBD;;AAsBA,KAAIyC,wBAAwB,SAAxBA,qBAAwB,GAAY;AACvC,MAAIC,mBAAmBvQ,EAAG,uCAAH,CAAvB;AACAuQ,mBAAiB5L,WAAjB,CAA8B,oBAA9B;AACA,MAAK4L,iBAAiB/Q,MAAjB,GAA0B,CAA/B,EAAmC;AAClC+Q,oBAAiBC,IAAjB,CAAuB,UAAW5G,KAAX,EAAkBoF,GAAlB,EAAwB;AAC9C,QAAKhP,EAAGgP,GAAH,EAASvD,QAAT,CAAmB,mBAAnB,CAAL,EAAgD;AAC/C;AACAzL,OAAGgP,GAAH,EAASlQ,IAAT,CAAe,cAAf,EAAgCiB,MAAhC;;AAEA;AACA,SAAI0Q,kBAAkBzQ,EAAGgP,GAAH,EAASlQ,IAAT,CAAe,uBAAf,CAAtB;;AAEA;AACA,SAAK2R,gBAAgBjR,MAAhB,GAAyB,CAA9B,EAAkC;AACjC,UAAIkR,YAAYD,gBAAgBlQ,MAAhB,CAAwB,YAAxB,EAAuCf,MAAvD;AACA,UAAIoG,QAAQ6K,gBAAgBlQ,MAAhB,CAAwB,QAAxB,EAAmCf,MAA/C;AACA;AACA,UAAKkR,aAAaD,gBAAgBjR,MAAlC,EAA2C;AAC1CQ,SAAGgP,GAAH,EAASzK,QAAT,CAAmB,UAAnB;AACA,OAFD,MAEO,IAAK,IAAImM,SAAJ,IAAiB,IAAI9K,KAA1B,EAAkC;AACxC;AACA5F,SAAGgP,GAAH,EAASzK,QAAT,CAAmB,SAAnB;AACA;AACD;AAED,KApBD,MAoBO;AACN;AACAvE,OAAGgP,GAAH,EAASlQ,IAAT,CAAe,cAAf,EAAgCiB,MAAhC;AACA;AACD,IAzBD;AA0BA;AACD,EA/BD;;AAiCA;;;;;;AAMA,KAAI4Q,kBAAkB,SAAlBA,eAAkB,GAAY;;AAEjC;AACA,MAAIC,UAAUrP,gBAAgBsP,eAAhB,GAAkC,CAAlC,GAAsCtP,gBAAgBsP,eAAtD,GAAwE,CAAtF;AACA,MAAIvK,gBAAgB/E,gBAAgB+E,aAAhB,GAAgC,CAAhC,GAAoC/E,gBAAgB+E,aAApD,GAAoE,CAAxF;AACA,MAAIwK,YAAY,UAAhB;AACA,MAAKF,UAAU,EAAf,EAAoB;AACnB,OAAIE,YAAY,UAAhB;AACA;AACD;AACA,MAAKF,UAAU,CAAf,EAAmB;AAClBA,aAAUE,YAAYF,OAAtB;AACAtK,mBAAgBwK,YAAYxK,aAA5B;AACA;;AAED/E,kBAAgBwP,WAAhB,GAA8B;AAC7B,cAAWxE,cAAeqE,OAAf,EAAwB,CAAxB,CADkB;AAE7B,oBAAiBjF,YAAarF,aAAb,EAA4B,CAA5B;;AAFY,GAA9B;AAKA,EApBD;;AAsBA;;;;;;AAMA,KAAIc,yBAAyB,SAAzBA,sBAAyB,CAAW4J,WAAX,EAAwB7M,IAAxB,EAA+B;AAC3D;AACA,MAAK,eAAe,OAAO5C,eAA3B,EAA6C;AAC5C;AACA;;AAED;AACA,MAAK,WAAW4C,IAAhB,EAAuB;AACtB5C,mBAAgB2E,aAAhB,GAAgC4C,SAAUvH,gBAAgB2E,aAA1B,IAA4C,CAA5E;;AAEA;AACA3E,mBAAgB0E,YAAhB,GAA+B6C,SAAUvH,gBAAgB0E,YAA1B,IAA2C6C,SAAUkI,YAAY1J,KAAtB,CAA1E;;AAEA;AACA,OAAK0J,YAAYC,QAAjB,EAA4B;AAC3B1P,oBAAgB8E,kBAAhB,GAAqCyC,SAAUvH,gBAAgB8E,kBAA1B,IAAiD,CAAtF;AACA;;AAED;AACA9E,mBAAgBiF,cAAhB,GAAiC,eAAe,OAAOwK,YAAYxK,cAAZ,CAA2BiH,KAAjD,GAAyD3E,SAAUvH,gBAAgBiF,cAA1B,IAA6CsC,SAAUkI,YAAYxK,cAAZ,CAA2BiH,KAArC,CAAtG,GAAqJ3E,SAAUvH,gBAAgBiF,cAA1B,CAAtL;;AAEA;AACAjF,mBAAgB6E,YAAhB,GAA+B,eAAe,OAAO4K,YAAYxK,cAAZ,CAA2BiH,KAAjD,GAAyD3E,SAAUvH,gBAAgB6E,YAA1B,IAA2C,CAApG,GAAwG7E,gBAAgB6E,YAAvJ;;AAEA;AACA7E,mBAAgBgF,kBAAhB,GAAqC,eAAe,OAAOyK,YAAYzK,kBAAlC,IAAwD,eAAe,OAAOyK,YAAYzK,kBAAZ,CAA+BkH,KAA7G,GAAqH3E,SAAUvH,gBAAgBgF,kBAA1B,IAAiDuC,SAAUkI,YAAYzK,kBAAZ,CAA+BkH,KAAzC,CAAtK,GAAyN3E,SAAUvH,gBAAgBgF,kBAA1B,CAA9P;AACA,GAnBD,MAmBO,IAAK,qBAAqBpC,IAA1B,EAAiC;AACvC;AACA5C,mBAAgB0E,YAAhB,GAA+B6C,SAAUvH,gBAAgB0E,YAA1B,IAA2C,CAA1E;AACA,GAHM,MAGA,IAAK,aAAa9B,IAAlB,EAAyB;AAC/B5C,mBAAgB2E,aAAhB,GAAgC4C,SAAUvH,gBAAgB2E,aAA1B,IAA4C,CAA5E;AACA3E,mBAAgB8E,kBAAhB,GAAqCyC,SAAUvH,gBAAgB8E,kBAA1B,IAAiD,CAAtF;;AAEA;AACA9E,mBAAgB0E,YAAhB,GAA+B6C,SAAUvH,gBAAgB0E,YAA1B,IAA2C6C,SAAUkI,YAAY1J,KAAtB,CAA1E;AACA;;AAED;AACA,MAAK0J,YAAYvK,WAAZ,GAA0BuK,YAAYtK,UAA3C,EAAwD;AACvD;AACAnF,mBAAgBkF,WAAhB,GAA8B,eAAe,OAAOuK,YAAYvK,WAAlC,GAAgDqC,SAAUvH,gBAAgBkF,WAA1B,IAA0CqC,SAAUkI,YAAYvK,WAAtB,CAA1F,GAAgIqC,SAAUvH,gBAAgBkF,WAA1B,CAA9J;AACAlF,mBAAgBmF,UAAhB,GAA6B,eAAe,OAAOsK,YAAYtK,UAAlC,GAA+CoC,SAAUvH,gBAAgBmF,UAA1B,IAAyCoC,SAAUkI,YAAYtK,UAAtB,CAAxF,GAA6HoC,SAAUvH,gBAAgBmF,UAA1B,CAA1J;AACA;AACD;AACA,MAAK,eAAe,OAAOsK,YAAYxK,cAAvC,EAAwD;AACvD;AACAjF,mBAAgBkF,WAAhB,GAA8B,eAAe,OAAOuK,YAAYxK,cAAZ,CAA2BC,WAAjD,GAA+DqC,SAAUvH,gBAAgBkF,WAA1B,IAA0CqC,SAAUkI,YAAYxK,cAAZ,CAA2BC,WAArC,CAAzG,GAA8JqC,SAAUvH,gBAAgBkF,WAA1B,CAA5L;AACAlF,mBAAgBmF,UAAhB,GAA6B,eAAe,OAAOsK,YAAYxK,cAAZ,CAA2BE,UAAjD,GAA8DoC,SAAUvH,gBAAgBmF,UAA1B,IAAyCoC,SAAUkI,YAAYxK,cAAZ,CAA2BE,UAArC,CAAvG,GAA2JoC,SAAUvH,gBAAgBmF,UAA1B,CAAxL;AACA;AACD;AACA,MAAK,eAAe,OAAOsK,YAAYzK,kBAAvC,EAA4D;AAC3D;AACAhF,mBAAgBkF,WAAhB,GAA8B,eAAe,OAAOuK,YAAYzK,kBAAZ,CAA+BE,WAArD,GAAmEqC,SAAUvH,gBAAgBkF,WAA1B,IAA0CqC,SAAUkI,YAAYzK,kBAAZ,CAA+BE,WAAzC,CAA7G,GAAsKqC,SAAUvH,gBAAgBkF,WAA1B,CAApM;AACAlF,mBAAgBmF,UAAhB,GAA6B,eAAe,OAAOsK,YAAYzK,kBAAZ,CAA+BG,UAArD,GAAkEoC,SAAUvH,gBAAgBmF,UAA1B,IAAyCoC,SAAUkI,YAAYzK,kBAAZ,CAA+BG,UAAzC,CAA3G,GAAmKoC,SAAUvH,gBAAgBmF,UAA1B,CAAhM;AACA;AACD,EAvDD;;AAyDA;;;;;AAKA,KAAIC,eAAe,SAAfA,YAAe,CAAWwG,SAAX,EAAuB;;AAEzC,MAAI+D,gBAAgB,CAApB;AAAA,MACCnE,gBAAgB,CADjB;AAEA,MAAIoE,aAAa,eAAe,OAAOhE,SAAtB,IAAmC,aAAaA,SAAjE;;AAEA;AACA5L,kBAAgB+E,aAAhB,GAAgCwC,SAAUvH,gBAAgBkF,WAA1B,IAA0CqC,SAAUvH,gBAAgBmF,UAA1B,CAA1E;;AAEA,MAAI0F,iBAAiBT,YAAapK,gBAAgB+E,aAA7B,EAA4C,CAA5C,CAArB;;AAEA,MAAK6K,UAAL,EAAkB;AACjBnR,KAAG,yCAAH,EAA+CjB,IAA/C,CAAqDqN,cAArD;AACA,GAFD,MAEO;AACNpM,KAAG,yCAAH,EAA+CjB,IAA/C,CAAqDuN,oBAAqBF,cAArB,CAArD;AACApM,KAAG,yCAAH,EAA+CjB,IAA/C,CAAqDoN,kBAAmBC,cAAnB,CAArD;AACA;;AAED;AACA7K,kBAAgBsP,eAAhB,GAAkCtE,cAAiBzD,SAAUvH,gBAAgB+E,aAA1B,IAA4CwC,SAAUvH,gBAAgBkF,WAA1B,CAA9C,GAA0F,GAAzG,EAA8G,CAA9G,CAAlC;AACA,MAAK,CAAE2K,MAAO7P,gBAAgBsP,eAAvB,CAAP,EAAkD;AACjD7Q,KAAG,2CAAH,EAAiDjB,IAAjD,CAAuDwC,gBAAgBsP,eAAvE;AACA;;AAED;AACA;;AAEA;AACAtP,kBAAgBmM,aAAhB,GAAgCnB,cAAiBzD,SAAUvH,gBAAgB2E,aAA1B,IAA4C4C,SAAUvH,gBAAgB4E,WAA1B,CAA9C,GAA0F,GAAzG,EAA8G,CAA9G,CAAhC;AACAnG,IAAG,8BAAH,EAAoCjB,IAApC,CAA0CwC,gBAAgBmM,aAA1D;;AAEA;AACA,MAAK,eAAe,OAAOnM,gBAAgB+E,aAAtC,IAAuD,eAAe,OAAO/E,gBAAgBiF,cAAlG,EAAmH;AAClH0K,mBAAgBpI,SAAUvH,gBAAgB+E,aAA1B,IAA4CwC,SAAUvH,gBAAgBiF,cAA1B,CAA5D;AACA,OAAK0K,gBAAgB,CAArB,EAAyB;AACxBlR,MAAG,iDAAH,EAAuDjB,IAAvD,CAA6D4M,YAAauF,aAAb,EAA4B,CAA5B,CAA7D;AACA;AACD;;AAED;AACA,MAAKC,UAAL,EAAkB;AACjBnR,KAAG,oDAAH,EAA0DjB,IAA1D,CAAgEwC,gBAAgB0E,YAAhF;AACA,GAFD,MAEO;AACNjG,KAAG,kFAAH,EAAwFjB,IAAxF,CAA8FwC,gBAAgB0E,YAA9G;AACA;;AAED;AACA;;AAEA;AACAjG,IAAG,yFAAH,EAA+FjB,IAA/F,CAAqGwC,gBAAgB6E,YAArH;;AAEA;AACA;;AAEA;;AAEA;AACA,MAAKpG,EAAG,2CAAH,EAAiDR,MAAjD,IAA2D,eAAe,OAAO+B,gBAAgB8E,kBAAtG,EAA2H;AAC1HrG,KAAG,2CAAH,EAAiDjB,IAAjD,CAAuDwC,gBAAgB8E,kBAAvE;AACA;;AAED;AACA,MAAIgL,2BAA2BrR,EAAG,2BAAH,CAA/B;AACA,MAAKqR,yBAAyB7R,MAAzB,GAAkC,CAAlC,IAAuC,eAAe,OAAS+B,gBAAgBgF,kBAA/E,IAAuGhF,gBAAgBgF,kBAAhB,IAAsC,EAAlJ,EAAuJ;AACtJ,OAAI+K,qBAAqBD,yBAAyBvS,IAAzB,CAA+B,iBAA/B,CAAzB;AACA,OAAKwS,mBAAmB9R,MAAnB,GAA4B,CAAjC,EAAqC;AACpC8R,uBAAmBvS,IAAnB,CAAyB4M,YAAapK,gBAAgBgF,kBAA7B,EAAiD,CAAjD,CAAzB;AACA;AACD;;AAED;AACA,MAAIgL,uBAAuBvR,EAAG,uBAAH,CAA3B;AACA,MAAKuR,qBAAqB/R,MAArB,GAA8B,CAA9B,IAAmC,eAAe,OAAS+B,gBAAgBiF,cAA3E,IAA+FjF,gBAAgBiF,cAAhB,IAAkC,EAAtI,EAA2I;AAC1I;AACA,OAAIgL,gBAAgB1I,SAAUvH,gBAAgBiF,cAA1B,CAApB;AACA,OAAIiL,iBAAiBF,qBAAqBzS,IAArB,CAA2B,iBAA3B,CAArB;AACA,OAAI4S,iBAAiBH,qBAAqBzS,IAArB,CAA2B,+BAA3B,CAArB;AACA;AACA,OAAK0S,gBAAgB,CAAhB,IAAqBC,eAAejS,MAAf,GAAwB,CAAlD,EAAsD;AACrD;AACA,QAAKkS,eAAelS,MAAf,GAAwB,CAA7B,EAAiC;AAChCkS,oBAAexS,IAAf;AACA;AACDuS,mBAAe1S,IAAf,CAAqB4M,YAAapK,gBAAgBiF,cAA7B,EAA6C,CAA7C,CAArB;AACA;AACD;;AAED;AACAmK;;AAEA;AACA,MAAK,eAAe,OAAQpP,gBAAgBwP,WAA5C,EAA2D;AAC1D;AACA,OAAIY,oBAAoB3R,EAAG,wBAAH,CAAxB;AACA,OAAK2R,kBAAkBnS,MAAlB,GAA2B,CAAhC,EAAoC;AACnC,QAAIoS,sBAAsBD,kBAAkB7S,IAAlB,CAAwB,yBAAxB,CAA1B;AACA,QAAI+S,oBAAoBF,kBAAkB7S,IAAlB,CAAwB,uBAAxB,CAAxB;AACA,QAAK8S,oBAAoBpS,MAApB,GAA6B,CAA7B,IAAkC,eAAe,OAAQ+B,gBAAgBwP,WAAhB,CAA4BnB,OAArF,IAAiGrO,gBAAgBwP,WAAhB,CAA4BnB,OAA5B,IAAuC,EAA7I,EAAkJ;AACjJgC,yBAAoB7S,IAApB,CAA0BwC,gBAAgBwP,WAAhB,CAA4BnB,OAAtD;AACA;AACD,QAAKiC,kBAAkBrS,MAAlB,GAA2B,CAA3B,IAAgC,eAAe,OAAQ+B,gBAAgBwP,WAAhB,CAA4BzK,aAAnF,IAAqG/E,gBAAgBwP,WAAhB,CAA4BzK,aAA5B,IAA6C,EAAvJ,EAA4J;AAC3JuL,uBAAkB9S,IAAlB,CAAwBwC,gBAAgBwP,WAAhB,CAA4BzK,aAApD;AACA;AACD;AACD;AACD,EA1GD;;AA4GA;;;AAGA,KAAIwL,2BAA2B,SAA3BA,wBAA2B,CAAWzB,WAAX,EAAyB;;AAEvD;AACArQ,IAAG,2BAAH,EAAiC2E,WAAjC,CAA8C,6BAA9C;;AAEA;AACA3E,IAAG,uBAAH,EAA6Bd,IAA7B,GAAoCoF,IAApC,CAA0C,UAA1C,EAAsD,UAAtD;;AAEA;AACA,MAAK,MAAM+L,WAAX,EAAyB;AACxBrQ,KAAG,uBAAH,EAA6BuD,MAA7B,GAAsCrE,IAAtC;AACA,GAFD,MAEO;AACNc,KAAG,uBAAH,EAA6BP,IAA7B,GAAoCqF,UAApC,CAAgD,UAAhD;AACA;;AAED;AACA9E,IAAG,wBAAH,EAA8BP,IAA9B,GAAqCqF,UAArC,CAAiD,UAAjD,EAA6D,UAA7D;;AAEA;AACAiL;;AAEA;AACAG;;AAEA,MAAK,MAAMG,WAAX,EAAyB;AACxB;AACA,OAAI0B,YAAY/R,EAAG,uBAAH,CAAhB;AACA,OAAI0P,QAAQqC,UAAUvS,MAAtB;AACA,OAAIwS,WAAWD,UAAUxR,MAAV,CAAkB,kBAAlB,EAAuCf,MAAtD;AACA,OAAImQ,UAAUD,QAAQsC,QAAtB;AACA,OAAKA,WAAW,CAAhB,EAAoB;AACnB;AACAhS,MAAG,6BAAH,EAAmCjB,IAAnC,CAAyCiT,QAAzC;AACAhS,MAAG,yBAAH,EAA+BjB,IAA/B,CAAqC2Q,KAArC;AACA1P,MAAG,2BAAH,EAAiCjB,IAAjC,CAAuC4Q,OAAvC;;AAEA;AACA3P,MAAG,oCAAH,EAA0CP,IAA1C;;AAEA;AACA2Q;AACA,IAXD,MAWO;;AAEN;AACA,QAAIzF,UAAU3K,EAAG,mCAAH,EAAyCiQ,KAAzC,GAAiDxQ,IAAjD,EAAd;AACA;AACAO,MAAG,+BAAH,EAAqCiS,GAArC,CAA0C,QAA1C,EAAqDA,GAArD,CAA0D,OAA1D,EAAoE/S,IAApE;AACAc,MAAG,wCAAH,EAA8CjB,IAA9C,CAAoD4L,OAApD,EAA8DhG,WAA9D,CAA2E,mBAA3E;;AAEA;AACAyL,yBAAsB,UAAtB;AACA;AACD,GA5BD,MA4BO;AACN;AACApQ,KAAG,qCAAH,EAA2CP,IAA3C;AACA;AACA2Q,wBAAsB,aAAtB;AACA;AACD,EA1DD;;AA4DA;;;AAGA,KAAI8B,YAAY,SAAZA,SAAY,GAAY;;AAE3B,MAAIC,oBAAoB7S,OAAQ,wEAAR,CAAxB;;AAEA;AACA,MAAI8S,cAAcD,kBAAkBE,KAAlB,EAAlB;;AAEA,MAAIC,eAAeF,YAAYtT,IAAZ,CAAkB,8BAAlB,CAAnB;AACA,MAAIyT,YAAYH,YAAYlD,OAAZ,CAAqB,IAArB,EAA4BE,IAA5B,CAAkC,IAAlC,CAAhB;AACA,MAAIoD,eAAeD,UAAUzT,IAAV,CAAgB,8BAAhB,CAAnB;AACA,MAAI2T,cAAcF,UAAUzT,IAAV,CAAgB,uBAAhB,CAAlB;AACA,MAAI4T,mBAAmBH,UAAUzT,IAAV,CAAgB,kCAAhB,CAAvB;;AAEA;AACA,MAAK0T,aAAahT,MAAb,IAAuB,CAA5B,EAAgC;AAC/BgT,gBAAajO,QAAb,CAAuB,6BAAvB,EAAuDI,WAAvD,CAAoE,mBAApE;AACA8N,eAAYlO,QAAZ,CAAsB,YAAtB,EAAqCrF,IAArC;AACA;;AAED;AACAc,IAAG,kCAAH,EAAwCiS,GAAxC,CAA6C,YAA7C,EAA4DtN,WAA5D,CAAyE,YAAzE;;AAEA;AACA2N,eAAa/N,QAAb,CAAuB,6BAAvB;;AAEA;AACA,MAAK6N,YAAY5S,MAAZ,KAAuB,CAA5B,EAAgC;AAC/BsS,4BAA0B,EAA1B;AACA;AACA;;AAED;AACA,MAAIzQ,QAAQ;AACXqC,WAAQ,UADG;AAEXiP,aAAUP,YAAY9N,IAAZ,CAAkB,IAAlB,CAFC;AAGXsO,cAAWT,kBAAkB3S,MAAlB,GAA2B,CAA3B,GAA+B,CAA/B,GAAmC,CAHnC;AAIXuE,UAAO/D,EAAG,eAAH,EAAqBqI,GAArB;AAJI,GAAZ;;AAOA;AACArI,IAAEsN,GAAF,CAAO3K,OAAP,EAAgBtB,KAAhB,EAAuB,UAAWiH,GAAX,EAAiB;;AAEvC;AACA,OAAK,OAAOA,IAAIlJ,IAAX,KAAoB,WAApB,IAAmCkJ,IAAIlJ,IAAJ,CAASwG,KAAT,IAAkB,0BAA1D,EAAuF;AACtF;AACAwM,gBAAYzN,WAAZ,CAAwB,WAAxB;AACA;AACAmN,6BAA0B,oBAA1B;AACA;AACA;;AAED;AACA,OAAI1S,OAAO,eAAe,OAASkJ,IAAIlJ,IAA5B,GAAqCkJ,IAAIlJ,IAAzC,GAAgD,EAA3D;;AAEA;AACA,OAAK,eAAe,OAAOA,KAAKyT,KAAhC,EAAyC;AACxC;AACA,QAAI7D,MAAM1P,OAAQgL,SAASwI,cAAT,CAAyB1T,KAAKyT,KAAL,CAAWhL,EAApC,CAAR,CAAV;AACA,QAAIkL,mBAAmB/D,IAAIlQ,IAAJ,CAAU,8BAAV,CAAvB;;AAEAkQ,QAAIrK,WAAJ,CAAiB,SAAjB;AACAoO,qBAAiBpO,WAAjB,CAA8B,6BAA9B;;AAEA,QAAK2D,IAAI9C,OAAT,EAAmB;;AAElBwJ,SAAIzK,QAAJ,CAAc,WAAd;AACAwO,sBAAiBxO,QAAjB,CAA2B,WAA3B;;AAEA;AACAwK,yBAAqBC,GAArB;;AAEA;AACA,KATD,MASO;AACN;AACAA,SAAIzK,QAAJ,CAAc,WAAd;AACAwO,sBAAiBxO,QAAjB,CAA2B,SAA3B;AACA;AACAwK,yBAAqBC,GAArB;AACA;;AAED;AACA;;AAED;AACA,OAAK,KAAKhP,EAAG,sCAAH,EAA4CqI,GAA5C,EAAV,EAA8D;AAC7D;AACA6J,cAAW,KAAX;AACA,IAHD,MAGO;AACN;AACAlS,MAAG,8BAAH,EAAoCqI,GAApC,CAAyC,CAAzC;AACA;AAED,GApDD;AAqDA,EA7FD;;AA+FA;AACA,UAAS2K,OAAT,CAAkBC,GAAlB,EAAwB;AACvB,MAAIC,SAAS,CAAb;AACA,MAAKD,IAAIE,YAAT,EAAwB;AACvB,MAAG;AACFD,cAAUD,IAAIG,SAAd;AACA,IAFD,QAEUH,MAAMA,IAAIE,YAFpB;AAGA,UAAO,CAACD,MAAD,CAAP;AACA;AACD;;AAED;AACA,KAAIG,eAAe,SAAfA,YAAe,CAAWC,QAAX,EAAsB;AACxC;AACAtT,IAAG,WAAH,EAAiBuT,OAAjB,CAA0B;AACxBC,cAAWxT,EAAGsT,QAAH,EAAcG,MAAd,GAAuBC,GAAvB,GAA6B;AADhB,GAA1B,EAGC,MAHD;AAIA,EAND;;AAQA,KAAIC,kBAAkB,SAAlBA,eAAkB,CAAWpR,IAAX,EAAkB;AACvCA,OAAK+B,IAAL,CAAW,UAAX,EAAuB,UAAvB;AACAtE,IAAG,kBAAH,EAAwBsE,IAAxB,CAA8B,UAA9B,EAA0C,UAA1C;AACA,EAHD;;AAKA,KAAIsP,2BAA2B,SAA3BA,wBAA2B,CAAWlO,KAAX,EAAmB;AACjD;AACA,MAAK,eAAe,OAASA,MAAMmO,SAAnC,EAAiD;AAChD,OAAIC,cAAc9T,EAAG,oEAAH,CAAlB;AACA,OAAI+T,gBAAgB/T,EAAG,sEAAH,CAApB;;AAEA;AACA,OAAK0F,MAAMmO,SAAN,CAAgBpG,KAAhB,GAAwB,CAA7B,EAAiC;AAChC;AACAzN,MAAG,oDAAH,EAA0Dd,IAA1D;AACA;AACA,QAAK4U,YAAYtU,MAAZ,GAAqB,CAA1B,EAA8B;AAC7BsU,iBAAY/U,IAAZ,CAAkB2G,MAAMmO,SAAN,CAAgBG,KAAlC;AACA,KAFD,MAEO;AACN,SAAIC,OAAO,wCAAwCvO,MAAMmO,SAAN,CAAgBpG,KAAxD,GAAgE,SAA3E;AACA;;AAED;AACA,QAAK/H,MAAMmO,SAAN,CAAgBjE,OAAhB,GAA0B,CAA/B,EAAmC;AAClC;AACA5P,OAAG,kEAAH,EAAwE2E,WAAxE,CAAoF,YAApF;AACA;AACA,SAAKoP,cAAcvU,MAAd,GAAuB,CAA5B,EAAgC;AAC/BuU,oBAAchV,IAAd,CAAoB2G,MAAMmO,SAAN,CAAgBjE,OAAhB,GAA0B,GAA9C;AACA,MAFD,MAEO;AACN,UAAIqE,OAAO,0CAA0CvO,MAAMmO,SAAN,CAAgBjE,OAA1D,GAAoE,GAApE,GAA0E,SAArF;AACA;AACD;AACD;AACD;;AAED;AACA,MAAK,eAAe,OAASlK,MAAMwO,cAA9B,IAAkDxO,MAAMwO,cAAN,CAAqB1U,MAArB,GAA8B,CAArF,EAAyF;AACxF,OAAI2U,UAAUzO,MAAMwO,cAApB;;AAEA,OAAIxG,gBAAkByG,QAAQxE,OAAR,GAAkBwE,QAAQC,WAA5B,GAA4C,GAAhE;AACA1G,mBAAgBnB,cAAemB,aAAf,EAA8B,CAA9B,CAAhB;;AAEA;AACA,OAAKA,aAAL,EAAqB;AACpB1N,MAAG,uDAAH,EAA6DjB,IAA7D,CAAmE2O,aAAnE;AACA;AACD;AACA,OAAKyG,QAAQC,WAAb,EAA2B;AAC1BpU,MAAG,yDAAH,EAA+DjB,IAA/D,CAAqEoV,QAAQC,WAA7E;AACA;AACD;AACA,OAAKD,QAAQvD,OAAb,EAAuB;AACtB5Q,MAAG,iDAAH,EAAuDjB,IAAvD,CAA6DoV,QAAQvD,OAArE;AACA;AACD,OAAKuD,QAAQvE,OAAb,EAAuB;AACtB5P,MAAG,mDAAH,EAAyDjB,IAAzD,CAA+DoV,QAAQvE,OAAvE;AACA;AACD;AACD,EAtDD;;AAwDA;;;AAGA,KAAIyE,aAAa,SAAbA,UAAa,GAAY;AAC5B;AACArU,IAAG,uBAAH,EAA6BP,IAA7B;AACAO,IAAG,iCAAH,EAAuCsU,KAAvC;AACA,EAJD;;AAMA;AACA,UAASC,UAAT,CAAqBrT,GAArB,EAA2B;AAC1B,MAAIA,MAAMA,IAAIsT,KAAJ,CAAWtT,IAAIE,OAAJ,CAAa,GAAb,IAAqB,CAAhC,EAAoCY,KAApC,CAA2C,GAA3C,CAAV;AACA,OAAM,IAAIC,IAAI,CAAd,EAAiBA,IAAIf,IAAI1B,MAAzB,EAAiCyC,GAAjC,EAAuC;AACtC,OAAIwS,WAAWC,UAAWxT,IAAIe,CAAJ,CAAX,EAAoBD,KAApB,CAA2B,OAA3B,EAAqC,CAArC,CAAf;AACA,UAAOyS,SAASnL,OAAT,CAAkB,gBAAlB,EAAoC,EAApC,CAAP;AACA;AACD;;AAED;;;AAGAtJ,GAAG,MAAH,EAAYwJ,EAAZ,CAAgB,OAAhB,EAAyB,uBAAzB,EAAkD,UAAWK,CAAX,EAAe;;AAEhE;AACA,MAAK,cAAc7J,EAAG,IAAH,EAAUsE,IAAV,CAAgB,UAAhB,CAAnB,EAAkD;AACjD,UAAO,KAAP;AACA;;AAED;AACAuF,IAAEC,cAAF;AACA;AACA,MAAI6K,eAAe3U,EAAG,IAAH,EAAUlB,IAAV,CAAgB,eAAhB,CAAnB;AACAkB,IAAG,IAAH,EAAUpB,OAAV,GAAoBC,EAApB,CAAwB,CAAxB,EAA4BC,IAA5B,CAAkC,sBAAlC,EAA2D8V,WAA3D;AACAD,eAAalU,IAAb,CAAmBkU,aAAalU,IAAb,MAAuB,GAAvB,GAA6B,GAA7B,GAAmC,GAAtD;AAGA,EAfD;;AAiBA;AACAT,GAAG,MAAH,EAAYwJ,EAAZ,CAAgB,OAAhB,EAAyB,uCAAzB,EAAkE,UAAWK,CAAX,EAAe;AAChF;AACAA,IAAEC,cAAF;AACA,MAAIzL,SAAS8D,KAAb,CAAoBnC,EAAG,IAAH,CAApB,EAA+B,KAA/B;AACA,EAJD;;AAMA;AACAA,GAAG,MAAH,EAAYwJ,EAAZ,CAAgB,OAAhB,EAAyB,wBAAzB,EAAmD,UAAWK,CAAX,EAAe;AACjE;AACAA,IAAEC,cAAF;AACA,MAAIzL,SAAS8D,KAAb,CAAoBnC,EAAG,IAAH,CAApB,EAA+B,KAA/B,EAAsC,SAAtC;AACA,EAJD;;AAMA;AACAA,GAAG,MAAH,EAAYwJ,EAAZ,CAAgB,OAAhB,EAAyB,wBAAzB,EAAmD,UAAWK,CAAX,EAAe;AACjE;AACAA,IAAEC,cAAF;;AAEA;AACA,MAAK,OAAOvI,eAAP,IAA0B,WAA1B,IACFA,gBAAgB0B,SAAhB,CAA0BzD,MAA1B,IAAoC,CAApC,IAAyC+B,gBAAgByB,OAAhB,CAAwBxD,MAAxB,IAAkC,CAD9E,EAEE;;AAED,UAAO,KAAP;AAEA;;AAEDF,SAAQ,kCAAR,EAA6CgF,IAA7C,CAAmD,UAAnD,EAA+D,UAA/D;AACAtE,IAAG,qCAAH,EAA2Cd,IAA3C;AACA,MAAIb,SAAS8D,KAAb,CAAoBnC,EAAG,IAAH,CAApB,EAA+B,IAA/B,EAAqC,SAArC;AAEA,EAjBD;;AAmBA;AACAA,GAAG,MAAH,EAAYwJ,EAAZ,CAAgB,OAAhB,EAAyB,mCAAzB,EAA8D,UAAWK,CAAX,EAAe;AAC5E,MAAIM,iBAAiBnK,EAAG,IAAH,CAArB;AACA,MAAIoK,eAAe,qBAAnB;AACAF,uBAAsBL,CAAtB,EAAyBM,cAAzB,EAAyCC,YAAzC,EAAuD,SAAvD;AACA;AACA,MAAI7G,SAAS4G,eAAevL,OAAf,GAAyBC,EAAzB,CAA6B,CAA7B,CAAb;AACA,MAAK0E,OAAOkI,QAAP,CAAiB,SAAjB,CAAL,EAAoC;AACnClI,UAAOoB,WAAP,CAAoB,SAApB,EAAgCJ,QAAhC,CAA0C,WAA1C;AACA;AACD,EATD;;AAWA;AACAvE,GAAG,MAAH,EAAYwJ,EAAZ,CAAgB,OAAhB,EAAyB,mCAAzB,EAA8D,UAAWK,CAAX,EAAe;AAC5E,MAAIM,iBAAiBnK,EAAG,IAAH,CAArB;AACA,MAAIoK,eAAe,qBAAnB;AACAF,uBAAsBL,CAAtB,EAAyBM,cAAzB,EAAyCC,YAAzC,EAAuD,UAAvD;AACA,EAJD;;AAMA;AACApK,GAAG,MAAH,EAAYwJ,EAAZ,CAAgB,OAAhB,EAAyB,2CAAzB,EAAsE,UAAWK,CAAX,EAAe;AACpF,MAAIM,iBAAiBnK,EAAG,IAAH,CAArB;AACA,MAAIoK,eAAe,6BAAnB;AACAF,uBAAsBL,CAAtB,EAAyBM,cAAzB,EAAyCC,YAAzC,EAAuD,SAAvD;AACA,EAJD;;AAMA;AACApK,GAAG,MAAH,EAAYwJ,EAAZ,CAAgB,OAAhB,EAAyB,2CAAzB,EAAsE,UAAWK,CAAX,EAAe;AACpF,MAAIM,iBAAiBnK,EAAG,IAAH,CAArB;AACA,MAAIoK,eAAe,6BAAnB;AACAF,uBAAsBL,CAAtB,EAAyBM,cAAzB,EAAyCC,YAAzC,EAAuD,UAAvD;AACA,EAJD;;AAMA;AACApK,GAAG,MAAH,EAAYwJ,EAAZ,CAAgB,OAAhB,EAAyB,gBAAzB,EAA2C,UAAWK,CAAX,EAAe;;AAEzDA,IAAEC,cAAF;;AAEA;AACAkD,eAAchN,EAAG,IAAH,CAAd,EAAyB,KAAzB;AACA,EAND;;AAQA;AACA;AACAA,GAAG,8CAAH,EAAoDwJ,EAApD,CAAwD,OAAxD,EAAiE,UAAWK,CAAX,EAAe;AAC/EA,IAAEC,cAAF;AACA,MAAI+K,MAAM7U,EAAG,IAAH,EAAUpB,OAAV,GAAoBC,EAApB,CAAwB,CAAxB,CAAV;AACAa,iBAAgBmV,GAAhB;;AAEA;AACA,MAAIxT,QAAQ;AACXqC,WAAQ;AADG,GAAZ;AAGA1D,IAAEwK,IAAF,CAAQ7H,OAAR,EAAiBtB,KAAjB;AACA,EAVD;;AAYA;AACArB,GAAG,MAAH,EAAYwJ,EAAZ,CAAgB,OAAhB,EAAyB,iCAAzB,EAA4D,UAAWK,CAAX,EAAe;AAC1EA,IAAEC,cAAF;AACA,MAAI+K,MAAM7U,EAAG,IAAH,EAAUuD,MAAV,EAAV;AACA7D,iBAAgBmV,GAAhB;AACA,EAJD;;AAMA;AACA7U,GAAG,8BAAH,EAAoCwJ,EAApC,CAAwC,OAAxC,EAAiD,UAAWK,CAAX,EAAe;AAC/DA,IAAEC,cAAF;;AAEA,MAAIgL,eAAe,EAAnB;AACA,MAAIC,gBAAgB/U,EAAG,4BAAH,CAApB;AACA;AACA,MAAK+U,cAAcvV,MAAd,GAAuB,CAA5B,EAAgC;AAC/BsV,kBAAeC,cAAc1M,GAAd,EAAf;AACA;;AAED;AACA,MAAI9F,OAAOvC,EAAG,IAAH,CAAX;AACAuC,OAAKgB,MAAL,GAAczE,IAAd,CAAoB,kCAApB,EAAyD6F,WAAzD,CAAsE,YAAtE;;AAEA;AACA,MAAK,MAAMmQ,YAAN,IAAsB,aAAaA,YAAxC,EAAuD;AACtD;AACA,OAAIzT,QAAQ;AACXqC,YAAQ,eADG;AAEXK,WAAO/D,EAAG,yBAAH,EAA+BqI,GAA/B;AAFI,IAAZ;;AAKAhH,WAAQ/B,OAAO+B,KAAP,CAAcA,KAAd,IAAwB,GAAxB,GAA8B/B,OAAQ,6BAAR,EAAwC0V,SAAxC,EAAtC;;AAEA;AACA1V,UAAOkL,IAAP,CAAa7H,OAAb,EAAsBtB,KAAtB,EAA8B8D,IAA9B,CAAoC,YAAY;AAC/C7F,WAAQ,6BAAR,EAAwC2V,MAAxC;AACA,WAAO,IAAP;AACA,IAHD;AAIA,GAdD,MAcO;;AAEN;AACA,OAAIpK,cAActI,KAAK3D,OAAL,GAAeC,EAAf,CAAmB,CAAnB,CAAlB;;AAEA;AACA,OAAIqW,YAAY5K,SAASwI,cAAT,CAAyB,oBAAzB,CAAhB;AACA,OAAIhF,cAAcxD,SAASwI,cAAT,CAAyB,gBAAzB,CAAlB;AACA,OAAIqC,iBAAiB7K,SAASwI,cAAT,CAAyB,mBAAzB,CAArB;AACA,OAAIsC,gBAAgB9K,SAASwI,cAAT,CAAyB,iBAAzB,CAApB;AACA,OAAIuC,eAAe/K,SAASwI,cAAT,CAAyB,qBAAzB,CAAnB;;AAEA,OAAIwC,oBAAoB,IAAxB;;AAEAtV,KAAG,sBAAH,EAA4Bd,IAA5B;;AAEA;AACA,OAAK,CAAEgW,cAAc,IAAd,IAAsBA,UAAUK,OAAlC,MACCzH,gBAAgB,IAAhB,IAAwB,CAACA,YAAYyH,OADtC,MAECJ,mBAAmB,IAAnB,IAA2B,CAACA,eAAeI,OAF5C,MAGCH,kBAAkB,IAAlB,IAA0B,CAACA,cAAcG,OAH1C,MAICF,iBAAiB,IAAjB,IAAyB,CAACA,aAAaE,OAJxC,CAAL,EAKE;AACDD,wBAAoB,KAApB;AACA;;AAED;AACA/S,QAAK+B,IAAL,CAAW,UAAX,EAAuB,UAAvB,EAAoCC,QAApC,CAA8C,aAA9C;;AAEA,OAAK+Q,iBAAL,EAAyB;AACxB/S,SAAK8F,GAAL,CAAU/J,cAAckX,QAAxB;AACA;;AAED;AACA,OAAIrI,YAAY5K,KAAKnD,IAAL,CAAW,MAAX,CAAhB;AACA+N,eAAY,eAAe,OAAOA,SAAtB,GAAkC,OAAlC,GAA4CA,SAAxD;;AAEA;AACA,OAAI9L,QAAQ;AACXqC,YAAQ,kBADG;AAEX2J,4BAAwB/N,OAAQ,yBAAR,EAAoC+I,GAApC,EAFb;AAGX8E,eAAWA;AAHA,IAAZ;;AAMA9L,WAAQ/B,OAAO+B,KAAP,CAAcA,KAAd,IAAwB,GAAxB,GAA8B/B,OAAQ,6BAAR,EAAwC0V,SAAxC,EAAtC;;AAEA;AACA1V,UAAOkL,IAAP,CAAa7H,OAAb,EAAsBtB,KAAtB,EAA8B8D,IAA9B,CAAoC,YAAY;AAC/C7F,WAAQ,6BAAR,EAAwC2V,MAAxC;AACA,WAAO,IAAP;AACA,IAHD;AAIA;AACD,EAjFD;;AAmFA;AACAjV,GAAG,MAAH,EAAYwJ,EAAZ,CAAgB,OAAhB,EAAyB,wBAAzB,EAAmD,UAAWK,CAAX,EAAe;AACjEA,IAAEC,cAAF;AACA,MAAIvH,OAAOjD,OAAQ,IAAR,CAAX;AACA,MAAImW,YAAYlT,KAAK3D,OAAL,GAAeC,EAAf,CAAmB,CAAnB,CAAhB;;AAEA;AACA,MAAIgW,MAAMtS,KAAKgB,MAAL,EAAV;AACA7D,iBAAgBmV,GAAhB;;AAEA;AACA7U,IAAG,oCAAH,EAA0CD,MAA1C;;AAEA;AACA0V,YAAU3W,IAAV,CAAgB,eAAhB,EAAkCwF,IAAlC,CAAwC,YAAxC,EAAsD,cAAtD;;AAEA;AACA/C,kBAAgB2E,aAAhB,GAAgC4C,SAAUvH,gBAAgB2E,aAA1B,IAA4C3E,gBAAgByB,OAAhB,CAAwBxD,MAApG;AACA+B,kBAAgB8E,kBAAhB,GAAqCyC,SAAUvH,gBAAgB8E,kBAA1B,IAAiD9E,gBAAgByB,OAAhB,CAAwBxD,MAA9G;;AAEA;AACA,MAAK+B,gBAAgB2E,aAAhB,IAAiC3E,gBAAgB4E,WAAtD,EAAoE;;AAEnE;AACAnG,KAAG,wEAAH,EAA8EP,IAA9E;;AAEA;AACAO,KAAG,yBAAH,EAA+Bd,IAA/B;AAEA;AACD;AACAc,IAAG,0BAAH,EAAgCD,MAAhC;;AAEA,MAAIoE,OAAOnE,EAAG,gBAAH,EAAsBZ,IAAtB,CAA4B,MAA5B,CAAX;AACA+E,SAAO,eAAe,OAAOA,IAAtB,GAA6B,OAA7B,GAAuCA,IAA9C;;AAEA,MAAI4I,gBAAgB,eAAe,OAAOxL,gBAAgB2E,aAAtC,GAAsD3E,gBAAgB2E,aAAtE,GAAsF,CAA1G;;AAEA,MAAIwH,gBAAkBX,gBAAgBxL,gBAAgB4E,WAAlC,GAAkD,GAAtE;AACAuH,kBAAgBnB,cAAemB,aAAf,EAA8B,CAA9B,CAAhB;;AAEA1N,IAAG,0BAAH,EAAgCjB,IAAhC,CAAsC2O,aAAtC;;AAEA;AACA;AACA,MAAIlG,gBAAgBlI,OAAQ,8CAAR,CAApB;AACA,MAAKkI,cAAchI,MAAd,GAAuB,CAA5B,EAAgC;AAC/B;AACA;;AAED;AACAgI,gBAAcC,GAAd,CAAmB,OAAnB,EAA4BiG,gBAAgB,GAA5C;;AAEA;AACA1N,IAAG,wBAAH,EAA8BP,IAA9B;AACAO,IAAG,oCAAH,EAA0CP,IAA1C;;AAEA,MAAI8K,SAAS;AACZ7G,WAAQ,qBADI;AAEZS,SAAMA;AAFM,GAAb;AAIA;AACAnE,IAAEwK,IAAF,CAAQ7H,OAAR,EAAiB4H,MAAjB,EAAyB,UAAWjC,GAAX,EAAiB;AACzC;AACA,OAAKA,IAAI9C,OAAJ,IAAe,eAAe,OAAO8C,IAAIlJ,IAAJ,CAASsG,KAAnD,EAA2D;AAC1D,QAAIA,QAAQ4C,IAAIlJ,IAAJ,CAASsG,KAArB;AACA;AACA,QAAK,gBAAgB,OAAOnE,eAA5B,EAA8C;AAC7CA,qBAAgB0E,YAAhB,GAA+B,eAAe,OAAOP,MAAMO,YAA5B,GAA2C6C,SAAUvH,gBAAgB0E,YAA1B,IAA2CP,MAAMO,YAA5F,GAA2G1E,gBAAgB0E,YAA1J;AACA1E,qBAAgBkF,WAAhB,GAA8B,eAAe,OAAOf,MAAMe,WAA5B,GAA0CqC,SAAUvH,gBAAgBkF,WAA1B,IAA0Cf,MAAMe,WAA1F,GAAwGlF,gBAAgBkF,WAAtJ;AACAlF,qBAAgBmF,UAAhB,GAA6B,eAAe,OAAOhB,MAAMgB,UAA5B,GAAyCoC,SAAUvH,gBAAgBmF,UAA1B,IAAyChB,MAAMgB,UAAxF,GAAqGnF,gBAAgBmF,UAAlJ;AACAnF,qBAAgBiF,cAAhB,GAAiC,eAAe,OAAOd,MAAMc,cAA5B,GAA6CsC,SAAUvH,gBAAgBiF,cAA1B,IAA6Cd,MAAMc,cAAhG,GAAiHjF,gBAAgBiF,cAAlK;AACAjF,qBAAgBgF,kBAAhB,GAAqC,eAAe,OAAOb,MAAMa,kBAA5B,GAAiDuC,SAAUvH,gBAAgBgF,kBAA1B,IAAiDb,MAAMa,kBAAxG,GAA6HhF,gBAAgBgF,kBAAlL;AACA;AACA,SAAK,eAAe,OAAShF,gBAAgBmU,iBAAxC,IAA+D,eAAe,OAASnU,gBAAgBmU,iBAAhB,CAAkCC,SAA9H,EAA4I;AAC3IpU,sBAAgBkF,WAAhB,GAA8B,eAAe,OAAOlF,gBAAgBmU,iBAAtC,GAA0D5M,SAAUvH,gBAAgBkF,WAA1B,IAA0CqC,SAAUvH,gBAAgBmU,iBAAhB,CAAkCC,SAA5C,CAApG,GAA8JpU,gBAAgBkF,WAA5M;AACAlF,sBAAgBmF,UAAhB,GAA6B,eAAe,OAAOnF,gBAAgBmU,iBAAtC,GAA0D5M,SAAUvH,gBAAgBmF,UAA1B,IAAyCoC,SAAUvH,gBAAgBmU,iBAAhB,CAAkCE,UAA5C,CAAnG,GAA8JrU,gBAAgBmF,UAA3M;AACA;;AAEDnF,qBAAgB6E,YAAhB,GAA+B,eAAe,OAAOV,MAAMU,YAA5B,GAA2C0C,SAAUvH,gBAAgB6E,YAA1B,IAA2CV,MAAMU,YAA5F,GAA2G7E,gBAAgB6E,YAA1J;AACA;AACD;AACA,QAAIpG,EAAE,+CAAF,EAAmDR,MAAnD,IAA6D,eAAe,OAAO+B,gBAAgB0B,SAAvG,EAAmH;AAClHjD,OAAE,+CAAF,EAAmDjB,IAAnD,CAAwDwC,gBAAgB0B,SAAhB,CAA0BzD,MAAlF;AACA;AACDmH;AACA;AACD,GAzBD;AA2BA,EAxFD;;AA0FA;AACA3G,GAAG,yBAAH,EAA+BwJ,EAA/B,CAAmC,OAAnC,EAA4C,UAAWK,CAAX,EAAe;AAC1DA,IAAEC,cAAF;;AAEA;AACA9J,IAAG,iBAAH,EAAuB6E,IAAvB,CAA6B,SAA7B,EAAwC,IAAxC,EAA+CyP,KAA/C;AACAjB,eAAc,wBAAd;AACA,EAND;;AAQA;AACArT,GAAG,yBAAH,EAA+BwJ,EAA/B,CAAmC,OAAnC,EAA4C,UAAWK,CAAX,EAAe;AAC1DA,IAAEC,cAAF;;AAEA;AACA9J,IAAG,kBAAH,EAAwB6E,IAAxB,CAA8B,SAA9B,EAAyC,IAAzC,EAAgDyP,KAAhD;AACAtU,IAAG,mCAAH,EAAyCP,IAAzC;;AAEA;AACA4T,eAAc,yBAAd;AACA,EATD;;AAWA;AACArT,GAAG,MAAH,EAAYwJ,EAAZ,CAAgB,OAAhB,EAAyB,wBAAzB,EAAmD,UAAWK,CAAX,EAAe;AACjEA,IAAEC,cAAF;AACA;AACA9J,IAAG,qBAAH,EAA2B6V,KAA3B;AACA7V,IAAG,yBAAH,EAA+B6V,KAA/B;AACA,EALD;;AAOA;AACA7V,GAAG,wCAAH,EAA8CsU,KAA9C,CAAqD,YAAY;AAChE;AACAtU,IAAG,IAAH,EAAU8V,QAAV,CAAoB,UAAWjM,CAAX,EAAe;AAClC,OAAKA,EAAEkM,OAAF,IAAa,EAAlB,EAAuB;AACtBlM,MAAEC,cAAF;AACA9J,MAAG,IAAH,EAAUlB,IAAV,CAAgB,kBAAhB,EAAqC+W,KAArC;AACA;AACD,GALD;AAMA,EARD;;AAUA;AACA7V,GAAG,MAAH,EAAYwJ,EAAZ,CAAgB,MAAhB,EAAwB,wBAAxB,EAAkD,YAAY;;AAE7D,MAAIjH,OAAOvC,EAAG,IAAH,CAAX;;AAEA,MAAI6K,cAActI,KAAK3D,OAAL,GAAeC,EAAf,CAAmB,CAAnB,CAAlB;;AAEA;AACA+L,2BAA0BC,WAA1B,EAAuC,KAAvC,EAA8C,KAA9C,EAP6D,CAON;AACvD,EARD;;AAUA;AACA7K,GAAG,MAAH,EAAYwJ,EAAZ,CAAgB,OAAhB,EAAyB,gDAAzB,EAA2E,YAAY;AACtF,MAAIjH,OAAOvC,EAAG,IAAH,CAAX;AACA,MAAIgW,gBAAgBhW,EAAG,gCAAH,CAApB;;AAEA,MAAKuC,KAAKgJ,EAAL,CAAS,UAAT,CAAL,EAA6B;AAC5ByK,iBAAcvW,IAAd;AACA,GAFD,MAEO;AACNuW,iBAAc9W,IAAd;AACA;AACD,EATD;;AAWA;AACAc,GAAG,MAAH,EAAYwJ,EAAZ,CAAgB,OAAhB,EAAyB,gBAAzB,EAA2C,YAAY;AACtD,MAAIjH,OAAOvC,EAAG,IAAH,CAAX;AACA,MAAIgW,gBAAgBhW,EAAG,2BAAH,CAApB;;AAEA,MAAKuC,KAAKgJ,EAAL,CAAS,UAAT,CAAL,EAA6B;AAC5ByK,iBAAcvW,IAAd;AACA,GAFD,MAEO;AACNuW,iBAAc9W,IAAd;AACA;AACD,EATD;;AAWA;AACAc,GAAG,MAAH,EAAYwJ,EAAZ,CAAgB,OAAhB,EAAyB,qBAAzB,EAAgD,YAAY;AAC3D,MAAIjH,OAAOvC,EAAG,IAAH,CAAX;AACA,MAAIiW,cAAcjW,EAAG,4BAAH,CAAlB;;AAEA,MAAKuC,KAAKgJ,EAAL,CAAS,UAAT,CAAL,EAA6B;AAC5B0K,eAAYxW,IAAZ;AACA,GAFD,MAEO;AACNwW,eAAY/W,IAAZ;AACA;AACD,EATD;;AAWA;AACAc,GAAG,sBAAH,EAA4B6V,KAA5B,CAAmC,YAAY;AAC9C,MAAItT,OAAOvC,EAAG,IAAH,CAAX;AACA,MAAIgW,gBAAgBhW,EAAG,2BAAH,CAApB;;AAEA,MAAKuC,KAAKgJ,EAAL,CAAS,UAAT,CAAL,EAA6B;AAC5ByK,iBAAcvW,IAAd;AACA,GAFD,MAEO;AACNuW,iBAAc9W,IAAd;AACA;AACD,EATD;;AAWA;AACAc,GAAG,uBAAH,EAA6BwJ,EAA7B,CAAiC,OAAjC,EAA0C,UAAWK,CAAX,EAAe;AACxD,MAAK7J,EAAG,IAAH,EAAUuL,EAAV,CAAc,UAAd,CAAL,EAAkC;AACjCvL,KAAG,2BAAH,EAAiCP,IAAjC;AACAO,KAAG,uBAAH,EAA6BiS,GAA7B,CAAkC,aAAlC,EAAkDzB,IAAlD,CAAwD,UAAW0F,CAAX,EAAe;AACtElW,MAAG,IAAH,EAAU2E,WAAV,CAAuB,YAAvB;AACA,IAFD;AAGA,GALD,MAKO;AACN3E,KAAG,2BAAH,EAAiCd,IAAjC;AACAc,KAAG,uBAAH,EAA6BiS,GAA7B,CAAkC,aAAlC,EAAkDzB,IAAlD,CAAwD,UAAW0F,CAAX,EAAe;AACtElW,MAAG,IAAH,EAAUuE,QAAV,CAAoB,YAApB;AACA,IAFD;AAGA;AACD,EAZD;;AAcA;AACAvE,GAAG,yBAAH,EAA+BwJ,EAA/B,CAAmC,OAAnC,EAA4C,UAAWK,CAAX,EAAe;AAC1DA,IAAEC,cAAF;AACA,MAAI5I,MAAM,KAAKiV,IAAf;AACA,MAAI1V,OAAO8T,WAAYrT,GAAZ,CAAX;AACA;AACAA,QAAMA,IAAIoI,OAAJ,CAAa,eAAb,EAA8B,OAAO7I,IAArC,CAAN;AACA,MAAI8G,QAAQ,GAAZ;AAAA,MACCmE,SAAS,GADV;AAAA,MAEC0K,OAAO,CAACpW,EAAG2B,MAAH,EAAY4F,KAAZ,KAAsBA,KAAvB,IAAgC,CAFxC;AAAA,MAGCmM,MAAM,CAAC1T,EAAG2B,MAAH,EAAY+J,MAAZ,KAAuBA,MAAxB,IAAkC,CAHzC;AAAA,MAICxK,MAAMA,GAJP;AAAA,MAKCmV,OAAO,aACN,SADM,GACM9O,KADN,GAEN,UAFM,GAEOmE,MAFP,GAGN,OAHM,GAGIgI,GAHJ,GAIN,QAJM,GAIK0C,IATb;;AAWAzU,SAAO2U,IAAP,CAAapV,GAAb,EAAkB,SAAlB,EAA6BmV,IAA7B;;AAEA,SAAO,KAAP;AACA,EApBD;;AAsBA;AACArW,GAAG,0BAAH,EAAgCwJ,EAAhC,CAAoC,OAApC,EAA6C,UAAWK,CAAX,EAAe;AAC3DA,IAAEC,cAAF;AACA,MAAIvC,QAAQ,GAAZ;AAAA,MACCmE,SAAS,GADV;AAAA,MAEC0K,OAAO,CAACpW,EAAG2B,MAAH,EAAY4F,KAAZ,KAAsBA,KAAvB,IAAgC,CAFxC;AAAA,MAGCmM,MAAM,CAAC1T,EAAG2B,MAAH,EAAY+J,MAAZ,KAAuBA,MAAxB,IAAkC,CAHzC;AAAA,MAICxK,MAAM,KAAKiV,IAJZ;AAAA,MAKCE,OAAO,aACN,SADM,GACM9O,KADN,GAEN,UAFM,GAEOmE,MAFP,GAGN,OAHM,GAGIgI,GAHJ,GAIN,QAJM,GAIK0C,IATb;;AAWAzU,SAAO2U,IAAP,CAAapV,GAAb,EAAkB,UAAlB,EAA8BmV,IAA9B;;AAEA,SAAO,KAAP;AACA,EAhBD;;AAkBA;AACArW,GAAG,6BAAH,EAAmCwJ,EAAnC,CAAuC,OAAvC,EAAgD,UAAWK,CAAX,EAAe;AAC9DA,IAAEC,cAAF;AACA;AACA,MAAIS,SAAS;AACZ7G,WAAQ;AADI,GAAb;AAGA,MAAI6S,OAAOvW,EAAG,IAAH,CAAX;AACA,MAAIuD,SAASgT,KAAK3X,OAAL,GAAeC,EAAf,CAAmB,CAAnB,CAAb;AACA0E,SAAOgB,QAAP,CAAiB,gBAAjB;AACAvE,IAAEsN,GAAF,CAAO3K,OAAP,EAAgB4H,MAAhB,EAAwB,UAAWE,CAAX,EAAe;AACtC;AACAlH,UAAOoB,WAAP,CAAoB,gBAApB,EAAuCJ,QAAvC,CAAiD,eAAjD;AACA,OAAK,KAAKkG,CAAV,EAAc;AACblH,WAAOe,IAAP,CAAa,cAAb,EAA6BhG,cAAckY,gBAA3C;AACA9W,mBAAgB6D,MAAhB,EAAwB,IAAxB;AACA,IAHD,MAGO;AACNA,WAAOe,IAAP,CAAa,cAAb,EAA6BhG,cAAcmY,kBAA3C;AACAvI,eAAY,SAASwI,aAAT,GAAyB;AACpCnT,YAAOoB,WAAP,CAAoB,eAApB;AACA,KAFD,EAEG,IAFH;AAGA;AACD,GAZD;AAaA,EAtBD;;AAwBA;AACA,KAAK,eAAe,OAAQgS,qBAAvB,IAAiD,KAAKA,qBAAtD,IAA+E3W,EAAG,gBAAH,EAAsBR,MAAtB,GAA+B,CAAnH,EAAuH;AACtH;AACAwN,eAAchN,EAAG,gBAAH,CAAd,EAAqC,KAArC;AACA;;AAED;AACAA,GAAG,MAAH,EAAYwJ,EAAZ,CAAgB,OAAhB,EAAyB,qBAAzB,EAAgD,UAAWK,CAAX,EAAe;AAC9D,MAAK7J,EAAG,qCAAH,EAA2CR,MAA3C,GAAoD,CAAzD,EAA6D;AAC5DqK,KAAEC,cAAF;AACA2E,OAAIC,OAAJ,CAAY,sBAAZ,EAAoCjP,IAApC;AACA;AACAO,KAAG,2CAAH,EAAiDuE,QAAjD,CAA2D,WAA3D;;AAEA;AACAvE,KAAG,gCAAH,EAAsC4W,QAAtC,CAAgD;AAC9CC,YAAQzI,gBADsC;AAE9C0I,iBAAa;AAFiC,IAAhD,EAIC,YAAY,CACX,CALF;AAQA;AACD,EAjBD;;AAmBA;AACA9W,GAAG,cAAH,EAAoBwJ,EAApB,CAAwB,OAAxB,EAAiC,wBAAjC,EAA2D,UAAWK,CAAX,EAAe;;AAEzEA,IAAEC,cAAF;;AAEA;AACA9J,IAAG,8CAAH,EAAoDd,IAApD;;AAEA;AACA,MAAKc,EAAG,IAAH,EAAUsE,IAAV,CAAgB,UAAhB,CAAL,EAAoC;AACnC;AACA,GAFD,MAEO;AACN;AACAtE,KAAG,IAAH,EAAUsE,IAAV,CAAgB,UAAhB,EAA4B,UAA5B;AACAtE,KAAG,wBAAH,EAA8BsE,IAA9B,CAAoC,UAApC,EAAgD,UAAhD;AACAtE,KAAG,wCAAH,EAA8CuE,QAA9C,CAAwD,WAAxD;AAEA;;AAED;AACAvE,IAAG,mBAAH,EAAyBD,MAAzB;;AAEAsU;;AAEA;AACArU,IAAG,2CAAH,EAAiDuE,QAAjD,CAA2D,WAA3D;;AAEA;AACAvE,IAAG,gCAAH,EAAsC4W,QAAtC,CAAgD;AAC9CC,WAAQzI,gBADsC;AAE9C0I,gBAAa;AAFiC,GAAhD,EAIC,YAAY,CACX,CALF;AAQA,EAnCD;;AAqCA;AACA9W,GAAG,mBAAH,EAAyBwJ,EAAzB,CAA6B,OAA7B,EAAsC,UAAWK,CAAX,EAAe;AACpD7J,IAAG,kBAAH,EAAwB8E,UAAxB,CAAoC,UAApC;AACA0J;AACA,EAHD;;AAKA;AACAxO,GAAG,sBAAH,EAA4BwJ,EAA5B,CAAgC,OAAhC,EAAyC,UAAWK,CAAX,EAAe;;AAEvDA,IAAEC,cAAF;;AAEA;AACA,MAAK9J,EAAG,IAAH,EAAUsE,IAAV,CAAgB,UAAhB,CAAL,EAAoC;AACnC;AACA;;AAED,MAAIoG,SAAS1K,EAAG,IAAH,CAAb;;AAEAA,IAAG,2CAAH,EAAiDyH,GAAjD,CAAsD,EAAC,WAAW,KAAZ,EAAtD;AACAzH,IAAG,6CAAH,EAAmD+W,MAAnD,CAA2D,OAA3D;;AAEA;AACA/W,IAAG,wBAAH,EAA8BD,MAA9B;;AAEA;AACA2K,SAAOpG,IAAP,CAAa,UAAb,EAAyB,UAAzB;;AAEA,MAAI0S,UAAUtM,OAAOnH,MAAP,GAAgBzE,IAAhB,CAAsB,iBAAtB,CAAd;AACA;AACAkY,UAAQzS,QAAR,CAAkB,6BAAlB;;AAEA;AACA,MAAI0S,OAAOjX,EAAG,6BAAH,EAAmCsE,IAAnC,CAAyC,KAAzC,CAAX;AACA2S,SAAO,eAAe,OAAQA,IAAvB,GAA+B,EAA/B,GAAoCA,IAA3C;;AAEA;AACA,MAAIC,WAAWlX,EAAG,kCAAH,EAAwCqI,GAAxC,EAAf;;AAEA;AACArI,IAAG,oBAAH,EAA0BqI,GAA1B,CAA+B6O,WAAW,GAAX,GAAiBD,IAAhD;;AAEA;AACA,MAAI5V,QAAQ;AACXqC,WAAQ,YADG;AAEXyT,eAAYnX,EAAG,oBAAH,EAA0BqI,GAA1B,EAFD;AAGX+O,qBAAkBpX,EAAG,gCAAH,EAAsCqI,GAAtC;AAHP,GAAZ;;AAMA;AACArI,IAAEsN,GAAF,CAAO3K,OAAP,EAAgBtB,KAAhB,EAAuB,UAAWiH,GAAX,EAAiB;AACvC,OAAK,CAACA,IAAI9C,OAAL,IAAgB,gBAAgB,OAAS8C,IAAIlJ,IAAJ,CAASuL,OAAvD,EAAmE;AAClE3K,MAAG,sCAAH,EAA4CjB,IAA5C,CAAkDuJ,IAAIlJ,IAAJ,CAASuL,OAA3D;AACA,IAFD,MAEO;AACN3K,MAAG,6CAAH,EAAmDuE,QAAnD,CAA6D,YAA7D;AACAvE,MAAG,sCAAH,EAA4CjB,IAA5C,CAAkDuJ,IAAIlJ,IAAtD;AACA,QAAIiY,yBAAyB/O,IAAIlJ,IAAJ,CAAS2D,GAAtC;AACA;AACD4L;AACAH;;AAEA;AACAwI,WAAQrS,WAAR,CAAqB,6BAArB;;AAEA;AACA3E,KAAG,uBAAH,EAA6B2E,WAA7B,CAA0C,YAA1C,EAAyDlF,IAAzD;AACA,GAhBD,EAgBI0F,IAhBJ,CAgBU,UAAWmD,GAAX,EAAiB;;AAE1B;AACAtI,KAAG,2CAAH,EAAiD2E,WAAjD,CAA8D,YAA9D;;AAEA;AACA,OAAK,CAAC2D,IAAI9C,OAAV,EAAoB;AACnB;AACAxF,MAAG,qCAAH,EAA2CuE,QAA3C,CAAqD,YAArD;AACA;AACA;;AAED;AACAvE,KAAG,qCAAH,EAA2C2E,WAA3C,CAAwD,YAAxD;;AAEA;AACA3E,KAAG,uBAAH,EAA6B8E,UAA7B,CAAyC,UAAzC;;AAEA;AACAiL;;AAEA;AACAG;;AAEAvO,UAAOC,QAAP,CAAgB0V,IAAhB,GAAuB,uBAAvB;AACA,GAzCD;AA0CA,EApFD;;AAsFA;;;AAGAtX,GAAG,wBAAH,EAA8BwJ,EAA9B,CAAkC,OAAlC,EAA2C,uBAA3C,EAAoE,UAAWK,CAAX,EAAe;AAClFA,IAAEC,cAAF;;AAEA;AACA,MAAK,CAAC9J,EAAG,qCAAH,EAA2CR,MAAjD,EAA0D;AACzD;AACA;;AAED;AACA,MAAIkL,SAAS1K,EAAG,iBAAH,CAAb;AACA,MAAIuD,SAASmH,OAAOnH,MAAP,EAAb;;AAEA;AACAvD,IAAG,yCAAH,EAA+Cd,IAA/C;;AAEA;AACAc,IAAG,sCAAH,EAA4CqI,GAA5C,CAAiD,CAAjD;;AAEA;AACArI,IAAG,wBAAH,EAA8Bd,IAA9B;;AAEA;AACAc,IAAG,uBAAH,EAA6Bd,IAA7B;;AAEA;AACAwL,SAAOxL,IAAP;AACAqE,SAAOzE,IAAP,CAAa,uBAAb,EAAuC6F,WAAvC,CAAoD,qBAApD,EAA4EG,UAA5E,CAAwF,UAAxF;;AAEA;AACA9E,IAAG,wBAAH,EAA8BsE,IAA9B,CAAoC,UAApC,EAAgD,UAAhD;;AAEA;AACAtE,IAAG,2BAAH,EAAiCuE,QAAjC,CAA2C,6BAA3C;;AAEA;AACA2N,YAAW,IAAX;AACA,EApCD;;AAsCA;AACAlS,GAAG,0BAAH,EAAgCwJ,EAAhC,CAAoC,OAApC,EAA6C,uBAA7C,EAAsE,UAAWK,CAAX,EAAe;AACpFA,IAAEC,cAAF;;AAEA,MAAIyN,eAAevX,EAAG,uBAAH,CAAnB;AACA;AACA,MAAKuX,aAAa9L,QAAb,CAAuB,UAAvB,CAAL,EAA2C;AAC1C,UAAO,KAAP;AACA;;AAED;AACAzL,IAAG,sCAAH,EAA4CqI,GAA5C,CAAiD,CAAjD;;AAEA;AACAkP,eAAahT,QAAb,CAAuB,YAAvB,EAAsCD,IAAtC,CAA4C,UAA5C,EAAwD,UAAxD;;AAEA;AACAtE,IAAG,+CAAH,EAAqDP,IAArD,GAA4DqF,UAA5D,CAAwE,UAAxE;AACA9E,IAAG,oEAAH,EAA0E2E,WAA1E,CAAuF,6BAAvF;;AAEA;AACA3E,IAAG,kCAAH,EAAwCuE,QAAxC,CAAkD,YAAlD;;AAEA;AACAvE,IAAG,uBAAH,EAA6BwQ,IAA7B,CAAmC,YAAW;AAC7C,OAAKxQ,EAAG,IAAH,EAAUuD,MAAV,GAAmBiU,OAAnB,CAA4B,sBAA5B,EAAqDhY,MAArD,KAAgE,CAArE,EAAyE;AACxEQ,MAAG,IAAH,EAAUP,IAAV;AACA;AACD,GAJD;;AAMA;AACAO,IAAG,2BAAH,EAAiC2E,WAAjC,CAA8C,6BAA9C;AACA,EA/BD;;AAiCA;AACA3E,GAAG,0BAAH,EAAgCwJ,EAAhC,CAAoC,OAApC,EAA6C,uBAA7C,EAAsE,UAAWK,CAAX,EAAe;AACpFA,IAAEC,cAAF;;AAEA,MAAIvH,OAAOvC,EAAG,IAAH,CAAX;;AAEA;AACA;;AAEA,MAAIiX,OAAO1U,KAAKnD,IAAL,CAAW,MAAX,CAAX;AACA,MAAIiC,QAAQ;AACXqC,WAAQ,oBADG;AAEXuT,SAAMA,IAFK;AAGXlT,UAAO/D,EAAG,kCAAH,EAAwCqI,GAAxC;AAHI,GAAZ;;AAMA;AACArI,IAAEwK,IAAF,CAAQ7H,OAAR,EAAiBtB,KAAjB,EAAwB,UAAWiH,GAAX,EAAiB;AACxC;AACA,OAAKA,IAAI9C,OAAT,EAAmB;AAClB;AACAjD,SAAK2M,OAAL,CAAc,uBAAd,EAAwCnP,MAAxC;AACAwC,SAAK2M,OAAL,CAAc,uBAAd,EAAwCuI,IAAxC,CAA8C,+BAA9C,EAAgF1X,MAAhF;;AAEA;AACA,QAAK,KAAKC,EAAG,qCAAH,EAA2CR,MAArD,EAA8D;AAC7DQ,OAAG,qCAAH,EAA2Cd,IAA3C;AACAc,OAAG,0BAAH,EAAgCd,IAAhC;AACA;AACD;AACD,GAbD;AAcA,EA9BD;;AAgCA;AACAc,GAAG,wBAAH,EAA8BwJ,EAA9B,CAAkC,OAAlC,EAA2C,YAAY;;AAEtD,MAAIjH,OAAOvC,EAAG,IAAH,CAAX;;AAEA;AACA2T,kBAAiBpR,IAAjB;;AAEA;AACAvC,IAAG,4BAAH,EAAkC2E,WAAlC,CAA+C,YAA/C;;AAEA,MAAI4F,SAAS;AACZ7G,WAAQ;AADI,GAAb;;AAIA;AACA1D,IAAEsN,GAAF,CAAO3K,OAAP,EAAgB4H,MAAhB,EAAwB,UAAWE,CAAX,EAAe;;AAEtC;AACAzK,KAAG,wBAAH,EAA8BD,MAA9B;AACA;AACAC,KAAG,wBAAH,EAA8B8E,UAA9B,CAA0C,UAA1C;AACA;AACA,OAAK,CAAC2F,EAAEjF,OAAR,EAAkB;AACjB;AACAxF,MAAG,uBAAH,EAA6B0I,KAA7B,CAAoC+B,EAAErL,IAAF,CAAOuL,OAA3C;AACA,IAHD,MAGO;AACN;AACA3K,MAAG,sCAAH,EAA4CjB,IAA5C,CAAkD0L,EAAErL,IAApD;AACAY,MAAG,0BAAH,EAAgC2E,WAAhC,CAA6C,YAA7C;;AAEAgK;AACA;AACD,GAjBD,EAiBIxJ,IAjBJ,CAiBU,YAAY;AACrB;AACA4K;;AAEA;AACAG;AACA,GAvBD;AAyBA,EAxCD;;AA0CA,KAAKlQ,EAAG,sBAAH,EAA4BR,MAA5B,GAAqC,CAA1C,EAA8C;AAC7C;AACA,MAAIkY,cAAc;AACjBhU,WAAQ;AADS,GAAlB;AAGA1D,IAAEsN,GAAF,CAAO3K,OAAP,EAAgB+U,WAAhB,EAA6B,UAAWjN,CAAX,EAAe;;AAE3C;AACAzK,KAAG,uCAAH,EAA6Cd,IAA7C;;AAEA;AACA,OAAK,CAACuL,EAAEjF,OAAH,IAAc,eAAe,OAASiF,EAAErL,IAAF,CAAOuL,OAAlD,EAA8D;AAC7D3K,MAAG,sCAAH,EAA4C2I,OAA5C,CAAqD8B,EAAErL,IAAF,CAAOuL,OAA5D;AACA;AACA;;AAED;AACA,OAAK,eAAe,OAASF,EAAErL,IAA1B,IAAmC,eAAe,OAASqL,EAAErL,IAAF,CAAOyU,SAAvE,EAAqF;AACpF;AACA7T,MAAG,0CAAH,EAAgD2F,MAAhD,CAAwDrH,cAAcqZ,UAAtE;AACA3X,MAAG,+CAAH,EAAqDd,IAArD;AAEA,IALD,MAKO;AACN;AACA0U,6BAA0BnJ,EAAErL,IAA5B;AACA;AAED,GAtBD;AAuBA;AACD;AACAY,GAAGsK,QAAH,EAAcsN,KAAd,CAAqB,UAAW/N,CAAX,EAAe;AACnC,MAAKA,EAAEkM,OAAF,KAAc,EAAnB,EAAwB;AACvB,OAAI8B,QAAQ7X,EAAG,wEAAH,CAAZ;AACA;AACA,OAAK,CAAC6X,MAAMtM,EAAN,CAAU,UAAV,CAAN,EAA+B;AAC9B;AACA;AACDsM,SAAM/Y,IAAN,CAAY,WAAZ,EAA0B+W,KAA1B;AAEA;AACD,EAVD;;AAYA;AACA7V,GAAG,6BAAH,EAAmCwJ,EAAnC,CAAuC,OAAvC,EAAgD,UAAWK,CAAX,EAAe;AAC9DA,IAAEC,cAAF;AACA,MAAIvG,SAASvD,EAAG,IAAH,EAAUuD,MAAV,EAAb;AACA;AACAA,SAAOrE,IAAP,CAAa,MAAb,EAAqB,YAAY;AAChCqE,UAAOxD,MAAP;AACA,GAFD;AAGAC,IAAE2D,IAAF,CAAQ;AACPQ,SAAM,MADC;AAEPjD,QAAKyB,OAFE;AAGPvD,SAAM;AACL,cAAU;AADL;AAHC,GAAR;AAOA,EAdD;;AAgBA;AACAY,GAAG,0CAAH,EAAgDwJ,EAAhD,CAAoD,OAApD,EAA6D,UAAWK,CAAX,EAAe;AAC3EA,IAAEC,cAAF;AACA,MAAIvG,SAASvD,EAAG,IAAH,EAAUuD,MAAV,EAAb;AACA;AACAA,SAAOrE,IAAP,CAAa,MAAb,EAAqB,YAAY;AAChCqE,UAAOxD,MAAP;AACA,GAFD;AAGAC,IAAE2D,IAAF,CAAQ;AACPQ,SAAM,MADC;AAEPjD,QAAKyB,OAFE;AAGPvD,SAAM;AACL,cAAU;AADL;AAHC,GAAR;AAOA,EAdD;AAgBA,CA3gFD;AA4gFA,CAAC,UAAWY,CAAX,EAAe;AACf,KAAImC,QAAQ,SAARA,KAAQ,CAAW2V,OAAX,EAAoBC,OAApB,EAA8B;AACzC,MAAIC,OAAOhY,EAAG8X,OAAH,CAAX;;AAEA,MAAIG,WAAW;AACdC,aAAU,KADI;AAEdvV,YAAS,EAFK;AAGdwV,SAAM,EAHQ;AAIdC,aAAU,cAJI;AAKdrV,QAAK;AALS,GAAf;AAOA,EAVD;AAWA/C,GAAEqY,EAAF,CAAKC,OAAL,GAAe,UAAWP,OAAX,EAAqB;AACnC,SAAO,KAAKvH,IAAL,CAAW,YAAY;AAC7B,OAAIsH,UAAU9X,EAAG,IAAH,CAAd;;AAEA;AACA,OAAK8X,QAAQ1Y,IAAR,CAAc,SAAd,CAAL,EACC;;AAED;AACA,OAAIkZ,UAAU,IAAInW,KAAJ,CAAW,IAAX,EAAiB4V,OAAjB,CAAd;;AAEA;AACAD,WAAQ1Y,IAAR,CAAc,SAAd,EAAyBkZ,OAAzB;AACA,GAZM,CAAP;AAaA,EAdD;AAgBA,CA5BD,EA4BIhZ,MA5BJ,E;;;;;;;;;;;;;;ACjlFAA,OAAQ,UAAWU,CAAX,EAAe;;AAEtB;AACAA,GAAG,WAAH,EAAiBwJ,EAAjB,CAAqB,OAArB,EAA8B,qBAA9B,EAAqD,UAAWK,CAAX,EAAe;AACnEA,IAAEC,cAAF;;AAEA9J,IAAG,IAAH,EAAUuD,MAAV,GAAmBgV,IAAnB,GAA0BzY,OAA1B,CAAmC,MAAnC;AACA,EAJD;;AAMAE,GAAG2B,MAAH,EAAY6H,EAAZ,CAAgB,MAAhB,EAAwB,YAAY;AACnC;AACA,MAAKxJ,EAAG,2BAAH,EAAiCR,MAAjC,GAA0C,CAA/C,EAAmD;AAClD;AACAmC,UAAO8M,GAAP,CAAWC,OAAX,CAAmB,0BAAnB,EAA+CjP,IAA/C;AACA;AACD,EAND;AAQA,CAjBD,E;;;;;;;;;;;;;;ACAE,WAAUO,CAAV,EAAc;AACf;;AAEA;;;;AAGAA,GAAG,2BAAH,EAAiCwJ,EAAjC,CAAqC,OAArC,EAA8C,YAAY;AACzD,MAAMjH,OAAOvC,EAAG,IAAH,CAAb;;AAEAA,IAAE2D,IAAF,CAAQ;AACPQ,SAAM,MADC;AAEPjD,QAAKyB,OAFE;AAGPvD,SAAMY,EAAG,yBAAH,EAA+BgV,SAA/B,EAHC;AAIPwD,eAAY,sBAAY;AACvB;AACAjW,SAAK+B,IAAL,CAAW,UAAX,EAAuB,UAAvB;;AAEA;AACAtE,MAAG,mDAAH,EAAyDyY,WAAzD,CAAsElW,IAAtE;AACA,IAVM;AAWPiD,YAAS,iBAAWpG,IAAX,EAAkB;AAC1B;AACAmD,SAAKuC,UAAL,CAAiB,UAAjB;AACA;AACAvC,SAAKgB,MAAL,GAAczE,IAAd,CAAoB,cAApB,EAAqCiB,MAArC;;AAEA;AACA6B,aAAS8W,MAAT;AACA;AAnBM,GAAR;AAqBA,EAxBD;;AA0BA;;;AAGA1Y,GAAG,mBAAH,EAAyBwJ,EAAzB,CAA6B,OAA7B,EAAsC,YAAY;AACjD,MAAMmP,OAAO3Y,EAAE,6BAAF,CAAb;;AAEAA,IAAE2D,IAAF,CAAQ;AACPQ,SAAM,MADC;AAEPjD,QAAKyB,OAFE;AAGPvD,SAAMuZ,KAAK3D,SAAL,EAHC;AAIPwD,eAAY,sBAAY;AACvBG,SAAK7Z,IAAL,CAAW,SAAX,EAAuBwF,IAAvB,CAA6B,UAA7B,EAAyC,UAAzC;AACA;AANM,GAAR;AAQA,EAXD;AAaA,CAhDC,EAgDChF,MAhDD,CAAF,C;;;;;;;;;;;;;;ACAA;;;AAGAA,OAAO,YAAY;AAClB,KAAIsZ,YAAYtZ,OAAO,eAAP,CAAhB;AAAA,KACCuZ,UAAUD,UAAU9Z,IAAV,CAAe,mBAAf,CADX;AAAA,KAECga,cAAcF,UAAU9Z,IAAV,CAAe,uBAAf,CAFf;AAGA8Z,WAAUG,MAAV,CAAiB,GAAjB;;AAEA;AACA,UAASC,aAAT,GAAyB;AACxBJ,YAAU/Y,MAAV,CAAiB,GAAjB,EAAsB,CAAtB,EAAyB,YAAY;AACpC+Y,aAAU9Y,OAAV,CAAkB,GAAlB,EAAuB,YAAY;AAClC8Y,cAAU7Y,MAAV;AACA,IAFD;AAGA,GAJD;AAKA;;AAED8Y,SAAQhD,KAAR,CAAc,UAAUoD,EAAV,EAAc;AAC3BD;AACAE,mBAAiBL,QAAQzZ,IAAR,CAAa,KAAb,CAAjB;AACA,EAHD;AAIA0Z,aAAYjD,KAAZ,CAAkB,UAAUoD,EAAV,EAAc;AAC/BD;AACAE,mBAAiBL,QAAQzZ,IAAR,CAAa,KAAb,CAAjB;AACA,EAHD;;AAKA;AACA,UAAS8Z,gBAAT,CAA0BvO,OAA1B,EAAmC;AAClCiO,YAAUtU,IAAV,CAAe,cAAf,EAA+BqG,OAA/B;AACAiO,YAAUrU,QAAV,CAAmB,SAAnB;;AAEA;AACA,MAAIlD,QAAQ;AACXqC,WAAQ;AADG,GAAZ;AAGApE,SAAOkL,IAAP,CAAY7H,OAAZ,EAAqBtB,KAArB;AACA;;AAED;AACA,UAAS8X,oBAAT,CAA+BzV,MAA/B,EAAwC;AACvC,MAAIrC,QAAQ;AACXqC,WAAQA;AADG,GAAZ;AAGApE,SAAOkL,IAAP,CAAY7H,OAAZ,EAAqBtB,KAArB;AACA;;AAED;AACA/B,QAAO,uBAAP,EAAgCkK,EAAhC,CAAmC,OAAnC,EAA4C,iBAA5C,EAA+D,UAAUK,CAAV,EAAa;AAC3EA,IAAEC,cAAF;AACA8O,cAAYtZ,OAAO,IAAP,CAAZ;AACA0Z;AACAG,uBAAsB,qBAAtB;AACA,EALD;;AAOA;AACA7Z,QAAO,8BAAP,EAAuCkK,EAAvC,CAA0C,OAA1C,EAAmD,gBAAnD,EAAqE,UAAUK,CAAV,EAAa;AACjF+O,cAAYtZ,OAAO,IAAP,CAAZ;AACA0Z;AACAG,uBAAsB,yBAAtB;AACA,EAJD;AAMA,CA3DD,E;;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,UAAU;AAClD;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,mBAAmB,gCAAgC,GAAG;;AAElF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD;AACrD,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,OAAO;AACP;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH,CAAC","file":"admin.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./_src/js/app.js\");\n","/**\n * jQueryFileTree plugin\n */\nimport 'jqueryfiletree/src/jQueryFileTree.js';\n\n/**\n * Admin modules\n */\nrequire('./modules/admin');\nrequire('./modules/bulk-smush');\nrequire('./modules/modals');\n\n/**\n * Notice scripts.\n *\n * Notices are used in the following functions:\n *\n * @used-by WpSmushitAdmin::smush_updated()\n * @used-by WpSmushS3::3_support_required_notice()\n * @used-by WpSmushBulkUi::installation_notice()\n *\n * TODO: should this be moved out in a separate file like common.scss?\n */\nrequire('./modules/notice');","/**\n * Processes bulk smushing\n *\n * @author Umesh Kumar <umeshsingla05@gmail.com>\n *\n * TODO: Use Element tag for all the class selectors\n */\nlet WP_Smush = WP_Smush || {};\n\n/**\n * Smush translation strings.\n *\n * @var {array} wp_smush_msgs\n */\nif ( wp_smush_msgs ) {\n\tconst wp_smush_msgs = wp_smush_msgs;\n}\n\n/**\n * Show/hide the progress bar for Smushing/Restore/SuperSmush\n *\n * @param cur_ele\n * @param txt Message to be displayed\n * @param {string} state show/hide\n */\nlet progress_bar = function ( cur_ele, txt, state ) {\n\t//Update Progress bar text and show it\n\tlet progress_button = cur_ele.parents().eq( 1 ).find( '.wp-smush-progress' );\n\n\tif ( 'show' === state ) {\n\t\tprogress_button.find( 'span' ).html( txt );\n\t\tprogress_button.toggleClass( 'visible' );\n\t} else {\n\t\t/** @var {string} wp_smush_msgs.all_done */\n\t\tprogress_button.find( 'span' ).html( wp_smush_msgs.all_done );\n\t\tprogress_button.hide();\n\t}\n};\n\n/**\n * Check membership validity\n *\n * @param {int} data.show_warning\n */\nlet membership_validity = function ( data ) {\n\tconst member_validity_notice = jQuery( '#wp-smush-invalid-member' );\n\n\t//Check for Membership warning\n\n\tif ( 'undefined' !== typeof ( data ) && 'undefined' !== typeof ( data.show_warning ) && member_validity_notice.length > 0 ) {\n\t\tif ( data.show_warning ) {\n\t\t\tmember_validity_notice.show();\n\t\t} else {\n\t\t\tmember_validity_notice.hide();\n\t\t}\n\t}\n};\n\nlet remove_element = function ( el, timeout ) {\n\tif ( typeof timeout === 'undefined' ) {\n\t\ttimeout = 100;\n\t}\n\tel.fadeTo( timeout, 0, function () {\n\t\tel.slideUp( timeout, function () {\n\t\t\tel.remove();\n\t\t} );\n\t} );\n};\n\njQuery( function ( $ ) {\n\t'use strict';\n\n\t/**\n\t * Remove the quick setup dialog\n\t */\n\tfunction remove_dialog() {\n\t\t$('dialog#smush-quick-setup').remove();\n\t}\n\n\t/**\n\t * Update image size in attachment info panel.\n\t *\n\t * @since 2.8\n\t *\n\t * @param new_size\n\t */\n\tfunction update_image_stats( new_size ) {\n\t\tif ( 0 === new_size ) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet attachmentSize = $('.attachment-info .file-size');\n\t\tconst currentSize = attachmentSize.contents().filter(function() {\n\t\t\treturn this.nodeType === 3;\n\t\t}).text();\n\n\t\t// There is a space before the size.\n\t\tif ( currentSize !== ( ' ' + new_size ) ) {\n\t\t\tconst sizeStrongEl = attachmentSize.contents().filter(function() {\n\t\t\t\treturn this.nodeType === 1;\n\t\t\t}   ).text();\n\t\t\tattachmentSize.html( '<strong>' + sizeStrongEl + '</strong> ' + new_size );\n\t\t}\n\t}\n\n\t// Show the Quick Setup dialog.\n\tif ( $( '#smush-quick-setup' ).size() > 0 ) {\n\t\t/** @var {string} wp_smush_msgs.quick_setup_title */\n\t\tWDP.showOverlay( \"#smush-quick-setup\", {\n\t\t\ttitle: wp_smush_msgs.quick_setup_title,\n\t\t\tclass: 'no-close wp-smush-overlay wp-smush-quick-setup'\n\t\t} );\n\t\tremove_dialog();\n\t}\n\n\tlet smushAddParams = function ( url, data ) {\n\t\tif ( !$.isEmptyObject( data ) ) {\n\t\t\turl += ( url.indexOf( '?' ) >= 0 ? '&' : '?' ) + $.param( data );\n\t\t}\n\n\t\treturn url;\n\t};\n\n\t// url for smushing\n\tWP_Smush.errors = [];\n\n\t/** @var {array} wp_smushit_data */\n\tWP_Smush.timeout = wp_smushit_data.timeout;\n\n\t/**\n\t * Checks for the specified param in URL\n\t * @param arg\n\t * @returns {*}\n\t */\n\tWP_Smush.geturlparam = function ( arg ) {\n\t\tvar $sPageURL = window.location.search.substring( 1 );\n\t\tvar $sURLVariables = $sPageURL.split( '&' );\n\n\t\tfor ( var i = 0; i < $sURLVariables.length; i++ ) {\n\t\t\tvar $sParameterName = $sURLVariables[i].split( '=' );\n\t\t\tif ( $sParameterName[0] == arg ) {\n\t\t\t\treturn $sParameterName[1];\n\t\t\t}\n\t\t}\n\t};\n\n\tWP_Smush.Smush = function ( $button, bulk, smush_type ) {\n\t\tvar self = this;\n\t\tvar skip_resmush = $button.data( 'smush' );\n\t\t//If smush attribute is not defined, Need not skip resmush ids\n\t\tskip_resmush = ( ( typeof skip_resmush == typeof undefined ) || skip_resmush == false ) ? false : true;\n\n\t\tthis.init = function () {\n\t\t\tthis.$button = $( $button[0] );\n\t\t\tthis.is_bulk = typeof bulk ? bulk : false;\n\t\t\tthis.url = ajaxurl;\n\t\t\tthis.$log = $( \".smush-final-log\" );\n\t\t\tthis.deferred = jQuery.Deferred();\n\t\t\tthis.deferred.errors = [];\n\n\t\t\tvar ids = wp_smushit_data.resmush.length > 0 && !skip_resmush ? ( wp_smushit_data.unsmushed.length > 0 ? wp_smushit_data.resmush.concat( wp_smushit_data.unsmushed ) : wp_smushit_data.resmush ) : wp_smushit_data.unsmushed;\n\t\t\tif ( 'object' == typeof ids ) {\n\t\t\t\t//If button has resmush class, and we do have ids that needs to resmushed, put them in the list\n\t\t\t\tthis.ids = ids.filter( function ( itm, i, a ) {\n\t\t\t\t\treturn i == a.indexOf( itm );\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tthis.ids = ids;\n\t\t\t}\n\n\t\t\tthis.is_bulk_resmush = wp_smushit_data.resmush.length > 0 && !skip_resmush ? true : false;\n\n\t\t\tthis.$status = this.$button.parent().find( '.smush-status' );\n\n\t\t\t//Added for NextGen support\n\t\t\tthis.smush_type = 'undefined' != typeof smush_type ? smush_type : 'media';\n\t\t\tthis.single_ajax_suffix = 'nextgen' == this.smush_type ? 'smush_manual_nextgen' : 'wp_smushit_manual';\n\t\t\tthis.bulk_ajax_suffix = 'nextgen' == this.smush_type ? 'wp_smushit_nextgen_bulk' : 'wp_smushit_bulk';\n\t\t\tthis.url = this.is_bulk ? smushAddParams( this.url, {action: this.bulk_ajax_suffix} ) : smushAddParams( this.url, {action: this.single_ajax_suffix} );\n\t\t};\n\n\t\t/** Send Ajax request for smushing the image **/\n\t\tWP_Smush.ajax = function ( is_bulk_resmush, $id, $send_url, $getnxt, nonce ) {\n\t\t\t\"use strict\";\n\t\t\tvar param = {\n\t\t\t\tis_bulk_resmush: is_bulk_resmush,\n\t\t\t\tattachment_id: $id,\n\t\t\t\tget_next: $getnxt,\n\t\t\t\t_nonce: nonce\n\t\t\t};\n\t\t\tparam = jQuery.param( param );\n\t\t\treturn $.ajax( {\n\t\t\t\ttype: \"GET\",\n\t\t\t\tdata: param,\n\t\t\t\turl: $send_url,\n\t\t\t\ttimeout: WP_Smush.timeout,\n\t\t\t\tdataType: 'json'\n\t\t\t} );\n\t\t};\n\n\t\t//Show loader in button for single and bulk smush\n\t\tthis.start = function () {\n\n\t\t\tthis.$button.attr( 'disabled', 'disabled' );\n\t\t\tthis.$button.addClass( 'wp-smush-started' );\n\n\t\t\tthis.bulk_start();\n\t\t\tthis.single_start();\n\t\t};\n\n\t\tthis.bulk_start = function () {\n\t\t\tif ( !this.is_bulk ) return;\n\n\t\t\t//Hide the Bulk Div\n\t\t\t$( '.wp-smush-bulk-wrapper' ).hide();\n\n\t\t\t//Show the Progress Bar\n\t\t\t$( '.bulk-smush-wrapper .wp-smush-bulk-progress-bar-wrapper' ).show();\n\n\t\t\t//Remove any Global Notices if there\n\t\t\t$( '.sui-notice-top' ).remove();\n\n\t\t\t//Hide the Bulk Limit message\n\t\t\t$( 'p.smush-error-message.limit_exceeded' ).remove();\n\t\t\t//Hide parent wrapper, if there are no other messages\n\t\t\tif ( $( 'div.smush-final-log p' ).length <= 0 ) {\n\t\t\t\t$( 'div.smush-final-log' ).hide();\n\t\t\t}\n\t\t};\n\n\t\tthis.single_start = function () {\n\t\t\tif ( this.is_bulk ) return;\n\t\t\tthis.show_loader();\n\t\t\tthis.$status.removeClass( \"error\" );\n\t\t};\n\n\t\tthis.enable_button = function () {\n\t\t\tthis.$button.prop( \"disabled\", false );\n\t\t\t//For Bulk process, Enable other buttons\n\t\t\t$( 'button.wp-smush-all' ).removeAttr( 'disabled' );\n\t\t\t$( 'button.wp-smush-scan, a.wp-smush-lossy-enable, button.wp-smush-resize-enable, input#wp-smush-save-settings' ).removeAttr( 'disabled' );\n\t\t};\n\n\t\tthis.show_loader = function () {\n\t\t\tprogress_bar( this.$button, wp_smush_msgs.smushing, 'show' );\n\t\t};\n\n\t\tthis.hide_loader = function () {\n\t\t\tprogress_bar( this.$button, wp_smush_msgs.smushing, 'hide' );\n\t\t};\n\n\t\tthis.single_done = function () {\n\t\t\tif ( this.is_bulk ) return;\n\n\t\t\tthis.hide_loader();\n\n\t\t\tthis.request.done( function ( response ) {\n\t\t\t\tif ( typeof response.data != 'undefined' ) {\n\n\t\t\t\t\t// Check if stats div exists.\n\t\t\t\t\tvar parent = self.$status.parent();\n\t\t\t\t\tvar stats_div = parent.find('.smush-stats-wrapper');\n\n\t\t\t\t\t// If we've updated status, replace the content.\n\t\t\t\t\tif ( response.data.status ) {\n\t\t\t\t\t\t//remove Links\n\t\t\t\t\t\tparent.find('.smush-status-links').remove();\n\t\t\t\t\t\tself.$status.replaceWith( response.data.status );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Check whether to show membership validity notice or not.\n\t\t\t\t\tmembership_validity( response.data );\n\n\t\t\t\t\tif ( response.success && response.data !== \"Not processed\" ) {\n\t\t\t\t\t\tself.$status.removeClass( 'sui-hidden' );\n\t\t\t\t\t\tself.$button.parent().removeClass( 'unsmushed' ).addClass( 'smushed' );\n\t\t\t\t\t\tself.$button.remove();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.$status.addClass( \"error\" );\n\t\t\t\t\t\tself.$status.html( response.data.error_msg );\n\t\t\t\t\t\tself.$status.show();\n\t\t\t\t\t}\n\t\t\t\t\tif ('undefined' != stats_div && stats_div.length ) {\n\t\t\t\t\t\tstats_div.replaceWith( response.data.stats );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tparent.append( response.data.stats );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Update image size in attachment info panel.\n\t\t\t\t\tupdate_image_stats(response.data.new_size);\n\t\t\t\t}\n\t\t\t\tself.enable_button();\n\t\t\t} ).error( function ( response ) {\n\t\t\t\tself.$status.html( response.data );\n\t\t\t\tself.$status.addClass( \"error\" );\n\t\t\t\tself.enable_button();\n\t\t\t} );\n\n\t\t};\n\n\t\tthis.sync_stats = function () {\n\t\t\tvar message_holder = $( 'div.wp-smush-bulk-progress-bar-wrapper div.wp-smush-count.tc' );\n\t\t\t//Store the existing content in a variable\n\t\t\tvar progress_message = message_holder.html();\n\t\t\tmessage_holder.html( wp_smush_msgs.sync_stats );\n\n\t\t\t//Send ajax\n\t\t\t$.ajax( {\n\t\t\t\ttype: \"GET\",\n\t\t\t\turl: ajaxurl,\n\t\t\t\tdata: {\n\t\t\t\t\t'action': 'get_stats'\n\t\t\t\t},\n\t\t\t\tsuccess: function ( response ) {\n\t\t\t\t\tif ( response && 'undefined' != typeof response ) {\n\t\t\t\t\t\tresponse = response.data;\n\t\t\t\t\t\t$.extend( wp_smushit_data, {\n\t\t\t\t\t\t\tcount_images: response.count_images,\n\t\t\t\t\t\t\tcount_smushed: response.count_smushed,\n\t\t\t\t\t\t\tcount_total: response.count_total,\n\t\t\t\t\t\t\tcount_resize: response.count_resize,\n\t\t\t\t\t\t\tcount_supersmushed: response.count_supersmushed,\n\t\t\t\t\t\t\tsavings_bytes: response.savings_bytes,\n\t\t\t\t\t\t\tsavings_conversion: response.savings_conversion,\n\t\t\t\t\t\t\tsavings_resize: response.savings_resize,\n\t\t\t\t\t\t\tsize_before: response.size_before,\n\t\t\t\t\t\t\tsize_after: response.size_after\n\t\t\t\t\t\t} );\n\t\t\t\t\t\t//Got the stats, Update it\n\t\t\t\t\t\tupdate_stats( this.smush_type );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} ).always( function () {\n\t\t\t\t\tmessage_holder.html( progress_message );\n\t\t\t\t}\n\t\t\t);\n\t\t};\n\n\t\t/** After the Bulk Smushing has been Finished **/\n\t\tthis.bulk_done = function () {\n\t\t\tif ( !this.is_bulk ) return;\n\n\t\t\t//Enable the button\n\t\t\tthis.enable_button();\n\n\t\t\t//Show Notice\n\t\t\tif ( self.ids.length == 0 ) {\n\t\t\t\t$( '.bulk-smush-wrapper .wp-smush-all-done, .wp-smush-pagespeed-recommendation' ).show();\n\t\t\t\t$( '.wp-smush-bulk-wrapper' ).hide();\n\t\t\t} else {\n\t\t\t\tif ( $( '.bulk-smush-wrapper .wp-smush-resmush-notice' ).length > 0 ) {\n\t\t\t\t\t$( '.bulk-smush-wrapper .wp-smush-resmush-notice' ).show();\n\t\t\t\t} else {\n\t\t\t\t\t$( '.bulk-smush-wrapper .wp-smush-remaining' ).show();\n\t\t\t\t}\n\t\t\t\t$( '.wp-smush-bulk-wrapper' ).show();\n\t\t\t}\n\n\t\t\t//Hide the Progress Bar\n\t\t\t$( '.wp-smush-bulk-progress-bar-wrapper' ).hide();\n\n\t\t\t//Enable Resmush and scan button\n\t\t\t$( '.wp-resmush.wp-smush-action, .wp-smush-scan' ).removeAttr( 'disabled' );\n\n\t\t\t// Show loader.\n\t\t\tif ( self.ids.length == 0 ) {\n\t\t\t\t$( '.sui-summary-smush .smush-stats-icon' ).addClass( 'sui-hidden' );\n\t\t\t} else {\n\t\t\t\t$( '.sui-summary-smush .smush-stats-icon' ).removeClass( 'sui-icon-loader sui-loading sui-hidden' ).addClass( 'sui-icon-info sui-warning' );\n\t\t\t}\n\t\t};\n\n\t\tthis.is_resolved = function () {\n\t\t\t\"use strict\";\n\t\t\treturn this.deferred.state() === \"resolved\";\n\t\t};\n\n\t\tthis.free_exceeded = function () {\n\t\t\t//Hide the Progress bar and show the Bulk smush wrapper\n\t\t\t$( '.wp-smush-bulk-progress-bar-wrapper' ).hide();\n\n\t\t\tif ( self.ids.length > 0 ) {\n\t\t\t\t//Show Bulk wrapper\n\t\t\t\t$( '.wp-smush-bulk-wrapper ' ).show();\n\t\t\t} else {\n\t\t\t\t$( '.wp-smush-notice.wp-smush-all-done, .wp-smush-pagespeed-recommendation' ).show();\n\t\t\t}\n\t\t};\n\n\t\tthis.update_remaining_count = function () {\n\t\t\tif ( this.is_bulk_resmush ) {\n\t\t\t\t//ReSmush Notice\n\t\t\t\tif ( $( '.wp-smush-resmush-notice .wp-smush-remaining-count' ).length && 'undefined' != typeof self.ids ) {\n\t\t\t\t\t$( '.wp-smush-resmush-notice .wp-smush-remaining-count' ).html( self.ids.length );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t//Smush Notice\n\t\t\t\tif ( $( '.bulk-smush-wrapper .wp-smush-remaining-count' ).length && 'undefined' != typeof self.ids ) {\n\t\t\t\t\t$( '.bulk-smush-wrapper .wp-smush-remaining-count' ).html( self.ids.length );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Update sidebar count.\n\t\t\tif ( $( '.smush-sidenav .wp-smush-remaining-count' ).length && 'undefined' != typeof self.ids ) {\n\t\t\t\tif ( self.ids.length > 0 ) {\n\t\t\t\t\t$( '.smush-sidenav .wp-smush-remaining-count' ).html( self.ids.length );\n\t\t\t\t} else {\n\t\t\t\t\t$( '.sui-summary-smush .smush-stats-icon' ).addClass( 'sui-hidden' );\n\t\t\t\t\t$( '.smush-sidenav .wp-smush-remaining-count' ).removeClass( 'sui-tag sui-tag-warning' ).html('');\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis.update_progress = function ( _res ) {\n\t\t\t//If not bulk\n\t\t\tif ( !this.is_bulk_resmush && !this.is_bulk ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar progress = '';\n\n\t\t\t//Update localized stats\n\t\t\tif ( _res && ( 'undefined' != typeof _res.data || 'undefined' != typeof _res.data.stats ) ) {\n\t\t\t\tupdate_localized_stats( _res.data.stats, this.smush_type );\n\t\t\t}\n\n\t\t\tif ( !this.is_bulk_resmush ) {\n\t\t\t\t//handle progress for normal bulk smush\n\t\t\t\tprogress = ( wp_smushit_data.count_smushed / wp_smushit_data.count_total ) * 100;\n\t\t\t} else {\n\t\t\t\t//If the Request was successful, Update the progress bar\n\t\t\t\tif ( _res.success ) {\n\t\t\t\t\t//Handle progress for Super smush progress bar\n\t\t\t\t\tif ( wp_smushit_data.resmush.length > 0 ) {\n\t\t\t\t\t\t//Update the Count\n\t\t\t\t\t\t$( '.wp-smush-images-remaining' ).html( wp_smushit_data.resmush.length );\n\t\t\t\t\t} else if ( wp_smushit_data.resmush.length == 0 && this.ids.length == 0 ) {\n\t\t\t\t\t\t//If all images are resmushed, show the All Smushed message\n\n\t\t\t\t\t\t//Show All Smushed\n\t\t\t\t\t\t$( '.bulk-resmush-wrapper .wp-smush-all-done, .wp-smush-pagespeed-recommendation' ).removeClass( 'sui-hidden' );\n\n\t\t\t\t\t\t//Hide Everything else\n\t\t\t\t\t\t$( '.wp-smush-resmush-wrap, .wp-smush-bulk-progress-bar-wrapper' ).hide();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//handle progress for normal bulk smush\n\t\t\t\t//Set Progress Bar width\n\t\t\t\tif ( 'undefined' !== typeof self.ids && 'undefined' !== typeof wp_smushit_data.count_total && wp_smushit_data.count_total > 0 ) {\n\t\t\t\t\tprogress = ( wp_smushit_data.count_smushed / wp_smushit_data.count_total ) * 100;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//Show Bulk Wrapper and Smush Notice\n\t\t\tif ( self.ids.length == 0 ) {\n\t\t\t\t//Sync stats for Bulk smush media Library ( Skip for Nextgen )\n\t\t\t\tif ( 'nextgen' != this.smush_type ) {\n\t\t\t\t\tthis.sync_stats();\n\t\t\t\t}\n\t\t\t\t$( '.bulk-smush-wrapper .wp-smush-all-done, .wp-smush-pagespeed-recommendation' ).show();\n\t\t\t\t$( '.wp-smush-bulk-wrapper' ).hide();\n\t\t\t}\n\n\t\t\t//Update remaining count\n\t\t\tself.update_remaining_count();\n\n\t\t\t//if we have received the progress data, update the stats else skip\n\t\t\tif ( 'undefined' != typeof _res.data.stats ) {\n\n\t\t\t\t// increase the progress bar\n\t\t\t\tthis._update_progress( wp_smushit_data.count_smushed, progress );\n\t\t\t}\n\t\t\t// Update stats and counts.\n\t\t\tupdate_stats( this.smush_type );\n\t\t};\n\n\t\tthis._update_progress = function ( count, width ) {\n\t\t\t\"use strict\";\n\t\t\tif ( !this.is_bulk && !this.is_bulk_resmush ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t//Update the Progress Bar Width\n\t\t\t// get the progress bar\n\t\t\tvar $progress_bar = jQuery( '.bulk-smush-wrapper .wp-smush-progress-inner' );\n\t\t\tif ( $progress_bar.length < 1 ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// increase progress\n\t\t\t$progress_bar.css( 'width', width + '%' );\n\n\t\t};\n\n\t\t//Whether to send the ajax requests further or not\n\t\tthis.continue = function () {\n\t\t\tvar continue_smush = self.$button.attr( 'continue_smush' );\n\n\t\t\tif ( typeof continue_smush == typeof undefined ) {\n\t\t\t\tcontinue_smush = true;\n\t\t\t}\n\n\t\t\tif ( 'false' == continue_smush || !continue_smush ) {\n\t\t\t\tcontinue_smush = false;\n\t\t\t}\n\n\t\t\treturn continue_smush && this.ids.length > 0 && this.is_bulk;\n\t\t};\n\n\t\tthis.increment_errors = function ( id ) {\n\t\t\tWP_Smush.errors.push( id );\n\t\t};\n\n\t\t//Send ajax request for smushing single and bulk, call update_progress on ajax response\n\t\tthis.call_ajax = function () {\n\t\t\tvar nonce_value = '';\n\t\t\tthis.current_id = this.is_bulk ? this.ids.shift() : this.$button.data( \"id\" ); //remove from array while processing so we can continue where left off\n\n\t\t\t//Remove the id from respective variable as well\n\t\t\tthis.update_smush_ids( this.current_id );\n\n\t\t\tvar nonce_field = this.$button.parent().find( '#_wp_smush_nonce' );\n\t\t\tif ( nonce_field ) {\n\t\t\t\tnonce_value = nonce_field.val();\n\t\t\t}\n\n\t\t\tthis.request = WP_Smush.ajax( this.is_bulk_resmush, this.current_id, this.url, 0, nonce_value )\n\t\t\t\t.error( function () {\n\t\t\t\t\tself.increment_errors( self.current_id );\n\t\t\t\t} ).done( function ( res ) {\n\t\t\t\t\t//Increase the error count except if bulk request limit excceded\n\t\t\t\t\tif ( typeof res.success === \"undefined\" || ( typeof res.success !== \"undefined\" && typeof res.success.data !== \"undefined\" && res.success === false && res.data.error !== 'bulk_request_image_limit_exceeded' ) ) {\n\t\t\t\t\t\tself.increment_errors( self.current_id );\n\t\t\t\t\t}\n\t\t\t\t\t//If no response or success is false, do not process further\n\t\t\t\t\tif ( !res || !res.success ) {\n\t\t\t\t\t\t//@todo: Handle Bulk Smush limit error message\n\t\t\t\t\t\tif ( 'undefined' !== typeof res && 'undefined' !== typeof res.data && typeof res.data.error !== 'undefined' ) {\n\t\t\t\t\t\t\tvar error_class = 'undefined' != typeof res.data.error_class ? 'smush-error-message ' + res.data.error_class : 'smush-error-message';\n\t\t\t\t\t\t\tvar error_msg = '<p class=\"' + error_class + '\">' + res.data.error_message + '</p>';\n\t\t\t\t\t\t\tif ( 'undefined' != typeof res.data.error && 'bulk_request_image_limit_exceeded' == res.data.error ) {\n\t\t\t\t\t\t\t\tvar ajax_error_message = $( '.wp-smush-ajax-error' );\n\t\t\t\t\t\t\t\t//If we have ajax error message div, append after it\n\t\t\t\t\t\t\t\tif ( ajax_error_message.length > 0 ) {\n\t\t\t\t\t\t\t\t\tajax_error_message.after( error_msg );\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t//Otherwise prepend\n\t\t\t\t\t\t\t\t\tself.$log.prepend( error_msg );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if ( 'undefined' != typeof res.data.error_class && \"\" != res.data.error_class && $( 'div.smush-final-log .' + res.data.error_class ).length > 0 ) {\n\t\t\t\t\t\t\t\tvar error_count = $( 'p.smush-error-message.' + res.data.error_class + ' .image-error-count' );\n\t\t\t\t\t\t\t\t//Get the error count, increase and append\n\t\t\t\t\t\t\t\tvar image_count = error_count.html();\n\t\t\t\t\t\t\t\timage_count = parseInt( image_count ) + 1;\n\t\t\t\t\t\t\t\t//Append the updated image count\n\t\t\t\t\t\t\t\terror_count.html( image_count );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t//Print the error on screen\n\t\t\t\t\t\t\t\tself.$log.append( error_msg );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tself.$log.show();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t//Check whether to show the warning notice or not\n\t\t\t\t\tmembership_validity( res.data );\n\n\t\t\t\t\t//Bulk Smush Limit Exceeded: Stop ajax requests, remove progress bar, append the last image id back to smush variable, and reset variables to allow the user to continue bulk smush\n\t\t\t\t\tif ( typeof res.data !== \"undefined\" && res.data.error == 'bulk_request_image_limit_exceeded' && !self.is_resolved() ) {\n\t\t\t\t\t\t//Add a data attribute to the smush button, to stop sending ajax\n\t\t\t\t\t\tself.$button.attr( 'continue_smush', false );\n\n\t\t\t\t\t\tself.free_exceeded();\n\n\t\t\t\t\t\t//Reinsert the current id\n\t\t\t\t\t\twp_smushit_data.unsmushed.unshift( self.current_id );\n\n\t\t\t\t\t\t//Update the remaining count to length of remaining ids + 1 (Current id)\n\t\t\t\t\t\tself.update_remaining_count();\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( self.is_bulk && res.success ) {\n\t\t\t\t\t\t\tself.update_progress( res );\n\t\t\t\t\t\t}else if (self.ids.length == 0) {\n\t\t\t\t\t\t\t//Sync stats anyway\n\t\t\t\t\t\t\tself.sync_stats();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tself.single_done();\n\t\t\t\t} ).complete( function () {\n\t\t\t\t\tif ( !self.continue() || !self.is_bulk ) {\n\t\t\t\t\t\t//Calls deferred.done()\n\t\t\t\t\t\tself.deferred.resolve();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.call_ajax();\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\tself.deferred.errors = WP_Smush.errors;\n\t\t\treturn self.deferred;\n\t\t};\n\n\t\tthis.init( arguments );\n\n\t\t//Send ajax request for single and bulk smushing\n\t\tthis.run = function () {\n\n\t\t\t// if we have a definite number of ids\n\t\t\tif ( this.is_bulk && this.ids.length > 0 ) {\n\t\t\t\tthis.call_ajax();\n\t\t\t}\n\n\t\t\tif ( !this.is_bulk )\n\t\t\t\tthis.call_ajax();\n\n\t\t};\n\n\t\t//Show bulk smush errors, and disable bulk smush button on completion\n\t\tthis.bind_deferred_events = function () {\n\n\t\t\tthis.deferred.done( function () {\n\n\t\t\t\tself.$button.removeAttr( 'continue_smush' );\n\n\t\t\t\tif ( WP_Smush.errors.length ) {\n\t\t\t\t\tvar error_message = '<div class=\"wp-smush-ajax-error\">' + wp_smush_msgs.error_in_bulk.replace( \"{{errors}}\", WP_Smush.errors.length ) + '</div>';\n\t\t\t\t\t//Remove any existing notice\n\t\t\t\t\t$( '.wp-smush-ajax-error' ).remove();\n\t\t\t\t\tself.$log.prepend( error_message );\n\t\t\t\t}\n\n\t\t\t\tself.bulk_done();\n\n\t\t\t\t//Re enable the buttons\n\t\t\t\t$( '.wp-smush-button:not(.wp-smush-finished), .wp-smush-scan' ).removeAttr( 'disabled' );\n\t\t\t} );\n\n\t\t};\n\t\t/** Handles the Cancel button Click\n\t\t *\n\t\t * Update the UI, and enables the bulk smush button\n\t\t *\n\t\t **/\n\t\tthis.cancel_ajax = function () {\n\t\t\t$( '.wp-smush-cancel-bulk' ).on( 'click', function () {\n\t\t\t\t//Add a data attribute to the smush button, to stop sending ajax\n\t\t\t\tself.$button.attr( 'continue_smush', false );\n\t\t\t\t//Sync and update stats\n\t\t\t\tself.sync_stats();\n\t\t\t\tupdate_stats( this.smush_type );\n\n\t\t\t\tself.request.abort();\n\t\t\t\tself.enable_button();\n\t\t\t\tself.$button.removeClass( 'wp-smush-started' );\n\t\t\t\twp_smushit_data.unsmushed.unshift( self.current_id );\n\t\t\t\t$( '.wp-smush-bulk-wrapper' ).show();\n\n\t\t\t\t//Hide the Progress Bar\n\t\t\t\t$( '.wp-smush-bulk-progress-bar-wrapper' ).hide();\n\t\t\t} );\n\t\t};\n\t\t/**\n\t\t * Remove the current id from unsmushed/resmush variable\n\t\t * @param current_id\n\t\t */\n\t\tthis.update_smush_ids = function ( current_id ) {\n\t\t\tif ( 'undefined' !== typeof wp_smushit_data.unsmushed && wp_smushit_data.unsmushed.length > 0 ) {\n\t\t\t\tvar u_index = wp_smushit_data.unsmushed.indexOf( current_id );\n\t\t\t\tif ( u_index > -1 ) {\n\t\t\t\t\twp_smushit_data.unsmushed.splice( u_index, 1 );\n\t\t\t\t}\n\t\t\t}\n\t\t\t//remove from the resmush list\n\t\t\tif ( 'undefined' !== typeof wp_smushit_data.resmush && wp_smushit_data.resmush.length > 0 ) {\n\t\t\t\tvar index = wp_smushit_data.resmush.indexOf( current_id );\n\t\t\t\tif ( index > -1 ) {\n\t\t\t\t\twp_smushit_data.resmush.splice( index, 1 );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis.start();\n\t\tthis.run();\n\t\tthis.bind_deferred_events();\n\n\t\t//Handle Cancel Ajax\n\t\tthis.cancel_ajax();\n\n\t\treturn this.deferred;\n\t};\n\n\t/**\n\t * Handle the Bulk Smush/ Bulk Resmush button click\n\t */\n\t$( 'body' ).on( 'click', 'button.wp-smush-all', function ( e ) {\n\n\t\t// prevent the default action\n\t\te.preventDefault();\n\n\t\t$( '.sui-notice-top.sui-notice-success' ).remove();\n\n\t\t//Disable Resmush and scan button\n\t\t$( '.wp-resmush.wp-smush-action, .wp-smush-scan, .wp-smush-button, a.wp-smush-lossy-enable, button.wp-smush-resize-enable, input#wp-smush-save-settings' ).attr( 'disabled', 'disabled' );\n\n\t\t//Check for ids, if there is none (Unsmushed or lossless), don't call smush function\n\t\tif ( typeof wp_smushit_data == 'undefined' ||\n\t\t\t( wp_smushit_data.unsmushed.length == 0 && wp_smushit_data.resmush.length == 0 )\n\t\t) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\t$( \".wp-smush-remaining\" ).hide();\n\n\t\t// Show loader.\n\t\t$( '.sui-summary-smush .smush-stats-icon' ).removeClass( 'sui-icon-info sui-warning' ).addClass( 'sui-icon-loader sui-loading' );\n\n\t\tnew WP_Smush.Smush( $( this ), true );\n\n\n\t} );\n\n\t/** Disable the action links **/\n\tvar disable_links = function ( c_element ) {\n\n\t\tvar parent = c_element.parent();\n\t\t//reduce parent opacity\n\t\tparent.css( {'opacity': '0.5'} );\n\t\t//Disable Links\n\t\tparent.find( 'a' ).attr( 'disabled', 'disabled' );\n\t};\n\n\t/** Enable the Action Links **/\n\tvar enable_links = function ( c_element ) {\n\n\t\tvar parent = c_element.parent();\n\n\t\t//reduce parent opacity\n\t\tparent.css( {'opacity': '1'} );\n\t\t//Disable Links\n\t\tparent.find( 'a' ).removeAttr( 'disabled' );\n\t};\n\t/**\n\t * Restore image request with a specified action for Media Library / NextGen Gallery\n\t * @param e\n\t * @param current_button\n\t * @param smush_action\n\t * @returns {boolean}\n\t */\n\tvar process_smush_action = function ( e, current_button, smush_action, action ) {\n\n\t\t//If disabled\n\t\tif ( 'disabled' == current_button.attr( 'disabled' ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\te.preventDefault();\n\n\t\t//Remove Error\n\t\t$( '.wp-smush-error' ).remove();\n\n\t\t//Hide stats\n\t\t$( '.smush-stats-wrapper' ).hide();\n\n\t\tvar mode = 'grid';\n\t\tif ( 'smush_restore_image' == smush_action ) {\n\t\t\tif ( $( document ).find( 'div.media-modal.wp-core-ui' ).length > 0 ) {\n\t\t\t\tmode = 'grid';\n\t\t\t} else {\n\t\t\t\tmode = window.location.search.indexOf( 'item' ) > -1 ? 'grid' : 'list';\n\t\t\t}\n\t\t}\n\n\t\t//Get the image ID and nonce\n\t\tvar params = {\n\t\t\taction: smush_action,\n\t\t\tattachment_id: current_button.data( 'id' ),\n\t\t\tmode: mode,\n\t\t\t_nonce: current_button.data( 'nonce' )\n\t\t};\n\n\t\t//Reduce the opacity of stats and disable the click\n\t\tdisable_links( current_button );\n\n\t\tprogress_bar( current_button, wp_smush_msgs[action], 'show' );\n\n\t\t//Restore the image\n\t\t$.post( ajaxurl, params, function ( r ) {\n\n\t\t\tprogress_bar( current_button, wp_smush_msgs[action], 'hide' );\n\n\t\t\t//reset all functionality\n\t\t\tenable_links( current_button );\n\n\t\t\tif (r.success && 'undefined' != typeof(r.data.button)) {\n\t\t\t\t//Replace in immediate parent for nextgen\n\t\t\t\tif ('undefined' != typeof (this.data) && this.data.indexOf('nextgen') > -1) {\n\t\t\t\t\t//Show the smush button, and remove stats and restore option\n\t\t\t\t\tcurrent_button.parent().html(r.data.button);\n\t\t\t\t} else {\n\t\t\t\t\t//Show the smush button, and remove stats and restore option\n\t\t\t\t\tcurrent_button.parents().eq(1).html(r.data.button);\n\t\t\t\t}\n\n\t\t\t\tif ( 'undefined' != typeof (r.data) && 'restore' === action ) {\n\t\t\t\t\tupdate_image_stats(r.data.new_size);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif ( r.data.message ) {\n\t\t\t\t\t//show error\n\t\t\t\t\tcurrent_button.parent().append( r.data.message );\n\t\t\t\t}\n\t\t\t}\n\t\t} )\n\t};\n\n\t/**\n\t * Validates the Resize Width and Height against the Largest Thumbnail Width and Height\n\t *\n\t * @param wrapper_div jQuery object for the whole setting row wrapper div\n\t * @param width_only Whether to validate only width\n\t * @param height_only Validate only Height\n\t * @returns {boolean} All Good or not\n\t *\n\t */\n\tvar validate_resize_settings = function ( wrapper_div, width_only, height_only ) {\n\t\tvar resize_checkbox = wrapper_div.find( '#wp-smush-resize, #wp-smush-resize-quick-setup' );\n\n\t\tif ( !height_only ) {\n\t\t\tvar width_input = wrapper_div.find( '#wp-smush-resize_width' );\n\t\t\tvar width_error_note = wrapper_div.find( '.sui-notice-info.wp-smush-update-width' );\n\t\t}\n\t\tif ( !width_only ) {\n\t\t\tvar height_input = wrapper_div.find( '#wp-smush-resize_height' );\n\t\t\tvar height_error_note = wrapper_div.find( '.sui-notice-info.wp-smush-update-height' );\n\t\t}\n\n\t\tvar width_error = false;\n\t\tvar height_error = false;\n\n\t\t//If resize settings is not enabled, return true\n\t\tif ( !resize_checkbox.is( ':checked' ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\t//Check if we have localised width and height\n\t\tif ( 'undefined' == typeof (wp_smushit_data.resize_sizes) || 'undefined' == typeof (wp_smushit_data.resize_sizes.width) ) {\n\t\t\t//Rely on server validation\n\t\t\treturn true;\n\t\t}\n\n\t\t//Check for width\n\t\tif ( !height_only && 'undefined' != typeof width_input && parseInt( wp_smushit_data.resize_sizes.width ) > parseInt( width_input.val() ) ) {\n\t\t\twidth_input.parent().addClass('sui-form-field-error');\n\t\t\twidth_error_note.show( 'slow' );\n\t\t\twidth_error = true;\n\t\t} else {\n\t\t\t//Remove error class\n\t\t\twidth_input.parent().removeClass('sui-form-field-error');\n\t\t\twidth_error_note.hide();\n\t\t\tif ( height_input.hasClass( 'error' ) ) {\n\t\t\t\theight_error_note.show( 'slow' );\n\t\t\t}\n\t\t}\n\n\t\t//Check for height\n\t\tif ( !width_only && 'undefined' != typeof height_input && parseInt( wp_smushit_data.resize_sizes.height ) > parseInt( height_input.val() ) ) {\n\t\t\theight_input.parent().addClass('sui-form-field-error');\n\t\t\t//If we are not showing the width error already\n\t\t\tif ( !width_error ) {\n\t\t\t\theight_error_note.show( 'slow' );\n\t\t\t}\n\t\t\theight_error = true;\n\t\t} else {\n\t\t\t//Remove error class\n\t\t\theight_input.parent().removeClass('sui-form-field-error');\n\t\t\theight_error_note.hide();\n\t\t\tif ( width_input.hasClass( 'error' ) ) {\n\t\t\t\twidth_error_note.show( 'slow' );\n\t\t\t}\n\t\t}\n\n\t\tif ( width_error || height_error ) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\n\t};\n\n\t/**\n\t * Convert bytes to human readable form\n\t * @param a, Bytes\n\t * @param b, Number of digits\n\t * @returns {*} Formatted Bytes\n\t */\n\tvar formatBytes = function ( a, b ) {\n\t\tvar thresh = 1024;\n\t\tif ( Math.abs( a ) < thresh ) {\n\t\t\treturn a + ' B';\n\t\t}\n\t\tvar units = ['KB', 'MB', 'GB', 'TB', 'PB'];\n\t\tvar u = -1;\n\t\tdo {\n\t\t\ta /= thresh;\n\t\t\t++u;\n\t\t} while ( Math.abs( a ) >= thresh && u < units.length - 1 );\n\t\treturn a.toFixed( b ) + ' ' + units[u];\n\t};\n\n\t/**\n\t * Convert bytes to human readable form\n\t * @param a, Bytes\n\t * @param b, Number of digits\n\t * @returns {*} Formatted Bytes\n\t */\n\tvar getSizeFromString = function ( formatted_size ) {\n\t\treturn formatted_size.replace( /[a-zA-Z]/g, '' ).trim();\n\t};\n\n\t/**\n\t * Convert bytes to human readable form\n\t * @param a, Bytes\n\t * @param b, Number of digits\n\t * @returns {*} Formatted Bytes\n\t */\n\tvar getFormatFromString = function ( formatted_size ) {\n\t\treturn formatted_size.replace( /[0-9.]/g, '' ).trim();\n\t};\n\n\t//Stackoverflow: http://stackoverflow.com/questions/1726630/formatting-a-number-with-exactly-two-decimals-in-javascript\n\tvar precise_round = function ( num, decimals ) {\n\t\tvar sign = num >= 0 ? 1 : -1;\n\t\t//Keep the percentage below 100\n\t\tnum = num > 100 ? 100 : num;\n\t\treturn (Math.round( (num * Math.pow( 10, decimals )) + (sign * 0.001) ) / Math.pow( 10, decimals ));\n\t};\n\n\t/**\n\t * Update the progress bar width if we have images that needs to be resmushed\n\t * @param unsmushed_count\n\t * @returns {boolean}\n\t */\n\tvar update_progress_bar_resmush = function ( unsmushed_count ) {\n\n\t\tif ( 'undefined' == typeof unsmushed_count ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar smushed_count = wp_smushit_data.count_total - unsmushed_count;\n\n\t\t//Update the Progress Bar Width\n\t\t// get the progress bar\n\t\tvar $progress_bar = jQuery( '.bulk-smush-wrapper .wp-smush-progress-inner' );\n\t\tif ( $progress_bar.length < 1 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar width = ( smushed_count / wp_smushit_data.count_total ) * 100;\n\n\t\t// increase progress\n\t\t$progress_bar.css( 'width', width + '%' );\n\t};\n\n\tvar run_re_check = function ( button, process_settings ) {\n\n\t\t// Empty the button text and add loader class.\n\t\tbutton.text( '' ).addClass( 'sui-button-onload sui-icon-loader sui-loading' ).blur();\n\n\t\t//Check if type is set in data attributes\n\t\tvar scan_type = button.data( 'type' );\n\t\tscan_type = 'undefined' == typeof scan_type ? 'media' : scan_type;\n\n\t\t//Remove the Skip resmush attribute from button\n\t\t$( 'button.wp-smush-all' ).removeAttr( 'data-smush' );\n\n\t\t//remove notices\n\t\tvar el = $( '.sui-notice-top.sui-notice-success' );\n\t\tel.slideUp( 100, function () {\n\t\t\tel.remove();\n\t\t} );\n\n\t\t//Disable Bulk smush button and itself\n\t\t$( '.wp-smush-button' ).attr( 'disabled', 'disabled' );\n\n\t\t//Hide Settings changed Notice\n\t\t$( '.wp-smush-settings-changed' ).hide();\n\n\t\t//Ajax Params\n\t\tvar params = {\n\t\t\taction: 'scan_for_resmush',\n\t\t\ttype: scan_type,\n\t\t\tget_ui: true,\n\t\t\tprocess_settings: process_settings,\n\t\t\twp_smush_options_nonce: jQuery( '#wp_smush_options_nonce' ).val()\n\t\t};\n\n\t\t//Send ajax request and get ids if any\n\t\t$.get( ajaxurl, params, function ( r ) {\n\t\t\t//Check if we have the ids,  initialize the local variable\n\t\t\tif ( 'undefined' != typeof r.data ) {\n\t\t\t\t//Update Resmush id list\n\t\t\t\tif ( 'undefined' != typeof r.data.resmush_ids ) {\n\t\t\t\t\twp_smushit_data.resmush = r.data.resmush_ids;\n\n\t\t\t\t\t//Update wp_smushit_data ( Smushed count, Smushed Percent, Image count, Super smush count, resize savings, conversion savings )\n\t\t\t\t\tif ( 'undefinied' != typeof wp_smushit_data ) {\n\t\t\t\t\t\twp_smushit_data.count_smushed = 'undefined' != typeof r.data.count_smushed ? r.data.count_smushed : wp_smushit_data.count_smushed;\n\t\t\t\t\t\twp_smushit_data.count_supersmushed = 'undefined' != typeof r.data.count_supersmushed ? r.data.count_supersmushed : wp_smushit_data.count_supersmushed;\n\t\t\t\t\t\twp_smushit_data.count_images = 'undefined' != typeof r.data.count_image ? r.data.count_image : wp_smushit_data.count_images;\n\t\t\t\t\t\twp_smushit_data.size_before = 'undefined' != typeof r.data.size_before ? r.data.size_before : wp_smushit_data.size_before;\n\t\t\t\t\t\twp_smushit_data.size_after = 'undefined' != typeof r.data.size_after ? r.data.size_after : wp_smushit_data.size_after;\n\t\t\t\t\t\twp_smushit_data.savings_resize = 'undefined' != typeof r.data.savings_resize ? r.data.savings_resize : wp_smushit_data.savings_resize;\n\t\t\t\t\t\twp_smushit_data.savings_conversion = 'undefined' != typeof r.data.savings_conversion ? r.data.savings_conversion : wp_smushit_data.savings_conversion;\n\t\t\t\t\t\twp_smushit_data.count_resize = 'undefined' != typeof r.data.count_resize ? r.data.count_resize : wp_smushit_data.count_resize;\n\t\t\t\t\t}\n\n\t\t\t\t\tif( 'nextgen' == scan_type ) {\n\t\t\t\t\t\twp_smushit_data.bytes = parseInt( wp_smushit_data.size_before ) - parseInt( wp_smushit_data.size_after )\n\t\t\t\t\t}\n\n\t\t\t\t\tvar smush_percent = ( wp_smushit_data.count_smushed / wp_smushit_data.count_total ) * 100;\n\t\t\t\t\tsmush_percent = precise_round( smush_percent, 1 );\n\n\t\t\t\t\t//Update it in stats bar\n\t\t\t\t\t$( '.wp-smush-images-percent' ).html( smush_percent );\n\n\t\t\t\t\t//Hide the Existing wrapper\n\t\t\t\t\tvar notices = $( '.bulk-smush-wrapper .sui-notice' );\n\t\t\t\t\tif ( notices.length > 0 ) {\n\t\t\t\t\t\tnotices.hide();\n\t\t\t\t\t\t$( '.wp-smush-pagespeed-recommendation' ).hide();\n\t\t\t\t\t}\n\t\t\t\t\t//remove existing Re-Smush notices\n\t\t\t\t\t$( '.wp-smush-resmush-notice' ).remove();\n\n\t\t\t\t\t//Show Bulk wrapper\n\t\t\t\t\t$( '.wp-smush-bulk-wrapper' ).show();\n\n\t\t\t\t\tif ( 'undefined' !== typeof r.data.count ) {\n\t\t\t\t\t\t//Update progress bar\n\t\t\t\t\t\tupdate_progress_bar_resmush( r.data.count );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//If content is received, Prepend it\n\t\t\t\tif ( 'undefined' != typeof r.data.content ) {\n\t\t\t\t\t$( '.bulk-smush-wrapper .sui-box-body' ).prepend( r.data.content );\n\t\t\t\t}\n\t\t\t\t//If we have any notice to show\n\t\t\t\tif ( 'undefined' != typeof r.data.notice ) {\n\t\t\t\t\t$( '.wp-smush-page-header' ).after( r.data.notice );\n\t\t\t\t}\n\t\t\t\t//Hide errors\n\t\t\t\t$( 'div.smush-final-log' ).hide();\n\n\t\t\t\t//Hide Super Smush notice if it's enabled in media settings\n\t\t\t\tif ( 'undefined' != typeof r.data.super_smush && r.data.super_smush ) {\n\t\t\t\t\tvar enable_lossy = jQuery( '.wp-smush-enable-lossy' );\n\t\t\t\t\tif ( enable_lossy.length > 0 ) {\n\t\t\t\t\t\tenable_lossy.remove();\n\t\t\t\t\t}\n\t\t\t\t\tif ( 'undefined' !== r.data.super_smush_stats ) {\n\t\t\t\t\t\t$( '.super-smush-attachments .wp-smush-stats' ).html( r.data.super_smush_stats );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tupdate_stats( scan_type );\n\t\t\t}\n\n\t\t} ).always( function () {\n\n\t\t\t//Hide the progress bar\n\t\t\tjQuery( '.bulk-smush-wrapper .wp-smush-bulk-progress-bar-wrapper' ).hide();\n\n\t\t\t// Add check complete status to button.\n\t\t\tbutton.text( wp_smush_msgs.resmush_complete )\n\t\t\t\t.removeClass( 'sui-button-onload sui-icon-loader sui-loading' )\n\t\t\t\t.addClass( 'smush-button-check-success' );\n\n\t\t\t// Remove success message from button.\n\t\t\tsetTimeout( function () {\n\t\t\t\tbutton.removeClass( 'smush-button-check-success' )\n\t\t\t\t\t.text( wp_smush_msgs.resmush_check );\n\t\t\t}, 2000 );\n\n\t\t\t$( '.wp-smush-button' ).removeAttr( 'disabled' );\n\n\t\t\t//If wp-smush-re-check-message is there, remove it\n\t\t\tif ( $( '.wp-smush-re-check-message' ).length ) {\n\t\t\t\tremove_element( $( '.wp-smush-re-check-message' ) );\n\t\t\t}\n\t\t} );\n\t};\n\n\t/**\n\t * Get directory list using Ajax\n\t *\n\t * @param param\n\t * @returns {string}\n\t *\n\t */\n\tvar getDirectoryList = function ( param ) {\n\t\tparam.action = 'smush_get_directory_list';\n\t\tparam.list_nonce = jQuery( 'input[name=\"list_nonce\"]' ).val();\n\t\tvar res = '';\n\t\t$.ajax( {\n\t\t\ttype: \"GET\",\n\t\t\turl: ajaxurl,\n\t\t\tdata: param,\n\t\t\tsuccess: function ( response ) {\n\t\t\t\tres = response;\n\t\t\t},\n\t\t\tasync: false\n\t\t} );\n\t\t//Update the button text\n\t\t$( 'button.wp-smush-select-dir' ).html( wp_smush_msgs.add_dir );\n\t\treturn res;\n\t};\n\t/**\n\t * Hide the popup and reset the opacity for the button\n\t *\n\t */\n\tvar close_dialog = function () {\n\n\t\t// Close the dialog.\n\t\tSUI.dialogs['wp-smush-list-dialog'].hide();\n\n\t\t$( '.wp-smush-select-dir, button.wp-smush-browse, button.wp-smush-resume, a.wp-smush-dir-link' ).removeAttr( 'disabled' );\n\n\t\t// Reset the opacity for content and scan button\n\t\t$( '.wp-smush-select-dir, .wp-smush-list-dialog .sui-box-body' ).css( {'opacity': '1'} );\n\t};\n\n\t/**\n\t * Initialize accordion\n\t *\n\t */\n\tvar set_accordion = function () {\n\n\t\t// backward compat of instantiate new accordion\n\t\tSUI.suiAccordion( $( '.sui-table.sui-accordion.smush-dir-smush-accordion' ) );\n\t};\n\n\t/**\n\t * Check if all the elements in the directory are smushed or not\n\t *\n\t * @param parent directory selector\n\t *\n\t * @returns {boolean}\n\t *\n\t */\n\tvar is_last_element = function ( parent ) {\n\t\tvar elements = parent.find( 'li.wp-smush-image-ele:not(.optimised,.processed,.error)' );\n\t\tif ( elements.length <= 0 ) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t};\n\n\t/**\n\t * Update directory optimisation progress if the element has a parent\n\t *\n\t * @param ele\n\t *\n\t */\n\tvar update_dir_progress = function ( ele ) {\n\n\t\tvar ele_tr = ele.closest( 'tr' );\n\t\tvar ele_prev_tr = ele_tr.prev( 'tr' );\n\t\tvar ele_dir_progress = ele_prev_tr.find( '.wp-smush-image-dir-progress' );\n\t\tvar ele_dir_progress_percent = ele_prev_tr.find( '.wp-smush-image-progress-percent' );\n\t\tvar ele_dir_count = ele_prev_tr.find( '.sui-tag' );\n\t\tvar ele_exclude_btn = ele_prev_tr.find( '.wp-smush-exclude-dir' );\n\n\t\tvar children = ele.closest( 'tr' ).find( '.wp-smush-image-ele' );\n\t\tvar parent = ele.is( 'li' ) ? ele.parent() : '';\n\n\t\t//Update the percentage, Check the total number of images inside dir, smushed images count\n\t\tif ( children.length > 0 ) {\n\t\t\tvar total = children.length;\n\t\t\tvar smushed = children.filter( '.optimised' ).length;\n\t\t\tif ( smushed > 0 && total > 0 ) {\n\t\t\t\tele_dir_progress_percent.removeClass( 'sui-hidden' );\n\t\t\t\tvar percent = ( smushed / total ) * 100;\n\t\t\t\tpercent = precise_round( percent, 1 );\n\t\t\t\tele_dir_progress_percent.html( percent + '%' );\n\t\t\t}\n\t\t}\n\n\t\t//Add the class in-progress, to show the respective icon for parent\n\t\tif ( 0 != $( 'input[name=\"wp-smush-continue-ajax\"]' ).val() && smushed != total ) {\n\t\t\t//Append a spinner\n\t\t\tele_dir_progress.addClass( 'sui-icon-loader sui-loading' );\n\t\t}\n\n\t\tif ( parent.length === 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\t//Check if last image, and if all the images are not smushed under the specified directory path, add a generic warning message\n\t\tif ( is_last_element( parent ) ) {\n\t\t\tif ( smushed < total ) {\n\t\t\t\tvar unsmushed = total - smushed;\n\t\t\t\tvar message = '<div class=\"sui-notice sui-notice-warning\"><p>' + unsmushed + ' ' + ( 1 == unsmushed ? wp_smush_msgs.unfinished_smush_single : wp_smush_msgs.unfinished_smush ) + '</p></div>';\n\n\t\t\t\t//If the notice is already displayed, remove it\n\t\t\t\tvar notice = parent.find( 'div.sui-notice' );\n\t\t\t\tif ( notice.length ) {\n\t\t\t\t\tnotice.remove();\n\t\t\t\t}\n\n\t\t\t\t//Append message to 2nd parent i.e li\n\t\t\t\tparent.after( message );\n\t\t\t\tele_dir_progress.removeClass( 'sui-icon-loader sui-loading' ).addClass( 'partial' );\n\t\t\t\tele_tr.find( 'td' ).addClass( 'partial' );\n\t\t\t\tele_prev_tr.find( 'td' ).addClass( 'partial' );\n\t\t\t} else {\n\t\t\t\tele_dir_progress.removeClass( 'partial sui-icon-loader sui-loading' ).addClass( 'optimised' );\n\t\t\t\t// Update the count tag class.\n\t\t\t\tele_dir_count.removeClass( 'sui-tag-warning' ).addClass( 'sui-tag-inactive' );\n\t\t\t\tele_exclude_btn.hide();\n\t\t\t\tele_tr.find( 'td' ).removeClass( 'partial' ).addClass( 'optimised' );\n\t\t\t\tele_prev_tr.find( 'td' ).removeClass( 'partial' ).addClass( 'optimised' );\n\t\t\t}\n\t\t\t//Remove the loader and percentage.\n\t\t\tele_dir_progress.removeClass( 'sui-icon-loader sui-loading' );\n\t\t\tele_dir_progress_percent.html( '' );\n\t\t}\n\n\t};\n\n\t/**\n\t * Add choose directory button at the top\n\t *\n\t */\n\tvar add_dir_browser_button = function () {\n\t\t//Get the content div length, if less than 1500, Skip\n\t\tif ( $( 'div.wp-smush-scan-result div.content' ).height() < 1500 || $( 'div.dir-smush-button-wrap.top' ).length >= 1 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar choose_button = $( 'div.dir-smush-button-wrap' ).clone();\n\t\tchoose_button.addClass( 'top' );\n\t\t$( 'div.wp-smush-scan-result div.content' ).prepend( choose_button );\n\t};\n\n\tvar add_smush_button = function () {\n\t\t//Get the content div length, if less than 1500, Skip\n\t\tif ( $( 'div.wp-smush-scan-result div.content' ).height() < 1500 || $( 'div.wp-smush-all-button-wrap.top' ).length >= 1 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar smush_button = $( 'div.wp-smush-all-button-wrap.bottom' ).clone();\n\t\tsmush_button.addClass( 'top' ).removeClass( 'bottom' );\n\t\t$( 'div.wp-smush-scan-result div.content' ).prepend( smush_button );\n\n\t};\n\n\t/**\n\t * Add smush notice after directory smushing is finished\n\t *\n\t * @param notice_type\n\t *  all_done -  If all the images were smushed else warning\n\t *  smush_limit - If Free users exceeded limit\n\t *\n\t */\n\tvar add_smush_dir_notice = function ( notice_type ) {\n\t\t//Get the content div length, if less than 1500, Skip\n\t\tif ( $( 'div.wp-smush-scan-result div.content' ).height() < 1500 || $( 'div.wp-smush-scan-result div.sui-notice.top' ).length >= 1 ) {\n\t\t\treturn;\n\t\t}\n\t\tvar notice = '';\n\t\t//Clone and append the notice\n\t\tif ( 'all_done' == notice_type ) {\n\t\t\tnotice = $( 'div.sui-notice.wp-smush-dir-all-done' ).clone();\n\t\t} else if ( 'smush_limit' == notice_type ) {\n\t\t\tnotice = $( 'div.sui-notice.wp-smush-dir-limit' ).clone();\n\t\t} else {\n\t\t\tnotice = $( 'div.sui-notice.wp-smush-dir-remaining' ).clone();\n\t\t}\n\n\t\t//Add class top\n\t\tnotice.addClass( 'top' );\n\n\t\t//Append the notice\n\t\t$( 'div.wp-smush-scan-result div.dir-smush-button-wrap' ).after( notice );\n\t};\n\n\tvar update_smush_progress = function () {\n\t\tvar in_progress_path = $( 'ul.wp-smush-image-list li.in-progress' );\n\t\tin_progress_path.removeClass( 'in-progress active' );\n\t\tif ( in_progress_path.length > 0 ) {\n\t\t\tin_progress_path.each( function ( index, ele ) {\n\t\t\t\tif ( $( ele ).hasClass( 'wp-smush-image-ul' ) ) {\n\t\t\t\t\t//Remove Spinner\n\t\t\t\t\t$( ele ).find( 'span.spinner' ).remove();\n\n\t\t\t\t\t//Check if images are pending\n\t\t\t\t\tvar in_progress_ele = $( ele ).find( 'li.wp-smush-image-ele' );\n\n\t\t\t\t\t//If there are elements\n\t\t\t\t\tif ( in_progress_ele.length > 0 ) {\n\t\t\t\t\t\tvar optimised = in_progress_ele.filter( '.optimised' ).length;\n\t\t\t\t\t\tvar error = in_progress_ele.filter( '.error' ).length;\n\t\t\t\t\t\t//if all the elements are optimised\n\t\t\t\t\t\tif ( optimised == in_progress_ele.length ) {\n\t\t\t\t\t\t\t$( ele ).addClass( 'complete' );\n\t\t\t\t\t\t} else if ( 0 < optimised || 0 < error ) {\n\t\t\t\t\t\t\t//If there are images that needs to be smushed, add the class partial\n\t\t\t\t\t\t\t$( ele ).addClass( 'partial' );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\t//Remove spinner for the element\n\t\t\t\t\t$( ele ).find( 'span.spinner' ).remove();\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t};\n\n\t/**\n\t * Set pro savings stats if not premium user.\n\t *\n\t * For non-premium users, show expected avarage savings based\n\t * on the free version savings.\n\t */\n\tvar set_pro_savings = function () {\n\n\t\t// Default values.\n\t\tvar savings = wp_smushit_data.savings_percent > 0 ? wp_smushit_data.savings_percent : 0;\n\t\tvar savings_bytes = wp_smushit_data.savings_bytes > 0 ? wp_smushit_data.savings_bytes : 0;\n\t\tvar orig_diff = 2.22058824;\n\t\tif ( savings > 49 ) {\n\t\t\tvar orig_diff = 1.22054412;\n\t\t}\n\t\t//Calculate Pro savings\n\t\tif ( savings > 0 ) {\n\t\t\tsavings = orig_diff * savings;\n\t\t\tsavings_bytes = orig_diff * savings_bytes;\n\t\t}\n\n\t\twp_smushit_data.pro_savings = {\n\t\t\t'percent': precise_round( savings, 1 ),\n\t\t\t'savings_bytes': formatBytes( savings_bytes, 1 )\n\n\t\t}\n\t};\n\n\t/**\n\t * Adds the stats for the current image to existing stats\n\t *\n\t * @param image_stats\n\t *\n\t */\n\tvar update_localized_stats = function ( image_stats, type ) {\n\t\t//Increase the smush count\n\t\tif ( 'undefined' == typeof wp_smushit_data ) {\n\t\t\treturn;\n\t\t}\n\n\t\t//No need to increase attachment count, resize, conversion savings for directory smush\n\t\tif ( 'media' == type ) {\n\t\t\twp_smushit_data.count_smushed = parseInt( wp_smushit_data.count_smushed ) + 1;\n\n\t\t\t//Increase smushed image count\n\t\t\twp_smushit_data.count_images = parseInt( wp_smushit_data.count_images ) + parseInt( image_stats.count );\n\n\t\t\t//Increase super smush count, if applicable\n\t\t\tif ( image_stats.is_lossy ) {\n\t\t\t\twp_smushit_data.count_supersmushed = parseInt( wp_smushit_data.count_supersmushed ) + 1;\n\t\t\t}\n\n\t\t\t//Add to Resize Savings\n\t\t\twp_smushit_data.savings_resize = 'undefined' != typeof image_stats.savings_resize.bytes ? parseInt( wp_smushit_data.savings_resize ) + parseInt( image_stats.savings_resize.bytes ) : parseInt( wp_smushit_data.savings_resize );\n\n\t\t\t//Update Resize count\n\t\t\twp_smushit_data.count_resize = 'undefined' != typeof image_stats.savings_resize.bytes ? parseInt( wp_smushit_data.count_resize ) + 1 : wp_smushit_data.count_resize;\n\n\t\t\t//Add to Conversion Savings\n\t\t\twp_smushit_data.savings_conversion = 'undefined' != typeof image_stats.savings_conversion && 'undefined' != typeof image_stats.savings_conversion.bytes ? parseInt( wp_smushit_data.savings_conversion ) + parseInt( image_stats.savings_conversion.bytes ) : parseInt( wp_smushit_data.savings_conversion );\n\t\t} else if ( 'directory_smush' == type ) {\n\t\t\t//Increase smushed image count\n\t\t\twp_smushit_data.count_images = parseInt( wp_smushit_data.count_images ) + 1;\n\t\t} else if ( 'nextgen' == type ) {\n\t\t\twp_smushit_data.count_smushed = parseInt( wp_smushit_data.count_smushed ) + 1;\n\t\t\twp_smushit_data.count_supersmushed = parseInt( wp_smushit_data.count_supersmushed ) + 1;\n\n\t\t\t//Increase smushed image count\n\t\t\twp_smushit_data.count_images = parseInt( wp_smushit_data.count_images ) + parseInt( image_stats.count );\n\t\t}\n\n\t\t//If we have savings\n\t\tif ( image_stats.size_before > image_stats.size_after ) {\n\t\t\t//Update savings\n\t\t\twp_smushit_data.size_before = 'undefined' != typeof image_stats.size_before ? parseInt( wp_smushit_data.size_before ) + parseInt( image_stats.size_before ) : parseInt( wp_smushit_data.size_before );\n\t\t\twp_smushit_data.size_after = 'undefined' != typeof image_stats.size_after ? parseInt( wp_smushit_data.size_after ) + parseInt( image_stats.size_after ) : parseInt( wp_smushit_data.size_after );\n\t\t}\n\t\t//Add stats for resizing\n\t\tif ( 'undefined' != typeof image_stats.savings_resize ) {\n\t\t\t//Update savings\n\t\t\twp_smushit_data.size_before = 'undefined' != typeof image_stats.savings_resize.size_before ? parseInt( wp_smushit_data.size_before ) + parseInt( image_stats.savings_resize.size_before ) : parseInt( wp_smushit_data.size_before );\n\t\t\twp_smushit_data.size_after = 'undefined' != typeof image_stats.savings_resize.size_after ? parseInt( wp_smushit_data.size_after ) + parseInt( image_stats.savings_resize.size_after ) : parseInt( wp_smushit_data.size_after );\n\t\t}\n\t\t//Add stats for Conversion\n\t\tif ( 'undefined' != typeof image_stats.savings_conversion ) {\n\t\t\t//Update savings\n\t\t\twp_smushit_data.size_before = 'undefined' != typeof image_stats.savings_conversion.size_before ? parseInt( wp_smushit_data.size_before ) + parseInt( image_stats.savings_conversion.size_before ) : parseInt( wp_smushit_data.size_before );\n\t\t\twp_smushit_data.size_after = 'undefined' != typeof image_stats.savings_conversion.size_after ? parseInt( wp_smushit_data.size_after ) + parseInt( image_stats.savings_conversion.size_after ) : parseInt( wp_smushit_data.size_after );\n\t\t}\n\t};\n\n\t/**\n\t * Update all stats sections based on the response.\n\t *\n\t * @param scan_type Current scan type.\n\t */\n\tvar update_stats = function ( scan_type ) {\n\n\t\tvar super_savings = 0,\n\t\t\tsmushed_count = 0;\n\t\tvar is_nextgen = 'undefined' != typeof scan_type && 'nextgen' == scan_type;\n\n\t\t//Calculate updated savings in bytes\n\t\twp_smushit_data.savings_bytes = parseInt( wp_smushit_data.size_before ) - parseInt( wp_smushit_data.size_after );\n\n\t\tvar formatted_size = formatBytes( wp_smushit_data.savings_bytes, 1 );\n\n\t\tif ( is_nextgen ) {\n\t\t\t$( '.wp-smush-savings .wp-smush-stats-human' ).html( formatted_size );\n\t\t} else {\n\t\t\t$( '.wp-smush-savings .wp-smush-stats-human' ).html( getFormatFromString( formatted_size ) );\n\t\t\t$( '.sui-summary-large.wp-smush-stats-human' ).html( getSizeFromString( formatted_size ) );\n\t\t}\n\n\t\t//Update the savings percent\n\t\twp_smushit_data.savings_percent = precise_round( ( parseInt( wp_smushit_data.savings_bytes ) / parseInt( wp_smushit_data.size_before ) ) * 100, 1 );\n\t\tif ( ! isNaN( wp_smushit_data.savings_percent ) ) {\n\t\t\t$( '.wp-smush-savings .wp-smush-stats-percent' ).html( wp_smushit_data.savings_percent );\n\t\t}\n\n\t\t//Update Savings in share message\n\t\t//$( 'span.smush-share-savings' ).html( formatBytes( wp_smushit_data.savings_bytes, 1 ) );\n\n\t\t//Update Smush percent\n\t\twp_smushit_data.smush_percent = precise_round( ( parseInt( wp_smushit_data.count_smushed ) / parseInt( wp_smushit_data.count_total ) ) * 100, 1 );\n\t\t$( 'span.wp-smush-images-percent' ).html( wp_smushit_data.smush_percent );\n\n\t\t//Super-Smush Savings\n\t\tif ( 'undefined' != typeof wp_smushit_data.savings_bytes && 'undefined' != typeof wp_smushit_data.savings_resize ) {\n\t\t\tsuper_savings = parseInt( wp_smushit_data.savings_bytes ) - parseInt( wp_smushit_data.savings_resize );\n\t\t\tif ( super_savings > 0 ) {\n\t\t\t\t$( 'li.super-smush-attachments span.smushed-savings' ).html( formatBytes( super_savings, 1 ) );\n\t\t\t}\n\t\t}\n\n\t\t//Update Image count\n\t\tif ( is_nextgen ) {\n\t\t\t$( '.sui-summary-details span.wp-smush-total-optimised' ).html( wp_smushit_data.count_images );\n\t\t} else {\n\t\t\t$( 'span.smushed-items-count span.wp-smush-count-total span.wp-smush-total-optimised' ).html( wp_smushit_data.count_images );\n\t\t}\n\n\t\t//Update image count in share message\n\t\t//$( 'span.smush-share-image-count' ).html( wp_smushit_data.count_images );\n\n\t\t//Update Resize image count\n\t\t$( 'span.smushed-items-count span.wp-smush-count-resize-total span.wp-smush-total-optimised' ).html( wp_smushit_data.count_resize );\n\n\t\t//Update Attachment image count\n\t\t//$( 'div.wp-smush-count-attachment-total span.wp-smush-total-optimised' ).html( wp_smushit_data.count_smushed );\n\n\t\t//Update image count in share message\n\n\t\t//Update supersmushed image count\n\t\tif ( $( 'li.super-smush-attachments .smushed-count' ).length && 'undefined' != typeof wp_smushit_data.count_supersmushed ) {\n\t\t\t$( 'li.super-smush-attachments .smushed-count' ).html( wp_smushit_data.count_supersmushed );\n\t\t}\n\n\t\t//Update Conversion Savings\n\t\tvar smush_conversion_savings = $( '.smush-conversion-savings' );\n\t\tif ( smush_conversion_savings.length > 0 && 'undefined' != typeof ( wp_smushit_data.savings_conversion ) && wp_smushit_data.savings_conversion != '' ) {\n\t\t\tvar conversion_savings = smush_conversion_savings.find( '.wp-smush-stats' );\n\t\t\tif ( conversion_savings.length > 0 ) {\n\t\t\t\tconversion_savings.html( formatBytes( wp_smushit_data.savings_conversion, 1 ) );\n\t\t\t}\n\t\t}\n\n\t\t//Update Resize Savings\n\t\tvar smush_resize_savings = $( '.smush-resize-savings' );\n\t\tif ( smush_resize_savings.length > 0 && 'undefined' != typeof ( wp_smushit_data.savings_resize ) && wp_smushit_data.savings_resize != '' ) {\n\t\t\t// Get the resize savings in number.\n\t\t\tvar savings_value = parseInt( wp_smushit_data.savings_resize );\n\t\t\tvar resize_savings = smush_resize_savings.find( '.wp-smush-stats' );\n\t\t\tvar resize_message = smush_resize_savings.find( '.wp-smush-stats-label-message' );\n\t\t\t// Replace only if value is grater than 0.\n\t\t\tif ( savings_value > 0 && resize_savings.length > 0 ) {\n\t\t\t\t// Hide message.\n\t\t\t\tif ( resize_message.length > 0 ) {\n\t\t\t\t\tresize_message.hide();\n\t\t\t\t}\n\t\t\t\tresize_savings.html( formatBytes( wp_smushit_data.savings_resize, 1 ) );\n\t\t\t}\n\t\t}\n\n\t\t//Update pro Savings\n\t\tset_pro_savings();\n\n\t\t// Updating pro savings stats.\n\t\tif ( 'undefined' != typeof (wp_smushit_data.pro_savings) ) {\n\t\t\t// Pro stats section.\n\t\t\tvar smush_pro_savings = $( '.smush-avg-pro-savings' );\n\t\t\tif ( smush_pro_savings.length > 0 ) {\n\t\t\t\tvar pro_savings_percent = smush_pro_savings.find( '.wp-smush-stats-percent' );\n\t\t\t\tvar pro_savings_bytes = smush_pro_savings.find( '.wp-smush-stats-human' );\n\t\t\t\tif ( pro_savings_percent.length > 0 && 'undefined' != typeof (wp_smushit_data.pro_savings.percent) && wp_smushit_data.pro_savings.percent != '' ) {\n\t\t\t\t\tpro_savings_percent.html( wp_smushit_data.pro_savings.percent );\n\t\t\t\t}\n\t\t\t\tif ( pro_savings_bytes.length > 0 && 'undefined' != typeof (wp_smushit_data.pro_savings.savings_bytes) && wp_smushit_data.pro_savings.savings_bytes != '' ) {\n\t\t\t\t\tpro_savings_bytes.html( wp_smushit_data.pro_savings.savings_bytes );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\n\t * Update the progress and show notice when smush completes\n\t */\n\tvar directory_smush_finished = function ( notice_type ) {\n\n\t\t// Remove progress icon from navbar.\n\t\t$( '.smush-nav-icon.directory' ).removeClass( 'sui-icon-loader sui-loading' );\n\n\t\t//If there are no images left\n\t\t$( 'button.wp-smush-pause' ).hide().attr( 'disabled', 'disabled' );\n\n\t\t//Hide Bulk Smush button if smush was stopped for error or finished\n\t\tif ( '' == notice_type ) {\n\t\t\t$( 'button.wp-smush-start' ).parent().hide();\n\t\t} else {\n\t\t\t$( 'button.wp-smush-start' ).show().removeAttr( 'disabled' );\n\t\t}\n\n\t\t//Enable Choose directory button\n\t\t$( 'button.wp-smush-browse' ).show().removeAttr( 'disabled', 'disabled' );\n\n\t\t//Clone Choose Directory Button and add at the top\n\t\tadd_dir_browser_button();\n\n\t\t//Clone and add Smush button\n\t\tadd_smush_button();\n\n\t\tif ( '' == notice_type ) {\n\t\t\t//Get the Total and Optimised image count\n\t\t\tvar image_ele = $( 'li.wp-smush-image-ele' );\n\t\t\tvar total = image_ele.length;\n\t\t\tvar remaning = image_ele.filter( ':not(.optimised)' ).length;\n\t\t\tvar smushed = total - remaning;\n\t\t\tif ( remaning > 0 ) {\n\t\t\t\t//Append the count\n\t\t\t\t$( 'span.wp-smush-dir-remaining' ).html( remaning );\n\t\t\t\t$( 'span.wp-smush-dir-total' ).html( total );\n\t\t\t\t$( 'span.wp-smush-dir-smushed' ).html( smushed );\n\n\t\t\t\t//Show remaining image notice\n\t\t\t\t$( '.sui-notice.wp-smush-dir-remaining' ).show();\n\n\t\t\t\t//Show notice on top if required\n\t\t\t\tadd_smush_dir_notice();\n\t\t\t} else {\n\n\t\t\t\t//Show success image notice\n\t\t\t\tvar message = $( '.sui-notice.wp-smush-dir-all-done' ).clone().show();\n\t\t\t\t// Hide images list.\n\t\t\t\t$( '.wp-smush-image-list tbody tr' ).not( ':first' ).not( ':last' ).hide();\n\t\t\t\t$( '.wp-smush-image-list tbody tr:first td' ).html( message ).removeClass( 'partial optimised' );\n\n\t\t\t\t//Show notice on top if required\n\t\t\t\tadd_smush_dir_notice( 'all_done' );\n\t\t\t}\n\t\t} else {\n\t\t\t//Show Bulk Limit Notice\n\t\t\t$( '.wp-smush-notice.wp-smush-dir-limit' ).show();\n\t\t\t//Show notice on top if required\n\t\t\tadd_smush_dir_notice( 'smush_limit' );\n\t\t}\n\t};\n\n\t/**\n\t * Start Optimising all the images listed in last directory scan\n\t */\n\tvar smush_all = function () {\n\n\t\tvar unprocessed_child = jQuery( '.wp-smush-image-list .wp-smush-image-ele:not(\".optimised, .processed\")' );\n\n\t\t//Update the Optimising status for the image\n\t\tvar first_child = unprocessed_child.first();\n\n\t\tvar img_progress = first_child.find( '.wp-smush-image-ele-progress' );\n\t\tvar parent_tr = first_child.closest( 'tr' ).prev( 'tr' );\n\t\tvar dir_progress = parent_tr.find( '.wp-smush-image-dir-progress' );\n\t\tvar exclude_btn = parent_tr.find( '.wp-smush-exclude-dir' );\n\t\tvar progress_percent = parent_tr.find( '.wp-smush-image-progress-percent' );\n\n\t\t//Check if the selected element is under expandable li\n\t\tif ( dir_progress.length == 1 ) {\n\t\t\tdir_progress.addClass( 'sui-icon-loader sui-loading' ).removeClass( 'partial optimised' );\n\t\t\texclude_btn.addClass( 'sui-hidden' ).hide();\n\t\t}\n\n\t\t// Show waiting message.\n\t\t$( '.wp-smush-image-progress-percent' ).not( '.optimised' ).removeClass( 'sui-hidden' );\n\n\t\t//Append and show spinner\n\t\timg_progress.addClass( 'sui-icon-loader sui-loading' );\n\n\t\t//If all the elements are optimised, No need to send ajax request\n\t\tif ( first_child.length === 0 ) {\n\t\t\tdirectory_smush_finished( '' );\n\t\t\treturn;\n\t\t}\n\n\t\t/** Ajax Request to optimise directory images */\n\t\tvar param = {\n\t\t\taction: 'optimise',\n\t\t\timage_id: first_child.attr( 'id' ),\n\t\t\tget_stats: unprocessed_child.length > 1 ? 0 : 1,\n\t\t\tnonce: $( '#wp-smush-all' ).val()\n\t\t};\n\n\t\t//Send Ajax request\n\t\t$.get( ajaxurl, param, function ( res ) {\n\n\t\t\t//Check, if limit is exceeded for free version\n\t\t\tif ( typeof res.data !== \"undefined\" && res.data.error == 'dir_smush_limit_exceeded' ) {\n\t\t\t\t//@todo: Check if this is required anymore\n\t\t\t\tfirst_child.removeClass('processed');\n\t\t\t\t//Show error, Bulk Smush limit exceeded\n\t\t\t\tdirectory_smush_finished( 'wp-smush-dir-limit' );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t//append stats, remove loader, add loader to next image, loop\n\t\t\tvar data = 'undefined' != typeof ( res.data ) ? res.data : '';\n\n\t\t\t//If image element is there\n\t\t\tif ( 'undefined' != typeof(data.image) ) {\n\t\t\t\t//Mark Optimised\n\t\t\t\tvar ele = jQuery( document.getElementById( data.image.id ) );\n\t\t\t\tvar ele_img_progress = ele.find( '.wp-smush-image-ele-progress' );\n\n\t\t\t\tele.removeClass( 'partial' );\n\t\t\t\tele_img_progress.removeClass( 'sui-icon-loader sui-loading' );\n\n\t\t\t\tif ( res.success ) {\n\n\t\t\t\t\tele.addClass( 'optimised' );\n\t\t\t\t\tele_img_progress.addClass( 'optimised' );\n\n\t\t\t\t\t//Update Directory progress\n\t\t\t\t\tupdate_dir_progress( ele );\n\n\t\t\t\t\t// @todo Update stats.\n\t\t\t\t} else {\n\t\t\t\t\t//If there was an error optimising the image\n\t\t\t\t\tele.addClass( 'processed' );\n\t\t\t\t\tele_img_progress.addClass( 'partial' );\n\t\t\t\t\t//Update Directory progress\n\t\t\t\t\tupdate_dir_progress( ele );\n\t\t\t\t}\n\n\t\t\t\t//@todo: Fixed stats UI\n\t\t\t}\n\n\t\t\t//If user haven't paused the Smushing\n\t\t\tif ( 1 == $( 'input[name=\"wp-smush-continue-ajax\"]' ).val() ) {\n\t\t\t\t//Loop\n\t\t\t\tsmush_all( false );\n\t\t\t} else {\n\t\t\t\t//Reset the Ajax flag\n\t\t\t\t$( 'input.wp-smush-continue-ajax' ).val( 1 );\n\t\t\t}\n\n\t\t} );\n\t};\n\n\t//Finds y value of given object\n\tfunction findPos( obj ) {\n\t\tvar curtop = 0;\n\t\tif ( obj.offsetParent ) {\n\t\t\tdo {\n\t\t\t\tcurtop += obj.offsetTop;\n\t\t\t} while ( obj = obj.offsetParent );\n\t\t\treturn [curtop];\n\t\t}\n\t}\n\n\t//Scroll the element to top of the page\n\tvar goToByScroll = function ( selector ) {\n\t\t// Scroll\n\t\t$( 'html,body' ).animate( {\n\t\t\t\tscrollTop: $( selector ).offset().top - 100\n\t\t\t},\n\t\t\t'slow' );\n\t};\n\n\tvar disable_buttons = function ( self ) {\n\t\tself.attr( 'disabled', 'disabled' );\n\t\t$( '.wp-smush-browse' ).attr( 'disabled', 'disabled' );\n\t};\n\n\tvar update_cummulative_stats = function ( stats ) {\n\t\t//Update Directory Smush Stats\n\t\tif ( 'undefined' != typeof ( stats.dir_smush ) ) {\n\t\t\tvar stats_human = $( 'li.smush-dir-savings span.wp-smush-stats span.wp-smush-stats-human' );\n\t\t\tvar stats_percent = $( 'li.smush-dir-savings span.wp-smush-stats span.wp-smush-stats-percent' );\n\n\t\t\t// Do not replace if 0 savings.\n\t\t\tif ( stats.dir_smush.bytes > 0 ) {\n\t\t\t\t// Hide selector.\n\t\t\t\t$( 'li.smush-dir-savings .wp-smush-stats-label-message' ).hide();\n\t\t\t\t//Update Savings in bytes\n\t\t\t\tif ( stats_human.length > 0 ) {\n\t\t\t\t\tstats_human.html( stats.dir_smush.human );\n\t\t\t\t} else {\n\t\t\t\t\tvar span = '<span class=\"wp-smush-stats-human\">' + stats.dir_smush.bytes + '</span>';\n\t\t\t\t}\n\n\t\t\t\t//Percentage section\n\t\t\t\tif ( stats.dir_smush.percent > 0 ) {\n\t\t\t\t\t// Show size and percentage separator.\n\t\t\t\t\t$( 'li.smush-dir-savings span.wp-smush-stats span.wp-smush-stats-sep' ).removeClass('sui-hidden');\n\t\t\t\t\t//Update Optimisation percentage\n\t\t\t\t\tif ( stats_percent.length > 0 ) {\n\t\t\t\t\t\tstats_percent.html( stats.dir_smush.percent + '%' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar span = '<span class=\"wp-smush-stats-percent\">' + stats.dir_smush.percent + '%' + '</span>';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//Update Combined stats\n\t\tif ( 'undefined' != typeof ( stats.combined_stats ) && stats.combined_stats.length > 0 ) {\n\t\t\tvar c_stats = stats.combined_stats;\n\n\t\t\tvar smush_percent = ( c_stats.smushed / c_stats.total_count ) * 100;\n\t\t\tsmush_percent = precise_round( smush_percent, 1 );\n\n\t\t\t//Smushed Percent\n\t\t\tif ( smush_percent ) {\n\t\t\t\t$( 'div.wp-smush-count-total span.wp-smush-images-percent' ).html( smush_percent );\n\t\t\t}\n\t\t\t//Update Total Attachment Count\n\t\t\tif ( c_stats.total_count ) {\n\t\t\t\t$( 'span.wp-smush-count-total span.wp-smush-total-optimised' ).html( c_stats.total_count );\n\t\t\t}\n\t\t\t//Update Savings and Percent\n\t\t\tif ( c_stats.savings ) {\n\t\t\t\t$( 'span.wp-smush-savings span.wp-smush-stats-human' ).html( c_stats.savings );\n\t\t\t}\n\t\t\tif ( c_stats.percent ) {\n\t\t\t\t$( 'span.wp-smush-savings span.wp-smush-stats-percent' ).html( c_stats.percent );\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\n\t * Show directory list popup and foucs on close button\n\t */\n\tvar showDialog = function () {\n\t\t//Shows the directories available\n\t\t$( '.wp-smush-list-dialog' ).show();\n\t\t$( '.wp-smush-list-dialog div.close' ).focus();\n\t};\n\n\t//Remove span tag from URL\n\tfunction removeSpan( url ) {\n\t\tvar url = url.slice( url.indexOf( '?' ) + 1 ).split( '&' );\n\t\tfor ( var i = 0; i < url.length; i++ ) {\n\t\t\tvar urlparam = decodeURI( url[i] ).split( /=(.+)/ )[1];\n\t\t\treturn urlparam.replace( /<(?:.|\\n)*?>/gm, '' );\n\t\t}\n\t}\n\n\t/**\n\t * Handle the Smush Stats link click\n\t */\n\t$( 'body' ).on( 'click', 'a.smush-stats-details', function ( e ) {\n\n\t\t//If disabled\n\t\tif ( 'disabled' == $( this ).attr( 'disabled' ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// prevent the default action\n\t\te.preventDefault();\n\t\t//Replace the `+` with a `-`\n\t\tvar slide_symbol = $( this ).find( '.stats-toggle' );\n\t\t$( this ).parents().eq( 1 ).find( '.smush-stats-wrapper' ).slideToggle();\n\t\tslide_symbol.text( slide_symbol.text() == '+' ? '-' : '+' );\n\n\n\t} );\n\n\t/** Handle smush button click **/\n\t$( 'body' ).on( 'click', '.wp-smush-send:not(.wp-smush-resmush)', function ( e ) {\n\t\t// prevent the default action\n\t\te.preventDefault();\n\t\tnew WP_Smush.Smush( $( this ), false );\n\t} );\n\n\t/** Handle NextGen Gallery smush button click **/\n\t$( 'body' ).on( 'click', '.wp-smush-nextgen-send', function ( e ) {\n\t\t// prevent the default action\n\t\te.preventDefault();\n\t\tnew WP_Smush.Smush( $( this ), false, 'nextgen' );\n\t} );\n\n\t/** Handle NextGen Gallery Bulk smush button click **/\n\t$( 'body' ).on( 'click', '.wp-smush-nextgen-bulk', function ( e ) {\n\t\t// prevent the default action\n\t\te.preventDefault();\n\n\t\t//Check for ids, if there is none (Unsmushed or lossless), don't call smush function\n\t\tif ( typeof wp_smushit_data == 'undefined' ||\n\t\t\t( wp_smushit_data.unsmushed.length == 0 && wp_smushit_data.resmush.length == 0 )\n\t\t) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t\tjQuery( '.wp-smush-button, .wp-smush-scan' ).attr( 'disabled', 'disabled' );\n\t\t$( \".wp-smush-notice.wp-smush-remaining\" ).hide();\n\t\tnew WP_Smush.Smush( $( this ), true, 'nextgen' );\n\n\t} );\n\n\t/** Restore: Media Library **/\n\t$( 'body' ).on( 'click', '.wp-smush-action.wp-smush-restore', function ( e ) {\n\t\tvar current_button = $( this );\n\t\tvar smush_action = 'smush_restore_image';\n\t\tprocess_smush_action( e, current_button, smush_action, 'restore' );\n\t\t//Change the class oa parent div ( Level 2 )\n\t\tvar parent = current_button.parents().eq( 1 );\n\t\tif ( parent.hasClass( 'smushed' ) ) {\n\t\t\tparent.removeClass( 'smushed' ).addClass( 'unsmushed' );\n\t\t}\n\t} );\n\n\t/** Resmush: Media Library **/\n\t$( 'body' ).on( 'click', '.wp-smush-action.wp-smush-resmush', function ( e ) {\n\t\tvar current_button = $( this );\n\t\tvar smush_action = 'smush_resmush_image';\n\t\tprocess_smush_action( e, current_button, smush_action, 'smushing' );\n\t} );\n\n\t/** Restore: NextGen Gallery **/\n\t$( 'body' ).on( 'click', '.wp-smush-action.wp-smush-nextgen-restore', function ( e ) {\n\t\tvar current_button = $( this );\n\t\tvar smush_action = 'smush_restore_nextgen_image';\n\t\tprocess_smush_action( e, current_button, smush_action, 'restore' );\n\t} );\n\n\t/** Resmush: NextGen Gallery **/\n\t$( 'body' ).on( 'click', '.wp-smush-action.wp-smush-nextgen-resmush', function ( e ) {\n\t\tvar current_button = $( this );\n\t\tvar smush_action = 'smush_resmush_nextgen_image';\n\t\tprocess_smush_action( e, current_button, smush_action, 'smushing' );\n\t} );\n\n\t//Scan For resmushing images\n\t$( 'body' ).on( 'click', '.wp-smush-scan', function ( e ) {\n\n\t\te.preventDefault();\n\n\t\t//Run the Re-check\n\t\trun_re_check( $( this ), false );\n\t} );\n\n\t//Dismiss Welcome notice\n\t//@todo: Use it for popup\n\t$( '#wp-smush-welcome-box .smush-dismiss-welcome' ).on( 'click', function ( e ) {\n\t\te.preventDefault();\n\t\tvar $el = $( this ).parents().eq( 1 );\n\t\tremove_element( $el );\n\n\t\t//Send a ajax request to save the dismissed notice option\n\t\tvar param = {\n\t\t\taction: 'dismiss_welcome_notice'\n\t\t};\n\t\t$.post( ajaxurl, param );\n\t} );\n\n\t//Remove Notice\n\t$( 'body' ).on( 'click', '.wp-smush-notice .icon-fi-close', function ( e ) {\n\t\te.preventDefault();\n\t\tvar $el = $( this ).parent();\n\t\tremove_element( $el );\n\t} );\n\n\t//On Click Update Settings. Check for change in settings\n\t$( 'input#wp-smush-save-settings' ).on( 'click', function ( e ) {\n\t\te.preventDefault();\n\n\t\tvar setting_type = '';\n\t\tvar setting_input = $( 'input[name=\"setting-type\"]' );\n\t\t//Check if setting type is set in the form\n\t\tif ( setting_input.length > 0 ) {\n\t\t\tsetting_type = setting_input.val();\n\t\t}\n\n\t\t//Show the spinner\n\t\tvar self = $( this );\n\t\tself.parent().find( 'span.sui-icon-loader.sui-loading' ).removeClass( 'sui-hidden' );\n\n\t\t//Save settings if in network admin\n\t\tif ( '' != setting_type && 'network' == setting_type ) {\n\t\t\t//Ajax param\n\t\t\tvar param = {\n\t\t\t\taction: 'save_settings',\n\t\t\t\tnonce: $( '#wp_smush_options_nonce' ).val()\n\t\t\t};\n\n\t\t\tparam = jQuery.param( param ) + '&' + jQuery( 'form#wp-smush-settings-form' ).serialize();\n\n\t\t\t//Send ajax, Update Settings, And Check For resmush\n\t\t\tjQuery.post( ajaxurl, param ).done( function () {\n\t\t\t\tjQuery( 'form#wp-smush-settings-form' ).submit();\n\t\t\t\treturn true;\n\t\t\t} );\n\t\t} else {\n\n\t\t\t//Check for all the settings, and scan for resmush\n\t\t\tvar wrapper_div = self.parents().eq( 1 );\n\n\t\t\t//Get all the main settings\n\t\t\tvar keep_exif = document.getElementById( \"wp-smush-keep_exif\" );\n\t\t\tvar super_smush = document.getElementById( \"wp-smush-lossy\" );\n\t\t\tvar smush_original = document.getElementById( \"wp-smush-original\" );\n\t\t\tvar resize_images = document.getElementById( \"wp-smush-resize\" );\n\t\t\tvar smush_pngjpg = document.getElementById( \"wp-smush-png_to_jpg\" );\n\n\t\t\tvar update_button_txt = true;\n\n\t\t\t$( '.wp-smush-hex-notice' ).hide();\n\n\t\t\t//If Preserve Exif is Checked, and all other settings are off, just save the settings\n\t\t\tif ( ( keep_exif === null || keep_exif.checked )\n\t\t\t\t&& ( super_smush === null || !super_smush.checked )\n\t\t\t\t&& ( smush_original === null || !smush_original.checked )\n\t\t\t\t&& ( resize_images === null || !resize_images.checked )\n\t\t\t\t&& ( smush_pngjpg === null || !smush_pngjpg.checked )\n\t\t\t) {\n\t\t\t\tupdate_button_txt = false;\n\t\t\t}\n\n\t\t\t//Update text\n\t\t\tself.attr( 'disabled', 'disabled' ).addClass( 'button-grey' );\n\n\t\t\tif ( update_button_txt ) {\n\t\t\t\tself.val( wp_smush_msgs.checking )\n\t\t\t}\n\n\t\t\t//Check if type is set in data attributes\n\t\t\tvar scan_type = self.data( 'type' );\n\t\t\tscan_type = 'undefined' == typeof scan_type ? 'media' : scan_type;\n\n\t\t\t//Ajax param\n\t\t\tvar param = {\n\t\t\t\taction: 'scan_for_resmush',\n\t\t\t\twp_smush_options_nonce: jQuery( '#wp_smush_options_nonce' ).val(),\n\t\t\t\tscan_type: scan_type\n\t\t\t};\n\n\t\t\tparam = jQuery.param( param ) + '&' + jQuery( 'form#wp-smush-settings-form' ).serialize();\n\n\t\t\t//Send ajax, Update Settings, And Check For resmush\n\t\t\tjQuery.post( ajaxurl, param ).done( function () {\n\t\t\t\tjQuery( 'form#wp-smush-settings-form' ).submit();\n\t\t\t\treturn true;\n\t\t\t} );\n\t\t}\n\t} );\n\n\t// On Resmush click.\n\t$( 'body' ).on( 'click', '.wp-smush-skip-resmush', function ( e ) {\n\t\te.preventDefault();\n\t\tvar self = jQuery( this );\n\t\tvar container = self.parents().eq( 1 );\n\n\t\t// Remove Parent div.\n\t\tvar $el = self.parent();\n\t\tremove_element( $el );\n\n\t\t// Remove Settings Notice.\n\t\t$( '.sui-notice-top.sui-notice-success' ).remove();\n\n\t\t// Set button attribute to skip re-smush ids.\n\t\tcontainer.find( '.wp-smush-all' ).attr( 'data-smush', 'skip_resmush' );\n\n\t\t// Update Smushed count.\n\t\twp_smushit_data.count_smushed = parseInt( wp_smushit_data.count_smushed ) + wp_smushit_data.resmush.length;\n\t\twp_smushit_data.count_supersmushed = parseInt( wp_smushit_data.count_supersmushed ) + wp_smushit_data.resmush.length;\n\n\t\t// Update Stats.\n\t\tif ( wp_smushit_data.count_smushed == wp_smushit_data.count_total ) {\n\n\t\t\t// Show all done notice.\n\t\t\t$( '.wp-smush-notice.wp-smush-all-done, .wp-smush-pagespeed-recommendation' ).show();\n\n\t\t\t// Hide Smush button.\n\t\t\t$( '.wp-smush-bulk-wrapper ' ).hide()\n\n\t\t}\n\t\t//Remove Re-Smush Notice\n\t\t$( '.wp-smush-resmush-notice' ).remove();\n\n\t\tvar type = $( '.wp-smush-scan' ).data( 'type' );\n\t\ttype = 'undefined' == typeof type ? 'media' : type;\n\n\t\tvar smushed_count = 'undefined' != typeof wp_smushit_data.count_smushed ? wp_smushit_data.count_smushed : 0;\n\n\t\tvar smush_percent = ( smushed_count / wp_smushit_data.count_total ) * 100;\n\t\tsmush_percent = precise_round( smush_percent, 1 );\n\n\t\t$( '.wp-smush-images-percent' ).html( smush_percent );\n\n\t\t//Update the Progress Bar Width\n\t\t// get the progress bar\n\t\tvar $progress_bar = jQuery( '.bulk-smush-wrapper .wp-smush-progress-inner' );\n\t\tif ( $progress_bar.length < 1 ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// increase progress\n\t\t$progress_bar.css( 'width', smush_percent + '%' );\n\n\t\t//Show the default bulk smush notice\n\t\t$( '.wp-smush-bulk-wrapper' ).show();\n\t\t$( '.wp-smush-bulk-wrapper .sui-notice' ).show();\n\n\t\tvar params = {\n\t\t\taction: 'delete_resmush_list',\n\t\t\ttype: type\n\t\t};\n\t\t//Delete resmush list, @todo: update stats from the ajax response\n\t\t$.post( ajaxurl, params, function ( res ) {\n\t\t\t//Remove the whole li element on success\n\t\t\tif ( res.success && 'undefined' != typeof res.data.stats ) {\n\t\t\t\tvar stats = res.data.stats;\n\t\t\t\t//Update wp_smushit_data ( Smushed count, Smushed Percent, Image count, Super smush count, resize savings, conversion savings )\n\t\t\t\tif ( 'undefinied' != typeof wp_smushit_data ) {\n\t\t\t\t\twp_smushit_data.count_images = 'undefined' != typeof stats.count_images ? parseInt( wp_smushit_data.count_images ) + stats.count_images : wp_smushit_data.count_images;\n\t\t\t\t\twp_smushit_data.size_before = 'undefined' != typeof stats.size_before ? parseInt( wp_smushit_data.size_before ) + stats.size_before : wp_smushit_data.size_before;\n\t\t\t\t\twp_smushit_data.size_after = 'undefined' != typeof stats.size_after ? parseInt( wp_smushit_data.size_after ) + stats.size_after : wp_smushit_data.size_after;\n\t\t\t\t\twp_smushit_data.savings_resize = 'undefined' != typeof stats.savings_resize ? parseInt( wp_smushit_data.savings_resize ) + stats.savings_resize : wp_smushit_data.savings_resize;\n\t\t\t\t\twp_smushit_data.savings_conversion = 'undefined' != typeof stats.savings_conversion ? parseInt( wp_smushit_data.savings_conversion ) + stats.savings_conversion : wp_smushit_data.savings_conversion;\n\t\t\t\t\t//Add directory smush stats\n\t\t\t\t\tif ( 'undefined' != typeof ( wp_smushit_data.savings_dir_smush ) && 'undefined' != typeof ( wp_smushit_data.savings_dir_smush.orig_size ) ) {\n\t\t\t\t\t\twp_smushit_data.size_before = 'undefined' != typeof wp_smushit_data.savings_dir_smush ? parseInt( wp_smushit_data.size_before ) + parseInt( wp_smushit_data.savings_dir_smush.orig_size ) : wp_smushit_data.size_before;\n\t\t\t\t\t\twp_smushit_data.size_after = 'undefined' != typeof wp_smushit_data.savings_dir_smush ? parseInt( wp_smushit_data.size_after ) + parseInt( wp_smushit_data.savings_dir_smush.image_size ) : wp_smushit_data.size_after;\n\t\t\t\t\t}\n\n\t\t\t\t\twp_smushit_data.count_resize = 'undefined' != typeof stats.count_resize ? parseInt( wp_smushit_data.count_resize ) + stats.count_resize : wp_smushit_data.count_resize;\n\t\t\t\t}\n\t\t\t\t//Smush Notice\n\t\t\t\tif ($('.bulk-smush-wrapper .wp-smush-remaining-count').length && 'undefined' != typeof wp_smushit_data.unsmushed ) {\n\t\t\t\t\t$('.bulk-smush-wrapper .wp-smush-remaining-count').html(wp_smushit_data.unsmushed.length);\n\t\t\t\t}\n\t\t\t\tupdate_stats();\n\t\t\t}\n\t\t} );\n\n\t} );\n\n\t//Enable Super Smush\n\t$( 'a.wp-smush-lossy-enable' ).on( 'click', function ( e ) {\n\t\te.preventDefault();\n\n\t\t//Enable Super Smush\n\t\t$( '#wp-smush-lossy' ).prop( 'checked', true ).focus();\n\t\tgoToByScroll( \"#column-wp-smush-lossy\" );\n\t} );\n\n\t//Enable Resize\n\t$( '.wp-smush-resize-enable' ).on( 'click', function ( e ) {\n\t\te.preventDefault();\n\n\t\t//Enable Resize, Show resize settings\n\t\t$( '#wp-smush-resize' ).prop( 'checked', true ).focus();\n\t\t$( 'div.wp-smush-resize-settings-wrap' ).show();\n\n\t\t//Scroll down to settings area\n\t\tgoToByScroll( \"#column-wp-smush-resize\" );\n\t} );\n\n\t//Trigger Bulk\n\t$( 'body' ).on( 'click', '.wp-smush-trigger-bulk', function ( e ) {\n\t\te.preventDefault();\n\t\t//Induce Setting button save click\n\t\t$( 'button.wp-smush-all' ).click();\n\t\t$( 'span.sui-notice-dismiss' ).click();\n\t} );\n\n\t//Allow the checkboxes to be Keyboard Accessible\n\t$( '.wp-smush-setting-row .toggle-checkbox' ).focus( function () {\n\t\t//If Space is pressed\n\t\t$( this ).keypress( function ( e ) {\n\t\t\tif ( e.keyCode == 32 ) {\n\t\t\t\te.preventDefault();\n\t\t\t\t$( this ).find( '.toggle-checkbox' ).click();\n\t\t\t}\n\t\t} );\n\t} );\n\n\t// Re-Validate Resize Width And Height.\n\t$( 'body' ).on( 'blur', '.wp-smush-resize-input', function () {\n\n\t\tvar self = $( this );\n\n\t\tvar wrapper_div = self.parents().eq( 4 );\n\n\t\t// Initiate the check.\n\t\tvalidate_resize_settings( wrapper_div, false, false ); // run the validation.\n\t} );\n\n\t// Handle Resize Checkbox toggle, to show/hide width, height settings.\n\t$( 'body' ).on( 'click', '#wp-smush-resize, #wp-smush-resize-quick-setup', function () {\n\t\tvar self = $( this );\n\t\tvar settings_wrap = $( '.wp-smush-resize-settings-wrap' );\n\n\t\tif ( self.is( ':checked' ) ) {\n\t\t\tsettings_wrap.show();\n\t\t} else {\n\t\t\tsettings_wrap.hide();\n\t\t}\n\t} );\n\n\t// Handle Automatic Smush Checkbox toggle, to show/hide image size settings.\n\t$( 'body' ).on( 'click', '#wp-smush-auto', function () {\n\t\tvar self = $( this );\n\t\tvar settings_wrap = $( '.wp-smush-image-size-list' );\n\n\t\tif ( self.is( ':checked' ) ) {\n\t\t\tsettings_wrap.show();\n\t\t} else {\n\t\t\tsettings_wrap.hide();\n\t\t}\n\t} );\n\n\t// Handle auto detect checkbox toggle, to show/hide highlighting notice.\n\t$( 'body' ).on( 'click', '#wp-smush-detection', function () {\n\t\tvar self = $( this );\n\t\tvar notice_wrap = $( '.smush-highlighting-notice' );\n\n\t\tif ( self.is( ':checked' ) ) {\n\t\t\tnotice_wrap.show();\n\t\t} else {\n\t\t\tnotice_wrap.hide();\n\t\t}\n\t} );\n\n\t// Handle PNG to JPG Checkbox toggle, to show/hide Transparent image conversion settings.\n\t$( '#wp-smush-png_to_jpg' ).click( function () {\n\t\tvar self = $( this );\n\t\tvar settings_wrap = $( '.wp-smush-png_to_jpg-wrap' );\n\n\t\tif ( self.is( ':checked' ) ) {\n\t\t\tsettings_wrap.show();\n\t\t} else {\n\t\t\tsettings_wrap.hide();\n\t\t}\n\t} );\n\n\t//Handle, Change event in Enable Networkwide settings\n\t$( '#wp-smush-networkwide' ).on( 'click', function ( e ) {\n\t\tif ( $( this ).is( ':checked' ) ) {\n\t\t\t$( '.network-settings-wrapper' ).show();\n\t\t\t$( '.sui-vertical-tabs li' ).not( '.smush-bulk' ).each( function ( n ) {\n\t\t\t\t$( this ).removeClass( 'sui-hidden' );\n\t\t\t} );\n\t\t} else {\n\t\t\t$( '.network-settings-wrapper' ).hide();\n\t\t\t$( '.sui-vertical-tabs li' ).not( '.smush-bulk' ).each( function ( n ) {\n\t\t\t\t$( this ).addClass( 'sui-hidden' );\n\t\t\t} );\n\t\t}\n\t} );\n\n\t//Handle Twitter Share\n\t$( '#wp-smush-twitter-share' ).on( 'click', function ( e ) {\n\t\te.preventDefault();\n\t\tvar url = this.href;\n\t\tvar text = removeSpan( url );\n\t\t//Update text in URL\n\t\turl = url.replace( /(text=)[^\\&]+/, '$1' + text );\n\t\tvar width = 550,\n\t\t\theight = 420,\n\t\t\tleft = ($( window ).width() - width) / 2,\n\t\t\ttop = ($( window ).height() - height) / 2,\n\t\t\turl = url,\n\t\t\topts = 'status=1' +\n\t\t\t\t',width=' + width +\n\t\t\t\t',height=' + height +\n\t\t\t\t',top=' + top +\n\t\t\t\t',left=' + left;\n\n\t\twindow.open( url, 'twitter', opts );\n\n\t\treturn false;\n\t} );\n\n\t//Handle Facebook Share\n\t$( '#wp-smush-facebook-share' ).on( 'click', function ( e ) {\n\t\te.preventDefault();\n\t\tvar width = 550,\n\t\t\theight = 420,\n\t\t\tleft = ($( window ).width() - width) / 2,\n\t\t\ttop = ($( window ).height() - height) / 2,\n\t\t\turl = this.href,\n\t\t\topts = 'status=1' +\n\t\t\t\t',width=' + width +\n\t\t\t\t',height=' + height +\n\t\t\t\t',top=' + top +\n\t\t\t\t',left=' + left;\n\n\t\twindow.open( url, 'facebook', opts );\n\n\t\treturn false;\n\t} );\n\n\t//Handle Re-check button functionality\n\t$( \"#wp-smush-revalidate-member\" ).on( 'click', function ( e ) {\n\t\te.preventDefault();\n\t\t//Ajax Params\n\t\tvar params = {\n\t\t\taction: 'smush_show_warning',\n\t\t};\n\t\tvar link = $( this );\n\t\tvar parent = link.parents().eq( 1 );\n\t\tparent.addClass( 'loading-notice' );\n\t\t$.get( ajaxurl, params, function ( r ) {\n\t\t\t//remove the warning\n\t\t\tparent.removeClass( 'loading-notice' ).addClass( \"loaded-notice\" );\n\t\t\tif ( 0 == r ) {\n\t\t\t\tparent.attr( 'data-message', wp_smush_msgs.membership_valid );\n\t\t\t\tremove_element( parent, 1000 );\n\t\t\t} else {\n\t\t\t\tparent.attr( 'data-message', wp_smush_msgs.membership_invalid );\n\t\t\t\tsetTimeout( function remove_loader() {\n\t\t\t\t\tparent.removeClass( 'loaded-notice' );\n\t\t\t\t}, 1000 )\n\t\t\t}\n\t\t} );\n\t} );\n\n\t//Initiate Re-check if the variable is set\n\tif ( 'undefined' != typeof (wp_smush_run_re_check) && 1 == wp_smush_run_re_check && $( '.wp-smush-scan' ).length > 0 ) {\n\t\t//Run the Re-check\n\t\trun_re_check( $( '.wp-smush-scan' ), false );\n\t}\n\n\t//Stats Section Choose Directory Link\n\t$( 'body' ).on( 'click', 'a.wp-smush-dir-link', function ( e ) {\n\t\tif ( $( 'div.sui-wrap button.wp-smush-browse' ).length > 0 ) {\n\t\t\te.preventDefault();\n\t\t\tSUI.dialogs[\"wp-smush-list-dialog\"].show();\n\t\t\t//Display the loader\n\t\t\t$( 'button.dir-smush-button-wrap span.spinner' ).addClass( 'is-active' );\n\n\t\t\t//Display File tree for Directory Smush\n\t\t\t$( \".wp-smush-list-dialog .content\" ).fileTree( {\n\t\t\t\t\tscript: getDirectoryList,\n\t\t\t\t\tmultiFolder: false\n\t\t\t\t},\n\t\t\t\tfunction () {\n\t\t\t\t}\n\t\t\t);\n\n\t\t}\n\t} );\n\n\t//WP Smush all : Scan Images\n\t$( 'div.sui-wrap' ).on( 'click', 'button.wp-smush-browse', function ( e ) {\n\n\t\te.preventDefault();\n\n\t\t//Hide all the notices\n\t\t$( 'div.wp-smush-scan-result div.wp-smush-notice' ).hide();\n\n\t\t//If disabled, do not process\n\t\tif ( $( this ).attr( 'disabled' ) ) {\n\t\t\treturn;\n\t\t} else {\n\t\t\t//Disable Buttons\n\t\t\t$( this ).attr( 'disabled', 'disabled' );\n\t\t\t$( 'button.wp-smush-resume' ).attr( 'disabled', 'disabled' );\n\t\t\t$( 'div.dir-smush-button-wrap span.spinner' ).addClass( 'is-active' );\n\n\t\t}\n\n\t\t//Remove Notice\n\t\t$( 'div.wp-smush-info' ).remove();\n\n\t\tshowDialog();\n\n\t\t//Display the loader\n\t\t$( 'button.dir-smush-button-wrap span.spinner' ).addClass( 'is-active' );\n\n\t\t//Display File tree for Directory Smush\n\t\t$( \".wp-smush-list-dialog .content\" ).fileTree( {\n\t\t\t\tscript: getDirectoryList,\n\t\t\t\tmultiFolder: false\n\t\t\t},\n\t\t\tfunction () {\n\t\t\t}\n\t\t);\n\n\t} );\n\n\t// On dialog close make browse btutton active.\n\t$( '.sui-dialog-close' ).on( 'click', function ( e ) {\n\t\t$( '.wp-smush-browse' ).removeAttr( 'disabled' );\n\t\tclose_dialog();\n\t} );\n\n\t//Image Directories: On Select button click\n\t$( '.wp-smush-select-dir' ).on( 'click', function ( e ) {\n\n\t\te.preventDefault();\n\n\t\t//If disabled, do not process\n\t\tif ( $( this ).attr( 'disabled' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar button = $( this );\n\n\t\t$( 'div.wp-smush-list-dialog div.sui-box-body' ).css( {'opacity': '0.8'} );\n\t\t$( 'div.wp-smush-list-dialog div.sui-box-body a' ).unbind( 'click' );\n\n\t\t//Remove resume button\n\t\t$( 'button.wp-smush-resume' ).remove();\n\n\t\t//Disable Button\n\t\tbutton.attr( 'disabled', 'disabled' );\n\n\t\tvar spinner = button.parent().find( '.add-dir-loader' );\n\t\t//Display the spinner\n\t\tspinner.addClass( 'sui-icon-loader sui-loading' );\n\n\t\t//Get the Selected directory path\n\t\tvar path = $( '.jqueryFileTree .selected a' ).attr( 'rel' );\n\t\tpath = 'undefined' == typeof (path) ? '' : path;\n\n\t\t//Absolute path\n\t\tvar abs_path = $( 'input[name=\"wp-smush-base-path\"]' ).val();\n\n\t\t//Fill in the input field\n\t\t$( '.wp-smush-dir-path' ).val( abs_path + '/' + path );\n\n\t\t//Send a ajax request to get a list of all the image files\n\t\tvar param = {\n\t\t\taction: 'image_list',\n\t\t\tsmush_path: $( '.wp-smush-dir-path' ).val(),\n\t\t\timage_list_nonce: $( 'input[name=\"image_list_nonce\"]' ).val()\n\t\t};\n\n\t\t//Get the List of images\n\t\t$.get( ajaxurl, param, function ( res ) {\n\t\t\tif ( !res.success && 'undefined' !== typeof ( res.data.message ) ) {\n\t\t\t\t$( 'div.wp-smush-scan-result div.content' ).html( res.data.message );\n\t\t\t} else {\n\t\t\t\t$( '.wp-smush-scan-result .smush-dir-smush-done' ).addClass( 'sui-hidden' );\n\t\t\t\t$( 'div.wp-smush-scan-result div.content' ).html( res.data );\n\t\t\t\tvar wp_smush_dir_image_ids = res.data.ids;\n\t\t\t}\n\t\t\tset_accordion();\n\t\t\tclose_dialog();\n\n\t\t\t//Remove the spinner\n\t\t\tspinner.removeClass( 'sui-icon-loader sui-loading' );\n\n\t\t\t//Show Scan result\n\t\t\t$( '.wp-smush-scan-result' ).removeClass( 'sui-hidden' ).show();\n\t\t} ).done( function ( res ) {\n\n\t\t\t// Show select directory button on top.\n\t\t\t$( 'div.sui-box-header button.wp-smush-browse' ).removeClass( 'sui-hidden' );\n\n\t\t\t//If there was no image list, return\n\t\t\tif ( !res.success ) {\n\t\t\t\t//Hide the smush button\n\t\t\t\t$( 'div.wp-smush-all-button-wrap.bottom' ).addClass( 'sui-hidden' );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t//Show the smush button\n\t\t\t$( 'div.wp-smush-all-button-wrap.bottom' ).removeClass( 'sui-hidden' );\n\n\t\t\t//Remove disabled attribute for the button\n\t\t\t$( 'button.wp-smush-start' ).removeAttr( 'disabled' );\n\n\t\t\t//Append a Directory browser button at the top\n\t\t\tadd_dir_browser_button();\n\n\t\t\t//Clone and add Smush button\n\t\t\tadd_smush_button();\n\n\t\t\twindow.location.hash = '#wp-smush-dir-browser';\n\t\t} );\n\t} );\n\n\t/**\n\t * Handle the Smush Now button click\n\t */\n\t$( '#wp-smush-dir-wrap-box' ).on( 'click', 'button.wp-smush-start', function ( e ) {\n\t\te.preventDefault();\n\n\t\t//Check if we have images to be optimised\n\t\tif ( !$( '.wp-smush-image-ele:not(.optimised)' ).length ) {\n\t\t\treturn;\n\t\t}\n\n\t\t//Disable this button\n\t\tvar button = $( '.wp-smush-start' );\n\t\tvar parent = button.parent();\n\n\t\t//Hide all the notices\n\t\t$( 'div.wp-smush-scan-result div.sui-notice' ).hide();\n\n\t\t//Set the button status to 0, to cancel next ajax request\n\t\t$( 'input[name=\"wp-smush-continue-ajax\"]' ).val( 1 );\n\n\t\t//Hide Directory browser button\n\t\t$( 'button.wp-smush-browse' ).hide();\n\n\t\t//Hide Exclude directory button link\n\t\t$( '.wp-smush-exclude-dir' ).hide();\n\n\t\t/** All the Styling changes **/\n\t\tbutton.hide();\n\t\tparent.find( 'button.wp-smush-pause' ).removeClass( 'disabled sui-hidden' ).removeAttr( 'disabled' );\n\n\t\t//Disable Select Directory button\n\t\t$( 'button.wp-smush-browse' ).attr( 'disabled', 'disabled' );\n\n\t\t// Add progress icon to navbar.\n\t\t$( '.smush-nav-icon.directory' ).addClass( 'sui-icon-loader sui-loading' );\n\n\t\t//Initialize the optimisation\n\t\tsmush_all( true );\n\t} );\n\n\t// Handle the Pause button click.\n\t$( 'div.wp-smush-scan-result' ).on( 'click', 'button.wp-smush-pause', function ( e ) {\n\t\te.preventDefault();\n\n\t\tvar pause_button = $( 'button.wp-smush-pause' );\n\t\t// Return if the link is disabled.\n\t\tif ( pause_button.hasClass( 'disabled' ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Set the button status to 0, to cancel next ajax request.\n\t\t$( 'input[name=\"wp-smush-continue-ajax\"]' ).val( 0 );\n\n\t\t// Enable the smush button, disable Pause button.\n\t\tpause_button.addClass( 'sui-hidden' ).attr( 'disabled', 'disabled' );\n\n\t\t// Enable the smush button, hide the spinner.\n\t\t$( 'button.wp-smush-start, button.wp-smush-browse' ).show().removeAttr( 'disabled' );\n\t\t$( 'span.wp-smush-image-dir-progress, span.wp-smush-image-ele-progress' ).removeClass( 'sui-icon-loader sui-loading' );\n\n\t\t// Hide the waiting message.\n\t\t$( '.wp-smush-image-progress-percent' ).addClass( 'sui-hidden' );\n\n\t\t// Show directory exclude option.\n\t\t$( '.wp-smush-exclude-dir' ).each( function() {\n\t\t\tif ( $( this ).parent().prevAll( '.optimised, .partial' ).length === 0 ) {\n\t\t\t\t$( this ).show();\n\t\t\t}\n\t\t});\n\n\t\t// Remove progress icon from navbar.\n\t\t$( '.smush-nav-icon.directory' ).removeClass( 'sui-icon-loader sui-loading' );\n\t} );\n\n\t//Exclude Directory from list - Handle Click\n\t$( 'div.wp-smush-scan-result' ).on( 'click', '.wp-smush-exclude-dir', function ( e ) {\n\t\te.preventDefault();\n\n\t\tvar self = $( this );\n\n\t\t//Hide the link\n\t\t//self.hide();\n\n\t\tvar path = self.data( 'path' );\n\t\tvar param = {\n\t\t\taction: 'smush_exclude_path',\n\t\t\tpath: path,\n\t\t\tnonce: $( 'input[name=\"exclude-path-nonce\"]' ).val()\n\t\t};\n\n\t\t//Send Ajax request to remove image for the given path from db\n\t\t$.post( ajaxurl, param, function ( res ) {\n\t\t\t//Remove the whole li element on success\n\t\t\tif ( res.success ) {\n\t\t\t\t// Remove content and parent rows.\n\t\t\t\tself.closest( 'tr.sui-accordion-item' ).remove();\n\t\t\t\tself.closest( 'tr.sui-accordion-item' ).next( 'tr.sui-accordion-item-content' ).remove();\n\n\t\t\t\t//Remove the bottom bulk smsuh button if there are no more directories left in scan results\n\t\t\t\tif ( 0 == $( '.wp-smush-image-ele:not(.optimised)' ).length ) {\n\t\t\t\t\t$( 'div.wp-smush-all-button-wrap.bottom' ).hide();\n\t\t\t\t\t$( 'div.wp-smush-scan-result' ).hide();\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t} );\n\n\t//Handle Click for Resume Last scan button\n\t$( 'button.wp-smush-resume' ).on( 'click', function () {\n\n\t\tvar self = $( this );\n\n\t\t//Disable buttons\n\t\tdisable_buttons( self );\n\n\t\t//Show Spinner\n\t\t$( 'span.wp-smush-resume-loder' ).removeClass( 'sui-hidden' );\n\n\t\tvar params = {\n\t\t\taction: 'resume_scan',\n\t\t};\n\n\t\t//Send Ajax request to load a list of images\n\t\t$.get( ajaxurl, params, function ( r ) {\n\n\t\t\t//Hide the buttons\n\t\t\t$( 'button.wp-smush-resume' ).remove();\n\t\t\t// Allow to select a new directory\n\t\t\t$( 'button.wp-smush-browse' ).removeAttr( 'disabled' );\n\t\t\t//Append the results\n\t\t\tif ( !r.success ) {\n\t\t\t\t//Append the error message before the buttons\n\t\t\t\t$( 'div.wp-smush-dir-desc' ).after( r.data.message );\n\t\t\t} else {\n\t\t\t\t//Append the image markup after the buttons\n\t\t\t\t$( 'div.wp-smush-scan-result div.content' ).html( r.data );\n\t\t\t\t$( 'div.wp-smush-scan-result' ).removeClass( 'sui-hidden' );\n\n\t\t\t\tset_accordion();\n\t\t\t}\n\t\t} ).done( function () {\n\t\t\t//Add Choose dir browser button\n\t\t\tadd_dir_browser_button();\n\n\t\t\t//Clone and add Smush button\n\t\t\tadd_smush_button();\n\t\t} );\n\n\t} );\n\n\tif ( $( 'li.smush-dir-savings' ).length > 0 ) {\n\t\t//Update Directory Smush, as soon as the page loads\n\t\tvar stats_param = {\n\t\t\taction: 'get_dir_smush_stats'\n\t\t};\n\t\t$.get( ajaxurl, stats_param, function ( r ) {\n\n\t\t\t//Hide the spinner\n\t\t\t$( 'li.smush-dir-savings .sui-icon-loader' ).hide();\n\n\t\t\t//If there are no errors, and we have a message to display\n\t\t\tif ( !r.success && 'undefined' != typeof ( r.data.message ) ) {\n\t\t\t\t$( 'div.wp-smush-scan-result div.content' ).prepend( r.data.message );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t//If there is no value in r\n\t\t\tif ( 'undefined' == typeof ( r.data) || 'undefined' == typeof ( r.data.dir_smush ) ) {\n\t\t\t\t//Append the text\n\t\t\t\t$( 'li.smush-dir-savings span.wp-smush-stats' ).append( wp_smush_msgs.ajax_error );\n\t\t\t\t$( 'li.smush-dir-savings span.wp-smush-stats span' ).hide();\n\n\t\t\t} else {\n\t\t\t\t//Update the stats\n\t\t\t\tupdate_cummulative_stats( r.data );\n\t\t\t}\n\n\t\t} );\n\t}\n\t//Close Directory smush modal, if pressed esc\n\t$( document ).keyup( function ( e ) {\n\t\tif ( e.keyCode === 27 ) {\n\t\t\tvar modal = $( 'div.dev-overlay.wp-smush-list-dialog, div.dev-overlay.wp-smush-get-pro' );\n\t\t\t//If the Directory dialog is not visible\n\t\t\tif ( !modal.is( ':visible' ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tmodal.find( 'div.close' ).click();\n\n\t\t}\n\t} );\n\n\t//Dismiss Smush recommendation\n\t$( 'span.dismiss-recommendation' ).on( 'click', function ( e ) {\n\t\te.preventDefault();\n\t\tvar parent = $( this ).parent();\n\t\t//remove div and save preference in db\n\t\tparent.hide( 'slow', function () {\n\t\t\tparent.remove();\n\t\t} );\n\t\t$.ajax( {\n\t\t\ttype: 'POST',\n\t\t\turl: ajaxurl,\n\t\t\tdata: {\n\t\t\t\t'action': 'hide_pagespeed_suggestion'\n\t\t\t}\n\t\t} );\n\t} )\n\n\t//Remove API message\n\t$( 'div.wp-smush-api-message i.icon-fi-close' ).on( 'click', function ( e ) {\n\t\te.preventDefault();\n\t\tvar parent = $( this ).parent();\n\t\t//remove div and save preference in db\n\t\tparent.hide( 'slow', function () {\n\t\t\tparent.remove();\n\t\t} );\n\t\t$.ajax( {\n\t\t\ttype: 'POST',\n\t\t\turl: ajaxurl,\n\t\t\tdata: {\n\t\t\t\t'action': 'hide_api_message'\n\t\t\t}\n\t\t} );\n\t} );\n\n} );\n(function ( $ ) {\n\tvar Smush = function ( element, options ) {\n\t\tvar elem = $( element );\n\n\t\tvar defaults = {\n\t\t\tisSingle: false,\n\t\t\tajaxurl: '',\n\t\t\tmsgs: {},\n\t\t\tmsgClass: 'wp-smush-msg',\n\t\t\tids: []\n\t\t};\n\t};\n\t$.fn.wpsmush = function ( options ) {\n\t\treturn this.each( function () {\n\t\t\tvar element = $( this );\n\n\t\t\t// Return early if this element already has a plugin instance\n\t\t\tif ( element.data( 'wpsmush' ) )\n\t\t\t\treturn;\n\n\t\t\t// pass options to plugin constructor and create a new instance\n\t\t\tvar wpsmush = new Smush( this, options );\n\n\t\t\t// Store plugin object in this element's data\n\t\t\telement.data( 'wpsmush', wpsmush );\n\t\t} );\n\t};\n\n})( jQuery );","jQuery( function ( $ ) {\n\n\t// Remove dismissable notices\n\t$( '.sui-wrap' ).on( 'click', '.sui-notice-dismiss', function ( e ) {\n\t\te.preventDefault();\n\n\t\t$( this ).parent().stop().slideUp( 'slow' );\n\t} );\n\n\t$( window ).on( 'load', function () {\n\t\t// If quick setup box is found, show.\n\t\tif ( $( '#smush-quick-setup-dialog' ).length > 0 ) {\n\t\t\t// Show the modal.\n\t\t\twindow.SUI.dialogs['smush-quick-setup-dialog'].show();\n\t\t}\n\t} );\n\n} );","( function( $ ) {\n\t'use strict';\n\n\t/**\n\t * Quick Setup - Form Submit\n\t */\n\t$( '#smush-quick-setup-submit' ).on( 'click', function () {\n\t\tconst self = $( this );\n\n\t\t$.ajax( {\n\t\t\ttype: 'POST',\n\t\t\turl: ajaxurl,\n\t\t\tdata: $( '#smush-quick-setup-form' ).serialize(),\n\t\t\tbeforeSend: function () {\n\t\t\t\t// Disable the button.\n\t\t\t\tself.attr( 'disabled', 'disabled' );\n\n\t\t\t\t// Show loader.\n\t\t\t\t$( '<span class=\"sui-icon-loader sui-loading\"></span>' ).insertAfter( self );\n\t\t\t},\n\t\t\tsuccess: function ( data ) {\n\t\t\t\t// Enable the button.\n\t\t\t\tself.removeAttr( 'disabled' );\n\t\t\t\t// Remove the loader.\n\t\t\t\tself.parent().find( 'span.spinner' ).remove();\n\n\t\t\t\t// Reload the Page.\n\t\t\t\tlocation.reload();\n\t\t\t}\n\t\t} );\n\t} );\n\n\t/**\n\t * Quick Setup - Skip button\n\t */\n\t$( '.smush-skip-setup' ).on( 'click', function () {\n\t\tconst form = $('form#smush-quick-setup-form');\n\n\t\t$.ajax( {\n\t\t\ttype: 'POST',\n\t\t\turl: ajaxurl,\n\t\t\tdata: form.serialize(),\n\t\t\tbeforeSend: function () {\n\t\t\t\tform.find( '.button' ).attr( 'disabled', 'disabled' );\n\t\t\t}\n\t\t} );\n\t} );\n\n}( jQuery ));","/**\n * Created by umeshkumar on 12/05/16.\n */\njQuery(function () {\n\tvar el_notice = jQuery(\".smush-notice\"),\n\t\tbtn_act = el_notice.find(\".smush-notice-act\"),\n\t\tbtn_dismiss = el_notice.find(\".smush-notice-dismiss\");\n\tel_notice.fadeIn(500);\n\n\t// Hide the notice after a CTA button was clicked\n\tfunction remove_notice() {\n\t\tel_notice.fadeTo(100, 0, function () {\n\t\t\tel_notice.slideUp(100, function () {\n\t\t\t\tel_notice.remove();\n\t\t\t});\n\t\t});\n\t}\n\n\tbtn_act.click(function (ev) {\n\t\tremove_notice();\n\t\tnotify_wordpress(btn_act.data(\"msg\"));\n\t});\n\tbtn_dismiss.click(function (ev) {\n\t\tremove_notice();\n\t\tnotify_wordpress(btn_act.data(\"msg\"));\n\t});\n\n\t// Notify WordPress about the users choice and close the message.\n\tfunction notify_wordpress(message) {\n\t\tel_notice.attr(\"data-message\", message);\n\t\tel_notice.addClass(\"loading\");\n\n\t\t//Send a ajax request to save the dismissed notice option\n\t\tvar param = {\n\t\t\taction: 'dismiss_upgrade_notice'\n\t\t};\n\t\tjQuery.post(ajaxurl, param);\n\t}\n\n\t// Store the preference in db.\n\tfunction send_dismiss_request( action ) {\n\t\tvar param = {\n\t\t\taction: action\n\t\t};\n\t\tjQuery.post(ajaxurl, param);\n\t}\n\n\t// Dismiss the update notice.\n\tjQuery('.wp-smush-update-info').on('click', '.notice-dismiss', function (e) {\n\t\te.preventDefault();\n\t\tel_notice = jQuery(this);\n\t\tremove_notice();\n\t\tsend_dismiss_request( 'dismiss_update_info' );\n\t});\n\n\t// Dismiss S3 support alert.\n\tjQuery('div.wp-smush-s3support-alert').on('click', '.icon-fi-close', function (e) {\n\t\tel_notice = jQuery(this);\n\t\tremove_notice();\n\t\tsend_dismiss_request( 'dismiss_s3support_alert' );\n\t});\n\n});","\n/*\n  * jQueryFileTree Plugin\n  *\n  * @author - Cory S.N. LaViska - A Beautiful Site (http://abeautifulsite.net/) - 24 March 2008\n  * @author - Dave Rogers - (https://github.com/daverogers/)\n  *\n  * Usage: $('.fileTreeDemo').fileTree({ options }, callback )\n  *\n  * TERMS OF USE\n  *\n  * This plugin is dual-licensed under the GNU General Public License and the MIT License and\n  * is copyright 2008 A Beautiful Site, LLC.\n */\nvar bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\n\n(function($, window) {\n  var FileTree;\n  FileTree = (function() {\n    function FileTree(el, args, callback) {\n      this.onEvent = bind(this.onEvent, this);\n      var $el, _this, defaults;\n      $el = $(el);\n      _this = this;\n      defaults = {\n        root: '/',\n        script: '/files/filetree',\n        folderEvent: 'click',\n        expandSpeed: 500,\n        collapseSpeed: 500,\n        expandEasing: 'swing',\n        collapseEasing: 'swing',\n        multiFolder: true,\n        loadMessage: 'Loading...',\n        errorMessage: 'Unable to get file tree information',\n        multiSelect: false,\n        onlyFolders: false,\n        onlyFiles: false,\n        preventLinkAction: false\n      };\n      this.jqft = {\n        container: $el\n      };\n      this.options = $.extend(defaults, args);\n      this.callback = callback;\n      this.data = {};\n      $el.html('<ul class=\"jqueryFileTree start\"><li class=\"wait\">' + this.options.loadMessage + '<li></ul>');\n      _this.showTree($el, escape(this.options.root), function() {\n        return _this._trigger('filetreeinitiated', {});\n      });\n      $el.delegate(\"li a\", this.options.folderEvent, _this.onEvent);\n    }\n\n    FileTree.prototype.onEvent = function(event) {\n      var $ev, _this, callback, jqft, options, ref;\n      $ev = $(event.target);\n      options = this.options;\n      jqft = this.jqft;\n      _this = this;\n      callback = this.callback;\n      _this.data = {};\n      _this.data.li = $ev.closest('li');\n      _this.data.type = (ref = _this.data.li.hasClass('directory')) != null ? ref : {\n        'directory': 'file'\n      };\n      _this.data.value = $ev.text();\n      _this.data.rel = $ev.prop('rel');\n      _this.data.container = jqft.container;\n      if (options.preventLinkAction) {\n        event.preventDefault();\n      }\n      if ($ev.parent().hasClass('directory')) {\n        if ($ev.parent().hasClass('collapsed')) {\n          if (!options.multiFolder) {\n            $ev.parent().parent().find('UL').slideUp({\n              duration: options.collapseSpeed,\n              easing: options.collapseEasing\n            });\n            $ev.parent().parent().find('LI.directory').removeClass('expanded').addClass('collapsed');\n          }\n          $ev.parent().removeClass('collapsed').addClass('expanded');\n          $ev.parent().find('UL').remove();\n          return _this.showTree($ev.parent(), $ev.attr('rel'), function() {\n            _this._trigger('filetreeexpanded', _this.data);\n            return callback != null;\n          });\n        } else {\n          return $ev.parent().find('UL').slideUp({\n            duration: options.collapseSpeed,\n            easing: options.collapseEasing,\n            start: function() {\n              return _this._trigger('filetreecollapse', _this.data);\n            },\n            complete: function() {\n              $ev.parent().removeClass('expanded').addClass('collapsed');\n              _this._trigger('filetreecollapsed', _this.data);\n              return callback != null;\n            }\n          });\n        }\n      } else {\n        if (!options.multiSelect) {\n          jqft.container.find('li').removeClass('selected');\n          $ev.parent().addClass('selected');\n        } else {\n          if ($ev.parent().find('input').is(':checked')) {\n            $ev.parent().find('input').prop('checked', false);\n            $ev.parent().removeClass('selected');\n          } else {\n            $ev.parent().find('input').prop('checked', true);\n            $ev.parent().addClass('selected');\n          }\n        }\n        _this._trigger('filetreeclicked', _this.data);\n        return typeof callback === \"function\" ? callback($ev.attr('rel')) : void 0;\n      }\n    };\n\n    FileTree.prototype.showTree = function(el, dir, finishCallback) {\n      var $el, _this, data, handleFail, handleResult, options, result;\n      $el = $(el);\n      options = this.options;\n      _this = this;\n      $el.addClass('wait');\n      $(\".jqueryFileTree.start\").remove();\n      data = {\n        dir: dir,\n        onlyFolders: options.onlyFolders,\n        onlyFiles: options.onlyFiles,\n        multiSelect: options.multiSelect\n      };\n      handleResult = function(result) {\n        var li;\n        $el.find('.start').html('');\n        $el.removeClass('wait').append(result);\n        if (options.root === dir) {\n          $el.find('UL:hidden').show(typeof callback !== \"undefined\" && callback !== null);\n        } else {\n          if (jQuery.easing[options.expandEasing] === void 0) {\n            console.log('Easing library not loaded. Include jQueryUI or 3rd party lib.');\n            options.expandEasing = 'swing';\n          }\n          $el.find('UL:hidden').slideDown({\n            duration: options.expandSpeed,\n            easing: options.expandEasing,\n            start: function() {\n              return _this._trigger('filetreeexpand', _this.data);\n            },\n            complete: finishCallback\n          });\n        }\n        li = $('[rel=\"' + decodeURIComponent(dir) + '\"]').parent();\n        if (options.multiSelect && li.children('input').is(':checked')) {\n          li.find('ul li input').each(function() {\n            $(this).prop('checked', true);\n            return $(this).parent().addClass('selected');\n          });\n        }\n        return false;\n      };\n      handleFail = function() {\n        $el.find('.start').html('');\n        $el.removeClass('wait').append(\"<p>\" + options.errorMessage + \"</p>\");\n        return false;\n      };\n      if (typeof options.script === 'function') {\n        result = options.script(data);\n        if (typeof result === 'string' || result instanceof jQuery) {\n          return handleResult(result);\n        } else {\n          return handleFail();\n        }\n      } else {\n        return $.ajax({\n          url: options.script,\n          type: 'POST',\n          dataType: 'HTML',\n          data: data\n        }).done(function(result) {\n          return handleResult(result);\n        }).fail(function() {\n          return handleFail();\n        });\n      }\n    };\n\n    FileTree.prototype._trigger = function(eventType, data) {\n      var $el;\n      $el = this.jqft.container;\n      return $el.triggerHandler(eventType, data);\n    };\n\n    return FileTree;\n\n  })();\n  return $.fn.extend({\n    fileTree: function(args, callback) {\n      return this.each(function() {\n        var $this, data;\n        $this = $(this);\n        data = $this.data('fileTree');\n        if (!data) {\n          $this.data('fileTree', (data = new FileTree(this, args, callback)));\n        }\n        if (typeof args === 'string') {\n          return data[option].apply(data);\n        }\n      });\n    }\n  });\n})(window.jQuery, window);\n"],"sourceRoot":""}