/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./_src/js/app.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./_src/js/app.js":
/*!************************!*\
  !*** ./_src/js/app.js ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\n__webpack_require__(/*! jqueryfiletree/src/jQueryFileTree.js */ \"./node_modules/jqueryfiletree/src/jQueryFileTree.js\");\n\n/**\n * Admin modules\n */\n__webpack_require__(/*! ./modules/admin */ \"./_src/js/modules/admin.js\"); /**\n                             * jQueryFileTree plugin\n                             */\n\n__webpack_require__(/*! ./modules/bulk-smush */ \"./_src/js/modules/bulk-smush.js\");\n\n/**\n * Notice scripts.\n *\n * Notices are used in the following functions:\n *\n * @used-by WpSmushitAdmin::smush_updated()\n * @used-by WpSmushS3::3_support_required_notice()\n * @used-by WpSmushBulkUi::installation_notice()\n */\n__webpack_require__(/*! ./modules/notice */ \"./_src/js/modules/notice.js\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9fc3JjL2pzL2FwcC5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL19zcmMvanMvYXBwLmpzPzhkMzkiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5yZXF1aXJlKCdqcXVlcnlmaWxldHJlZS9zcmMvalF1ZXJ5RmlsZVRyZWUuanMnKTtcblxuLyoqXG4gKiBBZG1pbiBtb2R1bGVzXG4gKi9cbnJlcXVpcmUoJy4vbW9kdWxlcy9hZG1pbicpOyAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBqUXVlcnlGaWxlVHJlZSBwbHVnaW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxucmVxdWlyZSgnLi9tb2R1bGVzL2J1bGstc211c2gnKTtcblxuLyoqXG4gKiBOb3RpY2Ugc2NyaXB0cy5cbiAqXG4gKiBOb3RpY2VzIGFyZSB1c2VkIGluIHRoZSBmb2xsb3dpbmcgZnVuY3Rpb25zOlxuICpcbiAqIEB1c2VkLWJ5IFdwU211c2hpdEFkbWluOjpzbXVzaF91cGRhdGVkKClcbiAqIEB1c2VkLWJ5IFdwU211c2hTMzo6M19zdXBwb3J0X3JlcXVpcmVkX25vdGljZSgpXG4gKiBAdXNlZC1ieSBXcFNtdXNoQnVsa1VpOjppbnN0YWxsYXRpb25fbm90aWNlKClcbiAqL1xucmVxdWlyZSgnLi9tb2R1bGVzL25vdGljZScpOyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./_src/js/app.js\n");

/***/ }),

/***/ "./_src/js/modules/admin.js":
/*!**********************************!*\
  !*** ./_src/js/modules/admin.js ***!
  \**********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n/**\n * Processes bulk smushing\n *\n * @author Umesh Kumar <umeshsingla05@gmail.com>\n *\n * TODO: Use Element tag for all the class selectors\n */\nvar WP_Smush = WP_Smush || {};\n\n/**\n * Smush translation strings.\n *\n * @var {array} wp_smush_msgs\n */\nif (wp_smush_msgs) {\n\tvar _wp_smush_msgs = _wp_smush_msgs;\n}\n\n/**\n * Show/hide the progress bar for Smushing/Restore/SuperSmush\n *\n * @param cur_ele\n * @param txt Message to be displayed\n * @param {string} state show/hide\n */\nvar progress_bar = function progress_bar(cur_ele, txt, state) {\n\t//Update Progress bar text and show it\n\tvar progress_button = cur_ele.parents().eq(1).find('.wp-smush-progress');\n\n\tif ('show' === state) {\n\t\tprogress_button.find('span').html(txt);\n\t\tprogress_button.removeClass('sui-hidden');\n\t} else {\n\t\t/** @var {string} wp_smush_msgs.all_done */\n\t\tprogress_button.find('span').html(wp_smush_msgs.all_done);\n\t\tprogress_button.hide();\n\t}\n};\n\n/**\n * Check membership validity\n *\n * @param {int} data.show_warning\n */\nvar membership_validity = function membership_validity(data) {\n\tvar member_validity_notice = jQuery('#wp-smush-invalid-member');\n\n\t//Check for Membership warning\n\n\tif ('undefined' !== typeof data && 'undefined' !== typeof data.show_warning && member_validity_notice.length > 0) {\n\t\tif (data.show_warning) {\n\t\t\tmember_validity_notice.show();\n\t\t} else {\n\t\t\tmember_validity_notice.hide();\n\t\t}\n\t}\n};\n\nvar remove_element = function remove_element(el, timeout) {\n\tif (typeof timeout === 'undefined') {\n\t\ttimeout = 100;\n\t}\n\tel.fadeTo(timeout, 0, function () {\n\t\tel.slideUp(timeout, function () {\n\t\t\tel.remove();\n\t\t});\n\t});\n};\n\njQuery(function ($) {\n\t'use strict';\n\n\t/**\n  * Remove the quick setup dialog\n  */\n\n\tfunction remove_dialog() {\n\t\t$('dialog#smush-quick-setup').remove();\n\t}\n\n\t/**\n  * Update image size in attachment info panel.\n  *\n  * @since 2.8\n  *\n  * @param new_size\n  */\n\tfunction update_image_stats(new_size) {\n\t\tif (0 === new_size) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar attachmentSize = $('.attachment-info .file-size');\n\t\tvar currentSize = attachmentSize.contents().filter(function () {\n\t\t\treturn this.nodeType === 3;\n\t\t}).text();\n\n\t\t// There is a space before the size.\n\t\tif (currentSize !== ' ' + new_size) {\n\t\t\tvar sizeStrongEl = attachmentSize.contents().filter(function () {\n\t\t\t\treturn this.nodeType === 1;\n\t\t\t}).text();\n\t\t\tattachmentSize.html('<strong>' + sizeStrongEl + '</strong> ' + new_size);\n\t\t}\n\t}\n\n\t// Show the Quick Setup dialog.\n\tif ($('#smush-quick-setup').size() > 0) {\n\t\t/** @var {string} wp_smush_msgs.quick_setup_title */\n\t\tWDP.showOverlay(\"#smush-quick-setup\", {\n\t\t\ttitle: wp_smush_msgs.quick_setup_title,\n\t\t\tclass: 'no-close wp-smush-overlay wp-smush-quick-setup'\n\t\t});\n\t\tremove_dialog();\n\t}\n\n\tvar smushAddParams = function smushAddParams(url, data) {\n\t\tif (!$.isEmptyObject(data)) {\n\t\t\turl += (url.indexOf('?') >= 0 ? '&' : '?') + $.param(data);\n\t\t}\n\n\t\treturn url;\n\t};\n\n\t// url for smushing\n\tWP_Smush.errors = [];\n\n\t/** @var {array} wp_smushit_data */\n\tWP_Smush.timeout = wp_smushit_data.timeout;\n\n\t/**\n  * Checks for the specified param in URL\n  * @param arg\n  * @returns {*}\n  */\n\tWP_Smush.geturlparam = function (arg) {\n\t\tvar $sPageURL = window.location.search.substring(1);\n\t\tvar $sURLVariables = $sPageURL.split('&');\n\n\t\tfor (var i = 0; i < $sURLVariables.length; i++) {\n\t\t\tvar $sParameterName = $sURLVariables[i].split('=');\n\t\t\tif ($sParameterName[0] == arg) {\n\t\t\t\treturn $sParameterName[1];\n\t\t\t}\n\t\t}\n\t};\n\n\tWP_Smush.Smush = function ($button, bulk, smush_type) {\n\t\tvar self = this;\n\t\tvar skip_resmush = $button.data('smush');\n\t\t//If smush attribute is not defined, Need not skip resmush ids\n\t\tskip_resmush = (typeof skip_resmush === 'undefined' ? 'undefined' : _typeof(skip_resmush)) == ( true ? 'undefined' : undefined) || skip_resmush == false ? false : true;\n\n\t\tthis.init = function () {\n\t\t\tthis.$button = $($button[0]);\n\t\t\tthis.is_bulk = (typeof bulk === 'undefined' ? 'undefined' : _typeof(bulk)) ? bulk : false;\n\t\t\tthis.url = ajaxurl;\n\t\t\tthis.$log = $(\".smush-final-log\");\n\t\t\tthis.deferred = jQuery.Deferred();\n\t\t\tthis.deferred.errors = [];\n\n\t\t\tvar ids = wp_smushit_data.resmush.length > 0 && !skip_resmush ? wp_smushit_data.unsmushed.length > 0 ? wp_smushit_data.resmush.concat(wp_smushit_data.unsmushed) : wp_smushit_data.resmush : wp_smushit_data.unsmushed;\n\t\t\tif ('object' == (typeof ids === 'undefined' ? 'undefined' : _typeof(ids))) {\n\t\t\t\t//If button has resmush class, and we do have ids that needs to resmushed, put them in the list\n\t\t\t\tthis.ids = ids.filter(function (itm, i, a) {\n\t\t\t\t\treturn i == a.indexOf(itm);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.ids = ids;\n\t\t\t}\n\n\t\t\tthis.is_bulk_resmush = wp_smushit_data.resmush.length > 0 && !skip_resmush ? true : false;\n\n\t\t\tthis.$status = this.$button.parent().find('.smush-status');\n\n\t\t\t//Added for NextGen support\n\t\t\tthis.smush_type = 'undefined' != typeof smush_type ? smush_type : 'media';\n\t\t\tthis.single_ajax_suffix = 'nextgen' == this.smush_type ? 'smush_manual_nextgen' : 'wp_smushit_manual';\n\t\t\tthis.bulk_ajax_suffix = 'nextgen' == this.smush_type ? 'wp_smushit_nextgen_bulk' : 'wp_smushit_bulk';\n\t\t\tthis.url = this.is_bulk ? smushAddParams(this.url, { action: this.bulk_ajax_suffix }) : smushAddParams(this.url, { action: this.single_ajax_suffix });\n\t\t};\n\n\t\t/** Send Ajax request for smushing the image **/\n\t\tWP_Smush.ajax = function (is_bulk_resmush, $id, $send_url, $getnxt, nonce) {\n\t\t\t\"use strict\";\n\n\t\t\tvar param = {\n\t\t\t\tis_bulk_resmush: is_bulk_resmush,\n\t\t\t\tattachment_id: $id,\n\t\t\t\tget_next: $getnxt,\n\t\t\t\t_nonce: nonce\n\t\t\t};\n\t\t\tparam = jQuery.param(param);\n\t\t\treturn $.ajax({\n\t\t\t\ttype: \"GET\",\n\t\t\t\tdata: param,\n\t\t\t\turl: $send_url,\n\t\t\t\ttimeout: WP_Smush.timeout,\n\t\t\t\tdataType: 'json'\n\t\t\t});\n\t\t};\n\n\t\t//Show loader in button for single and bulk smush\n\t\tthis.start = function () {\n\n\t\t\tthis.$button.attr('disabled', 'disabled');\n\t\t\tthis.$button.addClass('wp-smush-started');\n\n\t\t\tthis.bulk_start();\n\t\t\tthis.single_start();\n\t\t};\n\n\t\tthis.bulk_start = function () {\n\t\t\tif (!this.is_bulk) return;\n\n\t\t\t//Hide the Bulk Div\n\t\t\t$('.wp-smush-bulk-wrapper').hide();\n\n\t\t\t//Show the Progress Bar\n\t\t\t$('.bulk-smush-wrapper .wp-smush-bulk-progress-bar-wrapper').show();\n\n\t\t\t//Remove any Global Notices if there\n\t\t\t$('.sui-notice-top').remove();\n\n\t\t\t//Hide the Bulk Limit message\n\t\t\t$('p.smush-error-message.limit_exceeded').remove();\n\t\t\t//Hide parent wrapper, if there are no other messages\n\t\t\tif ($('div.smush-final-log p').length <= 0) {\n\t\t\t\t$('div.smush-final-log').hide();\n\t\t\t}\n\t\t};\n\n\t\tthis.single_start = function () {\n\t\t\tif (this.is_bulk) return;\n\t\t\tthis.show_loader();\n\t\t\tthis.$status.removeClass(\"error\");\n\t\t};\n\n\t\tthis.enable_button = function () {\n\t\t\tthis.$button.prop(\"disabled\", false);\n\t\t\t//For Bulk process, Enable other buttons\n\t\t\t$('button.wp-smush-all').removeAttr('disabled');\n\t\t\t$('button.wp-smush-scan, a.wp-smush-lossy-enable, button.wp-smush-resize-enable, input#wp-smush-save-settings').removeAttr('disabled');\n\t\t};\n\n\t\tthis.show_loader = function () {\n\t\t\tprogress_bar(this.$button, wp_smush_msgs.smushing, 'show');\n\t\t};\n\n\t\tthis.hide_loader = function () {\n\t\t\tprogress_bar(this.$button, wp_smush_msgs.smushing, 'hide');\n\t\t};\n\n\t\tthis.single_done = function () {\n\t\t\tif (this.is_bulk) return;\n\n\t\t\tthis.hide_loader();\n\n\t\t\tthis.request.done(function (response) {\n\t\t\t\tif (typeof response.data != 'undefined') {\n\n\t\t\t\t\t// Check if stats div exists.\n\t\t\t\t\tvar parent = self.$status.parent();\n\t\t\t\t\tvar stats_div = parent.find('.smush-stats-wrapper');\n\n\t\t\t\t\t// If we've updated status, replace the content.\n\t\t\t\t\tif (response.data.status) {\n\t\t\t\t\t\t//remove Links\n\t\t\t\t\t\tparent.find('.smush-status-links').remove();\n\t\t\t\t\t\tself.$status.replaceWith(response.data.status);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Check whether to show membership validity notice or not.\n\t\t\t\t\tmembership_validity(response.data);\n\n\t\t\t\t\tif (response.success && response.data !== \"Not processed\") {\n\t\t\t\t\t\tself.$status.removeClass('sui-hidden');\n\t\t\t\t\t\tself.$button.parent().removeClass('unsmushed').addClass('smushed');\n\t\t\t\t\t\tself.$button.remove();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.$status.addClass(\"error\");\n\t\t\t\t\t\tself.$status.html(response.data.error_msg);\n\t\t\t\t\t\tself.$status.show();\n\t\t\t\t\t}\n\t\t\t\t\tif ('undefined' != stats_div && stats_div.length) {\n\t\t\t\t\t\tstats_div.replaceWith(response.data.stats);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tparent.append(response.data.stats);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Update image size in attachment info panel.\n\t\t\t\t\tupdate_image_stats(response.data.new_size);\n\t\t\t\t}\n\t\t\t\tself.enable_button();\n\t\t\t}).error(function (response) {\n\t\t\t\tself.$status.html(response.data);\n\t\t\t\tself.$status.addClass(\"error\");\n\t\t\t\tself.enable_button();\n\t\t\t});\n\t\t};\n\n\t\tthis.sync_stats = function () {\n\t\t\tvar message_holder = $('div.wp-smush-bulk-progress-bar-wrapper div.wp-smush-count.tc');\n\t\t\t//Store the existing content in a variable\n\t\t\tvar progress_message = message_holder.html();\n\t\t\tmessage_holder.html(wp_smush_msgs.sync_stats);\n\n\t\t\t//Send ajax\n\t\t\t$.ajax({\n\t\t\t\ttype: \"GET\",\n\t\t\t\turl: ajaxurl,\n\t\t\t\tdata: {\n\t\t\t\t\t'action': 'get_stats'\n\t\t\t\t},\n\t\t\t\tsuccess: function success(response) {\n\t\t\t\t\tif (response && 'undefined' != typeof response) {\n\t\t\t\t\t\tresponse = response.data;\n\t\t\t\t\t\t$.extend(wp_smushit_data, {\n\t\t\t\t\t\t\tcount_images: response.count_images,\n\t\t\t\t\t\t\tcount_smushed: response.count_smushed,\n\t\t\t\t\t\t\tcount_total: response.count_total,\n\t\t\t\t\t\t\tcount_resize: response.count_resize,\n\t\t\t\t\t\t\tcount_supersmushed: response.count_supersmushed,\n\t\t\t\t\t\t\tsavings_bytes: response.savings_bytes,\n\t\t\t\t\t\t\tsavings_conversion: response.savings_conversion,\n\t\t\t\t\t\t\tsavings_resize: response.savings_resize,\n\t\t\t\t\t\t\tsize_before: response.size_before,\n\t\t\t\t\t\t\tsize_after: response.size_after\n\t\t\t\t\t\t});\n\t\t\t\t\t\t//Got the stats, Update it\n\t\t\t\t\t\tupdate_stats(this.smush_type);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}).always(function () {\n\t\t\t\tmessage_holder.html(progress_message);\n\t\t\t});\n\t\t};\n\n\t\t/** After the Bulk Smushing has been Finished **/\n\t\tthis.bulk_done = function () {\n\t\t\tif (!this.is_bulk) return;\n\n\t\t\t//Enable the button\n\t\t\tthis.enable_button();\n\n\t\t\t//Show Notice\n\t\t\tif (self.ids.length == 0) {\n\t\t\t\t$('.bulk-smush-wrapper .wp-smush-all-done, .wp-smush-pagespeed-recommendation').show();\n\t\t\t\t$('.wp-smush-bulk-wrapper').hide();\n\t\t\t} else {\n\t\t\t\tif ($('.bulk-smush-wrapper .wp-smush-resmush-notice').length > 0) {\n\t\t\t\t\t$('.bulk-smush-wrapper .wp-smush-resmush-notice').show();\n\t\t\t\t} else {\n\t\t\t\t\t$('.bulk-smush-wrapper .wp-smush-remaining').show();\n\t\t\t\t}\n\t\t\t\t$('.wp-smush-bulk-wrapper').show();\n\t\t\t}\n\n\t\t\t//Hide the Progress Bar\n\t\t\t$('.wp-smush-bulk-progress-bar-wrapper').hide();\n\n\t\t\t//Enable Resmush and scan button\n\t\t\t$('.wp-resmush.wp-smush-action, .wp-smush-scan').removeAttr('disabled');\n\n\t\t\t// Show loader.\n\t\t\tif (self.ids.length == 0) {\n\t\t\t\t$('.sui-summary-smush .smush-stats-icon').addClass('sui-hidden');\n\t\t\t} else {\n\t\t\t\t$('.sui-summary-smush .smush-stats-icon').removeClass('sui-icon-loader sui-loading sui-hidden').addClass('sui-icon-info sui-warning');\n\t\t\t}\n\t\t};\n\n\t\tthis.is_resolved = function () {\n\t\t\t\"use strict\";\n\n\t\t\treturn this.deferred.state() === \"resolved\";\n\t\t};\n\n\t\tthis.free_exceeded = function () {\n\t\t\t//Hide the Progress bar and show the Bulk smush wrapper\n\t\t\t$('.wp-smush-bulk-progress-bar-wrapper').hide();\n\n\t\t\tif (self.ids.length > 0) {\n\t\t\t\t//Show Bulk wrapper\n\t\t\t\t$('.wp-smush-bulk-wrapper ').show();\n\t\t\t} else {\n\t\t\t\t$('.wp-smush-notice.wp-smush-all-done, .wp-smush-pagespeed-recommendation').show();\n\t\t\t}\n\t\t};\n\n\t\tthis.update_remaining_count = function () {\n\t\t\tif (this.is_bulk_resmush) {\n\t\t\t\t//ReSmush Notice\n\t\t\t\tif ($('.wp-smush-resmush-notice .wp-smush-remaining-count').length && 'undefined' != typeof self.ids) {\n\t\t\t\t\t$('.wp-smush-resmush-notice .wp-smush-remaining-count').html(self.ids.length);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t//Smush Notice\n\t\t\t\tif ($('.bulk-smush-wrapper .wp-smush-remaining-count').length && 'undefined' != typeof self.ids) {\n\t\t\t\t\t$('.bulk-smush-wrapper .wp-smush-remaining-count').html(self.ids.length);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Update sidebar count.\n\t\t\tif ($('.smush-sidenav .wp-smush-remaining-count').length && 'undefined' != typeof self.ids) {\n\t\t\t\tif (self.ids.length > 0) {\n\t\t\t\t\t$('.smush-sidenav .wp-smush-remaining-count').html(self.ids.length);\n\t\t\t\t} else {\n\t\t\t\t\t$('.sui-summary-smush .smush-stats-icon').addClass('sui-hidden');\n\t\t\t\t\t$('.smush-sidenav .wp-smush-remaining-count').removeClass('sui-tag sui-tag-warning').html('');\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis.update_progress = function (_res) {\n\t\t\t//If not bulk\n\t\t\tif (!this.is_bulk_resmush && !this.is_bulk) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar progress = '';\n\n\t\t\t//Update localized stats\n\t\t\tif (_res && ('undefined' != typeof _res.data || 'undefined' != typeof _res.data.stats)) {\n\t\t\t\tupdate_localized_stats(_res.data.stats, this.smush_type);\n\t\t\t}\n\n\t\t\tif (!this.is_bulk_resmush) {\n\t\t\t\t//handle progress for normal bulk smush\n\t\t\t\tprogress = wp_smushit_data.count_smushed / wp_smushit_data.count_total * 100;\n\t\t\t} else {\n\t\t\t\t//If the Request was successful, Update the progress bar\n\t\t\t\tif (_res.success) {\n\t\t\t\t\t//Handle progress for Super smush progress bar\n\t\t\t\t\tif (wp_smushit_data.resmush.length > 0) {\n\t\t\t\t\t\t//Update the Count\n\t\t\t\t\t\t$('.wp-smush-images-remaining').html(wp_smushit_data.resmush.length);\n\t\t\t\t\t} else if (wp_smushit_data.resmush.length == 0 && this.ids.length == 0) {\n\t\t\t\t\t\t//If all images are resmushed, show the All Smushed message\n\n\t\t\t\t\t\t//Show All Smushed\n\t\t\t\t\t\t$('.bulk-resmush-wrapper .wp-smush-all-done, .wp-smush-pagespeed-recommendation').removeClass('sui-hidden');\n\n\t\t\t\t\t\t//Hide Everything else\n\t\t\t\t\t\t$('.wp-smush-resmush-wrap, .wp-smush-bulk-progress-bar-wrapper').hide();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//handle progress for normal bulk smush\n\t\t\t\t//Set Progress Bar width\n\t\t\t\tif ('undefined' !== typeof self.ids && 'undefined' !== typeof wp_smushit_data.count_total && wp_smushit_data.count_total > 0) {\n\t\t\t\t\tprogress = wp_smushit_data.count_smushed / wp_smushit_data.count_total * 100;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//Show Bulk Wrapper and Smush Notice\n\t\t\tif (self.ids.length == 0) {\n\t\t\t\t//Sync stats for Bulk smush media Library ( Skip for Nextgen )\n\t\t\t\tif ('nextgen' != this.smush_type) {\n\t\t\t\t\tthis.sync_stats();\n\t\t\t\t}\n\t\t\t\t$('.bulk-smush-wrapper .wp-smush-all-done, .wp-smush-pagespeed-recommendation').show();\n\t\t\t\t$('.wp-smush-bulk-wrapper').hide();\n\t\t\t}\n\n\t\t\t//Update remaining count\n\t\t\tself.update_remaining_count();\n\n\t\t\t//if we have received the progress data, update the stats else skip\n\t\t\tif ('undefined' != typeof _res.data.stats) {\n\n\t\t\t\t// increase the progress bar\n\t\t\t\tthis._update_progress(wp_smushit_data.count_smushed, progress);\n\t\t\t}\n\t\t\t// Update stats and counts.\n\t\t\tupdate_stats(this.smush_type);\n\t\t};\n\n\t\tthis._update_progress = function (count, width) {\n\t\t\t\"use strict\";\n\n\t\t\tif (!this.is_bulk && !this.is_bulk_resmush) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t//Update the Progress Bar Width\n\t\t\t// get the progress bar\n\t\t\tvar $progress_bar = jQuery('.bulk-smush-wrapper .wp-smush-progress-inner');\n\t\t\tif ($progress_bar.length < 1) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// increase progress\n\t\t\t$progress_bar.css('width', width + '%');\n\t\t};\n\n\t\t//Whether to send the ajax requests further or not\n\t\tthis.continue = function () {\n\t\t\tvar continue_smush = self.$button.attr('continue_smush');\n\n\t\t\tif ((typeof continue_smush === 'undefined' ? 'undefined' : _typeof(continue_smush)) == ( true ? 'undefined' : undefined)) {\n\t\t\t\tcontinue_smush = true;\n\t\t\t}\n\n\t\t\tif ('false' == continue_smush || !continue_smush) {\n\t\t\t\tcontinue_smush = false;\n\t\t\t}\n\n\t\t\treturn continue_smush && this.ids.length > 0 && this.is_bulk;\n\t\t};\n\n\t\tthis.increment_errors = function (id) {\n\t\t\tWP_Smush.errors.push(id);\n\t\t};\n\n\t\t//Send ajax request for smushing single and bulk, call update_progress on ajax response\n\t\tthis.call_ajax = function () {\n\t\t\tvar nonce_value = '';\n\t\t\tthis.current_id = this.is_bulk ? this.ids.shift() : this.$button.data(\"id\"); //remove from array while processing so we can continue where left off\n\n\t\t\t//Remove the id from respective variable as well\n\t\t\tthis.update_smush_ids(this.current_id);\n\n\t\t\tvar nonce_field = this.$button.parent().find('#_wp_smush_nonce');\n\t\t\tif (nonce_field) {\n\t\t\t\tnonce_value = nonce_field.val();\n\t\t\t}\n\n\t\t\tthis.request = WP_Smush.ajax(this.is_bulk_resmush, this.current_id, this.url, 0, nonce_value).error(function () {\n\t\t\t\tself.increment_errors(self.current_id);\n\t\t\t}).done(function (res) {\n\t\t\t\t//Increase the error count except if bulk request limit excceded\n\t\t\t\tif (typeof res.success === \"undefined\" || typeof res.success !== \"undefined\" && typeof res.success.data !== \"undefined\" && res.success === false && res.data.error !== 'bulk_request_image_limit_exceeded') {\n\t\t\t\t\tself.increment_errors(self.current_id);\n\t\t\t\t}\n\t\t\t\t//If no response or success is false, do not process further\n\t\t\t\tif (!res || !res.success) {\n\t\t\t\t\t//@todo: Handle Bulk Smush limit error message\n\t\t\t\t\tif ('undefined' !== typeof res && 'undefined' !== typeof res.data && typeof res.data.error !== 'undefined') {\n\t\t\t\t\t\tvar error_class = 'undefined' != typeof res.data.error_class ? 'smush-error-message ' + res.data.error_class : 'smush-error-message';\n\t\t\t\t\t\tvar error_msg = '<p class=\"' + error_class + '\">' + res.data.error_message + '</p>';\n\t\t\t\t\t\tif ('undefined' != typeof res.data.error && 'bulk_request_image_limit_exceeded' == res.data.error) {\n\t\t\t\t\t\t\tvar ajax_error_message = $('.wp-smush-ajax-error');\n\t\t\t\t\t\t\t//If we have ajax error message div, append after it\n\t\t\t\t\t\t\tif (ajax_error_message.length > 0) {\n\t\t\t\t\t\t\t\tajax_error_message.after(error_msg);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t//Otherwise prepend\n\t\t\t\t\t\t\t\tself.$log.prepend(error_msg);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if ('undefined' != typeof res.data.error_class && \"\" != res.data.error_class && $('div.smush-final-log .' + res.data.error_class).length > 0) {\n\t\t\t\t\t\t\tvar error_count = $('p.smush-error-message.' + res.data.error_class + ' .image-error-count');\n\t\t\t\t\t\t\t//Get the error count, increase and append\n\t\t\t\t\t\t\tvar image_count = error_count.html();\n\t\t\t\t\t\t\timage_count = parseInt(image_count) + 1;\n\t\t\t\t\t\t\t//Append the updated image count\n\t\t\t\t\t\t\terror_count.html(image_count);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t//Print the error on screen\n\t\t\t\t\t\t\tself.$log.append(error_msg);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself.$log.show();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//Check whether to show the warning notice or not\n\t\t\t\tmembership_validity(res.data);\n\n\t\t\t\t//Bulk Smush Limit Exceeded: Stop ajax requests, remove progress bar, append the last image id back to smush variable, and reset variables to allow the user to continue bulk smush\n\t\t\t\tif (typeof res.data !== \"undefined\" && res.data.error == 'bulk_request_image_limit_exceeded' && !self.is_resolved()) {\n\t\t\t\t\t//Add a data attribute to the smush button, to stop sending ajax\n\t\t\t\t\tself.$button.attr('continue_smush', false);\n\n\t\t\t\t\tself.free_exceeded();\n\n\t\t\t\t\t//Reinsert the current id\n\t\t\t\t\twp_smushit_data.unsmushed.unshift(self.current_id);\n\n\t\t\t\t\t//Update the remaining count to length of remaining ids + 1 (Current id)\n\t\t\t\t\tself.update_remaining_count();\n\t\t\t\t} else {\n\n\t\t\t\t\tif (self.is_bulk && res.success) {\n\t\t\t\t\t\tself.update_progress(res);\n\t\t\t\t\t} else if (self.ids.length == 0) {\n\t\t\t\t\t\t//Sync stats anyway\n\t\t\t\t\t\tself.sync_stats();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tself.single_done();\n\t\t\t}).complete(function () {\n\t\t\t\tif (!self.continue() || !self.is_bulk) {\n\t\t\t\t\t//Calls deferred.done()\n\t\t\t\t\tself.deferred.resolve();\n\t\t\t\t} else {\n\t\t\t\t\tself.call_ajax();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tself.deferred.errors = WP_Smush.errors;\n\t\t\treturn self.deferred;\n\t\t};\n\n\t\tthis.init(arguments);\n\n\t\t//Send ajax request for single and bulk smushing\n\t\tthis.run = function () {\n\n\t\t\t// if we have a definite number of ids\n\t\t\tif (this.is_bulk && this.ids.length > 0) {\n\t\t\t\tthis.call_ajax();\n\t\t\t}\n\n\t\t\tif (!this.is_bulk) this.call_ajax();\n\t\t};\n\n\t\t//Show bulk smush errors, and disable bulk smush button on completion\n\t\tthis.bind_deferred_events = function () {\n\n\t\t\tthis.deferred.done(function () {\n\n\t\t\t\tself.$button.removeAttr('continue_smush');\n\n\t\t\t\tif (WP_Smush.errors.length) {\n\t\t\t\t\tvar error_message = '<div class=\"wp-smush-ajax-error\">' + wp_smush_msgs.error_in_bulk.replace(\"{{errors}}\", WP_Smush.errors.length) + '</div>';\n\t\t\t\t\t//Remove any existing notice\n\t\t\t\t\t$('.wp-smush-ajax-error').remove();\n\t\t\t\t\tself.$log.prepend(error_message);\n\t\t\t\t}\n\n\t\t\t\tself.bulk_done();\n\n\t\t\t\t//Re enable the buttons\n\t\t\t\t$('.wp-smush-button:not(.wp-smush-finished), .wp-smush-scan').removeAttr('disabled');\n\t\t\t});\n\t\t};\n\t\t/** Handles the Cancel button Click\n   *\n   * Update the UI, and enables the bulk smush button\n   *\n   **/\n\t\tthis.cancel_ajax = function () {\n\t\t\t$('.wp-smush-cancel-bulk').on('click', function () {\n\t\t\t\t//Add a data attribute to the smush button, to stop sending ajax\n\t\t\t\tself.$button.attr('continue_smush', false);\n\t\t\t\t//Sync and update stats\n\t\t\t\tself.sync_stats();\n\t\t\t\tupdate_stats(this.smush_type);\n\n\t\t\t\tself.request.abort();\n\t\t\t\tself.enable_button();\n\t\t\t\tself.$button.removeClass('wp-smush-started');\n\t\t\t\twp_smushit_data.unsmushed.unshift(self.current_id);\n\t\t\t\t$('.wp-smush-bulk-wrapper').show();\n\n\t\t\t\t//Hide the Progress Bar\n\t\t\t\t$('.wp-smush-bulk-progress-bar-wrapper').hide();\n\t\t\t});\n\t\t};\n\t\t/**\n   * Remove the current id from unsmushed/resmush variable\n   * @param current_id\n   */\n\t\tthis.update_smush_ids = function (current_id) {\n\t\t\tif ('undefined' !== typeof wp_smushit_data.unsmushed && wp_smushit_data.unsmushed.length > 0) {\n\t\t\t\tvar u_index = wp_smushit_data.unsmushed.indexOf(current_id);\n\t\t\t\tif (u_index > -1) {\n\t\t\t\t\twp_smushit_data.unsmushed.splice(u_index, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t\t//remove from the resmush list\n\t\t\tif ('undefined' !== typeof wp_smushit_data.resmush && wp_smushit_data.resmush.length > 0) {\n\t\t\t\tvar index = wp_smushit_data.resmush.indexOf(current_id);\n\t\t\t\tif (index > -1) {\n\t\t\t\t\twp_smushit_data.resmush.splice(index, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis.start();\n\t\tthis.run();\n\t\tthis.bind_deferred_events();\n\n\t\t//Handle Cancel Ajax\n\t\tthis.cancel_ajax();\n\n\t\treturn this.deferred;\n\t};\n\n\t/**\n  * Handle the Bulk Smush/ Bulk Resmush button click\n  */\n\t$('body').on('click', 'button.wp-smush-all', function (e) {\n\n\t\t// prevent the default action\n\t\te.preventDefault();\n\n\t\t$('.sui-notice-top.sui-notice-success').remove();\n\n\t\t//Disable Resmush and scan button\n\t\t$('.wp-resmush.wp-smush-action, .wp-smush-scan, .wp-smush-button, a.wp-smush-lossy-enable, button.wp-smush-resize-enable, input#wp-smush-save-settings').attr('disabled', 'disabled');\n\n\t\t//Check for ids, if there is none (Unsmushed or lossless), don't call smush function\n\t\tif (typeof wp_smushit_data == 'undefined' || wp_smushit_data.unsmushed.length == 0 && wp_smushit_data.resmush.length == 0) {\n\n\t\t\treturn false;\n\t\t}\n\n\t\t$(\".wp-smush-remaining\").hide();\n\n\t\t// Show loader.\n\t\t$('.sui-summary-smush .smush-stats-icon').removeClass('sui-icon-info sui-warning').addClass('sui-icon-loader sui-loading');\n\n\t\tnew WP_Smush.Smush($(this), true);\n\t});\n\n\t/** Disable the action links **/\n\tvar disable_links = function disable_links(c_element) {\n\n\t\tvar parent = c_element.parent();\n\t\t//reduce parent opacity\n\t\tparent.css({ 'opacity': '0.5' });\n\t\t//Disable Links\n\t\tparent.find('a').attr('disabled', 'disabled');\n\t};\n\n\t/** Enable the Action Links **/\n\tvar enable_links = function enable_links(c_element) {\n\n\t\tvar parent = c_element.parent();\n\n\t\t//reduce parent opacity\n\t\tparent.css({ 'opacity': '1' });\n\t\t//Disable Links\n\t\tparent.find('a').removeAttr('disabled');\n\t};\n\t/**\n  * Restore image request with a specified action for Media Library / NextGen Gallery\n  * @param e\n  * @param current_button\n  * @param smush_action\n  * @returns {boolean}\n  */\n\tvar process_smush_action = function process_smush_action(e, current_button, smush_action, action) {\n\n\t\t//If disabled\n\t\tif ('disabled' == current_button.attr('disabled')) {\n\t\t\treturn false;\n\t\t}\n\n\t\te.preventDefault();\n\n\t\t//Remove Error\n\t\t$('.wp-smush-error').remove();\n\n\t\t//Hide stats\n\t\t$('.smush-stats-wrapper').hide();\n\n\t\tvar mode = 'grid';\n\t\tif ('smush_restore_image' == smush_action) {\n\t\t\tif ($(document).find('div.media-modal.wp-core-ui').length > 0) {\n\t\t\t\tmode = 'grid';\n\t\t\t} else {\n\t\t\t\tmode = window.location.search.indexOf('item') > -1 ? 'grid' : 'list';\n\t\t\t}\n\t\t}\n\n\t\t//Get the image ID and nonce\n\t\tvar params = {\n\t\t\taction: smush_action,\n\t\t\tattachment_id: current_button.data('id'),\n\t\t\tmode: mode,\n\t\t\t_nonce: current_button.data('nonce')\n\t\t};\n\n\t\t//Reduce the opacity of stats and disable the click\n\t\tdisable_links(current_button);\n\n\t\tprogress_bar(current_button, wp_smush_msgs[action], 'show');\n\n\t\t//Restore the image\n\t\t$.post(ajaxurl, params, function (r) {\n\n\t\t\tprogress_bar(current_button, wp_smush_msgs[action], 'hide');\n\n\t\t\t//reset all functionality\n\t\t\tenable_links(current_button);\n\n\t\t\tif (r.success && 'undefined' != typeof r.data.button) {\n\t\t\t\t//Replace in immediate parent for nextgen\n\t\t\t\tif ('undefined' != typeof this.data && this.data.indexOf('nextgen') > -1) {\n\t\t\t\t\t//Show the smush button, and remove stats and restore option\n\t\t\t\t\tcurrent_button.parent().html(r.data.button);\n\t\t\t\t} else {\n\t\t\t\t\t//Show the smush button, and remove stats and restore option\n\t\t\t\t\tcurrent_button.parents().eq(1).html(r.data.button);\n\t\t\t\t}\n\n\t\t\t\tif ('undefined' != typeof r.data && 'restore' === action) {\n\t\t\t\t\tupdate_image_stats(r.data.new_size);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (r.data.message) {\n\t\t\t\t\t//show error\n\t\t\t\t\tcurrent_button.parent().append(r.data.message);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\n\t/**\n  * Validates the Resize Width and Height against the Largest Thumbnail Width and Height\n  *\n  * @param wrapper_div jQuery object for the whole setting row wrapper div\n  * @param width_only Whether to validate only width\n  * @param height_only Validate only Height\n  * @returns {boolean} All Good or not\n  *\n  */\n\tvar validate_resize_settings = function validate_resize_settings(wrapper_div, width_only, height_only) {\n\t\tvar resize_checkbox = wrapper_div.find('#wp-smush-resize, #wp-smush-resize-quick-setup');\n\n\t\tif (!height_only) {\n\t\t\tvar width_input = wrapper_div.find('#wp-smush-resize_width');\n\t\t\tvar width_error_note = wrapper_div.find('.sui-notice-info.wp-smush-update-width');\n\t\t}\n\t\tif (!width_only) {\n\t\t\tvar height_input = wrapper_div.find('#wp-smush-resize_height');\n\t\t\tvar height_error_note = wrapper_div.find('.sui-notice-info.wp-smush-update-height');\n\t\t}\n\n\t\tvar width_error = false;\n\t\tvar height_error = false;\n\n\t\t//If resize settings is not enabled, return true\n\t\tif (!resize_checkbox.is(':checked')) {\n\t\t\treturn true;\n\t\t}\n\n\t\t//Check if we have localised width and height\n\t\tif ('undefined' == typeof wp_smushit_data.resize_sizes || 'undefined' == typeof wp_smushit_data.resize_sizes.width) {\n\t\t\t//Rely on server validation\n\t\t\treturn true;\n\t\t}\n\n\t\t//Check for width\n\t\tif (!height_only && 'undefined' != typeof width_input && parseInt(wp_smushit_data.resize_sizes.width) > parseInt(width_input.val())) {\n\t\t\twidth_input.parent().addClass('sui-form-field-error');\n\t\t\twidth_error_note.show('slow');\n\t\t\twidth_error = true;\n\t\t} else {\n\t\t\t//Remove error class\n\t\t\twidth_input.parent().removeClass('sui-form-field-error');\n\t\t\twidth_error_note.hide();\n\t\t\tif (height_input.hasClass('error')) {\n\t\t\t\theight_error_note.show('slow');\n\t\t\t}\n\t\t}\n\n\t\t//Check for height\n\t\tif (!width_only && 'undefined' != typeof height_input && parseInt(wp_smushit_data.resize_sizes.height) > parseInt(height_input.val())) {\n\t\t\theight_input.parent().addClass('sui-form-field-error');\n\t\t\t//If we are not showing the width error already\n\t\t\tif (!width_error) {\n\t\t\t\theight_error_note.show('slow');\n\t\t\t}\n\t\t\theight_error = true;\n\t\t} else {\n\t\t\t//Remove error class\n\t\t\theight_input.parent().removeClass('sui-form-field-error');\n\t\t\theight_error_note.hide();\n\t\t\tif (width_input.hasClass('error')) {\n\t\t\t\twidth_error_note.show('slow');\n\t\t\t}\n\t\t}\n\n\t\tif (width_error || height_error) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t};\n\n\t/**\n  * Convert bytes to human readable form\n  * @param a, Bytes\n  * @param b, Number of digits\n  * @returns {*} Formatted Bytes\n  */\n\tvar formatBytes = function formatBytes(a, b) {\n\t\tvar thresh = 1024;\n\t\tif (Math.abs(a) < thresh) {\n\t\t\treturn a + ' B';\n\t\t}\n\t\tvar units = ['KB', 'MB', 'GB', 'TB', 'PB'];\n\t\tvar u = -1;\n\t\tdo {\n\t\t\ta /= thresh;\n\t\t\t++u;\n\t\t} while (Math.abs(a) >= thresh && u < units.length - 1);\n\t\treturn a.toFixed(b) + ' ' + units[u];\n\t};\n\n\t/**\n  * Convert bytes to human readable form\n  * @param a, Bytes\n  * @param b, Number of digits\n  * @returns {*} Formatted Bytes\n  */\n\tvar getSizeFromString = function getSizeFromString(formatted_size) {\n\t\treturn formatted_size.replace(/[a-zA-Z]/g, '').trim();\n\t};\n\n\t/**\n  * Convert bytes to human readable form\n  * @param a, Bytes\n  * @param b, Number of digits\n  * @returns {*} Formatted Bytes\n  */\n\tvar getFormatFromString = function getFormatFromString(formatted_size) {\n\t\treturn formatted_size.replace(/[0-9.]/g, '').trim();\n\t};\n\n\t//Stackoverflow: http://stackoverflow.com/questions/1726630/formatting-a-number-with-exactly-two-decimals-in-javascript\n\tvar precise_round = function precise_round(num, decimals) {\n\t\tvar sign = num >= 0 ? 1 : -1;\n\t\t//Keep the percentage below 100\n\t\tnum = num > 100 ? 100 : num;\n\t\treturn Math.round(num * Math.pow(10, decimals) + sign * 0.001) / Math.pow(10, decimals);\n\t};\n\n\t/**\n  * Update the progress bar width if we have images that needs to be resmushed\n  * @param unsmushed_count\n  * @returns {boolean}\n  */\n\tvar update_progress_bar_resmush = function update_progress_bar_resmush(unsmushed_count) {\n\n\t\tif ('undefined' == typeof unsmushed_count) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar smushed_count = wp_smushit_data.count_total - unsmushed_count;\n\n\t\t//Update the Progress Bar Width\n\t\t// get the progress bar\n\t\tvar $progress_bar = jQuery('.bulk-smush-wrapper .wp-smush-progress-inner');\n\t\tif ($progress_bar.length < 1) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar width = smushed_count / wp_smushit_data.count_total * 100;\n\n\t\t// increase progress\n\t\t$progress_bar.css('width', width + '%');\n\t};\n\n\tvar run_re_check = function run_re_check(button, process_settings) {\n\n\t\t// Empty the button text and add loader class.\n\t\tbutton.text('').addClass('sui-button-onload sui-icon-loader sui-loading').blur();\n\n\t\t//Check if type is set in data attributes\n\t\tvar scan_type = button.data('type');\n\t\tscan_type = 'undefined' == typeof scan_type ? 'media' : scan_type;\n\n\t\t//Remove the Skip resmush attribute from button\n\t\t$('button.wp-smush-all').removeAttr('data-smush');\n\n\t\t//remove notices\n\t\tvar el = $('.sui-notice-top.sui-notice-success');\n\t\tel.slideUp(100, function () {\n\t\t\tel.remove();\n\t\t});\n\n\t\t//Disable Bulk smush button and itself\n\t\t$('.wp-smush-button').attr('disabled', 'disabled');\n\n\t\t//Hide Settings changed Notice\n\t\t$('.wp-smush-settings-changed').hide();\n\n\t\t//Ajax Params\n\t\tvar params = {\n\t\t\taction: 'scan_for_resmush',\n\t\t\ttype: scan_type,\n\t\t\tget_ui: true,\n\t\t\tprocess_settings: process_settings,\n\t\t\twp_smush_options_nonce: jQuery('#wp_smush_options_nonce').val()\n\t\t};\n\n\t\t//Send ajax request and get ids if any\n\t\t$.get(ajaxurl, params, function (r) {\n\t\t\t//Check if we have the ids,  initialize the local variable\n\t\t\tif ('undefined' != typeof r.data) {\n\t\t\t\t//Update Resmush id list\n\t\t\t\tif ('undefined' != typeof r.data.resmush_ids) {\n\t\t\t\t\twp_smushit_data.resmush = r.data.resmush_ids;\n\n\t\t\t\t\t//Update wp_smushit_data ( Smushed count, Smushed Percent, Image count, Super smush count, resize savings, conversion savings )\n\t\t\t\t\tif ('undefinied' != typeof wp_smushit_data) {\n\t\t\t\t\t\twp_smushit_data.count_smushed = 'undefined' != typeof r.data.count_smushed ? r.data.count_smushed : wp_smushit_data.count_smushed;\n\t\t\t\t\t\twp_smushit_data.count_supersmushed = 'undefined' != typeof r.data.count_supersmushed ? r.data.count_supersmushed : wp_smushit_data.count_supersmushed;\n\t\t\t\t\t\twp_smushit_data.count_images = 'undefined' != typeof r.data.count_image ? r.data.count_image : wp_smushit_data.count_images;\n\t\t\t\t\t\twp_smushit_data.size_before = 'undefined' != typeof r.data.size_before ? r.data.size_before : wp_smushit_data.size_before;\n\t\t\t\t\t\twp_smushit_data.size_after = 'undefined' != typeof r.data.size_after ? r.data.size_after : wp_smushit_data.size_after;\n\t\t\t\t\t\twp_smushit_data.savings_resize = 'undefined' != typeof r.data.savings_resize ? r.data.savings_resize : wp_smushit_data.savings_resize;\n\t\t\t\t\t\twp_smushit_data.savings_conversion = 'undefined' != typeof r.data.savings_conversion ? r.data.savings_conversion : wp_smushit_data.savings_conversion;\n\t\t\t\t\t\twp_smushit_data.count_resize = 'undefined' != typeof r.data.count_resize ? r.data.count_resize : wp_smushit_data.count_resize;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ('nextgen' == scan_type) {\n\t\t\t\t\t\twp_smushit_data.bytes = parseInt(wp_smushit_data.size_before) - parseInt(wp_smushit_data.size_after);\n\t\t\t\t\t}\n\n\t\t\t\t\tvar smush_percent = wp_smushit_data.count_smushed / wp_smushit_data.count_total * 100;\n\t\t\t\t\tsmush_percent = precise_round(smush_percent, 1);\n\n\t\t\t\t\t//Update it in stats bar\n\t\t\t\t\t$('.wp-smush-images-percent').html(smush_percent);\n\n\t\t\t\t\t//Hide the Existing wrapper\n\t\t\t\t\tvar notices = $('.bulk-smush-wrapper .sui-notice');\n\t\t\t\t\tif (notices.length > 0) {\n\t\t\t\t\t\tnotices.hide();\n\t\t\t\t\t\t$('.wp-smush-pagespeed-recommendation').hide();\n\t\t\t\t\t}\n\t\t\t\t\t//remove existing Re-Smush notices\n\t\t\t\t\t$('.wp-smush-resmush-notice').remove();\n\n\t\t\t\t\t//Show Bulk wrapper\n\t\t\t\t\t$('.wp-smush-bulk-wrapper').show();\n\n\t\t\t\t\tif ('undefined' !== typeof r.data.count) {\n\t\t\t\t\t\t//Update progress bar\n\t\t\t\t\t\tupdate_progress_bar_resmush(r.data.count);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//If content is received, Prepend it\n\t\t\t\tif ('undefined' != typeof r.data.content) {\n\t\t\t\t\t$('.bulk-smush-wrapper .sui-box-body').prepend(r.data.content);\n\t\t\t\t}\n\t\t\t\t//If we have any notice to show\n\t\t\t\tif ('undefined' != typeof r.data.notice) {\n\t\t\t\t\t$('.wp-smush-page-header').after(r.data.notice);\n\t\t\t\t}\n\t\t\t\t//Hide errors\n\t\t\t\t$('div.smush-final-log').hide();\n\n\t\t\t\t//Hide Super Smush notice if it's enabled in media settings\n\t\t\t\tif ('undefined' != typeof r.data.super_smush && r.data.super_smush) {\n\t\t\t\t\tvar enable_lossy = jQuery('.wp-smush-enable-lossy');\n\t\t\t\t\tif (enable_lossy.length > 0) {\n\t\t\t\t\t\tenable_lossy.remove();\n\t\t\t\t\t}\n\t\t\t\t\tif ('undefined' !== r.data.super_smush_stats) {\n\t\t\t\t\t\t$('.super-smush-attachments .wp-smush-stats').html(r.data.super_smush_stats);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tupdate_stats(scan_type);\n\t\t\t}\n\t\t}).always(function () {\n\n\t\t\t//Hide the progress bar\n\t\t\tjQuery('.bulk-smush-wrapper .wp-smush-bulk-progress-bar-wrapper').hide();\n\n\t\t\t// Add check complete status to button.\n\t\t\tbutton.text(wp_smush_msgs.resmush_complete).removeClass('sui-button-onload sui-icon-loader sui-loading').addClass('smush-button-check-success');\n\n\t\t\t// Remove success message from button.\n\t\t\tsetTimeout(function () {\n\t\t\t\tbutton.removeClass('smush-button-check-success').text(wp_smush_msgs.resmush_check);\n\t\t\t}, 2000);\n\n\t\t\t$('.wp-smush-button').removeAttr('disabled');\n\n\t\t\t//If wp-smush-re-check-message is there, remove it\n\t\t\tif ($('.wp-smush-re-check-message').length) {\n\t\t\t\tremove_element($('.wp-smush-re-check-message'));\n\t\t\t}\n\t\t});\n\t};\n\n\t/**\n  * Get directory list using Ajax\n  *\n  * @param param\n  * @returns {string}\n  *\n  */\n\tvar getDirectoryList = function getDirectoryList(param) {\n\t\tparam.action = 'smush_get_directory_list';\n\t\tparam.list_nonce = jQuery('input[name=\"list_nonce\"]').val();\n\t\tvar res = '';\n\t\t$.ajax({\n\t\t\ttype: \"GET\",\n\t\t\turl: ajaxurl,\n\t\t\tdata: param,\n\t\t\tsuccess: function success(response) {\n\t\t\t\tres = response;\n\t\t\t},\n\t\t\tasync: false\n\t\t});\n\t\t//Update the button text\n\t\t$('button.wp-smush-select-dir').html(wp_smush_msgs.add_dir);\n\t\treturn res;\n\t};\n\t/**\n  * Hide the popup and reset the opacity for the button\n  *\n  */\n\tvar close_dialog = function close_dialog() {\n\n\t\t// Close the dialog.\n\t\tSUI.dialogs['wp-smush-list-dialog'].hide();\n\n\t\t$('.wp-smush-select-dir, button.wp-smush-browse, button.wp-smush-resume, a.wp-smush-dir-link').removeAttr('disabled');\n\n\t\t// Reset the opacity for content and scan button\n\t\t$('.wp-smush-select-dir, .wp-smush-list-dialog .sui-box-body').css({ 'opacity': '1' });\n\t};\n\n\t/**\n  * Initialize accordion\n  *\n  */\n\tvar set_accordion = function set_accordion() {\n\n\t\t// backward compat of instantiate new accordion\n\t\tSUI.suiAccordion($('.sui-table.sui-accordion.smush-dir-smush-accordion'));\n\t};\n\n\t/**\n  * Check if all the elements in the directory are smushed or not\n  *\n  * @param parent directory selector\n  *\n  * @returns {boolean}\n  *\n  */\n\tvar is_last_element = function is_last_element(parent) {\n\t\tvar elements = parent.find('li.wp-smush-image-ele:not(.optimised,.processed,.error)');\n\t\tif (elements.length <= 0) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t};\n\n\t/**\n  * Update directory optimisation progress if the element has a parent\n  *\n  * @param ele\n  *\n  */\n\tvar update_dir_progress = function update_dir_progress(ele) {\n\n\t\tvar ele_tr = ele.closest('tr');\n\t\tvar ele_prev_tr = ele_tr.prev('tr');\n\t\tvar ele_dir_progress = ele_prev_tr.find('.wp-smush-image-dir-progress');\n\t\tvar ele_dir_progress_percent = ele_prev_tr.find('.wp-smush-image-progress-percent');\n\t\tvar ele_dir_count = ele_prev_tr.find('.sui-tag');\n\t\tvar ele_exclude_btn = ele_prev_tr.find('.wp-smush-exclude-dir');\n\n\t\tvar children = ele.closest('tr').find('.wp-smush-image-ele');\n\t\tvar parent = ele.is('li') ? ele.parent() : '';\n\n\t\t//Update the percentage, Check the total number of images inside dir, smushed images count\n\t\tif (children.length > 0) {\n\t\t\tvar total = children.length;\n\t\t\tvar smushed = children.filter('.optimised').length;\n\t\t\tif (smushed > 0 && total > 0) {\n\t\t\t\tele_dir_progress_percent.removeClass('sui-hidden');\n\t\t\t\tvar percent = smushed / total * 100;\n\t\t\t\tpercent = precise_round(percent, 1);\n\t\t\t\tele_dir_progress_percent.html(percent + '%');\n\t\t\t}\n\t\t}\n\n\t\t//Add the class in-progress, to show the respective icon for parent\n\t\tif (0 != $('input[name=\"wp-smush-continue-ajax\"]').val() && smushed != total) {\n\t\t\t//Append a spinner\n\t\t\tele_dir_progress.addClass('sui-icon-loader sui-loading');\n\t\t}\n\n\t\tif (parent.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\t//Check if last image, and if all the images are not smushed under the specified directory path, add a generic warning message\n\t\tif (is_last_element(parent)) {\n\t\t\tif (smushed < total) {\n\t\t\t\tvar unsmushed = total - smushed;\n\t\t\t\tvar message = '<div class=\"sui-notice sui-notice-warning\"><p>' + unsmushed + ' ' + (1 == unsmushed ? wp_smush_msgs.unfinished_smush_single : wp_smush_msgs.unfinished_smush) + '</p></div>';\n\n\t\t\t\t//If the notice is already displayed, remove it\n\t\t\t\tvar notice = parent.find('div.sui-notice');\n\t\t\t\tif (notice.length) {\n\t\t\t\t\tnotice.remove();\n\t\t\t\t}\n\n\t\t\t\t//Append message to 2nd parent i.e li\n\t\t\t\tparent.after(message);\n\t\t\t\tele_dir_progress.removeClass('sui-icon-loader sui-loading').addClass('partial');\n\t\t\t\tele_tr.find('td').addClass('partial');\n\t\t\t\tele_prev_tr.find('td').addClass('partial');\n\t\t\t} else {\n\t\t\t\tele_dir_progress.removeClass('partial sui-icon-loader sui-loading').addClass('optimised');\n\t\t\t\t// Update the count tag class.\n\t\t\t\tele_dir_count.removeClass('sui-tag-warning').addClass('sui-tag-inactive');\n\t\t\t\tele_exclude_btn.hide();\n\t\t\t\tele_tr.find('td').removeClass('partial').addClass('optimised');\n\t\t\t\tele_prev_tr.find('td').removeClass('partial').addClass('optimised');\n\t\t\t}\n\t\t\t//Remove the loader and percentage.\n\t\t\tele_dir_progress.removeClass('sui-icon-loader sui-loading');\n\t\t\tele_dir_progress_percent.html('');\n\t\t}\n\t};\n\n\t/**\n  * Add choose directory button at the top\n  *\n  */\n\tvar add_dir_browser_button = function add_dir_browser_button() {\n\t\t//Get the content div length, if less than 1500, Skip\n\t\tif ($('div.wp-smush-scan-result div.content').height() < 1500 || $('div.dir-smush-button-wrap.top').length >= 1) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar choose_button = $('div.dir-smush-button-wrap').clone();\n\t\tchoose_button.addClass('top');\n\t\t$('div.wp-smush-scan-result div.content').prepend(choose_button);\n\t};\n\n\tvar add_smush_button = function add_smush_button() {\n\t\t//Get the content div length, if less than 1500, Skip\n\t\tif ($('div.wp-smush-scan-result div.content').height() < 1500 || $('div.wp-smush-all-button-wrap.top').length >= 1) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar smush_button = $('div.wp-smush-all-button-wrap.bottom').clone();\n\t\tsmush_button.addClass('top').removeClass('bottom');\n\t\t$('div.wp-smush-scan-result div.content').prepend(smush_button);\n\t};\n\n\t/**\n  * Add smush notice after directory smushing is finished\n  *\n  * @param notice_type\n  *  all_done -  If all the images were smushed else warning\n  *  smush_limit - If Free users exceeded limit\n  *\n  */\n\tvar add_smush_dir_notice = function add_smush_dir_notice(notice_type) {\n\t\t//Get the content div length, if less than 1500, Skip\n\t\tif ($('div.wp-smush-scan-result div.content').height() < 1500 || $('div.wp-smush-scan-result div.sui-notice.top').length >= 1) {\n\t\t\treturn;\n\t\t}\n\t\tvar notice = '';\n\t\t//Clone and append the notice\n\t\tif ('all_done' == notice_type) {\n\t\t\tnotice = $('div.sui-notice.wp-smush-dir-all-done').clone();\n\t\t} else if ('smush_limit' == notice_type) {\n\t\t\tnotice = $('div.sui-notice.wp-smush-dir-limit').clone();\n\t\t} else {\n\t\t\tnotice = $('div.sui-notice.wp-smush-dir-remaining').clone();\n\t\t}\n\n\t\t//Add class top\n\t\tnotice.addClass('top');\n\n\t\t//Append the notice\n\t\t$('div.wp-smush-scan-result div.dir-smush-button-wrap').after(notice);\n\t};\n\n\tvar update_smush_progress = function update_smush_progress() {\n\t\tvar in_progress_path = $('ul.wp-smush-image-list li.in-progress');\n\t\tin_progress_path.removeClass('in-progress active');\n\t\tif (in_progress_path.length > 0) {\n\t\t\tin_progress_path.each(function (index, ele) {\n\t\t\t\tif ($(ele).hasClass('wp-smush-image-ul')) {\n\t\t\t\t\t//Remove Spinner\n\t\t\t\t\t$(ele).find('span.spinner').remove();\n\n\t\t\t\t\t//Check if images are pending\n\t\t\t\t\tvar in_progress_ele = $(ele).find('li.wp-smush-image-ele');\n\n\t\t\t\t\t//If there are elements\n\t\t\t\t\tif (in_progress_ele.length > 0) {\n\t\t\t\t\t\tvar optimised = in_progress_ele.filter('.optimised').length;\n\t\t\t\t\t\tvar error = in_progress_ele.filter('.error').length;\n\t\t\t\t\t\t//if all the elements are optimised\n\t\t\t\t\t\tif (optimised == in_progress_ele.length) {\n\t\t\t\t\t\t\t$(ele).addClass('complete');\n\t\t\t\t\t\t} else if (0 < optimised || 0 < error) {\n\t\t\t\t\t\t\t//If there are images that needs to be smushed, add the class partial\n\t\t\t\t\t\t\t$(ele).addClass('partial');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t//Remove spinner for the element\n\t\t\t\t\t$(ele).find('span.spinner').remove();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\n\t/**\n  * Set pro savings stats if not premium user.\n  *\n  * For non-premium users, show expected avarage savings based\n  * on the free version savings.\n  */\n\tvar set_pro_savings = function set_pro_savings() {\n\n\t\t// Default values.\n\t\tvar savings = wp_smushit_data.savings_percent > 0 ? wp_smushit_data.savings_percent : 0;\n\t\tvar savings_bytes = wp_smushit_data.savings_bytes > 0 ? wp_smushit_data.savings_bytes : 0;\n\t\tvar orig_diff = 2.22058824;\n\t\tif (savings > 49) {\n\t\t\tvar orig_diff = 1.22054412;\n\t\t}\n\t\t//Calculate Pro savings\n\t\tif (savings > 0) {\n\t\t\tsavings = orig_diff * savings;\n\t\t\tsavings_bytes = orig_diff * savings_bytes;\n\t\t}\n\n\t\twp_smushit_data.pro_savings = {\n\t\t\t'percent': precise_round(savings, 1),\n\t\t\t'savings_bytes': formatBytes(savings_bytes, 1)\n\n\t\t};\n\t};\n\n\t/**\n  * Adds the stats for the current image to existing stats\n  *\n  * @param image_stats\n  *\n  */\n\tvar update_localized_stats = function update_localized_stats(image_stats, type) {\n\t\t//Increase the smush count\n\t\tif ('undefined' == typeof wp_smushit_data) {\n\t\t\treturn;\n\t\t}\n\n\t\t//No need to increase attachment count, resize, conversion savings for directory smush\n\t\tif ('media' == type) {\n\t\t\twp_smushit_data.count_smushed = parseInt(wp_smushit_data.count_smushed) + 1;\n\n\t\t\t//Increase smushed image count\n\t\t\twp_smushit_data.count_images = parseInt(wp_smushit_data.count_images) + parseInt(image_stats.count);\n\n\t\t\t//Increase super smush count, if applicable\n\t\t\tif (image_stats.is_lossy) {\n\t\t\t\twp_smushit_data.count_supersmushed = parseInt(wp_smushit_data.count_supersmushed) + 1;\n\t\t\t}\n\n\t\t\t//Add to Resize Savings\n\t\t\twp_smushit_data.savings_resize = 'undefined' != typeof image_stats.savings_resize.bytes ? parseInt(wp_smushit_data.savings_resize) + parseInt(image_stats.savings_resize.bytes) : parseInt(wp_smushit_data.savings_resize);\n\n\t\t\t//Update Resize count\n\t\t\twp_smushit_data.count_resize = 'undefined' != typeof image_stats.savings_resize.bytes ? parseInt(wp_smushit_data.count_resize) + 1 : wp_smushit_data.count_resize;\n\n\t\t\t//Add to Conversion Savings\n\t\t\twp_smushit_data.savings_conversion = 'undefined' != typeof image_stats.savings_conversion && 'undefined' != typeof image_stats.savings_conversion.bytes ? parseInt(wp_smushit_data.savings_conversion) + parseInt(image_stats.savings_conversion.bytes) : parseInt(wp_smushit_data.savings_conversion);\n\t\t} else if ('directory_smush' == type) {\n\t\t\t//Increase smushed image count\n\t\t\twp_smushit_data.count_images = parseInt(wp_smushit_data.count_images) + 1;\n\t\t} else if ('nextgen' == type) {\n\t\t\twp_smushit_data.count_smushed = parseInt(wp_smushit_data.count_smushed) + 1;\n\t\t\twp_smushit_data.count_supersmushed = parseInt(wp_smushit_data.count_supersmushed) + 1;\n\n\t\t\t//Increase smushed image count\n\t\t\twp_smushit_data.count_images = parseInt(wp_smushit_data.count_images) + parseInt(image_stats.count);\n\t\t}\n\n\t\t//If we have savings\n\t\tif (image_stats.size_before > image_stats.size_after) {\n\t\t\t//Update savings\n\t\t\twp_smushit_data.size_before = 'undefined' != typeof image_stats.size_before ? parseInt(wp_smushit_data.size_before) + parseInt(image_stats.size_before) : parseInt(wp_smushit_data.size_before);\n\t\t\twp_smushit_data.size_after = 'undefined' != typeof image_stats.size_after ? parseInt(wp_smushit_data.size_after) + parseInt(image_stats.size_after) : parseInt(wp_smushit_data.size_after);\n\t\t}\n\t\t//Add stats for resizing\n\t\tif ('undefined' != typeof image_stats.savings_resize) {\n\t\t\t//Update savings\n\t\t\twp_smushit_data.size_before = 'undefined' != typeof image_stats.savings_resize.size_before ? parseInt(wp_smushit_data.size_before) + parseInt(image_stats.savings_resize.size_before) : parseInt(wp_smushit_data.size_before);\n\t\t\twp_smushit_data.size_after = 'undefined' != typeof image_stats.savings_resize.size_after ? parseInt(wp_smushit_data.size_after) + parseInt(image_stats.savings_resize.size_after) : parseInt(wp_smushit_data.size_after);\n\t\t}\n\t\t//Add stats for Conversion\n\t\tif ('undefined' != typeof image_stats.savings_conversion) {\n\t\t\t//Update savings\n\t\t\twp_smushit_data.size_before = 'undefined' != typeof image_stats.savings_conversion.size_before ? parseInt(wp_smushit_data.size_before) + parseInt(image_stats.savings_conversion.size_before) : parseInt(wp_smushit_data.size_before);\n\t\t\twp_smushit_data.size_after = 'undefined' != typeof image_stats.savings_conversion.size_after ? parseInt(wp_smushit_data.size_after) + parseInt(image_stats.savings_conversion.size_after) : parseInt(wp_smushit_data.size_after);\n\t\t}\n\t};\n\n\t/**\n  * Update all stats sections based on the response.\n  *\n  * @param scan_type Current scan type.\n  */\n\tvar update_stats = function update_stats(scan_type) {\n\n\t\tvar super_savings = 0,\n\t\t    smushed_count = 0;\n\t\tvar is_nextgen = 'undefined' != typeof scan_type && 'nextgen' == scan_type;\n\n\t\t//Calculate updated savings in bytes\n\t\twp_smushit_data.savings_bytes = parseInt(wp_smushit_data.size_before) - parseInt(wp_smushit_data.size_after);\n\n\t\tvar formatted_size = formatBytes(wp_smushit_data.savings_bytes, 1);\n\n\t\tif (is_nextgen) {\n\t\t\t$('.wp-smush-savings .wp-smush-stats-human').html(formatted_size);\n\t\t} else {\n\t\t\t$('.wp-smush-savings .wp-smush-stats-human').html(getFormatFromString(formatted_size));\n\t\t\t$('.sui-summary-large.wp-smush-stats-human').html(getSizeFromString(formatted_size));\n\t\t}\n\n\t\t//Update the savings percent\n\t\twp_smushit_data.savings_percent = precise_round(parseInt(wp_smushit_data.savings_bytes) / parseInt(wp_smushit_data.size_before) * 100, 1);\n\t\tif (!isNaN(wp_smushit_data.savings_percent)) {\n\t\t\t$('.wp-smush-savings .wp-smush-stats-percent').html(wp_smushit_data.savings_percent);\n\t\t}\n\n\t\t//Update Savings in share message\n\t\t//$( 'span.smush-share-savings' ).html( formatBytes( wp_smushit_data.savings_bytes, 1 ) );\n\n\t\t//Update Smush percent\n\t\twp_smushit_data.smush_percent = precise_round(parseInt(wp_smushit_data.count_smushed) / parseInt(wp_smushit_data.count_total) * 100, 1);\n\t\t$('span.wp-smush-images-percent').html(wp_smushit_data.smush_percent);\n\n\t\t//Super-Smush Savings\n\t\tif ('undefined' != typeof wp_smushit_data.savings_bytes && 'undefined' != typeof wp_smushit_data.savings_resize) {\n\t\t\tsuper_savings = parseInt(wp_smushit_data.savings_bytes) - parseInt(wp_smushit_data.savings_resize);\n\t\t\tif (super_savings > 0) {\n\t\t\t\t$('li.super-smush-attachments span.smushed-savings').html(formatBytes(super_savings, 1));\n\t\t\t}\n\t\t}\n\n\t\t//Update Image count\n\t\tif (is_nextgen) {\n\t\t\t$('.sui-summary-details span.wp-smush-total-optimised').html(wp_smushit_data.count_images);\n\t\t} else {\n\t\t\t$('span.smushed-items-count span.wp-smush-count-total span.wp-smush-total-optimised').html(wp_smushit_data.count_images);\n\t\t}\n\n\t\t//Update image count in share message\n\t\t//$( 'span.smush-share-image-count' ).html( wp_smushit_data.count_images );\n\n\t\t//Update Resize image count\n\t\t$('span.smushed-items-count span.wp-smush-count-resize-total span.wp-smush-total-optimised').html(wp_smushit_data.count_resize);\n\n\t\t//Update Attachment image count\n\t\t//$( 'div.wp-smush-count-attachment-total span.wp-smush-total-optimised' ).html( wp_smushit_data.count_smushed );\n\n\t\t//Update image count in share message\n\n\t\t//Update supersmushed image count\n\t\tif ($('li.super-smush-attachments .smushed-count').length && 'undefined' != typeof wp_smushit_data.count_supersmushed) {\n\t\t\t$('li.super-smush-attachments .smushed-count').html(wp_smushit_data.count_supersmushed);\n\t\t}\n\n\t\t//Update Conversion Savings\n\t\tvar smush_conversion_savings = $('.smush-conversion-savings');\n\t\tif (smush_conversion_savings.length > 0 && 'undefined' != typeof wp_smushit_data.savings_conversion && wp_smushit_data.savings_conversion != '') {\n\t\t\tvar conversion_savings = smush_conversion_savings.find('.wp-smush-stats');\n\t\t\tif (conversion_savings.length > 0) {\n\t\t\t\tconversion_savings.html(formatBytes(wp_smushit_data.savings_conversion, 1));\n\t\t\t}\n\t\t}\n\n\t\t//Update Resize Savings\n\t\tvar smush_resize_savings = $('.smush-resize-savings');\n\t\tif (smush_resize_savings.length > 0 && 'undefined' != typeof wp_smushit_data.savings_resize && wp_smushit_data.savings_resize != '') {\n\t\t\t// Get the resize savings in number.\n\t\t\tvar savings_value = parseInt(wp_smushit_data.savings_resize);\n\t\t\tvar resize_savings = smush_resize_savings.find('.wp-smush-stats');\n\t\t\tvar resize_message = smush_resize_savings.find('.wp-smush-stats-label-message');\n\t\t\t// Replace only if value is grater than 0.\n\t\t\tif (savings_value > 0 && resize_savings.length > 0) {\n\t\t\t\t// Hide message.\n\t\t\t\tif (resize_message.length > 0) {\n\t\t\t\t\tresize_message.hide();\n\t\t\t\t}\n\t\t\t\tresize_savings.html(formatBytes(wp_smushit_data.savings_resize, 1));\n\t\t\t}\n\t\t}\n\n\t\t//Update pro Savings\n\t\tset_pro_savings();\n\n\t\t// Updating pro savings stats.\n\t\tif ('undefined' != typeof wp_smushit_data.pro_savings) {\n\t\t\t// Make pro savings div visible if hidden.\n\t\t\t$('#smush-avg-pro-savings').removeClass('sui-hidden');\n\t\t\t// Pro stats section.\n\t\t\tvar smush_pro_savings = $('.smush-avg-pro-savings');\n\t\t\tif (smush_pro_savings.length > 0) {\n\t\t\t\tvar pro_savings_percent = smush_pro_savings.find('.wp-smush-stats-percent');\n\t\t\t\tvar pro_savings_bytes = smush_pro_savings.find('.wp-smush-stats-human');\n\t\t\t\tif (pro_savings_percent.length > 0 && 'undefined' != typeof wp_smushit_data.pro_savings.percent && wp_smushit_data.pro_savings.percent != '') {\n\t\t\t\t\tpro_savings_percent.html(wp_smushit_data.pro_savings.percent);\n\t\t\t\t}\n\t\t\t\tif (pro_savings_bytes.length > 0 && 'undefined' != typeof wp_smushit_data.pro_savings.savings_bytes && wp_smushit_data.pro_savings.savings_bytes != '') {\n\t\t\t\t\tpro_savings_bytes.html(wp_smushit_data.pro_savings.savings_bytes);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\n  * Update the progress and show notice when smush completes\n  */\n\tvar directory_smush_finished = function directory_smush_finished(notice_type) {\n\n\t\t// Remove progress icon from navbar.\n\t\t$('.smush-nav-icon.directory').removeClass('sui-icon-loader sui-loading');\n\n\t\t//If there are no images left\n\t\t$('button.wp-smush-pause').hide().attr('disabled', 'disabled');\n\n\t\t//Hide Bulk Smush button if smush was stopped for error or finished\n\t\tif ('' == notice_type) {\n\t\t\t$('button.wp-smush-start').parent().hide();\n\t\t} else {\n\t\t\t$('button.wp-smush-start').show().removeAttr('disabled');\n\t\t}\n\n\t\t//Enable Choose directory button\n\t\t$('button.wp-smush-browse').show().removeAttr('disabled', 'disabled');\n\n\t\t//Clone Choose Directory Button and add at the top\n\t\tadd_dir_browser_button();\n\n\t\t//Clone and add Smush button\n\t\tadd_smush_button();\n\n\t\tif ('' == notice_type) {\n\t\t\t//Get the Total and Optimised image count\n\t\t\tvar image_ele = $('li.wp-smush-image-ele');\n\t\t\tvar total = image_ele.length;\n\t\t\tvar remaning = image_ele.filter(':not(.optimised)').length;\n\t\t\tvar smushed = total - remaning;\n\t\t\tif (remaning > 0) {\n\t\t\t\t//Append the count\n\t\t\t\t$('span.wp-smush-dir-remaining').html(remaning);\n\t\t\t\t$('span.wp-smush-dir-total').html(total);\n\t\t\t\t$('span.wp-smush-dir-smushed').html(smushed);\n\n\t\t\t\t//Show remaining image notice\n\t\t\t\t$('.sui-notice.wp-smush-dir-remaining').show();\n\n\t\t\t\t//Show notice on top if required\n\t\t\t\tadd_smush_dir_notice();\n\t\t\t} else {\n\n\t\t\t\t//Show success image notice\n\t\t\t\tvar message = $('.sui-notice.wp-smush-dir-all-done').clone().show();\n\t\t\t\t// Hide images list.\n\t\t\t\t$('.wp-smush-image-list tbody tr').not(':first').not(':last').hide();\n\t\t\t\t$('.wp-smush-image-list tbody tr:first td').html(message).removeClass('partial optimised');\n\n\t\t\t\t//Show notice on top if required\n\t\t\t\tadd_smush_dir_notice('all_done');\n\t\t\t}\n\t\t} else {\n\t\t\t//Show Bulk Limit Notice\n\t\t\t$('.wp-smush-notice.wp-smush-dir-limit').show();\n\t\t\t//Show notice on top if required\n\t\t\tadd_smush_dir_notice('smush_limit');\n\t\t}\n\t};\n\n\t/**\n  * Start Optimising all the images listed in last directory scan\n  */\n\tvar smush_all = function smush_all() {\n\n\t\tvar unprocessed_child = jQuery('.wp-smush-image-list .wp-smush-image-ele:not(\".optimised, .processed\")');\n\n\t\t//Update the Optimising status for the image\n\t\tvar first_child = unprocessed_child.first();\n\n\t\tvar img_progress = first_child.find('.wp-smush-image-ele-progress');\n\t\tvar parent_tr = first_child.closest('tr').prev('tr');\n\t\tvar dir_progress = parent_tr.find('.wp-smush-image-dir-progress');\n\t\tvar exclude_btn = parent_tr.find('.wp-smush-exclude-dir');\n\t\tvar progress_percent = parent_tr.find('.wp-smush-image-progress-percent');\n\n\t\t//Check if the selected element is under expandable li\n\t\tif (dir_progress.length == 1) {\n\t\t\tdir_progress.addClass('sui-icon-loader sui-loading').removeClass('partial optimised');\n\t\t\texclude_btn.addClass('sui-hidden').hide();\n\t\t}\n\n\t\t// Show waiting message.\n\t\t$('.wp-smush-image-progress-percent').not('.optimised').removeClass('sui-hidden');\n\n\t\t//Append and show spinner\n\t\timg_progress.addClass('sui-icon-loader sui-loading');\n\n\t\t//If all the elements are optimised, No need to send ajax request\n\t\tif (first_child.length === 0) {\n\t\t\tdirectory_smush_finished('');\n\t\t\treturn;\n\t\t}\n\n\t\t/** Ajax Request to optimise directory images */\n\t\tvar param = {\n\t\t\taction: 'optimise',\n\t\t\timage_id: first_child.attr('id'),\n\t\t\tget_stats: unprocessed_child.length > 1 ? 0 : 1,\n\t\t\tnonce: $('#wp-smush-all').val()\n\t\t};\n\n\t\t//Send Ajax request\n\t\t$.get(ajaxurl, param, function (res) {\n\n\t\t\t//Check, if limit is exceeded for free version\n\t\t\tif (typeof res.data !== \"undefined\" && res.data.error == 'dir_smush_limit_exceeded') {\n\t\t\t\t//@todo: Check if this is required anymore\n\t\t\t\tfirst_child.removeClass('processed');\n\t\t\t\t//Show error, Bulk Smush limit exceeded\n\t\t\t\tdirectory_smush_finished('wp-smush-dir-limit');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t//append stats, remove loader, add loader to next image, loop\n\t\t\tvar data = 'undefined' != typeof res.data ? res.data : '';\n\n\t\t\t//If image element is there\n\t\t\tif ('undefined' != typeof data.image) {\n\t\t\t\t//Mark Optimised\n\t\t\t\tvar ele = jQuery(document.getElementById(data.image.id));\n\t\t\t\tvar ele_img_progress = ele.find('.wp-smush-image-ele-progress');\n\n\t\t\t\tele.removeClass('partial');\n\t\t\t\tele_img_progress.removeClass('sui-icon-loader sui-loading');\n\n\t\t\t\tif (res.success) {\n\n\t\t\t\t\tele.addClass('optimised');\n\t\t\t\t\tele_img_progress.addClass('optimised');\n\n\t\t\t\t\t//Update Directory progress\n\t\t\t\t\tupdate_dir_progress(ele);\n\n\t\t\t\t\t// @todo Update stats.\n\t\t\t\t} else {\n\t\t\t\t\t//If there was an error optimising the image\n\t\t\t\t\tele.addClass('processed');\n\t\t\t\t\tele_img_progress.addClass('partial');\n\t\t\t\t\t//Update Directory progress\n\t\t\t\t\tupdate_dir_progress(ele);\n\t\t\t\t}\n\n\t\t\t\t//@todo: Fixed stats UI\n\t\t\t}\n\n\t\t\t//If user haven't paused the Smushing\n\t\t\tif (1 == $('input[name=\"wp-smush-continue-ajax\"]').val()) {\n\t\t\t\t//Loop\n\t\t\t\tsmush_all(false);\n\t\t\t} else {\n\t\t\t\t//Reset the Ajax flag\n\t\t\t\t$('input.wp-smush-continue-ajax').val(1);\n\t\t\t}\n\t\t});\n\t};\n\n\t//Finds y value of given object\n\tfunction findPos(obj) {\n\t\tvar curtop = 0;\n\t\tif (obj.offsetParent) {\n\t\t\tdo {\n\t\t\t\tcurtop += obj.offsetTop;\n\t\t\t} while (obj = obj.offsetParent);\n\t\t\treturn [curtop];\n\t\t}\n\t}\n\n\t//Scroll the element to top of the page\n\tvar goToByScroll = function goToByScroll(selector) {\n\t\t// Scroll\n\t\t$('html,body').animate({\n\t\t\tscrollTop: $(selector).offset().top - 100\n\t\t}, 'slow');\n\t};\n\n\tvar disable_buttons = function disable_buttons(self) {\n\t\tself.attr('disabled', 'disabled');\n\t\t$('.wp-smush-browse').attr('disabled', 'disabled');\n\t};\n\n\tvar update_cummulative_stats = function update_cummulative_stats(stats) {\n\t\t//Update Directory Smush Stats\n\t\tif ('undefined' != typeof stats.dir_smush) {\n\t\t\tvar stats_human = $('li.smush-dir-savings span.wp-smush-stats span.wp-smush-stats-human');\n\t\t\tvar stats_percent = $('li.smush-dir-savings span.wp-smush-stats span.wp-smush-stats-percent');\n\n\t\t\t// Do not replace if 0 savings.\n\t\t\tif (stats.dir_smush.bytes > 0) {\n\t\t\t\t// Hide selector.\n\t\t\t\t$('li.smush-dir-savings .wp-smush-stats-label-message').hide();\n\t\t\t\t//Update Savings in bytes\n\t\t\t\tif (stats_human.length > 0) {\n\t\t\t\t\tstats_human.html(stats.dir_smush.human);\n\t\t\t\t} else {\n\t\t\t\t\tvar span = '<span class=\"wp-smush-stats-human\">' + stats.dir_smush.bytes + '</span>';\n\t\t\t\t}\n\n\t\t\t\t//Percentage section\n\t\t\t\tif (stats.dir_smush.percent > 0) {\n\t\t\t\t\t// Show size and percentage separator.\n\t\t\t\t\t$('li.smush-dir-savings span.wp-smush-stats span.wp-smush-stats-sep').removeClass('sui-hidden');\n\t\t\t\t\t//Update Optimisation percentage\n\t\t\t\t\tif (stats_percent.length > 0) {\n\t\t\t\t\t\tstats_percent.html(stats.dir_smush.percent + '%');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar span = '<span class=\"wp-smush-stats-percent\">' + stats.dir_smush.percent + '%' + '</span>';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//Update Combined stats\n\t\tif ('undefined' != typeof stats.combined_stats && stats.combined_stats.length > 0) {\n\t\t\tvar c_stats = stats.combined_stats;\n\n\t\t\tvar smush_percent = c_stats.smushed / c_stats.total_count * 100;\n\t\t\tsmush_percent = precise_round(smush_percent, 1);\n\n\t\t\t//Smushed Percent\n\t\t\tif (smush_percent) {\n\t\t\t\t$('div.wp-smush-count-total span.wp-smush-images-percent').html(smush_percent);\n\t\t\t}\n\t\t\t//Update Total Attachment Count\n\t\t\tif (c_stats.total_count) {\n\t\t\t\t$('span.wp-smush-count-total span.wp-smush-total-optimised').html(c_stats.total_count);\n\t\t\t}\n\t\t\t//Update Savings and Percent\n\t\t\tif (c_stats.savings) {\n\t\t\t\t$('span.wp-smush-savings span.wp-smush-stats-human').html(c_stats.savings);\n\t\t\t}\n\t\t\tif (c_stats.percent) {\n\t\t\t\t$('span.wp-smush-savings span.wp-smush-stats-percent').html(c_stats.percent);\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\n  * Show directory list popup and foucs on close button\n  */\n\tvar showDialog = function showDialog() {\n\t\t//Shows the directories available\n\t\t$('.wp-smush-list-dialog').show();\n\t\t$('.wp-smush-list-dialog div.close').focus();\n\t};\n\n\t//Remove span tag from URL\n\tfunction removeSpan(url) {\n\t\tvar url = url.slice(url.indexOf('?') + 1).split('&');\n\t\tfor (var i = 0; i < url.length; i++) {\n\t\t\tvar urlparam = decodeURI(url[i]).split(/=(.+)/)[1];\n\t\t\treturn urlparam.replace(/<(?:.|\\n)*?>/gm, '');\n\t\t}\n\t}\n\n\t/**\n  * Handle the Smush Stats link click\n  */\n\t$('body').on('click', 'a.smush-stats-details', function (e) {\n\n\t\t//If disabled\n\t\tif ('disabled' == $(this).attr('disabled')) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// prevent the default action\n\t\te.preventDefault();\n\t\t//Replace the `+` with a `-`\n\t\tvar slide_symbol = $(this).find('.stats-toggle');\n\t\t$(this).parents().eq(1).find('.smush-stats-wrapper').slideToggle();\n\t\tslide_symbol.text(slide_symbol.text() == '+' ? '-' : '+');\n\t});\n\n\t/** Handle smush button click **/\n\t$('body').on('click', '.wp-smush-send:not(.wp-smush-resmush)', function (e) {\n\n\t\t// prevent the default action\n\t\te.preventDefault();\n\t\tnew WP_Smush.Smush($(this), false);\n\t});\n\n\t/** Handle NextGen Gallery smush button click **/\n\t$('body').on('click', '.wp-smush-nextgen-send', function (e) {\n\n\t\t// prevent the default action\n\t\te.preventDefault();\n\t\tnew WP_Smush.Smush($(this), false, 'nextgen');\n\t});\n\n\t/** Handle NextGen Gallery Bulk smush button click **/\n\t$('body').on('click', '.wp-smush-nextgen-bulk', function (e) {\n\n\t\t// prevent the default action\n\t\te.preventDefault();\n\n\t\t//Check for ids, if there is none (Unsmushed or lossless), don't call smush function\n\t\tif (typeof wp_smushit_data == 'undefined' || wp_smushit_data.unsmushed.length == 0 && wp_smushit_data.resmush.length == 0) {\n\n\t\t\treturn false;\n\t\t}\n\n\t\tjQuery('.wp-smush-button, .wp-smush-scan').attr('disabled', 'disabled');\n\t\t$(\".wp-smush-notice.wp-smush-remaining\").hide();\n\t\tnew WP_Smush.Smush($(this), true, 'nextgen');\n\t});\n\n\t/** Restore: Media Library **/\n\t$('body').on('click', '.wp-smush-action.wp-smush-restore', function (e) {\n\t\tvar current_button = $(this);\n\t\tvar smush_action = 'smush_restore_image';\n\t\tprocess_smush_action(e, current_button, smush_action, 'restore');\n\t\t//Change the class oa parent div ( Level 2 )\n\t\tvar parent = current_button.parents().eq(1);\n\t\tif (parent.hasClass('smushed')) {\n\t\t\tparent.removeClass('smushed').addClass('unsmushed');\n\t\t}\n\t});\n\n\t/** Resmush: Media Library **/\n\t$('body').on('click', '.wp-smush-action.wp-smush-resmush', function (e) {\n\t\tvar current_button = $(this);\n\t\tvar smush_action = 'smush_resmush_image';\n\t\tprocess_smush_action(e, current_button, smush_action, 'smushing');\n\t});\n\n\t/** Restore: NextGen Gallery **/\n\t$('body').on('click', '.wp-smush-action.wp-smush-nextgen-restore', function (e) {\n\t\tvar current_button = $(this);\n\t\tvar smush_action = 'smush_restore_nextgen_image';\n\t\tprocess_smush_action(e, current_button, smush_action, 'restore');\n\t});\n\n\t/** Resmush: NextGen Gallery **/\n\t$('body').on('click', '.wp-smush-action.wp-smush-nextgen-resmush', function (e) {\n\t\tvar current_button = $(this);\n\t\tvar smush_action = 'smush_resmush_nextgen_image';\n\t\tprocess_smush_action(e, current_button, smush_action, 'smushing');\n\t});\n\n\t//Scan For resmushing images\n\t$('body').on('click', '.wp-smush-scan', function (e) {\n\n\t\te.preventDefault();\n\n\t\t//Run the Re-check\n\t\trun_re_check($(this), false);\n\t});\n\n\t//Dismiss Welcome notice\n\t//@todo: Use it for popup\n\t$('#wp-smush-welcome-box .smush-dismiss-welcome').on('click', function (e) {\n\t\te.preventDefault();\n\t\tvar $el = $(this).parents().eq(1);\n\t\tremove_element($el);\n\n\t\t//Send a ajax request to save the dismissed notice option\n\t\tvar param = {\n\t\t\taction: 'dismiss_welcome_notice'\n\t\t};\n\t\t$.post(ajaxurl, param);\n\t});\n\n\t//Remove Notice\n\t$('body').on('click', '.wp-smush-notice .icon-fi-close', function (e) {\n\t\te.preventDefault();\n\t\tvar $el = $(this).parent();\n\t\tremove_element($el);\n\t});\n\n\t//On Click Update Settings. Check for change in settings\n\t$('input#wp-smush-save-settings').on('click', function (e) {\n\t\te.preventDefault();\n\n\t\tvar setting_type = '';\n\t\tvar setting_input = $('input[name=\"setting-type\"]');\n\t\t//Check if setting type is set in the form\n\t\tif (setting_input.length > 0) {\n\t\t\tsetting_type = setting_input.val();\n\t\t}\n\n\t\t//Show the spinner\n\t\tvar self = $(this);\n\t\tself.parent().find('span.sui-icon-loader.sui-loading').removeClass('sui-hidden');\n\n\t\t//Save settings if in network admin\n\t\tif ('' != setting_type && 'network' == setting_type) {\n\t\t\t//Ajax param\n\t\t\tvar param = {\n\t\t\t\taction: 'save_settings',\n\t\t\t\tnonce: $('#wp_smush_options_nonce').val()\n\t\t\t};\n\n\t\t\tparam = jQuery.param(param) + '&' + jQuery('form#wp-smush-settings-form').serialize();\n\n\t\t\t//Send ajax, Update Settings, And Check For resmush\n\t\t\tjQuery.post(ajaxurl, param).done(function () {\n\t\t\t\tjQuery('form#wp-smush-settings-form').submit();\n\t\t\t\treturn true;\n\t\t\t});\n\t\t} else {\n\n\t\t\t//Check for all the settings, and scan for resmush\n\t\t\tvar wrapper_div = self.parents().eq(1);\n\n\t\t\t//Get all the main settings\n\t\t\tvar keep_exif = document.getElementById(\"wp-smush-keep_exif\");\n\t\t\tvar super_smush = document.getElementById(\"wp-smush-lossy\");\n\t\t\tvar smush_original = document.getElementById(\"wp-smush-original\");\n\t\t\tvar resize_images = document.getElementById(\"wp-smush-resize\");\n\t\t\tvar smush_pngjpg = document.getElementById(\"wp-smush-png_to_jpg\");\n\n\t\t\tvar update_button_txt = true;\n\n\t\t\t$('.wp-smush-hex-notice').hide();\n\n\t\t\t//If Preserve Exif is Checked, and all other settings are off, just save the settings\n\t\t\tif ((keep_exif === null || keep_exif.checked) && (super_smush === null || !super_smush.checked) && (smush_original === null || !smush_original.checked) && (resize_images === null || !resize_images.checked) && (smush_pngjpg === null || !smush_pngjpg.checked)) {\n\t\t\t\tupdate_button_txt = false;\n\t\t\t}\n\n\t\t\t//Update text\n\t\t\tself.attr('disabled', 'disabled').addClass('button-grey');\n\n\t\t\tif (update_button_txt) {\n\t\t\t\tself.val(wp_smush_msgs.checking);\n\t\t\t}\n\n\t\t\t//Check if type is set in data attributes\n\t\t\tvar scan_type = self.data('type');\n\t\t\tscan_type = 'undefined' == typeof scan_type ? 'media' : scan_type;\n\n\t\t\t//Ajax param\n\t\t\tvar param = {\n\t\t\t\taction: 'scan_for_resmush',\n\t\t\t\twp_smush_options_nonce: jQuery('#wp_smush_options_nonce').val(),\n\t\t\t\tscan_type: scan_type\n\t\t\t};\n\n\t\t\tparam = jQuery.param(param) + '&' + jQuery('form#wp-smush-settings-form').serialize();\n\n\t\t\t//Send ajax, Update Settings, And Check For resmush\n\t\t\tjQuery.post(ajaxurl, param).done(function () {\n\t\t\t\tjQuery('form#wp-smush-settings-form').submit();\n\t\t\t\treturn true;\n\t\t\t});\n\t\t}\n\t});\n\n\t// On Resmush click.\n\t$('body').on('click', '.wp-smush-skip-resmush', function (e) {\n\t\te.preventDefault();\n\t\tvar self = jQuery(this);\n\t\tvar container = self.parents().eq(1);\n\n\t\t// Remove Parent div.\n\t\tvar $el = self.parent();\n\t\tremove_element($el);\n\n\t\t// Remove Settings Notice.\n\t\t$('.sui-notice-top.sui-notice-success').remove();\n\n\t\t// Set button attribute to skip re-smush ids.\n\t\tcontainer.find('.wp-smush-all').attr('data-smush', 'skip_resmush');\n\n\t\t// Update Smushed count.\n\t\twp_smushit_data.count_smushed = parseInt(wp_smushit_data.count_smushed) + wp_smushit_data.resmush.length;\n\t\twp_smushit_data.count_supersmushed = parseInt(wp_smushit_data.count_supersmushed) + wp_smushit_data.resmush.length;\n\n\t\t// Update Stats.\n\t\tif (wp_smushit_data.count_smushed == wp_smushit_data.count_total) {\n\n\t\t\t// Show all done notice.\n\t\t\t$('.wp-smush-notice.wp-smush-all-done, .wp-smush-pagespeed-recommendation').show();\n\n\t\t\t// Hide Smush button.\n\t\t\t$('.wp-smush-bulk-wrapper ').hide();\n\t\t}\n\t\t//Remove Re-Smush Notice\n\t\t$('.wp-smush-resmush-notice').remove();\n\n\t\tvar type = $('.wp-smush-scan').data('type');\n\t\ttype = 'undefined' == typeof type ? 'media' : type;\n\n\t\tvar smushed_count = 'undefined' != typeof wp_smushit_data.count_smushed ? wp_smushit_data.count_smushed : 0;\n\n\t\tvar smush_percent = smushed_count / wp_smushit_data.count_total * 100;\n\t\tsmush_percent = precise_round(smush_percent, 1);\n\n\t\t$('.wp-smush-images-percent').html(smush_percent);\n\n\t\t//Update the Progress Bar Width\n\t\t// get the progress bar\n\t\tvar $progress_bar = jQuery('.bulk-smush-wrapper .wp-smush-progress-inner');\n\t\tif ($progress_bar.length < 1) {\n\t\t\treturn;\n\t\t}\n\n\t\t// increase progress\n\t\t$progress_bar.css('width', smush_percent + '%');\n\n\t\t//Show the default bulk smush notice\n\t\t$('.wp-smush-bulk-wrapper').show();\n\t\t$('.wp-smush-bulk-wrapper .sui-notice').show();\n\n\t\tvar params = {\n\t\t\taction: 'delete_resmush_list',\n\t\t\ttype: type\n\t\t};\n\t\t//Delete resmush list, @todo: update stats from the ajax response\n\t\t$.post(ajaxurl, params, function (res) {\n\t\t\t//Remove the whole li element on success\n\t\t\tif (res.success && 'undefined' != typeof res.data.stats) {\n\t\t\t\tvar stats = res.data.stats;\n\t\t\t\t//Update wp_smushit_data ( Smushed count, Smushed Percent, Image count, Super smush count, resize savings, conversion savings )\n\t\t\t\tif ('undefinied' != typeof wp_smushit_data) {\n\t\t\t\t\twp_smushit_data.count_images = 'undefined' != typeof stats.count_images ? parseInt(wp_smushit_data.count_images) + stats.count_images : wp_smushit_data.count_images;\n\t\t\t\t\twp_smushit_data.size_before = 'undefined' != typeof stats.size_before ? parseInt(wp_smushit_data.size_before) + stats.size_before : wp_smushit_data.size_before;\n\t\t\t\t\twp_smushit_data.size_after = 'undefined' != typeof stats.size_after ? parseInt(wp_smushit_data.size_after) + stats.size_after : wp_smushit_data.size_after;\n\t\t\t\t\twp_smushit_data.savings_resize = 'undefined' != typeof stats.savings_resize ? parseInt(wp_smushit_data.savings_resize) + stats.savings_resize : wp_smushit_data.savings_resize;\n\t\t\t\t\twp_smushit_data.savings_conversion = 'undefined' != typeof stats.savings_conversion ? parseInt(wp_smushit_data.savings_conversion) + stats.savings_conversion : wp_smushit_data.savings_conversion;\n\t\t\t\t\t//Add directory smush stats\n\t\t\t\t\tif ('undefined' != typeof wp_smushit_data.savings_dir_smush && 'undefined' != typeof wp_smushit_data.savings_dir_smush.orig_size) {\n\t\t\t\t\t\twp_smushit_data.size_before = 'undefined' != typeof wp_smushit_data.savings_dir_smush ? parseInt(wp_smushit_data.size_before) + parseInt(wp_smushit_data.savings_dir_smush.orig_size) : wp_smushit_data.size_before;\n\t\t\t\t\t\twp_smushit_data.size_after = 'undefined' != typeof wp_smushit_data.savings_dir_smush ? parseInt(wp_smushit_data.size_after) + parseInt(wp_smushit_data.savings_dir_smush.image_size) : wp_smushit_data.size_after;\n\t\t\t\t\t}\n\n\t\t\t\t\twp_smushit_data.count_resize = 'undefined' != typeof stats.count_resize ? parseInt(wp_smushit_data.count_resize) + stats.count_resize : wp_smushit_data.count_resize;\n\t\t\t\t}\n\t\t\t\t//Smush Notice\n\t\t\t\tif ($('.bulk-smush-wrapper .wp-smush-remaining-count').length && 'undefined' != typeof wp_smushit_data.unsmushed) {\n\t\t\t\t\t$('.bulk-smush-wrapper .wp-smush-remaining-count').html(wp_smushit_data.unsmushed.length);\n\t\t\t\t}\n\t\t\t\tupdate_stats();\n\t\t\t}\n\t\t});\n\t});\n\n\t//Enable Super Smush\n\t$('a.wp-smush-lossy-enable').on('click', function (e) {\n\t\te.preventDefault();\n\n\t\t//Enable Super Smush\n\t\t$('#wp-smush-lossy').prop('checked', true).focus();\n\t\tgoToByScroll(\"#column-wp-smush-lossy\");\n\t});\n\n\t//Enable Resize\n\t$('.wp-smush-resize-enable').on('click', function (e) {\n\t\te.preventDefault();\n\n\t\t//Enable Resize, Show resize settings\n\t\t$('#wp-smush-resize').prop('checked', true).focus();\n\t\t$('div.wp-smush-resize-settings-wrap').show();\n\n\t\t//Scroll down to settings area\n\t\tgoToByScroll(\"#column-wp-smush-resize\");\n\t});\n\n\t//Trigger Bulk\n\t$('body').on('click', '.wp-smush-trigger-bulk', function (e) {\n\t\te.preventDefault();\n\t\t//Induce Setting button save click\n\t\t$('button.wp-smush-all').click();\n\t\t$('span.sui-notice-dismiss').click();\n\t});\n\n\t//Allow the checkboxes to be Keyboard Accessible\n\t$('.wp-smush-setting-row .toggle-checkbox').focus(function () {\n\t\t//If Space is pressed\n\t\t$(this).keypress(function (e) {\n\t\t\tif (e.keyCode == 32) {\n\t\t\t\te.preventDefault();\n\t\t\t\t$(this).find('.toggle-checkbox').click();\n\t\t\t}\n\t\t});\n\t});\n\n\t// Re-Validate Resize Width And Height.\n\t$('body').on('blur', '.wp-smush-resize-input', function () {\n\n\t\tvar self = $(this);\n\n\t\tvar wrapper_div = self.parents().eq(4);\n\n\t\t// Initiate the check.\n\t\tvalidate_resize_settings(wrapper_div, false, false); // run the validation.\n\t});\n\n\t// Handle Resize Checkbox toggle, to show/hide width, height settings.\n\t$('body').on('click', '#wp-smush-resize, #wp-smush-resize-quick-setup', function () {\n\t\tvar self = $(this);\n\t\tvar settings_wrap = $('.wp-smush-resize-settings-wrap');\n\n\t\tif (self.is(':checked')) {\n\t\t\tsettings_wrap.show();\n\t\t} else {\n\t\t\tsettings_wrap.hide();\n\t\t}\n\t});\n\n\t// Handle Automatic Smush Checkbox toggle, to show/hide image size settings.\n\t$('body').on('click', '#wp-smush-auto', function () {\n\t\tvar self = $(this);\n\t\tvar settings_wrap = $('.wp-smush-image-size-list');\n\n\t\tif (self.is(':checked')) {\n\t\t\tsettings_wrap.show();\n\t\t} else {\n\t\t\tsettings_wrap.hide();\n\t\t}\n\t});\n\n\t// Handle auto detect checkbox toggle, to show/hide highlighting notice.\n\t$('body').on('click', '#wp-smush-detection', function () {\n\t\tvar self = $(this);\n\t\tvar notice_wrap = $('.smush-highlighting-notice');\n\n\t\tif (self.is(':checked')) {\n\t\t\tnotice_wrap.show();\n\t\t} else {\n\t\t\tnotice_wrap.hide();\n\t\t}\n\t});\n\n\t// Handle PNG to JPG Checkbox toggle, to show/hide Transparent image conversion settings.\n\t$('#wp-smush-png_to_jpg').click(function () {\n\t\tvar self = $(this);\n\t\tvar settings_wrap = $('.wp-smush-png_to_jpg-wrap');\n\n\t\tif (self.is(':checked')) {\n\t\t\tsettings_wrap.show();\n\t\t} else {\n\t\t\tsettings_wrap.hide();\n\t\t}\n\t});\n\n\t//Handle, Change event in Enable Networkwide settings\n\t$('#wp-smush-networkwide').on('click', function (e) {\n\t\tif ($(this).is(':checked')) {\n\t\t\t$('.network-settings-wrapper').show();\n\t\t\t$('.sui-vertical-tabs li').not('.smush-bulk').each(function (n) {\n\t\t\t\t$(this).removeClass('sui-hidden');\n\t\t\t});\n\t\t} else {\n\t\t\t$('.network-settings-wrapper').hide();\n\t\t\t$('.sui-vertical-tabs li').not('.smush-bulk').each(function (n) {\n\t\t\t\t$(this).addClass('sui-hidden');\n\t\t\t});\n\t\t}\n\t});\n\n\t//Handle Twitter Share\n\t$('#wp-smush-twitter-share').on('click', function (e) {\n\t\te.preventDefault();\n\t\tvar url = this.href;\n\t\tvar text = removeSpan(url);\n\t\t//Update text in URL\n\t\turl = url.replace(/(text=)[^\\&]+/, '$1' + text);\n\t\tvar width = 550,\n\t\t    height = 420,\n\t\t    left = ($(window).width() - width) / 2,\n\t\t    top = ($(window).height() - height) / 2,\n\t\t    url = url,\n\t\t    opts = 'status=1' + ',width=' + width + ',height=' + height + ',top=' + top + ',left=' + left;\n\n\t\twindow.open(url, 'twitter', opts);\n\n\t\treturn false;\n\t});\n\n\t//Handle Facebook Share\n\t$('#wp-smush-facebook-share').on('click', function (e) {\n\t\te.preventDefault();\n\t\tvar width = 550,\n\t\t    height = 420,\n\t\t    left = ($(window).width() - width) / 2,\n\t\t    top = ($(window).height() - height) / 2,\n\t\t    url = this.href,\n\t\t    opts = 'status=1' + ',width=' + width + ',height=' + height + ',top=' + top + ',left=' + left;\n\n\t\twindow.open(url, 'facebook', opts);\n\n\t\treturn false;\n\t});\n\n\t//Handle Re-check button functionality\n\t$(\"#wp-smush-revalidate-member\").on('click', function (e) {\n\t\te.preventDefault();\n\t\t//Ajax Params\n\t\tvar params = {\n\t\t\taction: 'smush_show_warning'\n\t\t};\n\t\tvar link = $(this);\n\t\tvar parent = link.parents().eq(1);\n\t\tparent.addClass('loading-notice');\n\t\t$.get(ajaxurl, params, function (r) {\n\t\t\t//remove the warning\n\t\t\tparent.removeClass('loading-notice').addClass(\"loaded-notice\");\n\t\t\tif (0 == r) {\n\t\t\t\tparent.attr('data-message', wp_smush_msgs.membership_valid);\n\t\t\t\tremove_element(parent, 1000);\n\t\t\t} else {\n\t\t\t\tparent.attr('data-message', wp_smush_msgs.membership_invalid);\n\t\t\t\tsetTimeout(function remove_loader() {\n\t\t\t\t\tparent.removeClass('loaded-notice');\n\t\t\t\t}, 1000);\n\t\t\t}\n\t\t});\n\t});\n\n\t//Initiate Re-check if the variable is set\n\tif ('undefined' != typeof wp_smush_run_re_check && 1 == wp_smush_run_re_check && $('.wp-smush-scan').length > 0) {\n\t\t//Run the Re-check\n\t\trun_re_check($('.wp-smush-scan'), false);\n\t}\n\n\t//Stats Section Choose Directory Link\n\t$('body').on('click', 'a.wp-smush-dir-link', function (e) {\n\t\tif ($('div.sui-wrap button.wp-smush-browse').length > 0) {\n\t\t\te.preventDefault();\n\t\t\tSUI.dialogs[\"wp-smush-list-dialog\"].show();\n\t\t\t//Display the loader\n\t\t\t$('button.dir-smush-button-wrap span.spinner').addClass('is-active');\n\n\t\t\t//Display File tree for Directory Smush\n\t\t\t$(\".wp-smush-list-dialog .content\").fileTree({\n\t\t\t\tscript: getDirectoryList,\n\t\t\t\tmultiFolder: false\n\t\t\t}, function () {});\n\t\t}\n\t});\n\n\t//WP Smush all : Scan Images\n\t$('div.sui-wrap').on('click', 'button.wp-smush-browse', function (e) {\n\n\t\te.preventDefault();\n\n\t\t//Hide all the notices\n\t\t$('div.wp-smush-scan-result div.wp-smush-notice').hide();\n\n\t\t//If disabled, do not process\n\t\tif ($(this).attr('disabled')) {\n\t\t\treturn;\n\t\t} else {\n\t\t\t//Disable Buttons\n\t\t\t$(this).attr('disabled', 'disabled');\n\t\t\t$('button.wp-smush-resume').attr('disabled', 'disabled');\n\t\t\t$('div.dir-smush-button-wrap span.spinner').addClass('is-active');\n\t\t}\n\n\t\t//Remove Notice\n\t\t$('div.wp-smush-info').remove();\n\n\t\tshowDialog();\n\n\t\t//Display the loader\n\t\t$('button.dir-smush-button-wrap span.spinner').addClass('is-active');\n\n\t\t//Display File tree for Directory Smush\n\t\t$(\".wp-smush-list-dialog .content\").fileTree({\n\t\t\tscript: getDirectoryList,\n\t\t\tmultiFolder: false\n\t\t}, function () {});\n\t});\n\n\t// On dialog close make browse btutton active.\n\t$('.sui-dialog-close').on('click', function (e) {\n\t\t$('.wp-smush-browse').removeAttr('disabled');\n\t\tclose_dialog();\n\t});\n\n\t//Image Directories: On Select button click\n\t$('.wp-smush-select-dir').on('click', function (e) {\n\n\t\te.preventDefault();\n\n\t\t//If disabled, do not process\n\t\tif ($(this).attr('disabled')) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar button = $(this);\n\n\t\t$('div.wp-smush-list-dialog div.sui-box-body').css({ 'opacity': '0.8' });\n\t\t$('div.wp-smush-list-dialog div.sui-box-body a').unbind('click');\n\n\t\t//Remove resume button\n\t\t$('button.wp-smush-resume').remove();\n\n\t\t//Disable Button\n\t\tbutton.attr('disabled', 'disabled');\n\n\t\tvar spinner = button.parent().find('.add-dir-loader');\n\t\t//Display the spinner\n\t\tspinner.addClass('sui-icon-loader sui-loading');\n\n\t\t//Get the Selected directory path\n\t\tvar path = $('.jqueryFileTree .selected a').attr('rel');\n\t\tpath = 'undefined' == typeof path ? '' : path;\n\n\t\t//Absolute path\n\t\tvar abs_path = $('input[name=\"wp-smush-base-path\"]').val();\n\n\t\t//Fill in the input field\n\t\t$('.wp-smush-dir-path').val(abs_path + '/' + path);\n\n\t\t//Send a ajax request to get a list of all the image files\n\t\tvar param = {\n\t\t\taction: 'image_list',\n\t\t\tsmush_path: $('.wp-smush-dir-path').val(),\n\t\t\timage_list_nonce: $('input[name=\"image_list_nonce\"]').val()\n\t\t};\n\n\t\t//Get the List of images\n\t\t$.get(ajaxurl, param, function (res) {\n\t\t\tif (!res.success && 'undefined' !== typeof res.data.message) {\n\t\t\t\t$('div.wp-smush-scan-result div.content').html(res.data.message);\n\t\t\t} else {\n\t\t\t\t$('.wp-smush-scan-result .smush-dir-smush-done').addClass('sui-hidden');\n\t\t\t\t$('div.wp-smush-scan-result div.content').html(res.data);\n\t\t\t\twp_smush_dir_image_ids = res.data.ids;\n\t\t\t}\n\t\t\tset_accordion();\n\t\t\tclose_dialog();\n\n\t\t\t//Remove the spinner\n\t\t\tspinner.removeClass('sui-icon-loader sui-loading');\n\n\t\t\t//Show Scan result\n\t\t\t$('.wp-smush-scan-result').removeClass('sui-hidden').show();\n\t\t}).done(function (res) {\n\n\t\t\t// Show select directory button on top.\n\t\t\t$('div.sui-box-header button.wp-smush-browse').removeClass('sui-hidden');\n\n\t\t\t//If there was no image list, return\n\t\t\tif (!res.success) {\n\t\t\t\t//Hide the smush button\n\t\t\t\t$('div.wp-smush-all-button-wrap.bottom').addClass('sui-hidden');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t//Show the smush button\n\t\t\t$('div.wp-smush-all-button-wrap.bottom').removeClass('sui-hidden');\n\n\t\t\t//Remove disabled attribute for the button\n\t\t\t$('button.wp-smush-start').removeAttr('disabled');\n\n\t\t\t//Append a Directory browser button at the top\n\t\t\tadd_dir_browser_button();\n\n\t\t\t//Clone and add Smush button\n\t\t\tadd_smush_button();\n\n\t\t\twindow.location.hash = '#wp-smush-dir-browser';\n\t\t});\n\t});\n\n\t/**\n  * Handle the Smush Now button click\n  */\n\t$('#wp-smush-dir-wrap-box').on('click', 'button.wp-smush-start', function (e) {\n\t\te.preventDefault();\n\n\t\t//Check if we have images to be optimised\n\t\tif (!$('.wp-smush-image-ele:not(.optimised)').length) {\n\t\t\treturn;\n\t\t}\n\n\t\t//Disable this button\n\t\tvar button = $('.wp-smush-start');\n\t\tvar parent = button.parent();\n\n\t\t//Hide all the notices\n\t\t$('div.wp-smush-scan-result div.sui-notice').hide();\n\n\t\t//Set the button status to 0, to cancel next ajax request\n\t\t$('input[name=\"wp-smush-continue-ajax\"]').val(1);\n\n\t\t//Hide Directory browser button\n\t\t$('button.wp-smush-browse').hide();\n\n\t\t//Hide Exclude directory button link\n\t\t$('.wp-smush-exclude-dir').hide();\n\n\t\t/** All the Styling changes **/\n\t\tbutton.hide();\n\t\tparent.find('button.wp-smush-pause').removeClass('disabled sui-hidden').removeAttr('disabled');\n\n\t\t//Disable Select Directory button\n\t\t$('button.wp-smush-browse').attr('disabled', 'disabled');\n\n\t\t// Add progress icon to navbar.\n\t\t$('.smush-nav-icon.directory').addClass('sui-icon-loader sui-loading');\n\n\t\t//Initialize the optimisation\n\t\tsmush_all(true);\n\t});\n\n\t// Handle the Pause button click.\n\t$('div.wp-smush-scan-result').on('click', 'button.wp-smush-pause', function (e) {\n\t\te.preventDefault();\n\n\t\tvar pause_button = $('button.wp-smush-pause');\n\t\t// Return if the link is disabled.\n\t\tif (pause_button.hasClass('disabled')) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Set the button status to 0, to cancel next ajax request.\n\t\t$('input[name=\"wp-smush-continue-ajax\"]').val(0);\n\n\t\t// Enable the smush button, disable Pause button.\n\t\tpause_button.addClass('sui-hidden').attr('disabled', 'disabled');\n\n\t\t// Enable the smush button, hide the spinner.\n\t\t$('button.wp-smush-start, button.wp-smush-browse').show().removeAttr('disabled');\n\t\t$('span.wp-smush-image-dir-progress, span.wp-smush-image-ele-progress').removeClass('sui-icon-loader sui-loading');\n\n\t\t// Hide the waiting message.\n\t\t$('.wp-smush-image-progress-percent').addClass('sui-hidden');\n\n\t\t// Show directory exclude option.\n\t\t$('.wp-smush-exclude-dir').each(function () {\n\t\t\tif ($(this).parent().prevAll('.optimised, .partial').length === 0) {\n\t\t\t\t$(this).show();\n\t\t\t}\n\t\t});\n\n\t\t// Remove progress icon from navbar.\n\t\t$('.smush-nav-icon.directory').removeClass('sui-icon-loader sui-loading');\n\t});\n\n\t//Exclude Directory from list - Handle Click\n\t$('div.wp-smush-scan-result').on('click', '.wp-smush-exclude-dir', function (e) {\n\t\te.preventDefault();\n\n\t\tvar self = $(this);\n\n\t\t//Hide the link\n\t\t//self.hide();\n\n\t\tvar path = self.data('path');\n\t\tvar param = {\n\t\t\taction: 'smush_exclude_path',\n\t\t\tpath: path,\n\t\t\tnonce: $('input[name=\"exclude-path-nonce\"]').val()\n\t\t};\n\n\t\t//Send Ajax request to remove image for the given path from db\n\t\t$.post(ajaxurl, param, function (res) {\n\t\t\t//Remove the whole li element on success\n\t\t\tif (res.success) {\n\t\t\t\t// Remove content and parent rows.\n\t\t\t\tself.closest('tr.sui-accordion-item').remove();\n\t\t\t\tself.closest('tr.sui-accordion-item').next('tr.sui-accordion-item-content').remove();\n\n\t\t\t\t//Remove the bottom bulk smsuh button if there are no more directories left in scan results\n\t\t\t\tif (0 == $('.wp-smush-image-ele:not(.optimised)').length) {\n\t\t\t\t\t$('div.wp-smush-all-button-wrap.bottom').hide();\n\t\t\t\t\t$('div.wp-smush-scan-result').hide();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n\n\t//Handle Click for Resume Last scan button\n\t$('button.wp-smush-resume').on('click', function () {\n\n\t\tvar self = $(this);\n\n\t\t//Disable buttons\n\t\tdisable_buttons(self);\n\n\t\t//Show Spinner\n\t\t$('span.wp-smush-resume-loder').removeClass('sui-hidden');\n\n\t\tvar params = {\n\t\t\taction: 'resume_scan'\n\t\t};\n\n\t\t//Send Ajax request to load a list of images\n\t\t$.get(ajaxurl, params, function (r) {\n\n\t\t\t//Hide the buttons\n\t\t\t$('button.wp-smush-resume').remove();\n\t\t\t// Allow to select a new directory\n\t\t\t$('button.wp-smush-browse').removeAttr('disabled');\n\t\t\t//Append the results\n\t\t\tif (!r.success) {\n\t\t\t\t//Append the error message before the buttons\n\t\t\t\t$('div.wp-smush-dir-desc').after(r.data.message);\n\t\t\t} else {\n\t\t\t\t//Append the image markup after the buttons\n\t\t\t\t$('div.wp-smush-scan-result div.content').html(r.data);\n\t\t\t\t$('div.wp-smush-scan-result').removeClass('sui-hidden');\n\n\t\t\t\tset_accordion();\n\t\t\t}\n\t\t}).done(function () {\n\t\t\t//Add Choose dir browser button\n\t\t\tadd_dir_browser_button();\n\n\t\t\t//Clone and add Smush button\n\t\t\tadd_smush_button();\n\t\t});\n\t});\n\n\tif ($('li.smush-dir-savings').length > 0) {\n\t\t//Update Directory Smush, as soon as the page loads\n\t\tvar stats_param = {\n\t\t\taction: 'get_dir_smush_stats'\n\t\t};\n\t\t$.get(ajaxurl, stats_param, function (r) {\n\n\t\t\t//Hide the spinner\n\t\t\t$('li.smush-dir-savings .sui-icon-loader').hide();\n\n\t\t\t//If there are no errors, and we have a message to display\n\t\t\tif (!r.success && 'undefined' != typeof r.data.message) {\n\t\t\t\t$('div.wp-smush-scan-result div.content').prepend(r.data.message);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t//If there is no value in r\n\t\t\tif ('undefined' == typeof r.data || 'undefined' == typeof r.data.dir_smush) {\n\t\t\t\t//Append the text\n\t\t\t\t$('li.smush-dir-savings span.wp-smush-stats').append(wp_smush_msgs.ajax_error);\n\t\t\t\t$('li.smush-dir-savings span.wp-smush-stats span').hide();\n\t\t\t} else {\n\t\t\t\t//Update the stats\n\t\t\t\tupdate_cummulative_stats(r.data);\n\t\t\t}\n\t\t});\n\t}\n\t//Close Directory smush modal, if pressed esc\n\t$(document).keyup(function (e) {\n\t\tif (e.keyCode === 27) {\n\t\t\tvar modal = $('div.dev-overlay.wp-smush-list-dialog, div.dev-overlay.wp-smush-get-pro');\n\t\t\t//If the Directory dialog is not visible\n\t\t\tif (!modal.is(':visible')) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tmodal.find('div.close').click();\n\t\t}\n\t});\n\n\t//Quick Setup - Form Submit\n\t$('#smush-quick-setup-submit').on('click', function () {\n\t\tvar self = $(this);\n\t\tvar submit_button = self.find('button[type=\"submit\"]');\n\t\t$.ajax({\n\t\t\ttype: 'POST',\n\t\t\turl: ajaxurl,\n\t\t\tdata: $('#smush-quick-setup-form').serialize(),\n\t\t\tbeforeSend: function beforeSend() {\n\t\t\t\t//Show loader\n\n\t\t\t\t//Disable the button\n\t\t\t\tsubmit_button.attr('disabled', 'disabled');\n\n\t\t\t\t//Show loader\n\t\t\t\t$('<span class=\"sui-icon-loader sui-loading\"></span>').insertAfter(submit_button);\n\t\t\t},\n\t\t\tsuccess: function success(data) {\n\t\t\t\t//Enable the button\n\t\t\t\tsubmit_button.removeAttr('disabled');\n\t\t\t\t//Remove the loader\n\t\t\t\tsubmit_button.parent().find('span.spinner').remove();\n\n\t\t\t\tif (data.success == 1) {\n\t\t\t\t\t//remove skip button\n\t\t\t\t\t$('.smush-skip-setup').hide();\n\t\t\t\t}\n\t\t\t\t//Reload the Page\n\t\t\t\t//location.reload();\n\t\t\t}\n\t\t});\n\t\treturn false;\n\t});\n\t//Quick Setup - Skip button\n\t$('body').on('submit', '.smush-skip-setup', function () {\n\t\tvar self = $(this);\n\t\t$.ajax({\n\t\t\ttype: 'POST',\n\t\t\turl: ajaxurl,\n\t\t\tdata: self.serialize(),\n\t\t\tbeforeSend: function beforeSend() {\n\t\t\t\tself.find('.button').attr('disabled', 'disabled');\n\t\t\t},\n\t\t\tsuccess: function success(data) {\n\t\t\t\tlocation.reload();\n\t\t\t}\n\t\t});\n\t\treturn false;\n\t});\n\n\t//Dismiss Smush recommendation\n\t$('span.dismiss-recommendation').on('click', function (e) {\n\t\te.preventDefault();\n\t\tvar parent = $(this).parent();\n\t\t//remove div and save preference in db\n\t\tparent.hide('slow', function () {\n\t\t\tparent.remove();\n\t\t});\n\t\t$.ajax({\n\t\t\ttype: 'POST',\n\t\t\turl: ajaxurl,\n\t\t\tdata: {\n\t\t\t\t'action': 'hide_pagespeed_suggestion'\n\t\t\t}\n\t\t});\n\t});\n\n\t//Remove API message\n\t$('div.wp-smush-api-message i.icon-fi-close').on('click', function (e) {\n\t\te.preventDefault();\n\t\tvar parent = $(this).parent();\n\t\t//remove div and save preference in db\n\t\tparent.hide('slow', function () {\n\t\t\tparent.remove();\n\t\t});\n\t\t$.ajax({\n\t\t\ttype: 'POST',\n\t\t\turl: ajaxurl,\n\t\t\tdata: {\n\t\t\t\t'action': 'hide_api_message'\n\t\t\t}\n\t\t});\n\t});\n});\n(function ($) {\n\tvar Smush = function Smush(element, options) {\n\t\tvar elem = $(element);\n\n\t\tvar defaults = {\n\t\t\tisSingle: false,\n\t\t\tajaxurl: '',\n\t\t\tmsgs: {},\n\t\t\tmsgClass: 'wp-smush-msg',\n\t\t\tids: []\n\t\t};\n\t};\n\t$.fn.wpsmush = function (options) {\n\t\treturn this.each(function () {\n\t\t\tvar element = $(this);\n\n\t\t\t// Return early if this element already has a plugin instance\n\t\t\tif (element.data('wpsmush')) return;\n\n\t\t\t// pass options to plugin constructor and create a new instance\n\t\t\tvar wpsmush = new Smush(this, options);\n\n\t\t\t// Store plugin object in this element's data\n\t\t\telement.data('wpsmush', wpsmush);\n\t\t});\n\t};\n})(jQuery);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9fc3JjL2pzL21vZHVsZXMvYWRtaW4uanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9fc3JjL2pzL21vZHVsZXMvYWRtaW4uanM/YmY4ZSJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTtcblxuLyoqXG4gKiBQcm9jZXNzZXMgYnVsayBzbXVzaGluZ1xuICpcbiAqIEBhdXRob3IgVW1lc2ggS3VtYXIgPHVtZXNoc2luZ2xhMDVAZ21haWwuY29tPlxuICpcbiAqIFRPRE86IFVzZSBFbGVtZW50IHRhZyBmb3IgYWxsIHRoZSBjbGFzcyBzZWxlY3RvcnNcbiAqL1xudmFyIFdQX1NtdXNoID0gV1BfU211c2ggfHwge307XG5cbi8qKlxuICogU211c2ggdHJhbnNsYXRpb24gc3RyaW5ncy5cbiAqXG4gKiBAdmFyIHthcnJheX0gd3Bfc211c2hfbXNnc1xuICovXG5pZiAod3Bfc211c2hfbXNncykge1xuXHR2YXIgX3dwX3NtdXNoX21zZ3MgPSBfd3Bfc211c2hfbXNncztcbn1cblxuLyoqXG4gKiBTaG93L2hpZGUgdGhlIHByb2dyZXNzIGJhciBmb3IgU211c2hpbmcvUmVzdG9yZS9TdXBlclNtdXNoXG4gKlxuICogQHBhcmFtIGN1cl9lbGVcbiAqIEBwYXJhbSB0eHQgTWVzc2FnZSB0byBiZSBkaXNwbGF5ZWRcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdGF0ZSBzaG93L2hpZGVcbiAqL1xudmFyIHByb2dyZXNzX2JhciA9IGZ1bmN0aW9uIHByb2dyZXNzX2JhcihjdXJfZWxlLCB0eHQsIHN0YXRlKSB7XG5cdC8vVXBkYXRlIFByb2dyZXNzIGJhciB0ZXh0IGFuZCBzaG93IGl0XG5cdHZhciBwcm9ncmVzc19idXR0b24gPSBjdXJfZWxlLnBhcmVudHMoKS5lcSgxKS5maW5kKCcud3Atc211c2gtcHJvZ3Jlc3MnKTtcblxuXHRpZiAoJ3Nob3cnID09PSBzdGF0ZSkge1xuXHRcdHByb2dyZXNzX2J1dHRvbi5maW5kKCdzcGFuJykuaHRtbCh0eHQpO1xuXHRcdHByb2dyZXNzX2J1dHRvbi5yZW1vdmVDbGFzcygnc3VpLWhpZGRlbicpO1xuXHR9IGVsc2Uge1xuXHRcdC8qKiBAdmFyIHtzdHJpbmd9IHdwX3NtdXNoX21zZ3MuYWxsX2RvbmUgKi9cblx0XHRwcm9ncmVzc19idXR0b24uZmluZCgnc3BhbicpLmh0bWwod3Bfc211c2hfbXNncy5hbGxfZG9uZSk7XG5cdFx0cHJvZ3Jlc3NfYnV0dG9uLmhpZGUoKTtcblx0fVxufTtcblxuLyoqXG4gKiBDaGVjayBtZW1iZXJzaGlwIHZhbGlkaXR5XG4gKlxuICogQHBhcmFtIHtpbnR9IGRhdGEuc2hvd193YXJuaW5nXG4gKi9cbnZhciBtZW1iZXJzaGlwX3ZhbGlkaXR5ID0gZnVuY3Rpb24gbWVtYmVyc2hpcF92YWxpZGl0eShkYXRhKSB7XG5cdHZhciBtZW1iZXJfdmFsaWRpdHlfbm90aWNlID0galF1ZXJ5KCcjd3Atc211c2gtaW52YWxpZC1tZW1iZXInKTtcblxuXHQvL0NoZWNrIGZvciBNZW1iZXJzaGlwIHdhcm5pbmdcblxuXHRpZiAoJ3VuZGVmaW5lZCcgIT09IHR5cGVvZiBkYXRhICYmICd1bmRlZmluZWQnICE9PSB0eXBlb2YgZGF0YS5zaG93X3dhcm5pbmcgJiYgbWVtYmVyX3ZhbGlkaXR5X25vdGljZS5sZW5ndGggPiAwKSB7XG5cdFx0aWYgKGRhdGEuc2hvd193YXJuaW5nKSB7XG5cdFx0XHRtZW1iZXJfdmFsaWRpdHlfbm90aWNlLnNob3coKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0bWVtYmVyX3ZhbGlkaXR5X25vdGljZS5oaWRlKCk7XG5cdFx0fVxuXHR9XG59O1xuXG52YXIgcmVtb3ZlX2VsZW1lbnQgPSBmdW5jdGlvbiByZW1vdmVfZWxlbWVudChlbCwgdGltZW91dCkge1xuXHRpZiAodHlwZW9mIHRpbWVvdXQgPT09ICd1bmRlZmluZWQnKSB7XG5cdFx0dGltZW91dCA9IDEwMDtcblx0fVxuXHRlbC5mYWRlVG8odGltZW91dCwgMCwgZnVuY3Rpb24gKCkge1xuXHRcdGVsLnNsaWRlVXAodGltZW91dCwgZnVuY3Rpb24gKCkge1xuXHRcdFx0ZWwucmVtb3ZlKCk7XG5cdFx0fSk7XG5cdH0pO1xufTtcblxualF1ZXJ5KGZ1bmN0aW9uICgkKSB7XG5cdCd1c2Ugc3RyaWN0JztcblxuXHQvKipcbiAgKiBSZW1vdmUgdGhlIHF1aWNrIHNldHVwIGRpYWxvZ1xuICAqL1xuXG5cdGZ1bmN0aW9uIHJlbW92ZV9kaWFsb2coKSB7XG5cdFx0JCgnZGlhbG9nI3NtdXNoLXF1aWNrLXNldHVwJykucmVtb3ZlKCk7XG5cdH1cblxuXHQvKipcbiAgKiBVcGRhdGUgaW1hZ2Ugc2l6ZSBpbiBhdHRhY2htZW50IGluZm8gcGFuZWwuXG4gICpcbiAgKiBAc2luY2UgMi44XG4gICpcbiAgKiBAcGFyYW0gbmV3X3NpemVcbiAgKi9cblx0ZnVuY3Rpb24gdXBkYXRlX2ltYWdlX3N0YXRzKG5ld19zaXplKSB7XG5cdFx0aWYgKDAgPT09IG5ld19zaXplKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dmFyIGF0dGFjaG1lbnRTaXplID0gJCgnLmF0dGFjaG1lbnQtaW5mbyAuZmlsZS1zaXplJyk7XG5cdFx0dmFyIGN1cnJlbnRTaXplID0gYXR0YWNobWVudFNpemUuY29udGVudHMoKS5maWx0ZXIoZnVuY3Rpb24gKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMubm9kZVR5cGUgPT09IDM7XG5cdFx0fSkudGV4dCgpO1xuXG5cdFx0Ly8gVGhlcmUgaXMgYSBzcGFjZSBiZWZvcmUgdGhlIHNpemUuXG5cdFx0aWYgKGN1cnJlbnRTaXplICE9PSAnICcgKyBuZXdfc2l6ZSkge1xuXHRcdFx0dmFyIHNpemVTdHJvbmdFbCA9IGF0dGFjaG1lbnRTaXplLmNvbnRlbnRzKCkuZmlsdGVyKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMubm9kZVR5cGUgPT09IDE7XG5cdFx0XHR9KS50ZXh0KCk7XG5cdFx0XHRhdHRhY2htZW50U2l6ZS5odG1sKCc8c3Ryb25nPicgKyBzaXplU3Ryb25nRWwgKyAnPC9zdHJvbmc+ICcgKyBuZXdfc2l6ZSk7XG5cdFx0fVxuXHR9XG5cblx0Ly8gU2hvdyB0aGUgUXVpY2sgU2V0dXAgZGlhbG9nLlxuXHRpZiAoJCgnI3NtdXNoLXF1aWNrLXNldHVwJykuc2l6ZSgpID4gMCkge1xuXHRcdC8qKiBAdmFyIHtzdHJpbmd9IHdwX3NtdXNoX21zZ3MucXVpY2tfc2V0dXBfdGl0bGUgKi9cblx0XHRXRFAuc2hvd092ZXJsYXkoXCIjc211c2gtcXVpY2stc2V0dXBcIiwge1xuXHRcdFx0dGl0bGU6IHdwX3NtdXNoX21zZ3MucXVpY2tfc2V0dXBfdGl0bGUsXG5cdFx0XHRjbGFzczogJ25vLWNsb3NlIHdwLXNtdXNoLW92ZXJsYXkgd3Atc211c2gtcXVpY2stc2V0dXAnXG5cdFx0fSk7XG5cdFx0cmVtb3ZlX2RpYWxvZygpO1xuXHR9XG5cblx0dmFyIHNtdXNoQWRkUGFyYW1zID0gZnVuY3Rpb24gc211c2hBZGRQYXJhbXModXJsLCBkYXRhKSB7XG5cdFx0aWYgKCEkLmlzRW1wdHlPYmplY3QoZGF0YSkpIHtcblx0XHRcdHVybCArPSAodXJsLmluZGV4T2YoJz8nKSA+PSAwID8gJyYnIDogJz8nKSArICQucGFyYW0oZGF0YSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHVybDtcblx0fTtcblxuXHQvLyB1cmwgZm9yIHNtdXNoaW5nXG5cdFdQX1NtdXNoLmVycm9ycyA9IFtdO1xuXG5cdC8qKiBAdmFyIHthcnJheX0gd3Bfc211c2hpdF9kYXRhICovXG5cdFdQX1NtdXNoLnRpbWVvdXQgPSB3cF9zbXVzaGl0X2RhdGEudGltZW91dDtcblxuXHQvKipcbiAgKiBDaGVja3MgZm9yIHRoZSBzcGVjaWZpZWQgcGFyYW0gaW4gVVJMXG4gICogQHBhcmFtIGFyZ1xuICAqIEByZXR1cm5zIHsqfVxuICAqL1xuXHRXUF9TbXVzaC5nZXR1cmxwYXJhbSA9IGZ1bmN0aW9uIChhcmcpIHtcblx0XHR2YXIgJHNQYWdlVVJMID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC5zdWJzdHJpbmcoMSk7XG5cdFx0dmFyICRzVVJMVmFyaWFibGVzID0gJHNQYWdlVVJMLnNwbGl0KCcmJyk7XG5cblx0XHRmb3IgKHZhciBpID0gMDsgaSA8ICRzVVJMVmFyaWFibGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR2YXIgJHNQYXJhbWV0ZXJOYW1lID0gJHNVUkxWYXJpYWJsZXNbaV0uc3BsaXQoJz0nKTtcblx0XHRcdGlmICgkc1BhcmFtZXRlck5hbWVbMF0gPT0gYXJnKSB7XG5cdFx0XHRcdHJldHVybiAkc1BhcmFtZXRlck5hbWVbMV07XG5cdFx0XHR9XG5cdFx0fVxuXHR9O1xuXG5cdFdQX1NtdXNoLlNtdXNoID0gZnVuY3Rpb24gKCRidXR0b24sIGJ1bGssIHNtdXNoX3R5cGUpIHtcblx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0dmFyIHNraXBfcmVzbXVzaCA9ICRidXR0b24uZGF0YSgnc211c2gnKTtcblx0XHQvL0lmIHNtdXNoIGF0dHJpYnV0ZSBpcyBub3QgZGVmaW5lZCwgTmVlZCBub3Qgc2tpcCByZXNtdXNoIGlkc1xuXHRcdHNraXBfcmVzbXVzaCA9ICh0eXBlb2Ygc2tpcF9yZXNtdXNoID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihza2lwX3Jlc211c2gpKSA9PSAodHlwZW9mIHVuZGVmaW5lZCA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YodW5kZWZpbmVkKSkgfHwgc2tpcF9yZXNtdXNoID09IGZhbHNlID8gZmFsc2UgOiB0cnVlO1xuXG5cdFx0dGhpcy5pbml0ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0dGhpcy4kYnV0dG9uID0gJCgkYnV0dG9uWzBdKTtcblx0XHRcdHRoaXMuaXNfYnVsayA9ICh0eXBlb2YgYnVsayA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YoYnVsaykpID8gYnVsayA6IGZhbHNlO1xuXHRcdFx0dGhpcy51cmwgPSBhamF4dXJsO1xuXHRcdFx0dGhpcy4kbG9nID0gJChcIi5zbXVzaC1maW5hbC1sb2dcIik7XG5cdFx0XHR0aGlzLmRlZmVycmVkID0galF1ZXJ5LkRlZmVycmVkKCk7XG5cdFx0XHR0aGlzLmRlZmVycmVkLmVycm9ycyA9IFtdO1xuXG5cdFx0XHR2YXIgaWRzID0gd3Bfc211c2hpdF9kYXRhLnJlc211c2gubGVuZ3RoID4gMCAmJiAhc2tpcF9yZXNtdXNoID8gd3Bfc211c2hpdF9kYXRhLnVuc211c2hlZC5sZW5ndGggPiAwID8gd3Bfc211c2hpdF9kYXRhLnJlc211c2guY29uY2F0KHdwX3NtdXNoaXRfZGF0YS51bnNtdXNoZWQpIDogd3Bfc211c2hpdF9kYXRhLnJlc211c2ggOiB3cF9zbXVzaGl0X2RhdGEudW5zbXVzaGVkO1xuXHRcdFx0aWYgKCdvYmplY3QnID09ICh0eXBlb2YgaWRzID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihpZHMpKSkge1xuXHRcdFx0XHQvL0lmIGJ1dHRvbiBoYXMgcmVzbXVzaCBjbGFzcywgYW5kIHdlIGRvIGhhdmUgaWRzIHRoYXQgbmVlZHMgdG8gcmVzbXVzaGVkLCBwdXQgdGhlbSBpbiB0aGUgbGlzdFxuXHRcdFx0XHR0aGlzLmlkcyA9IGlkcy5maWx0ZXIoZnVuY3Rpb24gKGl0bSwgaSwgYSkge1xuXHRcdFx0XHRcdHJldHVybiBpID09IGEuaW5kZXhPZihpdG0pO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuaWRzID0gaWRzO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLmlzX2J1bGtfcmVzbXVzaCA9IHdwX3NtdXNoaXRfZGF0YS5yZXNtdXNoLmxlbmd0aCA+IDAgJiYgIXNraXBfcmVzbXVzaCA/IHRydWUgOiBmYWxzZTtcblxuXHRcdFx0dGhpcy4kc3RhdHVzID0gdGhpcy4kYnV0dG9uLnBhcmVudCgpLmZpbmQoJy5zbXVzaC1zdGF0dXMnKTtcblxuXHRcdFx0Ly9BZGRlZCBmb3IgTmV4dEdlbiBzdXBwb3J0XG5cdFx0XHR0aGlzLnNtdXNoX3R5cGUgPSAndW5kZWZpbmVkJyAhPSB0eXBlb2Ygc211c2hfdHlwZSA/IHNtdXNoX3R5cGUgOiAnbWVkaWEnO1xuXHRcdFx0dGhpcy5zaW5nbGVfYWpheF9zdWZmaXggPSAnbmV4dGdlbicgPT0gdGhpcy5zbXVzaF90eXBlID8gJ3NtdXNoX21hbnVhbF9uZXh0Z2VuJyA6ICd3cF9zbXVzaGl0X21hbnVhbCc7XG5cdFx0XHR0aGlzLmJ1bGtfYWpheF9zdWZmaXggPSAnbmV4dGdlbicgPT0gdGhpcy5zbXVzaF90eXBlID8gJ3dwX3NtdXNoaXRfbmV4dGdlbl9idWxrJyA6ICd3cF9zbXVzaGl0X2J1bGsnO1xuXHRcdFx0dGhpcy51cmwgPSB0aGlzLmlzX2J1bGsgPyBzbXVzaEFkZFBhcmFtcyh0aGlzLnVybCwgeyBhY3Rpb246IHRoaXMuYnVsa19hamF4X3N1ZmZpeCB9KSA6IHNtdXNoQWRkUGFyYW1zKHRoaXMudXJsLCB7IGFjdGlvbjogdGhpcy5zaW5nbGVfYWpheF9zdWZmaXggfSk7XG5cdFx0fTtcblxuXHRcdC8qKiBTZW5kIEFqYXggcmVxdWVzdCBmb3Igc211c2hpbmcgdGhlIGltYWdlICoqL1xuXHRcdFdQX1NtdXNoLmFqYXggPSBmdW5jdGlvbiAoaXNfYnVsa19yZXNtdXNoLCAkaWQsICRzZW5kX3VybCwgJGdldG54dCwgbm9uY2UpIHtcblx0XHRcdFwidXNlIHN0cmljdFwiO1xuXG5cdFx0XHR2YXIgcGFyYW0gPSB7XG5cdFx0XHRcdGlzX2J1bGtfcmVzbXVzaDogaXNfYnVsa19yZXNtdXNoLFxuXHRcdFx0XHRhdHRhY2htZW50X2lkOiAkaWQsXG5cdFx0XHRcdGdldF9uZXh0OiAkZ2V0bnh0LFxuXHRcdFx0XHRfbm9uY2U6IG5vbmNlXG5cdFx0XHR9O1xuXHRcdFx0cGFyYW0gPSBqUXVlcnkucGFyYW0ocGFyYW0pO1xuXHRcdFx0cmV0dXJuICQuYWpheCh7XG5cdFx0XHRcdHR5cGU6IFwiR0VUXCIsXG5cdFx0XHRcdGRhdGE6IHBhcmFtLFxuXHRcdFx0XHR1cmw6ICRzZW5kX3VybCxcblx0XHRcdFx0dGltZW91dDogV1BfU211c2gudGltZW91dCxcblx0XHRcdFx0ZGF0YVR5cGU6ICdqc29uJ1xuXHRcdFx0fSk7XG5cdFx0fTtcblxuXHRcdC8vU2hvdyBsb2FkZXIgaW4gYnV0dG9uIGZvciBzaW5nbGUgYW5kIGJ1bGsgc211c2hcblx0XHR0aGlzLnN0YXJ0ID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0XHR0aGlzLiRidXR0b24uYXR0cignZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcblx0XHRcdHRoaXMuJGJ1dHRvbi5hZGRDbGFzcygnd3Atc211c2gtc3RhcnRlZCcpO1xuXG5cdFx0XHR0aGlzLmJ1bGtfc3RhcnQoKTtcblx0XHRcdHRoaXMuc2luZ2xlX3N0YXJ0KCk7XG5cdFx0fTtcblxuXHRcdHRoaXMuYnVsa19zdGFydCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdGlmICghdGhpcy5pc19idWxrKSByZXR1cm47XG5cblx0XHRcdC8vSGlkZSB0aGUgQnVsayBEaXZcblx0XHRcdCQoJy53cC1zbXVzaC1idWxrLXdyYXBwZXInKS5oaWRlKCk7XG5cblx0XHRcdC8vU2hvdyB0aGUgUHJvZ3Jlc3MgQmFyXG5cdFx0XHQkKCcuYnVsay1zbXVzaC13cmFwcGVyIC53cC1zbXVzaC1idWxrLXByb2dyZXNzLWJhci13cmFwcGVyJykuc2hvdygpO1xuXG5cdFx0XHQvL1JlbW92ZSBhbnkgR2xvYmFsIE5vdGljZXMgaWYgdGhlcmVcblx0XHRcdCQoJy5zdWktbm90aWNlLXRvcCcpLnJlbW92ZSgpO1xuXG5cdFx0XHQvL0hpZGUgdGhlIEJ1bGsgTGltaXQgbWVzc2FnZVxuXHRcdFx0JCgncC5zbXVzaC1lcnJvci1tZXNzYWdlLmxpbWl0X2V4Y2VlZGVkJykucmVtb3ZlKCk7XG5cdFx0XHQvL0hpZGUgcGFyZW50IHdyYXBwZXIsIGlmIHRoZXJlIGFyZSBubyBvdGhlciBtZXNzYWdlc1xuXHRcdFx0aWYgKCQoJ2Rpdi5zbXVzaC1maW5hbC1sb2cgcCcpLmxlbmd0aCA8PSAwKSB7XG5cdFx0XHRcdCQoJ2Rpdi5zbXVzaC1maW5hbC1sb2cnKS5oaWRlKCk7XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdHRoaXMuc2luZ2xlX3N0YXJ0ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0aWYgKHRoaXMuaXNfYnVsaykgcmV0dXJuO1xuXHRcdFx0dGhpcy5zaG93X2xvYWRlcigpO1xuXHRcdFx0dGhpcy4kc3RhdHVzLnJlbW92ZUNsYXNzKFwiZXJyb3JcIik7XG5cdFx0fTtcblxuXHRcdHRoaXMuZW5hYmxlX2J1dHRvbiA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdHRoaXMuJGJ1dHRvbi5wcm9wKFwiZGlzYWJsZWRcIiwgZmFsc2UpO1xuXHRcdFx0Ly9Gb3IgQnVsayBwcm9jZXNzLCBFbmFibGUgb3RoZXIgYnV0dG9uc1xuXHRcdFx0JCgnYnV0dG9uLndwLXNtdXNoLWFsbCcpLnJlbW92ZUF0dHIoJ2Rpc2FibGVkJyk7XG5cdFx0XHQkKCdidXR0b24ud3Atc211c2gtc2NhbiwgYS53cC1zbXVzaC1sb3NzeS1lbmFibGUsIGJ1dHRvbi53cC1zbXVzaC1yZXNpemUtZW5hYmxlLCBpbnB1dCN3cC1zbXVzaC1zYXZlLXNldHRpbmdzJykucmVtb3ZlQXR0cignZGlzYWJsZWQnKTtcblx0XHR9O1xuXG5cdFx0dGhpcy5zaG93X2xvYWRlciA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdHByb2dyZXNzX2Jhcih0aGlzLiRidXR0b24sIHdwX3NtdXNoX21zZ3Muc211c2hpbmcsICdzaG93Jyk7XG5cdFx0fTtcblxuXHRcdHRoaXMuaGlkZV9sb2FkZXIgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRwcm9ncmVzc19iYXIodGhpcy4kYnV0dG9uLCB3cF9zbXVzaF9tc2dzLnNtdXNoaW5nLCAnaGlkZScpO1xuXHRcdH07XG5cblx0XHR0aGlzLnNpbmdsZV9kb25lID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0aWYgKHRoaXMuaXNfYnVsaykgcmV0dXJuO1xuXG5cdFx0XHR0aGlzLmhpZGVfbG9hZGVyKCk7XG5cblx0XHRcdHRoaXMucmVxdWVzdC5kb25lKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXHRcdFx0XHRpZiAodHlwZW9mIHJlc3BvbnNlLmRhdGEgIT0gJ3VuZGVmaW5lZCcpIHtcblxuXHRcdFx0XHRcdC8vIENoZWNrIGlmIHN0YXRzIGRpdiBleGlzdHMuXG5cdFx0XHRcdFx0dmFyIHBhcmVudCA9IHNlbGYuJHN0YXR1cy5wYXJlbnQoKTtcblx0XHRcdFx0XHR2YXIgc3RhdHNfZGl2ID0gcGFyZW50LmZpbmQoJy5zbXVzaC1zdGF0cy13cmFwcGVyJyk7XG5cblx0XHRcdFx0XHQvLyBJZiB3ZSd2ZSB1cGRhdGVkIHN0YXR1cywgcmVwbGFjZSB0aGUgY29udGVudC5cblx0XHRcdFx0XHRpZiAocmVzcG9uc2UuZGF0YS5zdGF0dXMpIHtcblx0XHRcdFx0XHRcdC8vcmVtb3ZlIExpbmtzXG5cdFx0XHRcdFx0XHRwYXJlbnQuZmluZCgnLnNtdXNoLXN0YXR1cy1saW5rcycpLnJlbW92ZSgpO1xuXHRcdFx0XHRcdFx0c2VsZi4kc3RhdHVzLnJlcGxhY2VXaXRoKHJlc3BvbnNlLmRhdGEuc3RhdHVzKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBDaGVjayB3aGV0aGVyIHRvIHNob3cgbWVtYmVyc2hpcCB2YWxpZGl0eSBub3RpY2Ugb3Igbm90LlxuXHRcdFx0XHRcdG1lbWJlcnNoaXBfdmFsaWRpdHkocmVzcG9uc2UuZGF0YSk7XG5cblx0XHRcdFx0XHRpZiAocmVzcG9uc2Uuc3VjY2VzcyAmJiByZXNwb25zZS5kYXRhICE9PSBcIk5vdCBwcm9jZXNzZWRcIikge1xuXHRcdFx0XHRcdFx0c2VsZi4kc3RhdHVzLnJlbW92ZUNsYXNzKCdzdWktaGlkZGVuJyk7XG5cdFx0XHRcdFx0XHRzZWxmLiRidXR0b24ucGFyZW50KCkucmVtb3ZlQ2xhc3MoJ3Vuc211c2hlZCcpLmFkZENsYXNzKCdzbXVzaGVkJyk7XG5cdFx0XHRcdFx0XHRzZWxmLiRidXR0b24ucmVtb3ZlKCk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHNlbGYuJHN0YXR1cy5hZGRDbGFzcyhcImVycm9yXCIpO1xuXHRcdFx0XHRcdFx0c2VsZi4kc3RhdHVzLmh0bWwocmVzcG9uc2UuZGF0YS5lcnJvcl9tc2cpO1xuXHRcdFx0XHRcdFx0c2VsZi4kc3RhdHVzLnNob3coKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKCd1bmRlZmluZWQnICE9IHN0YXRzX2RpdiAmJiBzdGF0c19kaXYubGVuZ3RoKSB7XG5cdFx0XHRcdFx0XHRzdGF0c19kaXYucmVwbGFjZVdpdGgocmVzcG9uc2UuZGF0YS5zdGF0cyk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHBhcmVudC5hcHBlbmQocmVzcG9uc2UuZGF0YS5zdGF0cyk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gVXBkYXRlIGltYWdlIHNpemUgaW4gYXR0YWNobWVudCBpbmZvIHBhbmVsLlxuXHRcdFx0XHRcdHVwZGF0ZV9pbWFnZV9zdGF0cyhyZXNwb25zZS5kYXRhLm5ld19zaXplKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRzZWxmLmVuYWJsZV9idXR0b24oKTtcblx0XHRcdH0pLmVycm9yKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXHRcdFx0XHRzZWxmLiRzdGF0dXMuaHRtbChyZXNwb25zZS5kYXRhKTtcblx0XHRcdFx0c2VsZi4kc3RhdHVzLmFkZENsYXNzKFwiZXJyb3JcIik7XG5cdFx0XHRcdHNlbGYuZW5hYmxlX2J1dHRvbigpO1xuXHRcdFx0fSk7XG5cdFx0fTtcblxuXHRcdHRoaXMuc3luY19zdGF0cyA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdHZhciBtZXNzYWdlX2hvbGRlciA9ICQoJ2Rpdi53cC1zbXVzaC1idWxrLXByb2dyZXNzLWJhci13cmFwcGVyIGRpdi53cC1zbXVzaC1jb3VudC50YycpO1xuXHRcdFx0Ly9TdG9yZSB0aGUgZXhpc3RpbmcgY29udGVudCBpbiBhIHZhcmlhYmxlXG5cdFx0XHR2YXIgcHJvZ3Jlc3NfbWVzc2FnZSA9IG1lc3NhZ2VfaG9sZGVyLmh0bWwoKTtcblx0XHRcdG1lc3NhZ2VfaG9sZGVyLmh0bWwod3Bfc211c2hfbXNncy5zeW5jX3N0YXRzKTtcblxuXHRcdFx0Ly9TZW5kIGFqYXhcblx0XHRcdCQuYWpheCh7XG5cdFx0XHRcdHR5cGU6IFwiR0VUXCIsXG5cdFx0XHRcdHVybDogYWpheHVybCxcblx0XHRcdFx0ZGF0YToge1xuXHRcdFx0XHRcdCdhY3Rpb24nOiAnZ2V0X3N0YXRzJ1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiBzdWNjZXNzKHJlc3BvbnNlKSB7XG5cdFx0XHRcdFx0aWYgKHJlc3BvbnNlICYmICd1bmRlZmluZWQnICE9IHR5cGVvZiByZXNwb25zZSkge1xuXHRcdFx0XHRcdFx0cmVzcG9uc2UgPSByZXNwb25zZS5kYXRhO1xuXHRcdFx0XHRcdFx0JC5leHRlbmQod3Bfc211c2hpdF9kYXRhLCB7XG5cdFx0XHRcdFx0XHRcdGNvdW50X2ltYWdlczogcmVzcG9uc2UuY291bnRfaW1hZ2VzLFxuXHRcdFx0XHRcdFx0XHRjb3VudF9zbXVzaGVkOiByZXNwb25zZS5jb3VudF9zbXVzaGVkLFxuXHRcdFx0XHRcdFx0XHRjb3VudF90b3RhbDogcmVzcG9uc2UuY291bnRfdG90YWwsXG5cdFx0XHRcdFx0XHRcdGNvdW50X3Jlc2l6ZTogcmVzcG9uc2UuY291bnRfcmVzaXplLFxuXHRcdFx0XHRcdFx0XHRjb3VudF9zdXBlcnNtdXNoZWQ6IHJlc3BvbnNlLmNvdW50X3N1cGVyc211c2hlZCxcblx0XHRcdFx0XHRcdFx0c2F2aW5nc19ieXRlczogcmVzcG9uc2Uuc2F2aW5nc19ieXRlcyxcblx0XHRcdFx0XHRcdFx0c2F2aW5nc19jb252ZXJzaW9uOiByZXNwb25zZS5zYXZpbmdzX2NvbnZlcnNpb24sXG5cdFx0XHRcdFx0XHRcdHNhdmluZ3NfcmVzaXplOiByZXNwb25zZS5zYXZpbmdzX3Jlc2l6ZSxcblx0XHRcdFx0XHRcdFx0c2l6ZV9iZWZvcmU6IHJlc3BvbnNlLnNpemVfYmVmb3JlLFxuXHRcdFx0XHRcdFx0XHRzaXplX2FmdGVyOiByZXNwb25zZS5zaXplX2FmdGVyXG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdC8vR290IHRoZSBzdGF0cywgVXBkYXRlIGl0XG5cdFx0XHRcdFx0XHR1cGRhdGVfc3RhdHModGhpcy5zbXVzaF90eXBlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0pLmFsd2F5cyhmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdG1lc3NhZ2VfaG9sZGVyLmh0bWwocHJvZ3Jlc3NfbWVzc2FnZSk7XG5cdFx0XHR9KTtcblx0XHR9O1xuXG5cdFx0LyoqIEFmdGVyIHRoZSBCdWxrIFNtdXNoaW5nIGhhcyBiZWVuIEZpbmlzaGVkICoqL1xuXHRcdHRoaXMuYnVsa19kb25lID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0aWYgKCF0aGlzLmlzX2J1bGspIHJldHVybjtcblxuXHRcdFx0Ly9FbmFibGUgdGhlIGJ1dHRvblxuXHRcdFx0dGhpcy5lbmFibGVfYnV0dG9uKCk7XG5cblx0XHRcdC8vU2hvdyBOb3RpY2Vcblx0XHRcdGlmIChzZWxmLmlkcy5sZW5ndGggPT0gMCkge1xuXHRcdFx0XHQkKCcuYnVsay1zbXVzaC13cmFwcGVyIC53cC1zbXVzaC1hbGwtZG9uZSwgLndwLXNtdXNoLXBhZ2VzcGVlZC1yZWNvbW1lbmRhdGlvbicpLnNob3coKTtcblx0XHRcdFx0JCgnLndwLXNtdXNoLWJ1bGstd3JhcHBlcicpLmhpZGUoKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmICgkKCcuYnVsay1zbXVzaC13cmFwcGVyIC53cC1zbXVzaC1yZXNtdXNoLW5vdGljZScpLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHQkKCcuYnVsay1zbXVzaC13cmFwcGVyIC53cC1zbXVzaC1yZXNtdXNoLW5vdGljZScpLnNob3coKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQkKCcuYnVsay1zbXVzaC13cmFwcGVyIC53cC1zbXVzaC1yZW1haW5pbmcnKS5zaG93KCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0JCgnLndwLXNtdXNoLWJ1bGstd3JhcHBlcicpLnNob3coKTtcblx0XHRcdH1cblxuXHRcdFx0Ly9IaWRlIHRoZSBQcm9ncmVzcyBCYXJcblx0XHRcdCQoJy53cC1zbXVzaC1idWxrLXByb2dyZXNzLWJhci13cmFwcGVyJykuaGlkZSgpO1xuXG5cdFx0XHQvL0VuYWJsZSBSZXNtdXNoIGFuZCBzY2FuIGJ1dHRvblxuXHRcdFx0JCgnLndwLXJlc211c2gud3Atc211c2gtYWN0aW9uLCAud3Atc211c2gtc2NhbicpLnJlbW92ZUF0dHIoJ2Rpc2FibGVkJyk7XG5cblx0XHRcdC8vIFNob3cgbG9hZGVyLlxuXHRcdFx0aWYgKHNlbGYuaWRzLmxlbmd0aCA9PSAwKSB7XG5cdFx0XHRcdCQoJy5zdWktc3VtbWFyeS1zbXVzaCAuc211c2gtc3RhdHMtaWNvbicpLmFkZENsYXNzKCdzdWktaGlkZGVuJyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQkKCcuc3VpLXN1bW1hcnktc211c2ggLnNtdXNoLXN0YXRzLWljb24nKS5yZW1vdmVDbGFzcygnc3VpLWljb24tbG9hZGVyIHN1aS1sb2FkaW5nIHN1aS1oaWRkZW4nKS5hZGRDbGFzcygnc3VpLWljb24taW5mbyBzdWktd2FybmluZycpO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHR0aGlzLmlzX3Jlc29sdmVkID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0XCJ1c2Ugc3RyaWN0XCI7XG5cblx0XHRcdHJldHVybiB0aGlzLmRlZmVycmVkLnN0YXRlKCkgPT09IFwicmVzb2x2ZWRcIjtcblx0XHR9O1xuXG5cdFx0dGhpcy5mcmVlX2V4Y2VlZGVkID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0Ly9IaWRlIHRoZSBQcm9ncmVzcyBiYXIgYW5kIHNob3cgdGhlIEJ1bGsgc211c2ggd3JhcHBlclxuXHRcdFx0JCgnLndwLXNtdXNoLWJ1bGstcHJvZ3Jlc3MtYmFyLXdyYXBwZXInKS5oaWRlKCk7XG5cblx0XHRcdGlmIChzZWxmLmlkcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdC8vU2hvdyBCdWxrIHdyYXBwZXJcblx0XHRcdFx0JCgnLndwLXNtdXNoLWJ1bGstd3JhcHBlciAnKS5zaG93KCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQkKCcud3Atc211c2gtbm90aWNlLndwLXNtdXNoLWFsbC1kb25lLCAud3Atc211c2gtcGFnZXNwZWVkLXJlY29tbWVuZGF0aW9uJykuc2hvdygpO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHR0aGlzLnVwZGF0ZV9yZW1haW5pbmdfY291bnQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRpZiAodGhpcy5pc19idWxrX3Jlc211c2gpIHtcblx0XHRcdFx0Ly9SZVNtdXNoIE5vdGljZVxuXHRcdFx0XHRpZiAoJCgnLndwLXNtdXNoLXJlc211c2gtbm90aWNlIC53cC1zbXVzaC1yZW1haW5pbmctY291bnQnKS5sZW5ndGggJiYgJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIHNlbGYuaWRzKSB7XG5cdFx0XHRcdFx0JCgnLndwLXNtdXNoLXJlc211c2gtbm90aWNlIC53cC1zbXVzaC1yZW1haW5pbmctY291bnQnKS5odG1sKHNlbGYuaWRzLmxlbmd0aCk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vU211c2ggTm90aWNlXG5cdFx0XHRcdGlmICgkKCcuYnVsay1zbXVzaC13cmFwcGVyIC53cC1zbXVzaC1yZW1haW5pbmctY291bnQnKS5sZW5ndGggJiYgJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIHNlbGYuaWRzKSB7XG5cdFx0XHRcdFx0JCgnLmJ1bGstc211c2gtd3JhcHBlciAud3Atc211c2gtcmVtYWluaW5nLWNvdW50JykuaHRtbChzZWxmLmlkcy5sZW5ndGgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8vIFVwZGF0ZSBzaWRlYmFyIGNvdW50LlxuXHRcdFx0aWYgKCQoJy5zbXVzaC1zaWRlbmF2IC53cC1zbXVzaC1yZW1haW5pbmctY291bnQnKS5sZW5ndGggJiYgJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIHNlbGYuaWRzKSB7XG5cdFx0XHRcdGlmIChzZWxmLmlkcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0JCgnLnNtdXNoLXNpZGVuYXYgLndwLXNtdXNoLXJlbWFpbmluZy1jb3VudCcpLmh0bWwoc2VsZi5pZHMubGVuZ3RoKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQkKCcuc3VpLXN1bW1hcnktc211c2ggLnNtdXNoLXN0YXRzLWljb24nKS5hZGRDbGFzcygnc3VpLWhpZGRlbicpO1xuXHRcdFx0XHRcdCQoJy5zbXVzaC1zaWRlbmF2IC53cC1zbXVzaC1yZW1haW5pbmctY291bnQnKS5yZW1vdmVDbGFzcygnc3VpLXRhZyBzdWktdGFnLXdhcm5pbmcnKS5odG1sKCcnKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH07XG5cblx0XHR0aGlzLnVwZGF0ZV9wcm9ncmVzcyA9IGZ1bmN0aW9uIChfcmVzKSB7XG5cdFx0XHQvL0lmIG5vdCBidWxrXG5cdFx0XHRpZiAoIXRoaXMuaXNfYnVsa19yZXNtdXNoICYmICF0aGlzLmlzX2J1bGspIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHR2YXIgcHJvZ3Jlc3MgPSAnJztcblxuXHRcdFx0Ly9VcGRhdGUgbG9jYWxpemVkIHN0YXRzXG5cdFx0XHRpZiAoX3JlcyAmJiAoJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIF9yZXMuZGF0YSB8fCAndW5kZWZpbmVkJyAhPSB0eXBlb2YgX3Jlcy5kYXRhLnN0YXRzKSkge1xuXHRcdFx0XHR1cGRhdGVfbG9jYWxpemVkX3N0YXRzKF9yZXMuZGF0YS5zdGF0cywgdGhpcy5zbXVzaF90eXBlKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCF0aGlzLmlzX2J1bGtfcmVzbXVzaCkge1xuXHRcdFx0XHQvL2hhbmRsZSBwcm9ncmVzcyBmb3Igbm9ybWFsIGJ1bGsgc211c2hcblx0XHRcdFx0cHJvZ3Jlc3MgPSB3cF9zbXVzaGl0X2RhdGEuY291bnRfc211c2hlZCAvIHdwX3NtdXNoaXRfZGF0YS5jb3VudF90b3RhbCAqIDEwMDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vSWYgdGhlIFJlcXVlc3Qgd2FzIHN1Y2Nlc3NmdWwsIFVwZGF0ZSB0aGUgcHJvZ3Jlc3MgYmFyXG5cdFx0XHRcdGlmIChfcmVzLnN1Y2Nlc3MpIHtcblx0XHRcdFx0XHQvL0hhbmRsZSBwcm9ncmVzcyBmb3IgU3VwZXIgc211c2ggcHJvZ3Jlc3MgYmFyXG5cdFx0XHRcdFx0aWYgKHdwX3NtdXNoaXRfZGF0YS5yZXNtdXNoLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdC8vVXBkYXRlIHRoZSBDb3VudFxuXHRcdFx0XHRcdFx0JCgnLndwLXNtdXNoLWltYWdlcy1yZW1haW5pbmcnKS5odG1sKHdwX3NtdXNoaXRfZGF0YS5yZXNtdXNoLmxlbmd0aCk7XG5cdFx0XHRcdFx0fSBlbHNlIGlmICh3cF9zbXVzaGl0X2RhdGEucmVzbXVzaC5sZW5ndGggPT0gMCAmJiB0aGlzLmlkcy5sZW5ndGggPT0gMCkge1xuXHRcdFx0XHRcdFx0Ly9JZiBhbGwgaW1hZ2VzIGFyZSByZXNtdXNoZWQsIHNob3cgdGhlIEFsbCBTbXVzaGVkIG1lc3NhZ2VcblxuXHRcdFx0XHRcdFx0Ly9TaG93IEFsbCBTbXVzaGVkXG5cdFx0XHRcdFx0XHQkKCcuYnVsay1yZXNtdXNoLXdyYXBwZXIgLndwLXNtdXNoLWFsbC1kb25lLCAud3Atc211c2gtcGFnZXNwZWVkLXJlY29tbWVuZGF0aW9uJykucmVtb3ZlQ2xhc3MoJ3N1aS1oaWRkZW4nKTtcblxuXHRcdFx0XHRcdFx0Ly9IaWRlIEV2ZXJ5dGhpbmcgZWxzZVxuXHRcdFx0XHRcdFx0JCgnLndwLXNtdXNoLXJlc211c2gtd3JhcCwgLndwLXNtdXNoLWJ1bGstcHJvZ3Jlc3MtYmFyLXdyYXBwZXInKS5oaWRlKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly9oYW5kbGUgcHJvZ3Jlc3MgZm9yIG5vcm1hbCBidWxrIHNtdXNoXG5cdFx0XHRcdC8vU2V0IFByb2dyZXNzIEJhciB3aWR0aFxuXHRcdFx0XHRpZiAoJ3VuZGVmaW5lZCcgIT09IHR5cGVvZiBzZWxmLmlkcyAmJiAndW5kZWZpbmVkJyAhPT0gdHlwZW9mIHdwX3NtdXNoaXRfZGF0YS5jb3VudF90b3RhbCAmJiB3cF9zbXVzaGl0X2RhdGEuY291bnRfdG90YWwgPiAwKSB7XG5cdFx0XHRcdFx0cHJvZ3Jlc3MgPSB3cF9zbXVzaGl0X2RhdGEuY291bnRfc211c2hlZCAvIHdwX3NtdXNoaXRfZGF0YS5jb3VudF90b3RhbCAqIDEwMDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvL1Nob3cgQnVsayBXcmFwcGVyIGFuZCBTbXVzaCBOb3RpY2Vcblx0XHRcdGlmIChzZWxmLmlkcy5sZW5ndGggPT0gMCkge1xuXHRcdFx0XHQvL1N5bmMgc3RhdHMgZm9yIEJ1bGsgc211c2ggbWVkaWEgTGlicmFyeSAoIFNraXAgZm9yIE5leHRnZW4gKVxuXHRcdFx0XHRpZiAoJ25leHRnZW4nICE9IHRoaXMuc211c2hfdHlwZSkge1xuXHRcdFx0XHRcdHRoaXMuc3luY19zdGF0cygpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdCQoJy5idWxrLXNtdXNoLXdyYXBwZXIgLndwLXNtdXNoLWFsbC1kb25lLCAud3Atc211c2gtcGFnZXNwZWVkLXJlY29tbWVuZGF0aW9uJykuc2hvdygpO1xuXHRcdFx0XHQkKCcud3Atc211c2gtYnVsay13cmFwcGVyJykuaGlkZSgpO1xuXHRcdFx0fVxuXG5cdFx0XHQvL1VwZGF0ZSByZW1haW5pbmcgY291bnRcblx0XHRcdHNlbGYudXBkYXRlX3JlbWFpbmluZ19jb3VudCgpO1xuXG5cdFx0XHQvL2lmIHdlIGhhdmUgcmVjZWl2ZWQgdGhlIHByb2dyZXNzIGRhdGEsIHVwZGF0ZSB0aGUgc3RhdHMgZWxzZSBza2lwXG5cdFx0XHRpZiAoJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIF9yZXMuZGF0YS5zdGF0cykge1xuXG5cdFx0XHRcdC8vIGluY3JlYXNlIHRoZSBwcm9ncmVzcyBiYXJcblx0XHRcdFx0dGhpcy5fdXBkYXRlX3Byb2dyZXNzKHdwX3NtdXNoaXRfZGF0YS5jb3VudF9zbXVzaGVkLCBwcm9ncmVzcyk7XG5cdFx0XHR9XG5cdFx0XHQvLyBVcGRhdGUgc3RhdHMgYW5kIGNvdW50cy5cblx0XHRcdHVwZGF0ZV9zdGF0cyh0aGlzLnNtdXNoX3R5cGUpO1xuXHRcdH07XG5cblx0XHR0aGlzLl91cGRhdGVfcHJvZ3Jlc3MgPSBmdW5jdGlvbiAoY291bnQsIHdpZHRoKSB7XG5cdFx0XHRcInVzZSBzdHJpY3RcIjtcblxuXHRcdFx0aWYgKCF0aGlzLmlzX2J1bGsgJiYgIXRoaXMuaXNfYnVsa19yZXNtdXNoKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdC8vVXBkYXRlIHRoZSBQcm9ncmVzcyBCYXIgV2lkdGhcblx0XHRcdC8vIGdldCB0aGUgcHJvZ3Jlc3MgYmFyXG5cdFx0XHR2YXIgJHByb2dyZXNzX2JhciA9IGpRdWVyeSgnLmJ1bGstc211c2gtd3JhcHBlciAud3Atc211c2gtcHJvZ3Jlc3MtaW5uZXInKTtcblx0XHRcdGlmICgkcHJvZ3Jlc3NfYmFyLmxlbmd0aCA8IDEpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0Ly8gaW5jcmVhc2UgcHJvZ3Jlc3Ncblx0XHRcdCRwcm9ncmVzc19iYXIuY3NzKCd3aWR0aCcsIHdpZHRoICsgJyUnKTtcblx0XHR9O1xuXG5cdFx0Ly9XaGV0aGVyIHRvIHNlbmQgdGhlIGFqYXggcmVxdWVzdHMgZnVydGhlciBvciBub3Rcblx0XHR0aGlzLmNvbnRpbnVlID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0dmFyIGNvbnRpbnVlX3NtdXNoID0gc2VsZi4kYnV0dG9uLmF0dHIoJ2NvbnRpbnVlX3NtdXNoJyk7XG5cblx0XHRcdGlmICgodHlwZW9mIGNvbnRpbnVlX3NtdXNoID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihjb250aW51ZV9zbXVzaCkpID09ICh0eXBlb2YgdW5kZWZpbmVkID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZih1bmRlZmluZWQpKSkge1xuXHRcdFx0XHRjb250aW51ZV9zbXVzaCA9IHRydWU7XG5cdFx0XHR9XG5cblx0XHRcdGlmICgnZmFsc2UnID09IGNvbnRpbnVlX3NtdXNoIHx8ICFjb250aW51ZV9zbXVzaCkge1xuXHRcdFx0XHRjb250aW51ZV9zbXVzaCA9IGZhbHNlO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gY29udGludWVfc211c2ggJiYgdGhpcy5pZHMubGVuZ3RoID4gMCAmJiB0aGlzLmlzX2J1bGs7XG5cdFx0fTtcblxuXHRcdHRoaXMuaW5jcmVtZW50X2Vycm9ycyA9IGZ1bmN0aW9uIChpZCkge1xuXHRcdFx0V1BfU211c2guZXJyb3JzLnB1c2goaWQpO1xuXHRcdH07XG5cblx0XHQvL1NlbmQgYWpheCByZXF1ZXN0IGZvciBzbXVzaGluZyBzaW5nbGUgYW5kIGJ1bGssIGNhbGwgdXBkYXRlX3Byb2dyZXNzIG9uIGFqYXggcmVzcG9uc2Vcblx0XHR0aGlzLmNhbGxfYWpheCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdHZhciBub25jZV92YWx1ZSA9ICcnO1xuXHRcdFx0dGhpcy5jdXJyZW50X2lkID0gdGhpcy5pc19idWxrID8gdGhpcy5pZHMuc2hpZnQoKSA6IHRoaXMuJGJ1dHRvbi5kYXRhKFwiaWRcIik7IC8vcmVtb3ZlIGZyb20gYXJyYXkgd2hpbGUgcHJvY2Vzc2luZyBzbyB3ZSBjYW4gY29udGludWUgd2hlcmUgbGVmdCBvZmZcblxuXHRcdFx0Ly9SZW1vdmUgdGhlIGlkIGZyb20gcmVzcGVjdGl2ZSB2YXJpYWJsZSBhcyB3ZWxsXG5cdFx0XHR0aGlzLnVwZGF0ZV9zbXVzaF9pZHModGhpcy5jdXJyZW50X2lkKTtcblxuXHRcdFx0dmFyIG5vbmNlX2ZpZWxkID0gdGhpcy4kYnV0dG9uLnBhcmVudCgpLmZpbmQoJyNfd3Bfc211c2hfbm9uY2UnKTtcblx0XHRcdGlmIChub25jZV9maWVsZCkge1xuXHRcdFx0XHRub25jZV92YWx1ZSA9IG5vbmNlX2ZpZWxkLnZhbCgpO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLnJlcXVlc3QgPSBXUF9TbXVzaC5hamF4KHRoaXMuaXNfYnVsa19yZXNtdXNoLCB0aGlzLmN1cnJlbnRfaWQsIHRoaXMudXJsLCAwLCBub25jZV92YWx1ZSkuZXJyb3IoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRzZWxmLmluY3JlbWVudF9lcnJvcnMoc2VsZi5jdXJyZW50X2lkKTtcblx0XHRcdH0pLmRvbmUoZnVuY3Rpb24gKHJlcykge1xuXHRcdFx0XHQvL0luY3JlYXNlIHRoZSBlcnJvciBjb3VudCBleGNlcHQgaWYgYnVsayByZXF1ZXN0IGxpbWl0IGV4Y2NlZGVkXG5cdFx0XHRcdGlmICh0eXBlb2YgcmVzLnN1Y2Nlc3MgPT09IFwidW5kZWZpbmVkXCIgfHwgdHlwZW9mIHJlcy5zdWNjZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiByZXMuc3VjY2Vzcy5kYXRhICE9PSBcInVuZGVmaW5lZFwiICYmIHJlcy5zdWNjZXNzID09PSBmYWxzZSAmJiByZXMuZGF0YS5lcnJvciAhPT0gJ2J1bGtfcmVxdWVzdF9pbWFnZV9saW1pdF9leGNlZWRlZCcpIHtcblx0XHRcdFx0XHRzZWxmLmluY3JlbWVudF9lcnJvcnMoc2VsZi5jdXJyZW50X2lkKTtcblx0XHRcdFx0fVxuXHRcdFx0XHQvL0lmIG5vIHJlc3BvbnNlIG9yIHN1Y2Nlc3MgaXMgZmFsc2UsIGRvIG5vdCBwcm9jZXNzIGZ1cnRoZXJcblx0XHRcdFx0aWYgKCFyZXMgfHwgIXJlcy5zdWNjZXNzKSB7XG5cdFx0XHRcdFx0Ly9AdG9kbzogSGFuZGxlIEJ1bGsgU211c2ggbGltaXQgZXJyb3IgbWVzc2FnZVxuXHRcdFx0XHRcdGlmICgndW5kZWZpbmVkJyAhPT0gdHlwZW9mIHJlcyAmJiAndW5kZWZpbmVkJyAhPT0gdHlwZW9mIHJlcy5kYXRhICYmIHR5cGVvZiByZXMuZGF0YS5lcnJvciAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRcdFx0XHRcdHZhciBlcnJvcl9jbGFzcyA9ICd1bmRlZmluZWQnICE9IHR5cGVvZiByZXMuZGF0YS5lcnJvcl9jbGFzcyA/ICdzbXVzaC1lcnJvci1tZXNzYWdlICcgKyByZXMuZGF0YS5lcnJvcl9jbGFzcyA6ICdzbXVzaC1lcnJvci1tZXNzYWdlJztcblx0XHRcdFx0XHRcdHZhciBlcnJvcl9tc2cgPSAnPHAgY2xhc3M9XCInICsgZXJyb3JfY2xhc3MgKyAnXCI+JyArIHJlcy5kYXRhLmVycm9yX21lc3NhZ2UgKyAnPC9wPic7XG5cdFx0XHRcdFx0XHRpZiAoJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIHJlcy5kYXRhLmVycm9yICYmICdidWxrX3JlcXVlc3RfaW1hZ2VfbGltaXRfZXhjZWVkZWQnID09IHJlcy5kYXRhLmVycm9yKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBhamF4X2Vycm9yX21lc3NhZ2UgPSAkKCcud3Atc211c2gtYWpheC1lcnJvcicpO1xuXHRcdFx0XHRcdFx0XHQvL0lmIHdlIGhhdmUgYWpheCBlcnJvciBtZXNzYWdlIGRpdiwgYXBwZW5kIGFmdGVyIGl0XG5cdFx0XHRcdFx0XHRcdGlmIChhamF4X2Vycm9yX21lc3NhZ2UubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0XHRcdGFqYXhfZXJyb3JfbWVzc2FnZS5hZnRlcihlcnJvcl9tc2cpO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdC8vT3RoZXJ3aXNlIHByZXBlbmRcblx0XHRcdFx0XHRcdFx0XHRzZWxmLiRsb2cucHJlcGVuZChlcnJvcl9tc2cpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKCd1bmRlZmluZWQnICE9IHR5cGVvZiByZXMuZGF0YS5lcnJvcl9jbGFzcyAmJiBcIlwiICE9IHJlcy5kYXRhLmVycm9yX2NsYXNzICYmICQoJ2Rpdi5zbXVzaC1maW5hbC1sb2cgLicgKyByZXMuZGF0YS5lcnJvcl9jbGFzcykubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0XHR2YXIgZXJyb3JfY291bnQgPSAkKCdwLnNtdXNoLWVycm9yLW1lc3NhZ2UuJyArIHJlcy5kYXRhLmVycm9yX2NsYXNzICsgJyAuaW1hZ2UtZXJyb3ItY291bnQnKTtcblx0XHRcdFx0XHRcdFx0Ly9HZXQgdGhlIGVycm9yIGNvdW50LCBpbmNyZWFzZSBhbmQgYXBwZW5kXG5cdFx0XHRcdFx0XHRcdHZhciBpbWFnZV9jb3VudCA9IGVycm9yX2NvdW50Lmh0bWwoKTtcblx0XHRcdFx0XHRcdFx0aW1hZ2VfY291bnQgPSBwYXJzZUludChpbWFnZV9jb3VudCkgKyAxO1xuXHRcdFx0XHRcdFx0XHQvL0FwcGVuZCB0aGUgdXBkYXRlZCBpbWFnZSBjb3VudFxuXHRcdFx0XHRcdFx0XHRlcnJvcl9jb3VudC5odG1sKGltYWdlX2NvdW50KTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdC8vUHJpbnQgdGhlIGVycm9yIG9uIHNjcmVlblxuXHRcdFx0XHRcdFx0XHRzZWxmLiRsb2cuYXBwZW5kKGVycm9yX21zZyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRzZWxmLiRsb2cuc2hvdygpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vQ2hlY2sgd2hldGhlciB0byBzaG93IHRoZSB3YXJuaW5nIG5vdGljZSBvciBub3Rcblx0XHRcdFx0bWVtYmVyc2hpcF92YWxpZGl0eShyZXMuZGF0YSk7XG5cblx0XHRcdFx0Ly9CdWxrIFNtdXNoIExpbWl0IEV4Y2VlZGVkOiBTdG9wIGFqYXggcmVxdWVzdHMsIHJlbW92ZSBwcm9ncmVzcyBiYXIsIGFwcGVuZCB0aGUgbGFzdCBpbWFnZSBpZCBiYWNrIHRvIHNtdXNoIHZhcmlhYmxlLCBhbmQgcmVzZXQgdmFyaWFibGVzIHRvIGFsbG93IHRoZSB1c2VyIHRvIGNvbnRpbnVlIGJ1bGsgc211c2hcblx0XHRcdFx0aWYgKHR5cGVvZiByZXMuZGF0YSAhPT0gXCJ1bmRlZmluZWRcIiAmJiByZXMuZGF0YS5lcnJvciA9PSAnYnVsa19yZXF1ZXN0X2ltYWdlX2xpbWl0X2V4Y2VlZGVkJyAmJiAhc2VsZi5pc19yZXNvbHZlZCgpKSB7XG5cdFx0XHRcdFx0Ly9BZGQgYSBkYXRhIGF0dHJpYnV0ZSB0byB0aGUgc211c2ggYnV0dG9uLCB0byBzdG9wIHNlbmRpbmcgYWpheFxuXHRcdFx0XHRcdHNlbGYuJGJ1dHRvbi5hdHRyKCdjb250aW51ZV9zbXVzaCcsIGZhbHNlKTtcblxuXHRcdFx0XHRcdHNlbGYuZnJlZV9leGNlZWRlZCgpO1xuXG5cdFx0XHRcdFx0Ly9SZWluc2VydCB0aGUgY3VycmVudCBpZFxuXHRcdFx0XHRcdHdwX3NtdXNoaXRfZGF0YS51bnNtdXNoZWQudW5zaGlmdChzZWxmLmN1cnJlbnRfaWQpO1xuXG5cdFx0XHRcdFx0Ly9VcGRhdGUgdGhlIHJlbWFpbmluZyBjb3VudCB0byBsZW5ndGggb2YgcmVtYWluaW5nIGlkcyArIDEgKEN1cnJlbnQgaWQpXG5cdFx0XHRcdFx0c2VsZi51cGRhdGVfcmVtYWluaW5nX2NvdW50KCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0XHRpZiAoc2VsZi5pc19idWxrICYmIHJlcy5zdWNjZXNzKSB7XG5cdFx0XHRcdFx0XHRzZWxmLnVwZGF0ZV9wcm9ncmVzcyhyZXMpO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAoc2VsZi5pZHMubGVuZ3RoID09IDApIHtcblx0XHRcdFx0XHRcdC8vU3luYyBzdGF0cyBhbnl3YXlcblx0XHRcdFx0XHRcdHNlbGYuc3luY19zdGF0cygpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRzZWxmLnNpbmdsZV9kb25lKCk7XG5cdFx0XHR9KS5jb21wbGV0ZShmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdGlmICghc2VsZi5jb250aW51ZSgpIHx8ICFzZWxmLmlzX2J1bGspIHtcblx0XHRcdFx0XHQvL0NhbGxzIGRlZmVycmVkLmRvbmUoKVxuXHRcdFx0XHRcdHNlbGYuZGVmZXJyZWQucmVzb2x2ZSgpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHNlbGYuY2FsbF9hamF4KCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0XHRzZWxmLmRlZmVycmVkLmVycm9ycyA9IFdQX1NtdXNoLmVycm9ycztcblx0XHRcdHJldHVybiBzZWxmLmRlZmVycmVkO1xuXHRcdH07XG5cblx0XHR0aGlzLmluaXQoYXJndW1lbnRzKTtcblxuXHRcdC8vU2VuZCBhamF4IHJlcXVlc3QgZm9yIHNpbmdsZSBhbmQgYnVsayBzbXVzaGluZ1xuXHRcdHRoaXMucnVuID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0XHQvLyBpZiB3ZSBoYXZlIGEgZGVmaW5pdGUgbnVtYmVyIG9mIGlkc1xuXHRcdFx0aWYgKHRoaXMuaXNfYnVsayAmJiB0aGlzLmlkcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdHRoaXMuY2FsbF9hamF4KCk7XG5cdFx0XHR9XG5cblx0XHRcdGlmICghdGhpcy5pc19idWxrKSB0aGlzLmNhbGxfYWpheCgpO1xuXHRcdH07XG5cblx0XHQvL1Nob3cgYnVsayBzbXVzaCBlcnJvcnMsIGFuZCBkaXNhYmxlIGJ1bGsgc211c2ggYnV0dG9uIG9uIGNvbXBsZXRpb25cblx0XHR0aGlzLmJpbmRfZGVmZXJyZWRfZXZlbnRzID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0XHR0aGlzLmRlZmVycmVkLmRvbmUoZnVuY3Rpb24gKCkge1xuXG5cdFx0XHRcdHNlbGYuJGJ1dHRvbi5yZW1vdmVBdHRyKCdjb250aW51ZV9zbXVzaCcpO1xuXG5cdFx0XHRcdGlmIChXUF9TbXVzaC5lcnJvcnMubGVuZ3RoKSB7XG5cdFx0XHRcdFx0dmFyIGVycm9yX21lc3NhZ2UgPSAnPGRpdiBjbGFzcz1cIndwLXNtdXNoLWFqYXgtZXJyb3JcIj4nICsgd3Bfc211c2hfbXNncy5lcnJvcl9pbl9idWxrLnJlcGxhY2UoXCJ7e2Vycm9yc319XCIsIFdQX1NtdXNoLmVycm9ycy5sZW5ndGgpICsgJzwvZGl2Pic7XG5cdFx0XHRcdFx0Ly9SZW1vdmUgYW55IGV4aXN0aW5nIG5vdGljZVxuXHRcdFx0XHRcdCQoJy53cC1zbXVzaC1hamF4LWVycm9yJykucmVtb3ZlKCk7XG5cdFx0XHRcdFx0c2VsZi4kbG9nLnByZXBlbmQoZXJyb3JfbWVzc2FnZSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRzZWxmLmJ1bGtfZG9uZSgpO1xuXG5cdFx0XHRcdC8vUmUgZW5hYmxlIHRoZSBidXR0b25zXG5cdFx0XHRcdCQoJy53cC1zbXVzaC1idXR0b246bm90KC53cC1zbXVzaC1maW5pc2hlZCksIC53cC1zbXVzaC1zY2FuJykucmVtb3ZlQXR0cignZGlzYWJsZWQnKTtcblx0XHRcdH0pO1xuXHRcdH07XG5cdFx0LyoqIEhhbmRsZXMgdGhlIENhbmNlbCBidXR0b24gQ2xpY2tcbiAgICpcbiAgICogVXBkYXRlIHRoZSBVSSwgYW5kIGVuYWJsZXMgdGhlIGJ1bGsgc211c2ggYnV0dG9uXG4gICAqXG4gICAqKi9cblx0XHR0aGlzLmNhbmNlbF9hamF4ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0JCgnLndwLXNtdXNoLWNhbmNlbC1idWxrJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuXHRcdFx0XHQvL0FkZCBhIGRhdGEgYXR0cmlidXRlIHRvIHRoZSBzbXVzaCBidXR0b24sIHRvIHN0b3Agc2VuZGluZyBhamF4XG5cdFx0XHRcdHNlbGYuJGJ1dHRvbi5hdHRyKCdjb250aW51ZV9zbXVzaCcsIGZhbHNlKTtcblx0XHRcdFx0Ly9TeW5jIGFuZCB1cGRhdGUgc3RhdHNcblx0XHRcdFx0c2VsZi5zeW5jX3N0YXRzKCk7XG5cdFx0XHRcdHVwZGF0ZV9zdGF0cyh0aGlzLnNtdXNoX3R5cGUpO1xuXG5cdFx0XHRcdHNlbGYucmVxdWVzdC5hYm9ydCgpO1xuXHRcdFx0XHRzZWxmLmVuYWJsZV9idXR0b24oKTtcblx0XHRcdFx0c2VsZi4kYnV0dG9uLnJlbW92ZUNsYXNzKCd3cC1zbXVzaC1zdGFydGVkJyk7XG5cdFx0XHRcdHdwX3NtdXNoaXRfZGF0YS51bnNtdXNoZWQudW5zaGlmdChzZWxmLmN1cnJlbnRfaWQpO1xuXHRcdFx0XHQkKCcud3Atc211c2gtYnVsay13cmFwcGVyJykuc2hvdygpO1xuXG5cdFx0XHRcdC8vSGlkZSB0aGUgUHJvZ3Jlc3MgQmFyXG5cdFx0XHRcdCQoJy53cC1zbXVzaC1idWxrLXByb2dyZXNzLWJhci13cmFwcGVyJykuaGlkZSgpO1xuXHRcdFx0fSk7XG5cdFx0fTtcblx0XHQvKipcbiAgICogUmVtb3ZlIHRoZSBjdXJyZW50IGlkIGZyb20gdW5zbXVzaGVkL3Jlc211c2ggdmFyaWFibGVcbiAgICogQHBhcmFtIGN1cnJlbnRfaWRcbiAgICovXG5cdFx0dGhpcy51cGRhdGVfc211c2hfaWRzID0gZnVuY3Rpb24gKGN1cnJlbnRfaWQpIHtcblx0XHRcdGlmICgndW5kZWZpbmVkJyAhPT0gdHlwZW9mIHdwX3NtdXNoaXRfZGF0YS51bnNtdXNoZWQgJiYgd3Bfc211c2hpdF9kYXRhLnVuc211c2hlZC5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdHZhciB1X2luZGV4ID0gd3Bfc211c2hpdF9kYXRhLnVuc211c2hlZC5pbmRleE9mKGN1cnJlbnRfaWQpO1xuXHRcdFx0XHRpZiAodV9pbmRleCA+IC0xKSB7XG5cdFx0XHRcdFx0d3Bfc211c2hpdF9kYXRhLnVuc211c2hlZC5zcGxpY2UodV9pbmRleCwgMSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdC8vcmVtb3ZlIGZyb20gdGhlIHJlc211c2ggbGlzdFxuXHRcdFx0aWYgKCd1bmRlZmluZWQnICE9PSB0eXBlb2Ygd3Bfc211c2hpdF9kYXRhLnJlc211c2ggJiYgd3Bfc211c2hpdF9kYXRhLnJlc211c2gubGVuZ3RoID4gMCkge1xuXHRcdFx0XHR2YXIgaW5kZXggPSB3cF9zbXVzaGl0X2RhdGEucmVzbXVzaC5pbmRleE9mKGN1cnJlbnRfaWQpO1xuXHRcdFx0XHRpZiAoaW5kZXggPiAtMSkge1xuXHRcdFx0XHRcdHdwX3NtdXNoaXRfZGF0YS5yZXNtdXNoLnNwbGljZShpbmRleCwgMSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0dGhpcy5zdGFydCgpO1xuXHRcdHRoaXMucnVuKCk7XG5cdFx0dGhpcy5iaW5kX2RlZmVycmVkX2V2ZW50cygpO1xuXG5cdFx0Ly9IYW5kbGUgQ2FuY2VsIEFqYXhcblx0XHR0aGlzLmNhbmNlbF9hamF4KCk7XG5cblx0XHRyZXR1cm4gdGhpcy5kZWZlcnJlZDtcblx0fTtcblxuXHQvKipcbiAgKiBIYW5kbGUgdGhlIEJ1bGsgU211c2gvIEJ1bGsgUmVzbXVzaCBidXR0b24gY2xpY2tcbiAgKi9cblx0JCgnYm9keScpLm9uKCdjbGljaycsICdidXR0b24ud3Atc211c2gtYWxsJywgZnVuY3Rpb24gKGUpIHtcblxuXHRcdC8vIHByZXZlbnQgdGhlIGRlZmF1bHQgYWN0aW9uXG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0JCgnLnN1aS1ub3RpY2UtdG9wLnN1aS1ub3RpY2Utc3VjY2VzcycpLnJlbW92ZSgpO1xuXG5cdFx0Ly9EaXNhYmxlIFJlc211c2ggYW5kIHNjYW4gYnV0dG9uXG5cdFx0JCgnLndwLXJlc211c2gud3Atc211c2gtYWN0aW9uLCAud3Atc211c2gtc2NhbiwgLndwLXNtdXNoLWJ1dHRvbiwgYS53cC1zbXVzaC1sb3NzeS1lbmFibGUsIGJ1dHRvbi53cC1zbXVzaC1yZXNpemUtZW5hYmxlLCBpbnB1dCN3cC1zbXVzaC1zYXZlLXNldHRpbmdzJykuYXR0cignZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcblxuXHRcdC8vQ2hlY2sgZm9yIGlkcywgaWYgdGhlcmUgaXMgbm9uZSAoVW5zbXVzaGVkIG9yIGxvc3NsZXNzKSwgZG9uJ3QgY2FsbCBzbXVzaCBmdW5jdGlvblxuXHRcdGlmICh0eXBlb2Ygd3Bfc211c2hpdF9kYXRhID09ICd1bmRlZmluZWQnIHx8IHdwX3NtdXNoaXRfZGF0YS51bnNtdXNoZWQubGVuZ3RoID09IDAgJiYgd3Bfc211c2hpdF9kYXRhLnJlc211c2gubGVuZ3RoID09IDApIHtcblxuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdCQoXCIud3Atc211c2gtcmVtYWluaW5nXCIpLmhpZGUoKTtcblxuXHRcdC8vIFNob3cgbG9hZGVyLlxuXHRcdCQoJy5zdWktc3VtbWFyeS1zbXVzaCAuc211c2gtc3RhdHMtaWNvbicpLnJlbW92ZUNsYXNzKCdzdWktaWNvbi1pbmZvIHN1aS13YXJuaW5nJykuYWRkQ2xhc3MoJ3N1aS1pY29uLWxvYWRlciBzdWktbG9hZGluZycpO1xuXG5cdFx0bmV3IFdQX1NtdXNoLlNtdXNoKCQodGhpcyksIHRydWUpO1xuXHR9KTtcblxuXHQvKiogRGlzYWJsZSB0aGUgYWN0aW9uIGxpbmtzICoqL1xuXHR2YXIgZGlzYWJsZV9saW5rcyA9IGZ1bmN0aW9uIGRpc2FibGVfbGlua3MoY19lbGVtZW50KSB7XG5cblx0XHR2YXIgcGFyZW50ID0gY19lbGVtZW50LnBhcmVudCgpO1xuXHRcdC8vcmVkdWNlIHBhcmVudCBvcGFjaXR5XG5cdFx0cGFyZW50LmNzcyh7ICdvcGFjaXR5JzogJzAuNScgfSk7XG5cdFx0Ly9EaXNhYmxlIExpbmtzXG5cdFx0cGFyZW50LmZpbmQoJ2EnKS5hdHRyKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuXHR9O1xuXG5cdC8qKiBFbmFibGUgdGhlIEFjdGlvbiBMaW5rcyAqKi9cblx0dmFyIGVuYWJsZV9saW5rcyA9IGZ1bmN0aW9uIGVuYWJsZV9saW5rcyhjX2VsZW1lbnQpIHtcblxuXHRcdHZhciBwYXJlbnQgPSBjX2VsZW1lbnQucGFyZW50KCk7XG5cblx0XHQvL3JlZHVjZSBwYXJlbnQgb3BhY2l0eVxuXHRcdHBhcmVudC5jc3MoeyAnb3BhY2l0eSc6ICcxJyB9KTtcblx0XHQvL0Rpc2FibGUgTGlua3Ncblx0XHRwYXJlbnQuZmluZCgnYScpLnJlbW92ZUF0dHIoJ2Rpc2FibGVkJyk7XG5cdH07XG5cdC8qKlxuICAqIFJlc3RvcmUgaW1hZ2UgcmVxdWVzdCB3aXRoIGEgc3BlY2lmaWVkIGFjdGlvbiBmb3IgTWVkaWEgTGlicmFyeSAvIE5leHRHZW4gR2FsbGVyeVxuICAqIEBwYXJhbSBlXG4gICogQHBhcmFtIGN1cnJlbnRfYnV0dG9uXG4gICogQHBhcmFtIHNtdXNoX2FjdGlvblxuICAqIEByZXR1cm5zIHtib29sZWFufVxuICAqL1xuXHR2YXIgcHJvY2Vzc19zbXVzaF9hY3Rpb24gPSBmdW5jdGlvbiBwcm9jZXNzX3NtdXNoX2FjdGlvbihlLCBjdXJyZW50X2J1dHRvbiwgc211c2hfYWN0aW9uLCBhY3Rpb24pIHtcblxuXHRcdC8vSWYgZGlzYWJsZWRcblx0XHRpZiAoJ2Rpc2FibGVkJyA9PSBjdXJyZW50X2J1dHRvbi5hdHRyKCdkaXNhYmxlZCcpKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0Ly9SZW1vdmUgRXJyb3Jcblx0XHQkKCcud3Atc211c2gtZXJyb3InKS5yZW1vdmUoKTtcblxuXHRcdC8vSGlkZSBzdGF0c1xuXHRcdCQoJy5zbXVzaC1zdGF0cy13cmFwcGVyJykuaGlkZSgpO1xuXG5cdFx0dmFyIG1vZGUgPSAnZ3JpZCc7XG5cdFx0aWYgKCdzbXVzaF9yZXN0b3JlX2ltYWdlJyA9PSBzbXVzaF9hY3Rpb24pIHtcblx0XHRcdGlmICgkKGRvY3VtZW50KS5maW5kKCdkaXYubWVkaWEtbW9kYWwud3AtY29yZS11aScpLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0bW9kZSA9ICdncmlkJztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG1vZGUgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoLmluZGV4T2YoJ2l0ZW0nKSA+IC0xID8gJ2dyaWQnIDogJ2xpc3QnO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vR2V0IHRoZSBpbWFnZSBJRCBhbmQgbm9uY2Vcblx0XHR2YXIgcGFyYW1zID0ge1xuXHRcdFx0YWN0aW9uOiBzbXVzaF9hY3Rpb24sXG5cdFx0XHRhdHRhY2htZW50X2lkOiBjdXJyZW50X2J1dHRvbi5kYXRhKCdpZCcpLFxuXHRcdFx0bW9kZTogbW9kZSxcblx0XHRcdF9ub25jZTogY3VycmVudF9idXR0b24uZGF0YSgnbm9uY2UnKVxuXHRcdH07XG5cblx0XHQvL1JlZHVjZSB0aGUgb3BhY2l0eSBvZiBzdGF0cyBhbmQgZGlzYWJsZSB0aGUgY2xpY2tcblx0XHRkaXNhYmxlX2xpbmtzKGN1cnJlbnRfYnV0dG9uKTtcblxuXHRcdHByb2dyZXNzX2JhcihjdXJyZW50X2J1dHRvbiwgd3Bfc211c2hfbXNnc1thY3Rpb25dLCAnc2hvdycpO1xuXG5cdFx0Ly9SZXN0b3JlIHRoZSBpbWFnZVxuXHRcdCQucG9zdChhamF4dXJsLCBwYXJhbXMsIGZ1bmN0aW9uIChyKSB7XG5cblx0XHRcdHByb2dyZXNzX2JhcihjdXJyZW50X2J1dHRvbiwgd3Bfc211c2hfbXNnc1thY3Rpb25dLCAnaGlkZScpO1xuXG5cdFx0XHQvL3Jlc2V0IGFsbCBmdW5jdGlvbmFsaXR5XG5cdFx0XHRlbmFibGVfbGlua3MoY3VycmVudF9idXR0b24pO1xuXG5cdFx0XHRpZiAoci5zdWNjZXNzICYmICd1bmRlZmluZWQnICE9IHR5cGVvZiByLmRhdGEuYnV0dG9uKSB7XG5cdFx0XHRcdC8vUmVwbGFjZSBpbiBpbW1lZGlhdGUgcGFyZW50IGZvciBuZXh0Z2VuXG5cdFx0XHRcdGlmICgndW5kZWZpbmVkJyAhPSB0eXBlb2YgdGhpcy5kYXRhICYmIHRoaXMuZGF0YS5pbmRleE9mKCduZXh0Z2VuJykgPiAtMSkge1xuXHRcdFx0XHRcdC8vU2hvdyB0aGUgc211c2ggYnV0dG9uLCBhbmQgcmVtb3ZlIHN0YXRzIGFuZCByZXN0b3JlIG9wdGlvblxuXHRcdFx0XHRcdGN1cnJlbnRfYnV0dG9uLnBhcmVudCgpLmh0bWwoci5kYXRhLmJ1dHRvbik7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly9TaG93IHRoZSBzbXVzaCBidXR0b24sIGFuZCByZW1vdmUgc3RhdHMgYW5kIHJlc3RvcmUgb3B0aW9uXG5cdFx0XHRcdFx0Y3VycmVudF9idXR0b24ucGFyZW50cygpLmVxKDEpLmh0bWwoci5kYXRhLmJ1dHRvbik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIHIuZGF0YSAmJiAncmVzdG9yZScgPT09IGFjdGlvbikge1xuXHRcdFx0XHRcdHVwZGF0ZV9pbWFnZV9zdGF0cyhyLmRhdGEubmV3X3NpemUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAoci5kYXRhLm1lc3NhZ2UpIHtcblx0XHRcdFx0XHQvL3Nob3cgZXJyb3Jcblx0XHRcdFx0XHRjdXJyZW50X2J1dHRvbi5wYXJlbnQoKS5hcHBlbmQoci5kYXRhLm1lc3NhZ2UpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH07XG5cblx0LyoqXG4gICogVmFsaWRhdGVzIHRoZSBSZXNpemUgV2lkdGggYW5kIEhlaWdodCBhZ2FpbnN0IHRoZSBMYXJnZXN0IFRodW1ibmFpbCBXaWR0aCBhbmQgSGVpZ2h0XG4gICpcbiAgKiBAcGFyYW0gd3JhcHBlcl9kaXYgalF1ZXJ5IG9iamVjdCBmb3IgdGhlIHdob2xlIHNldHRpbmcgcm93IHdyYXBwZXIgZGl2XG4gICogQHBhcmFtIHdpZHRoX29ubHkgV2hldGhlciB0byB2YWxpZGF0ZSBvbmx5IHdpZHRoXG4gICogQHBhcmFtIGhlaWdodF9vbmx5IFZhbGlkYXRlIG9ubHkgSGVpZ2h0XG4gICogQHJldHVybnMge2Jvb2xlYW59IEFsbCBHb29kIG9yIG5vdFxuICAqXG4gICovXG5cdHZhciB2YWxpZGF0ZV9yZXNpemVfc2V0dGluZ3MgPSBmdW5jdGlvbiB2YWxpZGF0ZV9yZXNpemVfc2V0dGluZ3Mod3JhcHBlcl9kaXYsIHdpZHRoX29ubHksIGhlaWdodF9vbmx5KSB7XG5cdFx0dmFyIHJlc2l6ZV9jaGVja2JveCA9IHdyYXBwZXJfZGl2LmZpbmQoJyN3cC1zbXVzaC1yZXNpemUsICN3cC1zbXVzaC1yZXNpemUtcXVpY2stc2V0dXAnKTtcblxuXHRcdGlmICghaGVpZ2h0X29ubHkpIHtcblx0XHRcdHZhciB3aWR0aF9pbnB1dCA9IHdyYXBwZXJfZGl2LmZpbmQoJyN3cC1zbXVzaC1yZXNpemVfd2lkdGgnKTtcblx0XHRcdHZhciB3aWR0aF9lcnJvcl9ub3RlID0gd3JhcHBlcl9kaXYuZmluZCgnLnN1aS1ub3RpY2UtaW5mby53cC1zbXVzaC11cGRhdGUtd2lkdGgnKTtcblx0XHR9XG5cdFx0aWYgKCF3aWR0aF9vbmx5KSB7XG5cdFx0XHR2YXIgaGVpZ2h0X2lucHV0ID0gd3JhcHBlcl9kaXYuZmluZCgnI3dwLXNtdXNoLXJlc2l6ZV9oZWlnaHQnKTtcblx0XHRcdHZhciBoZWlnaHRfZXJyb3Jfbm90ZSA9IHdyYXBwZXJfZGl2LmZpbmQoJy5zdWktbm90aWNlLWluZm8ud3Atc211c2gtdXBkYXRlLWhlaWdodCcpO1xuXHRcdH1cblxuXHRcdHZhciB3aWR0aF9lcnJvciA9IGZhbHNlO1xuXHRcdHZhciBoZWlnaHRfZXJyb3IgPSBmYWxzZTtcblxuXHRcdC8vSWYgcmVzaXplIHNldHRpbmdzIGlzIG5vdCBlbmFibGVkLCByZXR1cm4gdHJ1ZVxuXHRcdGlmICghcmVzaXplX2NoZWNrYm94LmlzKCc6Y2hlY2tlZCcpKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cblx0XHQvL0NoZWNrIGlmIHdlIGhhdmUgbG9jYWxpc2VkIHdpZHRoIGFuZCBoZWlnaHRcblx0XHRpZiAoJ3VuZGVmaW5lZCcgPT0gdHlwZW9mIHdwX3NtdXNoaXRfZGF0YS5yZXNpemVfc2l6ZXMgfHwgJ3VuZGVmaW5lZCcgPT0gdHlwZW9mIHdwX3NtdXNoaXRfZGF0YS5yZXNpemVfc2l6ZXMud2lkdGgpIHtcblx0XHRcdC8vUmVseSBvbiBzZXJ2ZXIgdmFsaWRhdGlvblxuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0Ly9DaGVjayBmb3Igd2lkdGhcblx0XHRpZiAoIWhlaWdodF9vbmx5ICYmICd1bmRlZmluZWQnICE9IHR5cGVvZiB3aWR0aF9pbnB1dCAmJiBwYXJzZUludCh3cF9zbXVzaGl0X2RhdGEucmVzaXplX3NpemVzLndpZHRoKSA+IHBhcnNlSW50KHdpZHRoX2lucHV0LnZhbCgpKSkge1xuXHRcdFx0d2lkdGhfaW5wdXQucGFyZW50KCkuYWRkQ2xhc3MoJ3N1aS1mb3JtLWZpZWxkLWVycm9yJyk7XG5cdFx0XHR3aWR0aF9lcnJvcl9ub3RlLnNob3coJ3Nsb3cnKTtcblx0XHRcdHdpZHRoX2Vycm9yID0gdHJ1ZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly9SZW1vdmUgZXJyb3IgY2xhc3Ncblx0XHRcdHdpZHRoX2lucHV0LnBhcmVudCgpLnJlbW92ZUNsYXNzKCdzdWktZm9ybS1maWVsZC1lcnJvcicpO1xuXHRcdFx0d2lkdGhfZXJyb3Jfbm90ZS5oaWRlKCk7XG5cdFx0XHRpZiAoaGVpZ2h0X2lucHV0Lmhhc0NsYXNzKCdlcnJvcicpKSB7XG5cdFx0XHRcdGhlaWdodF9lcnJvcl9ub3RlLnNob3coJ3Nsb3cnKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvL0NoZWNrIGZvciBoZWlnaHRcblx0XHRpZiAoIXdpZHRoX29ubHkgJiYgJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIGhlaWdodF9pbnB1dCAmJiBwYXJzZUludCh3cF9zbXVzaGl0X2RhdGEucmVzaXplX3NpemVzLmhlaWdodCkgPiBwYXJzZUludChoZWlnaHRfaW5wdXQudmFsKCkpKSB7XG5cdFx0XHRoZWlnaHRfaW5wdXQucGFyZW50KCkuYWRkQ2xhc3MoJ3N1aS1mb3JtLWZpZWxkLWVycm9yJyk7XG5cdFx0XHQvL0lmIHdlIGFyZSBub3Qgc2hvd2luZyB0aGUgd2lkdGggZXJyb3IgYWxyZWFkeVxuXHRcdFx0aWYgKCF3aWR0aF9lcnJvcikge1xuXHRcdFx0XHRoZWlnaHRfZXJyb3Jfbm90ZS5zaG93KCdzbG93Jyk7XG5cdFx0XHR9XG5cdFx0XHRoZWlnaHRfZXJyb3IgPSB0cnVlO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvL1JlbW92ZSBlcnJvciBjbGFzc1xuXHRcdFx0aGVpZ2h0X2lucHV0LnBhcmVudCgpLnJlbW92ZUNsYXNzKCdzdWktZm9ybS1maWVsZC1lcnJvcicpO1xuXHRcdFx0aGVpZ2h0X2Vycm9yX25vdGUuaGlkZSgpO1xuXHRcdFx0aWYgKHdpZHRoX2lucHV0Lmhhc0NsYXNzKCdlcnJvcicpKSB7XG5cdFx0XHRcdHdpZHRoX2Vycm9yX25vdGUuc2hvdygnc2xvdycpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmICh3aWR0aF9lcnJvciB8fCBoZWlnaHRfZXJyb3IpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdFx0cmV0dXJuIHRydWU7XG5cdH07XG5cblx0LyoqXG4gICogQ29udmVydCBieXRlcyB0byBodW1hbiByZWFkYWJsZSBmb3JtXG4gICogQHBhcmFtIGEsIEJ5dGVzXG4gICogQHBhcmFtIGIsIE51bWJlciBvZiBkaWdpdHNcbiAgKiBAcmV0dXJucyB7Kn0gRm9ybWF0dGVkIEJ5dGVzXG4gICovXG5cdHZhciBmb3JtYXRCeXRlcyA9IGZ1bmN0aW9uIGZvcm1hdEJ5dGVzKGEsIGIpIHtcblx0XHR2YXIgdGhyZXNoID0gMTAyNDtcblx0XHRpZiAoTWF0aC5hYnMoYSkgPCB0aHJlc2gpIHtcblx0XHRcdHJldHVybiBhICsgJyBCJztcblx0XHR9XG5cdFx0dmFyIHVuaXRzID0gWydLQicsICdNQicsICdHQicsICdUQicsICdQQiddO1xuXHRcdHZhciB1ID0gLTE7XG5cdFx0ZG8ge1xuXHRcdFx0YSAvPSB0aHJlc2g7XG5cdFx0XHQrK3U7XG5cdFx0fSB3aGlsZSAoTWF0aC5hYnMoYSkgPj0gdGhyZXNoICYmIHUgPCB1bml0cy5sZW5ndGggLSAxKTtcblx0XHRyZXR1cm4gYS50b0ZpeGVkKGIpICsgJyAnICsgdW5pdHNbdV07XG5cdH07XG5cblx0LyoqXG4gICogQ29udmVydCBieXRlcyB0byBodW1hbiByZWFkYWJsZSBmb3JtXG4gICogQHBhcmFtIGEsIEJ5dGVzXG4gICogQHBhcmFtIGIsIE51bWJlciBvZiBkaWdpdHNcbiAgKiBAcmV0dXJucyB7Kn0gRm9ybWF0dGVkIEJ5dGVzXG4gICovXG5cdHZhciBnZXRTaXplRnJvbVN0cmluZyA9IGZ1bmN0aW9uIGdldFNpemVGcm9tU3RyaW5nKGZvcm1hdHRlZF9zaXplKSB7XG5cdFx0cmV0dXJuIGZvcm1hdHRlZF9zaXplLnJlcGxhY2UoL1thLXpBLVpdL2csICcnKS50cmltKCk7XG5cdH07XG5cblx0LyoqXG4gICogQ29udmVydCBieXRlcyB0byBodW1hbiByZWFkYWJsZSBmb3JtXG4gICogQHBhcmFtIGEsIEJ5dGVzXG4gICogQHBhcmFtIGIsIE51bWJlciBvZiBkaWdpdHNcbiAgKiBAcmV0dXJucyB7Kn0gRm9ybWF0dGVkIEJ5dGVzXG4gICovXG5cdHZhciBnZXRGb3JtYXRGcm9tU3RyaW5nID0gZnVuY3Rpb24gZ2V0Rm9ybWF0RnJvbVN0cmluZyhmb3JtYXR0ZWRfc2l6ZSkge1xuXHRcdHJldHVybiBmb3JtYXR0ZWRfc2l6ZS5yZXBsYWNlKC9bMC05Ll0vZywgJycpLnRyaW0oKTtcblx0fTtcblxuXHQvL1N0YWNrb3ZlcmZsb3c6IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTcyNjYzMC9mb3JtYXR0aW5nLWEtbnVtYmVyLXdpdGgtZXhhY3RseS10d28tZGVjaW1hbHMtaW4tamF2YXNjcmlwdFxuXHR2YXIgcHJlY2lzZV9yb3VuZCA9IGZ1bmN0aW9uIHByZWNpc2Vfcm91bmQobnVtLCBkZWNpbWFscykge1xuXHRcdHZhciBzaWduID0gbnVtID49IDAgPyAxIDogLTE7XG5cdFx0Ly9LZWVwIHRoZSBwZXJjZW50YWdlIGJlbG93IDEwMFxuXHRcdG51bSA9IG51bSA+IDEwMCA/IDEwMCA6IG51bTtcblx0XHRyZXR1cm4gTWF0aC5yb3VuZChudW0gKiBNYXRoLnBvdygxMCwgZGVjaW1hbHMpICsgc2lnbiAqIDAuMDAxKSAvIE1hdGgucG93KDEwLCBkZWNpbWFscyk7XG5cdH07XG5cblx0LyoqXG4gICogVXBkYXRlIHRoZSBwcm9ncmVzcyBiYXIgd2lkdGggaWYgd2UgaGF2ZSBpbWFnZXMgdGhhdCBuZWVkcyB0byBiZSByZXNtdXNoZWRcbiAgKiBAcGFyYW0gdW5zbXVzaGVkX2NvdW50XG4gICogQHJldHVybnMge2Jvb2xlYW59XG4gICovXG5cdHZhciB1cGRhdGVfcHJvZ3Jlc3NfYmFyX3Jlc211c2ggPSBmdW5jdGlvbiB1cGRhdGVfcHJvZ3Jlc3NfYmFyX3Jlc211c2godW5zbXVzaGVkX2NvdW50KSB7XG5cblx0XHRpZiAoJ3VuZGVmaW5lZCcgPT0gdHlwZW9mIHVuc211c2hlZF9jb3VudCkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdHZhciBzbXVzaGVkX2NvdW50ID0gd3Bfc211c2hpdF9kYXRhLmNvdW50X3RvdGFsIC0gdW5zbXVzaGVkX2NvdW50O1xuXG5cdFx0Ly9VcGRhdGUgdGhlIFByb2dyZXNzIEJhciBXaWR0aFxuXHRcdC8vIGdldCB0aGUgcHJvZ3Jlc3MgYmFyXG5cdFx0dmFyICRwcm9ncmVzc19iYXIgPSBqUXVlcnkoJy5idWxrLXNtdXNoLXdyYXBwZXIgLndwLXNtdXNoLXByb2dyZXNzLWlubmVyJyk7XG5cdFx0aWYgKCRwcm9ncmVzc19iYXIubGVuZ3RoIDwgMSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHZhciB3aWR0aCA9IHNtdXNoZWRfY291bnQgLyB3cF9zbXVzaGl0X2RhdGEuY291bnRfdG90YWwgKiAxMDA7XG5cblx0XHQvLyBpbmNyZWFzZSBwcm9ncmVzc1xuXHRcdCRwcm9ncmVzc19iYXIuY3NzKCd3aWR0aCcsIHdpZHRoICsgJyUnKTtcblx0fTtcblxuXHR2YXIgcnVuX3JlX2NoZWNrID0gZnVuY3Rpb24gcnVuX3JlX2NoZWNrKGJ1dHRvbiwgcHJvY2Vzc19zZXR0aW5ncykge1xuXG5cdFx0Ly8gRW1wdHkgdGhlIGJ1dHRvbiB0ZXh0IGFuZCBhZGQgbG9hZGVyIGNsYXNzLlxuXHRcdGJ1dHRvbi50ZXh0KCcnKS5hZGRDbGFzcygnc3VpLWJ1dHRvbi1vbmxvYWQgc3VpLWljb24tbG9hZGVyIHN1aS1sb2FkaW5nJykuYmx1cigpO1xuXG5cdFx0Ly9DaGVjayBpZiB0eXBlIGlzIHNldCBpbiBkYXRhIGF0dHJpYnV0ZXNcblx0XHR2YXIgc2Nhbl90eXBlID0gYnV0dG9uLmRhdGEoJ3R5cGUnKTtcblx0XHRzY2FuX3R5cGUgPSAndW5kZWZpbmVkJyA9PSB0eXBlb2Ygc2Nhbl90eXBlID8gJ21lZGlhJyA6IHNjYW5fdHlwZTtcblxuXHRcdC8vUmVtb3ZlIHRoZSBTa2lwIHJlc211c2ggYXR0cmlidXRlIGZyb20gYnV0dG9uXG5cdFx0JCgnYnV0dG9uLndwLXNtdXNoLWFsbCcpLnJlbW92ZUF0dHIoJ2RhdGEtc211c2gnKTtcblxuXHRcdC8vcmVtb3ZlIG5vdGljZXNcblx0XHR2YXIgZWwgPSAkKCcuc3VpLW5vdGljZS10b3Auc3VpLW5vdGljZS1zdWNjZXNzJyk7XG5cdFx0ZWwuc2xpZGVVcCgxMDAsIGZ1bmN0aW9uICgpIHtcblx0XHRcdGVsLnJlbW92ZSgpO1xuXHRcdH0pO1xuXG5cdFx0Ly9EaXNhYmxlIEJ1bGsgc211c2ggYnV0dG9uIGFuZCBpdHNlbGZcblx0XHQkKCcud3Atc211c2gtYnV0dG9uJykuYXR0cignZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcblxuXHRcdC8vSGlkZSBTZXR0aW5ncyBjaGFuZ2VkIE5vdGljZVxuXHRcdCQoJy53cC1zbXVzaC1zZXR0aW5ncy1jaGFuZ2VkJykuaGlkZSgpO1xuXG5cdFx0Ly9BamF4IFBhcmFtc1xuXHRcdHZhciBwYXJhbXMgPSB7XG5cdFx0XHRhY3Rpb246ICdzY2FuX2Zvcl9yZXNtdXNoJyxcblx0XHRcdHR5cGU6IHNjYW5fdHlwZSxcblx0XHRcdGdldF91aTogdHJ1ZSxcblx0XHRcdHByb2Nlc3Nfc2V0dGluZ3M6IHByb2Nlc3Nfc2V0dGluZ3MsXG5cdFx0XHR3cF9zbXVzaF9vcHRpb25zX25vbmNlOiBqUXVlcnkoJyN3cF9zbXVzaF9vcHRpb25zX25vbmNlJykudmFsKClcblx0XHR9O1xuXG5cdFx0Ly9TZW5kIGFqYXggcmVxdWVzdCBhbmQgZ2V0IGlkcyBpZiBhbnlcblx0XHQkLmdldChhamF4dXJsLCBwYXJhbXMsIGZ1bmN0aW9uIChyKSB7XG5cdFx0XHQvL0NoZWNrIGlmIHdlIGhhdmUgdGhlIGlkcywgIGluaXRpYWxpemUgdGhlIGxvY2FsIHZhcmlhYmxlXG5cdFx0XHRpZiAoJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIHIuZGF0YSkge1xuXHRcdFx0XHQvL1VwZGF0ZSBSZXNtdXNoIGlkIGxpc3Rcblx0XHRcdFx0aWYgKCd1bmRlZmluZWQnICE9IHR5cGVvZiByLmRhdGEucmVzbXVzaF9pZHMpIHtcblx0XHRcdFx0XHR3cF9zbXVzaGl0X2RhdGEucmVzbXVzaCA9IHIuZGF0YS5yZXNtdXNoX2lkcztcblxuXHRcdFx0XHRcdC8vVXBkYXRlIHdwX3NtdXNoaXRfZGF0YSAoIFNtdXNoZWQgY291bnQsIFNtdXNoZWQgUGVyY2VudCwgSW1hZ2UgY291bnQsIFN1cGVyIHNtdXNoIGNvdW50LCByZXNpemUgc2F2aW5ncywgY29udmVyc2lvbiBzYXZpbmdzIClcblx0XHRcdFx0XHRpZiAoJ3VuZGVmaW5pZWQnICE9IHR5cGVvZiB3cF9zbXVzaGl0X2RhdGEpIHtcblx0XHRcdFx0XHRcdHdwX3NtdXNoaXRfZGF0YS5jb3VudF9zbXVzaGVkID0gJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIHIuZGF0YS5jb3VudF9zbXVzaGVkID8gci5kYXRhLmNvdW50X3NtdXNoZWQgOiB3cF9zbXVzaGl0X2RhdGEuY291bnRfc211c2hlZDtcblx0XHRcdFx0XHRcdHdwX3NtdXNoaXRfZGF0YS5jb3VudF9zdXBlcnNtdXNoZWQgPSAndW5kZWZpbmVkJyAhPSB0eXBlb2Ygci5kYXRhLmNvdW50X3N1cGVyc211c2hlZCA/IHIuZGF0YS5jb3VudF9zdXBlcnNtdXNoZWQgOiB3cF9zbXVzaGl0X2RhdGEuY291bnRfc3VwZXJzbXVzaGVkO1xuXHRcdFx0XHRcdFx0d3Bfc211c2hpdF9kYXRhLmNvdW50X2ltYWdlcyA9ICd1bmRlZmluZWQnICE9IHR5cGVvZiByLmRhdGEuY291bnRfaW1hZ2UgPyByLmRhdGEuY291bnRfaW1hZ2UgOiB3cF9zbXVzaGl0X2RhdGEuY291bnRfaW1hZ2VzO1xuXHRcdFx0XHRcdFx0d3Bfc211c2hpdF9kYXRhLnNpemVfYmVmb3JlID0gJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIHIuZGF0YS5zaXplX2JlZm9yZSA/IHIuZGF0YS5zaXplX2JlZm9yZSA6IHdwX3NtdXNoaXRfZGF0YS5zaXplX2JlZm9yZTtcblx0XHRcdFx0XHRcdHdwX3NtdXNoaXRfZGF0YS5zaXplX2FmdGVyID0gJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIHIuZGF0YS5zaXplX2FmdGVyID8gci5kYXRhLnNpemVfYWZ0ZXIgOiB3cF9zbXVzaGl0X2RhdGEuc2l6ZV9hZnRlcjtcblx0XHRcdFx0XHRcdHdwX3NtdXNoaXRfZGF0YS5zYXZpbmdzX3Jlc2l6ZSA9ICd1bmRlZmluZWQnICE9IHR5cGVvZiByLmRhdGEuc2F2aW5nc19yZXNpemUgPyByLmRhdGEuc2F2aW5nc19yZXNpemUgOiB3cF9zbXVzaGl0X2RhdGEuc2F2aW5nc19yZXNpemU7XG5cdFx0XHRcdFx0XHR3cF9zbXVzaGl0X2RhdGEuc2F2aW5nc19jb252ZXJzaW9uID0gJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIHIuZGF0YS5zYXZpbmdzX2NvbnZlcnNpb24gPyByLmRhdGEuc2F2aW5nc19jb252ZXJzaW9uIDogd3Bfc211c2hpdF9kYXRhLnNhdmluZ3NfY29udmVyc2lvbjtcblx0XHRcdFx0XHRcdHdwX3NtdXNoaXRfZGF0YS5jb3VudF9yZXNpemUgPSAndW5kZWZpbmVkJyAhPSB0eXBlb2Ygci5kYXRhLmNvdW50X3Jlc2l6ZSA/IHIuZGF0YS5jb3VudF9yZXNpemUgOiB3cF9zbXVzaGl0X2RhdGEuY291bnRfcmVzaXplO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmICgnbmV4dGdlbicgPT0gc2Nhbl90eXBlKSB7XG5cdFx0XHRcdFx0XHR3cF9zbXVzaGl0X2RhdGEuYnl0ZXMgPSBwYXJzZUludCh3cF9zbXVzaGl0X2RhdGEuc2l6ZV9iZWZvcmUpIC0gcGFyc2VJbnQod3Bfc211c2hpdF9kYXRhLnNpemVfYWZ0ZXIpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHZhciBzbXVzaF9wZXJjZW50ID0gd3Bfc211c2hpdF9kYXRhLmNvdW50X3NtdXNoZWQgLyB3cF9zbXVzaGl0X2RhdGEuY291bnRfdG90YWwgKiAxMDA7XG5cdFx0XHRcdFx0c211c2hfcGVyY2VudCA9IHByZWNpc2Vfcm91bmQoc211c2hfcGVyY2VudCwgMSk7XG5cblx0XHRcdFx0XHQvL1VwZGF0ZSBpdCBpbiBzdGF0cyBiYXJcblx0XHRcdFx0XHQkKCcud3Atc211c2gtaW1hZ2VzLXBlcmNlbnQnKS5odG1sKHNtdXNoX3BlcmNlbnQpO1xuXG5cdFx0XHRcdFx0Ly9IaWRlIHRoZSBFeGlzdGluZyB3cmFwcGVyXG5cdFx0XHRcdFx0dmFyIG5vdGljZXMgPSAkKCcuYnVsay1zbXVzaC13cmFwcGVyIC5zdWktbm90aWNlJyk7XG5cdFx0XHRcdFx0aWYgKG5vdGljZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0bm90aWNlcy5oaWRlKCk7XG5cdFx0XHRcdFx0XHQkKCcud3Atc211c2gtcGFnZXNwZWVkLXJlY29tbWVuZGF0aW9uJykuaGlkZSgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHQvL3JlbW92ZSBleGlzdGluZyBSZS1TbXVzaCBub3RpY2VzXG5cdFx0XHRcdFx0JCgnLndwLXNtdXNoLXJlc211c2gtbm90aWNlJykucmVtb3ZlKCk7XG5cblx0XHRcdFx0XHQvL1Nob3cgQnVsayB3cmFwcGVyXG5cdFx0XHRcdFx0JCgnLndwLXNtdXNoLWJ1bGstd3JhcHBlcicpLnNob3coKTtcblxuXHRcdFx0XHRcdGlmICgndW5kZWZpbmVkJyAhPT0gdHlwZW9mIHIuZGF0YS5jb3VudCkge1xuXHRcdFx0XHRcdFx0Ly9VcGRhdGUgcHJvZ3Jlc3MgYmFyXG5cdFx0XHRcdFx0XHR1cGRhdGVfcHJvZ3Jlc3NfYmFyX3Jlc211c2goci5kYXRhLmNvdW50KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly9JZiBjb250ZW50IGlzIHJlY2VpdmVkLCBQcmVwZW5kIGl0XG5cdFx0XHRcdGlmICgndW5kZWZpbmVkJyAhPSB0eXBlb2Ygci5kYXRhLmNvbnRlbnQpIHtcblx0XHRcdFx0XHQkKCcuYnVsay1zbXVzaC13cmFwcGVyIC5zdWktYm94LWJvZHknKS5wcmVwZW5kKHIuZGF0YS5jb250ZW50KTtcblx0XHRcdFx0fVxuXHRcdFx0XHQvL0lmIHdlIGhhdmUgYW55IG5vdGljZSB0byBzaG93XG5cdFx0XHRcdGlmICgndW5kZWZpbmVkJyAhPSB0eXBlb2Ygci5kYXRhLm5vdGljZSkge1xuXHRcdFx0XHRcdCQoJy53cC1zbXVzaC1wYWdlLWhlYWRlcicpLmFmdGVyKHIuZGF0YS5ub3RpY2UpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdC8vSGlkZSBlcnJvcnNcblx0XHRcdFx0JCgnZGl2LnNtdXNoLWZpbmFsLWxvZycpLmhpZGUoKTtcblxuXHRcdFx0XHQvL0hpZGUgU3VwZXIgU211c2ggbm90aWNlIGlmIGl0J3MgZW5hYmxlZCBpbiBtZWRpYSBzZXR0aW5nc1xuXHRcdFx0XHRpZiAoJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIHIuZGF0YS5zdXBlcl9zbXVzaCAmJiByLmRhdGEuc3VwZXJfc211c2gpIHtcblx0XHRcdFx0XHR2YXIgZW5hYmxlX2xvc3N5ID0galF1ZXJ5KCcud3Atc211c2gtZW5hYmxlLWxvc3N5Jyk7XG5cdFx0XHRcdFx0aWYgKGVuYWJsZV9sb3NzeS5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0XHRlbmFibGVfbG9zc3kucmVtb3ZlKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmICgndW5kZWZpbmVkJyAhPT0gci5kYXRhLnN1cGVyX3NtdXNoX3N0YXRzKSB7XG5cdFx0XHRcdFx0XHQkKCcuc3VwZXItc211c2gtYXR0YWNobWVudHMgLndwLXNtdXNoLXN0YXRzJykuaHRtbChyLmRhdGEuc3VwZXJfc211c2hfc3RhdHMpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHR1cGRhdGVfc3RhdHMoc2Nhbl90eXBlKTtcblx0XHRcdH1cblx0XHR9KS5hbHdheXMoZnVuY3Rpb24gKCkge1xuXG5cdFx0XHQvL0hpZGUgdGhlIHByb2dyZXNzIGJhclxuXHRcdFx0alF1ZXJ5KCcuYnVsay1zbXVzaC13cmFwcGVyIC53cC1zbXVzaC1idWxrLXByb2dyZXNzLWJhci13cmFwcGVyJykuaGlkZSgpO1xuXG5cdFx0XHQvLyBBZGQgY2hlY2sgY29tcGxldGUgc3RhdHVzIHRvIGJ1dHRvbi5cblx0XHRcdGJ1dHRvbi50ZXh0KHdwX3NtdXNoX21zZ3MucmVzbXVzaF9jb21wbGV0ZSkucmVtb3ZlQ2xhc3MoJ3N1aS1idXR0b24tb25sb2FkIHN1aS1pY29uLWxvYWRlciBzdWktbG9hZGluZycpLmFkZENsYXNzKCdzbXVzaC1idXR0b24tY2hlY2stc3VjY2VzcycpO1xuXG5cdFx0XHQvLyBSZW1vdmUgc3VjY2VzcyBtZXNzYWdlIGZyb20gYnV0dG9uLlxuXHRcdFx0c2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdGJ1dHRvbi5yZW1vdmVDbGFzcygnc211c2gtYnV0dG9uLWNoZWNrLXN1Y2Nlc3MnKS50ZXh0KHdwX3NtdXNoX21zZ3MucmVzbXVzaF9jaGVjayk7XG5cdFx0XHR9LCAyMDAwKTtcblxuXHRcdFx0JCgnLndwLXNtdXNoLWJ1dHRvbicpLnJlbW92ZUF0dHIoJ2Rpc2FibGVkJyk7XG5cblx0XHRcdC8vSWYgd3Atc211c2gtcmUtY2hlY2stbWVzc2FnZSBpcyB0aGVyZSwgcmVtb3ZlIGl0XG5cdFx0XHRpZiAoJCgnLndwLXNtdXNoLXJlLWNoZWNrLW1lc3NhZ2UnKS5sZW5ndGgpIHtcblx0XHRcdFx0cmVtb3ZlX2VsZW1lbnQoJCgnLndwLXNtdXNoLXJlLWNoZWNrLW1lc3NhZ2UnKSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH07XG5cblx0LyoqXG4gICogR2V0IGRpcmVjdG9yeSBsaXN0IHVzaW5nIEFqYXhcbiAgKlxuICAqIEBwYXJhbSBwYXJhbVxuICAqIEByZXR1cm5zIHtzdHJpbmd9XG4gICpcbiAgKi9cblx0dmFyIGdldERpcmVjdG9yeUxpc3QgPSBmdW5jdGlvbiBnZXREaXJlY3RvcnlMaXN0KHBhcmFtKSB7XG5cdFx0cGFyYW0uYWN0aW9uID0gJ3NtdXNoX2dldF9kaXJlY3RvcnlfbGlzdCc7XG5cdFx0cGFyYW0ubGlzdF9ub25jZSA9IGpRdWVyeSgnaW5wdXRbbmFtZT1cImxpc3Rfbm9uY2VcIl0nKS52YWwoKTtcblx0XHR2YXIgcmVzID0gJyc7XG5cdFx0JC5hamF4KHtcblx0XHRcdHR5cGU6IFwiR0VUXCIsXG5cdFx0XHR1cmw6IGFqYXh1cmwsXG5cdFx0XHRkYXRhOiBwYXJhbSxcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uIHN1Y2Nlc3MocmVzcG9uc2UpIHtcblx0XHRcdFx0cmVzID0gcmVzcG9uc2U7XG5cdFx0XHR9LFxuXHRcdFx0YXN5bmM6IGZhbHNlXG5cdFx0fSk7XG5cdFx0Ly9VcGRhdGUgdGhlIGJ1dHRvbiB0ZXh0XG5cdFx0JCgnYnV0dG9uLndwLXNtdXNoLXNlbGVjdC1kaXInKS5odG1sKHdwX3NtdXNoX21zZ3MuYWRkX2Rpcik7XG5cdFx0cmV0dXJuIHJlcztcblx0fTtcblx0LyoqXG4gICogSGlkZSB0aGUgcG9wdXAgYW5kIHJlc2V0IHRoZSBvcGFjaXR5IGZvciB0aGUgYnV0dG9uXG4gICpcbiAgKi9cblx0dmFyIGNsb3NlX2RpYWxvZyA9IGZ1bmN0aW9uIGNsb3NlX2RpYWxvZygpIHtcblxuXHRcdC8vIENsb3NlIHRoZSBkaWFsb2cuXG5cdFx0U1VJLmRpYWxvZ3NbJ3dwLXNtdXNoLWxpc3QtZGlhbG9nJ10uaGlkZSgpO1xuXG5cdFx0JCgnLndwLXNtdXNoLXNlbGVjdC1kaXIsIGJ1dHRvbi53cC1zbXVzaC1icm93c2UsIGJ1dHRvbi53cC1zbXVzaC1yZXN1bWUsIGEud3Atc211c2gtZGlyLWxpbmsnKS5yZW1vdmVBdHRyKCdkaXNhYmxlZCcpO1xuXG5cdFx0Ly8gUmVzZXQgdGhlIG9wYWNpdHkgZm9yIGNvbnRlbnQgYW5kIHNjYW4gYnV0dG9uXG5cdFx0JCgnLndwLXNtdXNoLXNlbGVjdC1kaXIsIC53cC1zbXVzaC1saXN0LWRpYWxvZyAuc3VpLWJveC1ib2R5JykuY3NzKHsgJ29wYWNpdHknOiAnMScgfSk7XG5cdH07XG5cblx0LyoqXG4gICogSW5pdGlhbGl6ZSBhY2NvcmRpb25cbiAgKlxuICAqL1xuXHR2YXIgc2V0X2FjY29yZGlvbiA9IGZ1bmN0aW9uIHNldF9hY2NvcmRpb24oKSB7XG5cblx0XHQvLyBiYWNrd2FyZCBjb21wYXQgb2YgaW5zdGFudGlhdGUgbmV3IGFjY29yZGlvblxuXHRcdFNVSS5zdWlBY2NvcmRpb24oJCgnLnN1aS10YWJsZS5zdWktYWNjb3JkaW9uLnNtdXNoLWRpci1zbXVzaC1hY2NvcmRpb24nKSk7XG5cdH07XG5cblx0LyoqXG4gICogQ2hlY2sgaWYgYWxsIHRoZSBlbGVtZW50cyBpbiB0aGUgZGlyZWN0b3J5IGFyZSBzbXVzaGVkIG9yIG5vdFxuICAqXG4gICogQHBhcmFtIHBhcmVudCBkaXJlY3Rvcnkgc2VsZWN0b3JcbiAgKlxuICAqIEByZXR1cm5zIHtib29sZWFufVxuICAqXG4gICovXG5cdHZhciBpc19sYXN0X2VsZW1lbnQgPSBmdW5jdGlvbiBpc19sYXN0X2VsZW1lbnQocGFyZW50KSB7XG5cdFx0dmFyIGVsZW1lbnRzID0gcGFyZW50LmZpbmQoJ2xpLndwLXNtdXNoLWltYWdlLWVsZTpub3QoLm9wdGltaXNlZCwucHJvY2Vzc2VkLC5lcnJvciknKTtcblx0XHRpZiAoZWxlbWVudHMubGVuZ3RoIDw9IDApIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH07XG5cblx0LyoqXG4gICogVXBkYXRlIGRpcmVjdG9yeSBvcHRpbWlzYXRpb24gcHJvZ3Jlc3MgaWYgdGhlIGVsZW1lbnQgaGFzIGEgcGFyZW50XG4gICpcbiAgKiBAcGFyYW0gZWxlXG4gICpcbiAgKi9cblx0dmFyIHVwZGF0ZV9kaXJfcHJvZ3Jlc3MgPSBmdW5jdGlvbiB1cGRhdGVfZGlyX3Byb2dyZXNzKGVsZSkge1xuXG5cdFx0dmFyIGVsZV90ciA9IGVsZS5jbG9zZXN0KCd0cicpO1xuXHRcdHZhciBlbGVfcHJldl90ciA9IGVsZV90ci5wcmV2KCd0cicpO1xuXHRcdHZhciBlbGVfZGlyX3Byb2dyZXNzID0gZWxlX3ByZXZfdHIuZmluZCgnLndwLXNtdXNoLWltYWdlLWRpci1wcm9ncmVzcycpO1xuXHRcdHZhciBlbGVfZGlyX3Byb2dyZXNzX3BlcmNlbnQgPSBlbGVfcHJldl90ci5maW5kKCcud3Atc211c2gtaW1hZ2UtcHJvZ3Jlc3MtcGVyY2VudCcpO1xuXHRcdHZhciBlbGVfZGlyX2NvdW50ID0gZWxlX3ByZXZfdHIuZmluZCgnLnN1aS10YWcnKTtcblx0XHR2YXIgZWxlX2V4Y2x1ZGVfYnRuID0gZWxlX3ByZXZfdHIuZmluZCgnLndwLXNtdXNoLWV4Y2x1ZGUtZGlyJyk7XG5cblx0XHR2YXIgY2hpbGRyZW4gPSBlbGUuY2xvc2VzdCgndHInKS5maW5kKCcud3Atc211c2gtaW1hZ2UtZWxlJyk7XG5cdFx0dmFyIHBhcmVudCA9IGVsZS5pcygnbGknKSA/IGVsZS5wYXJlbnQoKSA6ICcnO1xuXG5cdFx0Ly9VcGRhdGUgdGhlIHBlcmNlbnRhZ2UsIENoZWNrIHRoZSB0b3RhbCBudW1iZXIgb2YgaW1hZ2VzIGluc2lkZSBkaXIsIHNtdXNoZWQgaW1hZ2VzIGNvdW50XG5cdFx0aWYgKGNoaWxkcmVuLmxlbmd0aCA+IDApIHtcblx0XHRcdHZhciB0b3RhbCA9IGNoaWxkcmVuLmxlbmd0aDtcblx0XHRcdHZhciBzbXVzaGVkID0gY2hpbGRyZW4uZmlsdGVyKCcub3B0aW1pc2VkJykubGVuZ3RoO1xuXHRcdFx0aWYgKHNtdXNoZWQgPiAwICYmIHRvdGFsID4gMCkge1xuXHRcdFx0XHRlbGVfZGlyX3Byb2dyZXNzX3BlcmNlbnQucmVtb3ZlQ2xhc3MoJ3N1aS1oaWRkZW4nKTtcblx0XHRcdFx0dmFyIHBlcmNlbnQgPSBzbXVzaGVkIC8gdG90YWwgKiAxMDA7XG5cdFx0XHRcdHBlcmNlbnQgPSBwcmVjaXNlX3JvdW5kKHBlcmNlbnQsIDEpO1xuXHRcdFx0XHRlbGVfZGlyX3Byb2dyZXNzX3BlcmNlbnQuaHRtbChwZXJjZW50ICsgJyUnKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvL0FkZCB0aGUgY2xhc3MgaW4tcHJvZ3Jlc3MsIHRvIHNob3cgdGhlIHJlc3BlY3RpdmUgaWNvbiBmb3IgcGFyZW50XG5cdFx0aWYgKDAgIT0gJCgnaW5wdXRbbmFtZT1cIndwLXNtdXNoLWNvbnRpbnVlLWFqYXhcIl0nKS52YWwoKSAmJiBzbXVzaGVkICE9IHRvdGFsKSB7XG5cdFx0XHQvL0FwcGVuZCBhIHNwaW5uZXJcblx0XHRcdGVsZV9kaXJfcHJvZ3Jlc3MuYWRkQ2xhc3MoJ3N1aS1pY29uLWxvYWRlciBzdWktbG9hZGluZycpO1xuXHRcdH1cblxuXHRcdGlmIChwYXJlbnQubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly9DaGVjayBpZiBsYXN0IGltYWdlLCBhbmQgaWYgYWxsIHRoZSBpbWFnZXMgYXJlIG5vdCBzbXVzaGVkIHVuZGVyIHRoZSBzcGVjaWZpZWQgZGlyZWN0b3J5IHBhdGgsIGFkZCBhIGdlbmVyaWMgd2FybmluZyBtZXNzYWdlXG5cdFx0aWYgKGlzX2xhc3RfZWxlbWVudChwYXJlbnQpKSB7XG5cdFx0XHRpZiAoc211c2hlZCA8IHRvdGFsKSB7XG5cdFx0XHRcdHZhciB1bnNtdXNoZWQgPSB0b3RhbCAtIHNtdXNoZWQ7XG5cdFx0XHRcdHZhciBtZXNzYWdlID0gJzxkaXYgY2xhc3M9XCJzdWktbm90aWNlIHN1aS1ub3RpY2Utd2FybmluZ1wiPjxwPicgKyB1bnNtdXNoZWQgKyAnICcgKyAoMSA9PSB1bnNtdXNoZWQgPyB3cF9zbXVzaF9tc2dzLnVuZmluaXNoZWRfc211c2hfc2luZ2xlIDogd3Bfc211c2hfbXNncy51bmZpbmlzaGVkX3NtdXNoKSArICc8L3A+PC9kaXY+JztcblxuXHRcdFx0XHQvL0lmIHRoZSBub3RpY2UgaXMgYWxyZWFkeSBkaXNwbGF5ZWQsIHJlbW92ZSBpdFxuXHRcdFx0XHR2YXIgbm90aWNlID0gcGFyZW50LmZpbmQoJ2Rpdi5zdWktbm90aWNlJyk7XG5cdFx0XHRcdGlmIChub3RpY2UubGVuZ3RoKSB7XG5cdFx0XHRcdFx0bm90aWNlLnJlbW92ZSgpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly9BcHBlbmQgbWVzc2FnZSB0byAybmQgcGFyZW50IGkuZSBsaVxuXHRcdFx0XHRwYXJlbnQuYWZ0ZXIobWVzc2FnZSk7XG5cdFx0XHRcdGVsZV9kaXJfcHJvZ3Jlc3MucmVtb3ZlQ2xhc3MoJ3N1aS1pY29uLWxvYWRlciBzdWktbG9hZGluZycpLmFkZENsYXNzKCdwYXJ0aWFsJyk7XG5cdFx0XHRcdGVsZV90ci5maW5kKCd0ZCcpLmFkZENsYXNzKCdwYXJ0aWFsJyk7XG5cdFx0XHRcdGVsZV9wcmV2X3RyLmZpbmQoJ3RkJykuYWRkQ2xhc3MoJ3BhcnRpYWwnKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGVsZV9kaXJfcHJvZ3Jlc3MucmVtb3ZlQ2xhc3MoJ3BhcnRpYWwgc3VpLWljb24tbG9hZGVyIHN1aS1sb2FkaW5nJykuYWRkQ2xhc3MoJ29wdGltaXNlZCcpO1xuXHRcdFx0XHQvLyBVcGRhdGUgdGhlIGNvdW50IHRhZyBjbGFzcy5cblx0XHRcdFx0ZWxlX2Rpcl9jb3VudC5yZW1vdmVDbGFzcygnc3VpLXRhZy13YXJuaW5nJykuYWRkQ2xhc3MoJ3N1aS10YWctaW5hY3RpdmUnKTtcblx0XHRcdFx0ZWxlX2V4Y2x1ZGVfYnRuLmhpZGUoKTtcblx0XHRcdFx0ZWxlX3RyLmZpbmQoJ3RkJykucmVtb3ZlQ2xhc3MoJ3BhcnRpYWwnKS5hZGRDbGFzcygnb3B0aW1pc2VkJyk7XG5cdFx0XHRcdGVsZV9wcmV2X3RyLmZpbmQoJ3RkJykucmVtb3ZlQ2xhc3MoJ3BhcnRpYWwnKS5hZGRDbGFzcygnb3B0aW1pc2VkJyk7XG5cdFx0XHR9XG5cdFx0XHQvL1JlbW92ZSB0aGUgbG9hZGVyIGFuZCBwZXJjZW50YWdlLlxuXHRcdFx0ZWxlX2Rpcl9wcm9ncmVzcy5yZW1vdmVDbGFzcygnc3VpLWljb24tbG9hZGVyIHN1aS1sb2FkaW5nJyk7XG5cdFx0XHRlbGVfZGlyX3Byb2dyZXNzX3BlcmNlbnQuaHRtbCgnJyk7XG5cdFx0fVxuXHR9O1xuXG5cdC8qKlxuICAqIEFkZCBjaG9vc2UgZGlyZWN0b3J5IGJ1dHRvbiBhdCB0aGUgdG9wXG4gICpcbiAgKi9cblx0dmFyIGFkZF9kaXJfYnJvd3Nlcl9idXR0b24gPSBmdW5jdGlvbiBhZGRfZGlyX2Jyb3dzZXJfYnV0dG9uKCkge1xuXHRcdC8vR2V0IHRoZSBjb250ZW50IGRpdiBsZW5ndGgsIGlmIGxlc3MgdGhhbiAxNTAwLCBTa2lwXG5cdFx0aWYgKCQoJ2Rpdi53cC1zbXVzaC1zY2FuLXJlc3VsdCBkaXYuY29udGVudCcpLmhlaWdodCgpIDwgMTUwMCB8fCAkKCdkaXYuZGlyLXNtdXNoLWJ1dHRvbi13cmFwLnRvcCcpLmxlbmd0aCA+PSAxKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dmFyIGNob29zZV9idXR0b24gPSAkKCdkaXYuZGlyLXNtdXNoLWJ1dHRvbi13cmFwJykuY2xvbmUoKTtcblx0XHRjaG9vc2VfYnV0dG9uLmFkZENsYXNzKCd0b3AnKTtcblx0XHQkKCdkaXYud3Atc211c2gtc2Nhbi1yZXN1bHQgZGl2LmNvbnRlbnQnKS5wcmVwZW5kKGNob29zZV9idXR0b24pO1xuXHR9O1xuXG5cdHZhciBhZGRfc211c2hfYnV0dG9uID0gZnVuY3Rpb24gYWRkX3NtdXNoX2J1dHRvbigpIHtcblx0XHQvL0dldCB0aGUgY29udGVudCBkaXYgbGVuZ3RoLCBpZiBsZXNzIHRoYW4gMTUwMCwgU2tpcFxuXHRcdGlmICgkKCdkaXYud3Atc211c2gtc2Nhbi1yZXN1bHQgZGl2LmNvbnRlbnQnKS5oZWlnaHQoKSA8IDE1MDAgfHwgJCgnZGl2LndwLXNtdXNoLWFsbC1idXR0b24td3JhcC50b3AnKS5sZW5ndGggPj0gMSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHZhciBzbXVzaF9idXR0b24gPSAkKCdkaXYud3Atc211c2gtYWxsLWJ1dHRvbi13cmFwLmJvdHRvbScpLmNsb25lKCk7XG5cdFx0c211c2hfYnV0dG9uLmFkZENsYXNzKCd0b3AnKS5yZW1vdmVDbGFzcygnYm90dG9tJyk7XG5cdFx0JCgnZGl2LndwLXNtdXNoLXNjYW4tcmVzdWx0IGRpdi5jb250ZW50JykucHJlcGVuZChzbXVzaF9idXR0b24pO1xuXHR9O1xuXG5cdC8qKlxuICAqIEFkZCBzbXVzaCBub3RpY2UgYWZ0ZXIgZGlyZWN0b3J5IHNtdXNoaW5nIGlzIGZpbmlzaGVkXG4gICpcbiAgKiBAcGFyYW0gbm90aWNlX3R5cGVcbiAgKiAgYWxsX2RvbmUgLSAgSWYgYWxsIHRoZSBpbWFnZXMgd2VyZSBzbXVzaGVkIGVsc2Ugd2FybmluZ1xuICAqICBzbXVzaF9saW1pdCAtIElmIEZyZWUgdXNlcnMgZXhjZWVkZWQgbGltaXRcbiAgKlxuICAqL1xuXHR2YXIgYWRkX3NtdXNoX2Rpcl9ub3RpY2UgPSBmdW5jdGlvbiBhZGRfc211c2hfZGlyX25vdGljZShub3RpY2VfdHlwZSkge1xuXHRcdC8vR2V0IHRoZSBjb250ZW50IGRpdiBsZW5ndGgsIGlmIGxlc3MgdGhhbiAxNTAwLCBTa2lwXG5cdFx0aWYgKCQoJ2Rpdi53cC1zbXVzaC1zY2FuLXJlc3VsdCBkaXYuY29udGVudCcpLmhlaWdodCgpIDwgMTUwMCB8fCAkKCdkaXYud3Atc211c2gtc2Nhbi1yZXN1bHQgZGl2LnN1aS1ub3RpY2UudG9wJykubGVuZ3RoID49IDEpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0dmFyIG5vdGljZSA9ICcnO1xuXHRcdC8vQ2xvbmUgYW5kIGFwcGVuZCB0aGUgbm90aWNlXG5cdFx0aWYgKCdhbGxfZG9uZScgPT0gbm90aWNlX3R5cGUpIHtcblx0XHRcdG5vdGljZSA9ICQoJ2Rpdi5zdWktbm90aWNlLndwLXNtdXNoLWRpci1hbGwtZG9uZScpLmNsb25lKCk7XG5cdFx0fSBlbHNlIGlmICgnc211c2hfbGltaXQnID09IG5vdGljZV90eXBlKSB7XG5cdFx0XHRub3RpY2UgPSAkKCdkaXYuc3VpLW5vdGljZS53cC1zbXVzaC1kaXItbGltaXQnKS5jbG9uZSgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRub3RpY2UgPSAkKCdkaXYuc3VpLW5vdGljZS53cC1zbXVzaC1kaXItcmVtYWluaW5nJykuY2xvbmUoKTtcblx0XHR9XG5cblx0XHQvL0FkZCBjbGFzcyB0b3Bcblx0XHRub3RpY2UuYWRkQ2xhc3MoJ3RvcCcpO1xuXG5cdFx0Ly9BcHBlbmQgdGhlIG5vdGljZVxuXHRcdCQoJ2Rpdi53cC1zbXVzaC1zY2FuLXJlc3VsdCBkaXYuZGlyLXNtdXNoLWJ1dHRvbi13cmFwJykuYWZ0ZXIobm90aWNlKTtcblx0fTtcblxuXHR2YXIgdXBkYXRlX3NtdXNoX3Byb2dyZXNzID0gZnVuY3Rpb24gdXBkYXRlX3NtdXNoX3Byb2dyZXNzKCkge1xuXHRcdHZhciBpbl9wcm9ncmVzc19wYXRoID0gJCgndWwud3Atc211c2gtaW1hZ2UtbGlzdCBsaS5pbi1wcm9ncmVzcycpO1xuXHRcdGluX3Byb2dyZXNzX3BhdGgucmVtb3ZlQ2xhc3MoJ2luLXByb2dyZXNzIGFjdGl2ZScpO1xuXHRcdGlmIChpbl9wcm9ncmVzc19wYXRoLmxlbmd0aCA+IDApIHtcblx0XHRcdGluX3Byb2dyZXNzX3BhdGguZWFjaChmdW5jdGlvbiAoaW5kZXgsIGVsZSkge1xuXHRcdFx0XHRpZiAoJChlbGUpLmhhc0NsYXNzKCd3cC1zbXVzaC1pbWFnZS11bCcpKSB7XG5cdFx0XHRcdFx0Ly9SZW1vdmUgU3Bpbm5lclxuXHRcdFx0XHRcdCQoZWxlKS5maW5kKCdzcGFuLnNwaW5uZXInKS5yZW1vdmUoKTtcblxuXHRcdFx0XHRcdC8vQ2hlY2sgaWYgaW1hZ2VzIGFyZSBwZW5kaW5nXG5cdFx0XHRcdFx0dmFyIGluX3Byb2dyZXNzX2VsZSA9ICQoZWxlKS5maW5kKCdsaS53cC1zbXVzaC1pbWFnZS1lbGUnKTtcblxuXHRcdFx0XHRcdC8vSWYgdGhlcmUgYXJlIGVsZW1lbnRzXG5cdFx0XHRcdFx0aWYgKGluX3Byb2dyZXNzX2VsZS5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0XHR2YXIgb3B0aW1pc2VkID0gaW5fcHJvZ3Jlc3NfZWxlLmZpbHRlcignLm9wdGltaXNlZCcpLmxlbmd0aDtcblx0XHRcdFx0XHRcdHZhciBlcnJvciA9IGluX3Byb2dyZXNzX2VsZS5maWx0ZXIoJy5lcnJvcicpLmxlbmd0aDtcblx0XHRcdFx0XHRcdC8vaWYgYWxsIHRoZSBlbGVtZW50cyBhcmUgb3B0aW1pc2VkXG5cdFx0XHRcdFx0XHRpZiAob3B0aW1pc2VkID09IGluX3Byb2dyZXNzX2VsZS5sZW5ndGgpIHtcblx0XHRcdFx0XHRcdFx0JChlbGUpLmFkZENsYXNzKCdjb21wbGV0ZScpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIGlmICgwIDwgb3B0aW1pc2VkIHx8IDAgPCBlcnJvcikge1xuXHRcdFx0XHRcdFx0XHQvL0lmIHRoZXJlIGFyZSBpbWFnZXMgdGhhdCBuZWVkcyB0byBiZSBzbXVzaGVkLCBhZGQgdGhlIGNsYXNzIHBhcnRpYWxcblx0XHRcdFx0XHRcdFx0JChlbGUpLmFkZENsYXNzKCdwYXJ0aWFsJyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdC8vUmVtb3ZlIHNwaW5uZXIgZm9yIHRoZSBlbGVtZW50XG5cdFx0XHRcdFx0JChlbGUpLmZpbmQoJ3NwYW4uc3Bpbm5lcicpLnJlbW92ZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9XG5cdH07XG5cblx0LyoqXG4gICogU2V0IHBybyBzYXZpbmdzIHN0YXRzIGlmIG5vdCBwcmVtaXVtIHVzZXIuXG4gICpcbiAgKiBGb3Igbm9uLXByZW1pdW0gdXNlcnMsIHNob3cgZXhwZWN0ZWQgYXZhcmFnZSBzYXZpbmdzIGJhc2VkXG4gICogb24gdGhlIGZyZWUgdmVyc2lvbiBzYXZpbmdzLlxuICAqL1xuXHR2YXIgc2V0X3Byb19zYXZpbmdzID0gZnVuY3Rpb24gc2V0X3Byb19zYXZpbmdzKCkge1xuXG5cdFx0Ly8gRGVmYXVsdCB2YWx1ZXMuXG5cdFx0dmFyIHNhdmluZ3MgPSB3cF9zbXVzaGl0X2RhdGEuc2F2aW5nc19wZXJjZW50ID4gMCA/IHdwX3NtdXNoaXRfZGF0YS5zYXZpbmdzX3BlcmNlbnQgOiAwO1xuXHRcdHZhciBzYXZpbmdzX2J5dGVzID0gd3Bfc211c2hpdF9kYXRhLnNhdmluZ3NfYnl0ZXMgPiAwID8gd3Bfc211c2hpdF9kYXRhLnNhdmluZ3NfYnl0ZXMgOiAwO1xuXHRcdHZhciBvcmlnX2RpZmYgPSAyLjIyMDU4ODI0O1xuXHRcdGlmIChzYXZpbmdzID4gNDkpIHtcblx0XHRcdHZhciBvcmlnX2RpZmYgPSAxLjIyMDU0NDEyO1xuXHRcdH1cblx0XHQvL0NhbGN1bGF0ZSBQcm8gc2F2aW5nc1xuXHRcdGlmIChzYXZpbmdzID4gMCkge1xuXHRcdFx0c2F2aW5ncyA9IG9yaWdfZGlmZiAqIHNhdmluZ3M7XG5cdFx0XHRzYXZpbmdzX2J5dGVzID0gb3JpZ19kaWZmICogc2F2aW5nc19ieXRlcztcblx0XHR9XG5cblx0XHR3cF9zbXVzaGl0X2RhdGEucHJvX3NhdmluZ3MgPSB7XG5cdFx0XHQncGVyY2VudCc6IHByZWNpc2Vfcm91bmQoc2F2aW5ncywgMSksXG5cdFx0XHQnc2F2aW5nc19ieXRlcyc6IGZvcm1hdEJ5dGVzKHNhdmluZ3NfYnl0ZXMsIDEpXG5cblx0XHR9O1xuXHR9O1xuXG5cdC8qKlxuICAqIEFkZHMgdGhlIHN0YXRzIGZvciB0aGUgY3VycmVudCBpbWFnZSB0byBleGlzdGluZyBzdGF0c1xuICAqXG4gICogQHBhcmFtIGltYWdlX3N0YXRzXG4gICpcbiAgKi9cblx0dmFyIHVwZGF0ZV9sb2NhbGl6ZWRfc3RhdHMgPSBmdW5jdGlvbiB1cGRhdGVfbG9jYWxpemVkX3N0YXRzKGltYWdlX3N0YXRzLCB0eXBlKSB7XG5cdFx0Ly9JbmNyZWFzZSB0aGUgc211c2ggY291bnRcblx0XHRpZiAoJ3VuZGVmaW5lZCcgPT0gdHlwZW9mIHdwX3NtdXNoaXRfZGF0YSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vTm8gbmVlZCB0byBpbmNyZWFzZSBhdHRhY2htZW50IGNvdW50LCByZXNpemUsIGNvbnZlcnNpb24gc2F2aW5ncyBmb3IgZGlyZWN0b3J5IHNtdXNoXG5cdFx0aWYgKCdtZWRpYScgPT0gdHlwZSkge1xuXHRcdFx0d3Bfc211c2hpdF9kYXRhLmNvdW50X3NtdXNoZWQgPSBwYXJzZUludCh3cF9zbXVzaGl0X2RhdGEuY291bnRfc211c2hlZCkgKyAxO1xuXG5cdFx0XHQvL0luY3JlYXNlIHNtdXNoZWQgaW1hZ2UgY291bnRcblx0XHRcdHdwX3NtdXNoaXRfZGF0YS5jb3VudF9pbWFnZXMgPSBwYXJzZUludCh3cF9zbXVzaGl0X2RhdGEuY291bnRfaW1hZ2VzKSArIHBhcnNlSW50KGltYWdlX3N0YXRzLmNvdW50KTtcblxuXHRcdFx0Ly9JbmNyZWFzZSBzdXBlciBzbXVzaCBjb3VudCwgaWYgYXBwbGljYWJsZVxuXHRcdFx0aWYgKGltYWdlX3N0YXRzLmlzX2xvc3N5KSB7XG5cdFx0XHRcdHdwX3NtdXNoaXRfZGF0YS5jb3VudF9zdXBlcnNtdXNoZWQgPSBwYXJzZUludCh3cF9zbXVzaGl0X2RhdGEuY291bnRfc3VwZXJzbXVzaGVkKSArIDE7XG5cdFx0XHR9XG5cblx0XHRcdC8vQWRkIHRvIFJlc2l6ZSBTYXZpbmdzXG5cdFx0XHR3cF9zbXVzaGl0X2RhdGEuc2F2aW5nc19yZXNpemUgPSAndW5kZWZpbmVkJyAhPSB0eXBlb2YgaW1hZ2Vfc3RhdHMuc2F2aW5nc19yZXNpemUuYnl0ZXMgPyBwYXJzZUludCh3cF9zbXVzaGl0X2RhdGEuc2F2aW5nc19yZXNpemUpICsgcGFyc2VJbnQoaW1hZ2Vfc3RhdHMuc2F2aW5nc19yZXNpemUuYnl0ZXMpIDogcGFyc2VJbnQod3Bfc211c2hpdF9kYXRhLnNhdmluZ3NfcmVzaXplKTtcblxuXHRcdFx0Ly9VcGRhdGUgUmVzaXplIGNvdW50XG5cdFx0XHR3cF9zbXVzaGl0X2RhdGEuY291bnRfcmVzaXplID0gJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIGltYWdlX3N0YXRzLnNhdmluZ3NfcmVzaXplLmJ5dGVzID8gcGFyc2VJbnQod3Bfc211c2hpdF9kYXRhLmNvdW50X3Jlc2l6ZSkgKyAxIDogd3Bfc211c2hpdF9kYXRhLmNvdW50X3Jlc2l6ZTtcblxuXHRcdFx0Ly9BZGQgdG8gQ29udmVyc2lvbiBTYXZpbmdzXG5cdFx0XHR3cF9zbXVzaGl0X2RhdGEuc2F2aW5nc19jb252ZXJzaW9uID0gJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIGltYWdlX3N0YXRzLnNhdmluZ3NfY29udmVyc2lvbiAmJiAndW5kZWZpbmVkJyAhPSB0eXBlb2YgaW1hZ2Vfc3RhdHMuc2F2aW5nc19jb252ZXJzaW9uLmJ5dGVzID8gcGFyc2VJbnQod3Bfc211c2hpdF9kYXRhLnNhdmluZ3NfY29udmVyc2lvbikgKyBwYXJzZUludChpbWFnZV9zdGF0cy5zYXZpbmdzX2NvbnZlcnNpb24uYnl0ZXMpIDogcGFyc2VJbnQod3Bfc211c2hpdF9kYXRhLnNhdmluZ3NfY29udmVyc2lvbik7XG5cdFx0fSBlbHNlIGlmICgnZGlyZWN0b3J5X3NtdXNoJyA9PSB0eXBlKSB7XG5cdFx0XHQvL0luY3JlYXNlIHNtdXNoZWQgaW1hZ2UgY291bnRcblx0XHRcdHdwX3NtdXNoaXRfZGF0YS5jb3VudF9pbWFnZXMgPSBwYXJzZUludCh3cF9zbXVzaGl0X2RhdGEuY291bnRfaW1hZ2VzKSArIDE7XG5cdFx0fSBlbHNlIGlmICgnbmV4dGdlbicgPT0gdHlwZSkge1xuXHRcdFx0d3Bfc211c2hpdF9kYXRhLmNvdW50X3NtdXNoZWQgPSBwYXJzZUludCh3cF9zbXVzaGl0X2RhdGEuY291bnRfc211c2hlZCkgKyAxO1xuXHRcdFx0d3Bfc211c2hpdF9kYXRhLmNvdW50X3N1cGVyc211c2hlZCA9IHBhcnNlSW50KHdwX3NtdXNoaXRfZGF0YS5jb3VudF9zdXBlcnNtdXNoZWQpICsgMTtcblxuXHRcdFx0Ly9JbmNyZWFzZSBzbXVzaGVkIGltYWdlIGNvdW50XG5cdFx0XHR3cF9zbXVzaGl0X2RhdGEuY291bnRfaW1hZ2VzID0gcGFyc2VJbnQod3Bfc211c2hpdF9kYXRhLmNvdW50X2ltYWdlcykgKyBwYXJzZUludChpbWFnZV9zdGF0cy5jb3VudCk7XG5cdFx0fVxuXG5cdFx0Ly9JZiB3ZSBoYXZlIHNhdmluZ3Ncblx0XHRpZiAoaW1hZ2Vfc3RhdHMuc2l6ZV9iZWZvcmUgPiBpbWFnZV9zdGF0cy5zaXplX2FmdGVyKSB7XG5cdFx0XHQvL1VwZGF0ZSBzYXZpbmdzXG5cdFx0XHR3cF9zbXVzaGl0X2RhdGEuc2l6ZV9iZWZvcmUgPSAndW5kZWZpbmVkJyAhPSB0eXBlb2YgaW1hZ2Vfc3RhdHMuc2l6ZV9iZWZvcmUgPyBwYXJzZUludCh3cF9zbXVzaGl0X2RhdGEuc2l6ZV9iZWZvcmUpICsgcGFyc2VJbnQoaW1hZ2Vfc3RhdHMuc2l6ZV9iZWZvcmUpIDogcGFyc2VJbnQod3Bfc211c2hpdF9kYXRhLnNpemVfYmVmb3JlKTtcblx0XHRcdHdwX3NtdXNoaXRfZGF0YS5zaXplX2FmdGVyID0gJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIGltYWdlX3N0YXRzLnNpemVfYWZ0ZXIgPyBwYXJzZUludCh3cF9zbXVzaGl0X2RhdGEuc2l6ZV9hZnRlcikgKyBwYXJzZUludChpbWFnZV9zdGF0cy5zaXplX2FmdGVyKSA6IHBhcnNlSW50KHdwX3NtdXNoaXRfZGF0YS5zaXplX2FmdGVyKTtcblx0XHR9XG5cdFx0Ly9BZGQgc3RhdHMgZm9yIHJlc2l6aW5nXG5cdFx0aWYgKCd1bmRlZmluZWQnICE9IHR5cGVvZiBpbWFnZV9zdGF0cy5zYXZpbmdzX3Jlc2l6ZSkge1xuXHRcdFx0Ly9VcGRhdGUgc2F2aW5nc1xuXHRcdFx0d3Bfc211c2hpdF9kYXRhLnNpemVfYmVmb3JlID0gJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIGltYWdlX3N0YXRzLnNhdmluZ3NfcmVzaXplLnNpemVfYmVmb3JlID8gcGFyc2VJbnQod3Bfc211c2hpdF9kYXRhLnNpemVfYmVmb3JlKSArIHBhcnNlSW50KGltYWdlX3N0YXRzLnNhdmluZ3NfcmVzaXplLnNpemVfYmVmb3JlKSA6IHBhcnNlSW50KHdwX3NtdXNoaXRfZGF0YS5zaXplX2JlZm9yZSk7XG5cdFx0XHR3cF9zbXVzaGl0X2RhdGEuc2l6ZV9hZnRlciA9ICd1bmRlZmluZWQnICE9IHR5cGVvZiBpbWFnZV9zdGF0cy5zYXZpbmdzX3Jlc2l6ZS5zaXplX2FmdGVyID8gcGFyc2VJbnQod3Bfc211c2hpdF9kYXRhLnNpemVfYWZ0ZXIpICsgcGFyc2VJbnQoaW1hZ2Vfc3RhdHMuc2F2aW5nc19yZXNpemUuc2l6ZV9hZnRlcikgOiBwYXJzZUludCh3cF9zbXVzaGl0X2RhdGEuc2l6ZV9hZnRlcik7XG5cdFx0fVxuXHRcdC8vQWRkIHN0YXRzIGZvciBDb252ZXJzaW9uXG5cdFx0aWYgKCd1bmRlZmluZWQnICE9IHR5cGVvZiBpbWFnZV9zdGF0cy5zYXZpbmdzX2NvbnZlcnNpb24pIHtcblx0XHRcdC8vVXBkYXRlIHNhdmluZ3Ncblx0XHRcdHdwX3NtdXNoaXRfZGF0YS5zaXplX2JlZm9yZSA9ICd1bmRlZmluZWQnICE9IHR5cGVvZiBpbWFnZV9zdGF0cy5zYXZpbmdzX2NvbnZlcnNpb24uc2l6ZV9iZWZvcmUgPyBwYXJzZUludCh3cF9zbXVzaGl0X2RhdGEuc2l6ZV9iZWZvcmUpICsgcGFyc2VJbnQoaW1hZ2Vfc3RhdHMuc2F2aW5nc19jb252ZXJzaW9uLnNpemVfYmVmb3JlKSA6IHBhcnNlSW50KHdwX3NtdXNoaXRfZGF0YS5zaXplX2JlZm9yZSk7XG5cdFx0XHR3cF9zbXVzaGl0X2RhdGEuc2l6ZV9hZnRlciA9ICd1bmRlZmluZWQnICE9IHR5cGVvZiBpbWFnZV9zdGF0cy5zYXZpbmdzX2NvbnZlcnNpb24uc2l6ZV9hZnRlciA/IHBhcnNlSW50KHdwX3NtdXNoaXRfZGF0YS5zaXplX2FmdGVyKSArIHBhcnNlSW50KGltYWdlX3N0YXRzLnNhdmluZ3NfY29udmVyc2lvbi5zaXplX2FmdGVyKSA6IHBhcnNlSW50KHdwX3NtdXNoaXRfZGF0YS5zaXplX2FmdGVyKTtcblx0XHR9XG5cdH07XG5cblx0LyoqXG4gICogVXBkYXRlIGFsbCBzdGF0cyBzZWN0aW9ucyBiYXNlZCBvbiB0aGUgcmVzcG9uc2UuXG4gICpcbiAgKiBAcGFyYW0gc2Nhbl90eXBlIEN1cnJlbnQgc2NhbiB0eXBlLlxuICAqL1xuXHR2YXIgdXBkYXRlX3N0YXRzID0gZnVuY3Rpb24gdXBkYXRlX3N0YXRzKHNjYW5fdHlwZSkge1xuXG5cdFx0dmFyIHN1cGVyX3NhdmluZ3MgPSAwLFxuXHRcdCAgICBzbXVzaGVkX2NvdW50ID0gMDtcblx0XHR2YXIgaXNfbmV4dGdlbiA9ICd1bmRlZmluZWQnICE9IHR5cGVvZiBzY2FuX3R5cGUgJiYgJ25leHRnZW4nID09IHNjYW5fdHlwZTtcblxuXHRcdC8vQ2FsY3VsYXRlIHVwZGF0ZWQgc2F2aW5ncyBpbiBieXRlc1xuXHRcdHdwX3NtdXNoaXRfZGF0YS5zYXZpbmdzX2J5dGVzID0gcGFyc2VJbnQod3Bfc211c2hpdF9kYXRhLnNpemVfYmVmb3JlKSAtIHBhcnNlSW50KHdwX3NtdXNoaXRfZGF0YS5zaXplX2FmdGVyKTtcblxuXHRcdHZhciBmb3JtYXR0ZWRfc2l6ZSA9IGZvcm1hdEJ5dGVzKHdwX3NtdXNoaXRfZGF0YS5zYXZpbmdzX2J5dGVzLCAxKTtcblxuXHRcdGlmIChpc19uZXh0Z2VuKSB7XG5cdFx0XHQkKCcud3Atc211c2gtc2F2aW5ncyAud3Atc211c2gtc3RhdHMtaHVtYW4nKS5odG1sKGZvcm1hdHRlZF9zaXplKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0JCgnLndwLXNtdXNoLXNhdmluZ3MgLndwLXNtdXNoLXN0YXRzLWh1bWFuJykuaHRtbChnZXRGb3JtYXRGcm9tU3RyaW5nKGZvcm1hdHRlZF9zaXplKSk7XG5cdFx0XHQkKCcuc3VpLXN1bW1hcnktbGFyZ2Uud3Atc211c2gtc3RhdHMtaHVtYW4nKS5odG1sKGdldFNpemVGcm9tU3RyaW5nKGZvcm1hdHRlZF9zaXplKSk7XG5cdFx0fVxuXG5cdFx0Ly9VcGRhdGUgdGhlIHNhdmluZ3MgcGVyY2VudFxuXHRcdHdwX3NtdXNoaXRfZGF0YS5zYXZpbmdzX3BlcmNlbnQgPSBwcmVjaXNlX3JvdW5kKHBhcnNlSW50KHdwX3NtdXNoaXRfZGF0YS5zYXZpbmdzX2J5dGVzKSAvIHBhcnNlSW50KHdwX3NtdXNoaXRfZGF0YS5zaXplX2JlZm9yZSkgKiAxMDAsIDEpO1xuXHRcdGlmICghaXNOYU4od3Bfc211c2hpdF9kYXRhLnNhdmluZ3NfcGVyY2VudCkpIHtcblx0XHRcdCQoJy53cC1zbXVzaC1zYXZpbmdzIC53cC1zbXVzaC1zdGF0cy1wZXJjZW50JykuaHRtbCh3cF9zbXVzaGl0X2RhdGEuc2F2aW5nc19wZXJjZW50KTtcblx0XHR9XG5cblx0XHQvL1VwZGF0ZSBTYXZpbmdzIGluIHNoYXJlIG1lc3NhZ2Vcblx0XHQvLyQoICdzcGFuLnNtdXNoLXNoYXJlLXNhdmluZ3MnICkuaHRtbCggZm9ybWF0Qnl0ZXMoIHdwX3NtdXNoaXRfZGF0YS5zYXZpbmdzX2J5dGVzLCAxICkgKTtcblxuXHRcdC8vVXBkYXRlIFNtdXNoIHBlcmNlbnRcblx0XHR3cF9zbXVzaGl0X2RhdGEuc211c2hfcGVyY2VudCA9IHByZWNpc2Vfcm91bmQocGFyc2VJbnQod3Bfc211c2hpdF9kYXRhLmNvdW50X3NtdXNoZWQpIC8gcGFyc2VJbnQod3Bfc211c2hpdF9kYXRhLmNvdW50X3RvdGFsKSAqIDEwMCwgMSk7XG5cdFx0JCgnc3Bhbi53cC1zbXVzaC1pbWFnZXMtcGVyY2VudCcpLmh0bWwod3Bfc211c2hpdF9kYXRhLnNtdXNoX3BlcmNlbnQpO1xuXG5cdFx0Ly9TdXBlci1TbXVzaCBTYXZpbmdzXG5cdFx0aWYgKCd1bmRlZmluZWQnICE9IHR5cGVvZiB3cF9zbXVzaGl0X2RhdGEuc2F2aW5nc19ieXRlcyAmJiAndW5kZWZpbmVkJyAhPSB0eXBlb2Ygd3Bfc211c2hpdF9kYXRhLnNhdmluZ3NfcmVzaXplKSB7XG5cdFx0XHRzdXBlcl9zYXZpbmdzID0gcGFyc2VJbnQod3Bfc211c2hpdF9kYXRhLnNhdmluZ3NfYnl0ZXMpIC0gcGFyc2VJbnQod3Bfc211c2hpdF9kYXRhLnNhdmluZ3NfcmVzaXplKTtcblx0XHRcdGlmIChzdXBlcl9zYXZpbmdzID4gMCkge1xuXHRcdFx0XHQkKCdsaS5zdXBlci1zbXVzaC1hdHRhY2htZW50cyBzcGFuLnNtdXNoZWQtc2F2aW5ncycpLmh0bWwoZm9ybWF0Qnl0ZXMoc3VwZXJfc2F2aW5ncywgMSkpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vVXBkYXRlIEltYWdlIGNvdW50XG5cdFx0aWYgKGlzX25leHRnZW4pIHtcblx0XHRcdCQoJy5zdWktc3VtbWFyeS1kZXRhaWxzIHNwYW4ud3Atc211c2gtdG90YWwtb3B0aW1pc2VkJykuaHRtbCh3cF9zbXVzaGl0X2RhdGEuY291bnRfaW1hZ2VzKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0JCgnc3Bhbi5zbXVzaGVkLWl0ZW1zLWNvdW50IHNwYW4ud3Atc211c2gtY291bnQtdG90YWwgc3Bhbi53cC1zbXVzaC10b3RhbC1vcHRpbWlzZWQnKS5odG1sKHdwX3NtdXNoaXRfZGF0YS5jb3VudF9pbWFnZXMpO1xuXHRcdH1cblxuXHRcdC8vVXBkYXRlIGltYWdlIGNvdW50IGluIHNoYXJlIG1lc3NhZ2Vcblx0XHQvLyQoICdzcGFuLnNtdXNoLXNoYXJlLWltYWdlLWNvdW50JyApLmh0bWwoIHdwX3NtdXNoaXRfZGF0YS5jb3VudF9pbWFnZXMgKTtcblxuXHRcdC8vVXBkYXRlIFJlc2l6ZSBpbWFnZSBjb3VudFxuXHRcdCQoJ3NwYW4uc211c2hlZC1pdGVtcy1jb3VudCBzcGFuLndwLXNtdXNoLWNvdW50LXJlc2l6ZS10b3RhbCBzcGFuLndwLXNtdXNoLXRvdGFsLW9wdGltaXNlZCcpLmh0bWwod3Bfc211c2hpdF9kYXRhLmNvdW50X3Jlc2l6ZSk7XG5cblx0XHQvL1VwZGF0ZSBBdHRhY2htZW50IGltYWdlIGNvdW50XG5cdFx0Ly8kKCAnZGl2LndwLXNtdXNoLWNvdW50LWF0dGFjaG1lbnQtdG90YWwgc3Bhbi53cC1zbXVzaC10b3RhbC1vcHRpbWlzZWQnICkuaHRtbCggd3Bfc211c2hpdF9kYXRhLmNvdW50X3NtdXNoZWQgKTtcblxuXHRcdC8vVXBkYXRlIGltYWdlIGNvdW50IGluIHNoYXJlIG1lc3NhZ2VcblxuXHRcdC8vVXBkYXRlIHN1cGVyc211c2hlZCBpbWFnZSBjb3VudFxuXHRcdGlmICgkKCdsaS5zdXBlci1zbXVzaC1hdHRhY2htZW50cyAuc211c2hlZC1jb3VudCcpLmxlbmd0aCAmJiAndW5kZWZpbmVkJyAhPSB0eXBlb2Ygd3Bfc211c2hpdF9kYXRhLmNvdW50X3N1cGVyc211c2hlZCkge1xuXHRcdFx0JCgnbGkuc3VwZXItc211c2gtYXR0YWNobWVudHMgLnNtdXNoZWQtY291bnQnKS5odG1sKHdwX3NtdXNoaXRfZGF0YS5jb3VudF9zdXBlcnNtdXNoZWQpO1xuXHRcdH1cblxuXHRcdC8vVXBkYXRlIENvbnZlcnNpb24gU2F2aW5nc1xuXHRcdHZhciBzbXVzaF9jb252ZXJzaW9uX3NhdmluZ3MgPSAkKCcuc211c2gtY29udmVyc2lvbi1zYXZpbmdzJyk7XG5cdFx0aWYgKHNtdXNoX2NvbnZlcnNpb25fc2F2aW5ncy5sZW5ndGggPiAwICYmICd1bmRlZmluZWQnICE9IHR5cGVvZiB3cF9zbXVzaGl0X2RhdGEuc2F2aW5nc19jb252ZXJzaW9uICYmIHdwX3NtdXNoaXRfZGF0YS5zYXZpbmdzX2NvbnZlcnNpb24gIT0gJycpIHtcblx0XHRcdHZhciBjb252ZXJzaW9uX3NhdmluZ3MgPSBzbXVzaF9jb252ZXJzaW9uX3NhdmluZ3MuZmluZCgnLndwLXNtdXNoLXN0YXRzJyk7XG5cdFx0XHRpZiAoY29udmVyc2lvbl9zYXZpbmdzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0Y29udmVyc2lvbl9zYXZpbmdzLmh0bWwoZm9ybWF0Qnl0ZXMod3Bfc211c2hpdF9kYXRhLnNhdmluZ3NfY29udmVyc2lvbiwgMSkpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vVXBkYXRlIFJlc2l6ZSBTYXZpbmdzXG5cdFx0dmFyIHNtdXNoX3Jlc2l6ZV9zYXZpbmdzID0gJCgnLnNtdXNoLXJlc2l6ZS1zYXZpbmdzJyk7XG5cdFx0aWYgKHNtdXNoX3Jlc2l6ZV9zYXZpbmdzLmxlbmd0aCA+IDAgJiYgJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIHdwX3NtdXNoaXRfZGF0YS5zYXZpbmdzX3Jlc2l6ZSAmJiB3cF9zbXVzaGl0X2RhdGEuc2F2aW5nc19yZXNpemUgIT0gJycpIHtcblx0XHRcdC8vIEdldCB0aGUgcmVzaXplIHNhdmluZ3MgaW4gbnVtYmVyLlxuXHRcdFx0dmFyIHNhdmluZ3NfdmFsdWUgPSBwYXJzZUludCh3cF9zbXVzaGl0X2RhdGEuc2F2aW5nc19yZXNpemUpO1xuXHRcdFx0dmFyIHJlc2l6ZV9zYXZpbmdzID0gc211c2hfcmVzaXplX3NhdmluZ3MuZmluZCgnLndwLXNtdXNoLXN0YXRzJyk7XG5cdFx0XHR2YXIgcmVzaXplX21lc3NhZ2UgPSBzbXVzaF9yZXNpemVfc2F2aW5ncy5maW5kKCcud3Atc211c2gtc3RhdHMtbGFiZWwtbWVzc2FnZScpO1xuXHRcdFx0Ly8gUmVwbGFjZSBvbmx5IGlmIHZhbHVlIGlzIGdyYXRlciB0aGFuIDAuXG5cdFx0XHRpZiAoc2F2aW5nc192YWx1ZSA+IDAgJiYgcmVzaXplX3NhdmluZ3MubGVuZ3RoID4gMCkge1xuXHRcdFx0XHQvLyBIaWRlIG1lc3NhZ2UuXG5cdFx0XHRcdGlmIChyZXNpemVfbWVzc2FnZS5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0cmVzaXplX21lc3NhZ2UuaGlkZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJlc2l6ZV9zYXZpbmdzLmh0bWwoZm9ybWF0Qnl0ZXMod3Bfc211c2hpdF9kYXRhLnNhdmluZ3NfcmVzaXplLCAxKSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly9VcGRhdGUgcHJvIFNhdmluZ3Ncblx0XHRzZXRfcHJvX3NhdmluZ3MoKTtcblxuXHRcdC8vIFVwZGF0aW5nIHBybyBzYXZpbmdzIHN0YXRzLlxuXHRcdGlmICgndW5kZWZpbmVkJyAhPSB0eXBlb2Ygd3Bfc211c2hpdF9kYXRhLnByb19zYXZpbmdzKSB7XG5cdFx0XHQvLyBNYWtlIHBybyBzYXZpbmdzIGRpdiB2aXNpYmxlIGlmIGhpZGRlbi5cblx0XHRcdCQoJyNzbXVzaC1hdmctcHJvLXNhdmluZ3MnKS5yZW1vdmVDbGFzcygnc3VpLWhpZGRlbicpO1xuXHRcdFx0Ly8gUHJvIHN0YXRzIHNlY3Rpb24uXG5cdFx0XHR2YXIgc211c2hfcHJvX3NhdmluZ3MgPSAkKCcuc211c2gtYXZnLXByby1zYXZpbmdzJyk7XG5cdFx0XHRpZiAoc211c2hfcHJvX3NhdmluZ3MubGVuZ3RoID4gMCkge1xuXHRcdFx0XHR2YXIgcHJvX3NhdmluZ3NfcGVyY2VudCA9IHNtdXNoX3Byb19zYXZpbmdzLmZpbmQoJy53cC1zbXVzaC1zdGF0cy1wZXJjZW50Jyk7XG5cdFx0XHRcdHZhciBwcm9fc2F2aW5nc19ieXRlcyA9IHNtdXNoX3Byb19zYXZpbmdzLmZpbmQoJy53cC1zbXVzaC1zdGF0cy1odW1hbicpO1xuXHRcdFx0XHRpZiAocHJvX3NhdmluZ3NfcGVyY2VudC5sZW5ndGggPiAwICYmICd1bmRlZmluZWQnICE9IHR5cGVvZiB3cF9zbXVzaGl0X2RhdGEucHJvX3NhdmluZ3MucGVyY2VudCAmJiB3cF9zbXVzaGl0X2RhdGEucHJvX3NhdmluZ3MucGVyY2VudCAhPSAnJykge1xuXHRcdFx0XHRcdHByb19zYXZpbmdzX3BlcmNlbnQuaHRtbCh3cF9zbXVzaGl0X2RhdGEucHJvX3NhdmluZ3MucGVyY2VudCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKHByb19zYXZpbmdzX2J5dGVzLmxlbmd0aCA+IDAgJiYgJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIHdwX3NtdXNoaXRfZGF0YS5wcm9fc2F2aW5ncy5zYXZpbmdzX2J5dGVzICYmIHdwX3NtdXNoaXRfZGF0YS5wcm9fc2F2aW5ncy5zYXZpbmdzX2J5dGVzICE9ICcnKSB7XG5cdFx0XHRcdFx0cHJvX3NhdmluZ3NfYnl0ZXMuaHRtbCh3cF9zbXVzaGl0X2RhdGEucHJvX3NhdmluZ3Muc2F2aW5nc19ieXRlcyk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH07XG5cblx0LyoqXG4gICogVXBkYXRlIHRoZSBwcm9ncmVzcyBhbmQgc2hvdyBub3RpY2Ugd2hlbiBzbXVzaCBjb21wbGV0ZXNcbiAgKi9cblx0dmFyIGRpcmVjdG9yeV9zbXVzaF9maW5pc2hlZCA9IGZ1bmN0aW9uIGRpcmVjdG9yeV9zbXVzaF9maW5pc2hlZChub3RpY2VfdHlwZSkge1xuXG5cdFx0Ly8gUmVtb3ZlIHByb2dyZXNzIGljb24gZnJvbSBuYXZiYXIuXG5cdFx0JCgnLnNtdXNoLW5hdi1pY29uLmRpcmVjdG9yeScpLnJlbW92ZUNsYXNzKCdzdWktaWNvbi1sb2FkZXIgc3VpLWxvYWRpbmcnKTtcblxuXHRcdC8vSWYgdGhlcmUgYXJlIG5vIGltYWdlcyBsZWZ0XG5cdFx0JCgnYnV0dG9uLndwLXNtdXNoLXBhdXNlJykuaGlkZSgpLmF0dHIoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7XG5cblx0XHQvL0hpZGUgQnVsayBTbXVzaCBidXR0b24gaWYgc211c2ggd2FzIHN0b3BwZWQgZm9yIGVycm9yIG9yIGZpbmlzaGVkXG5cdFx0aWYgKCcnID09IG5vdGljZV90eXBlKSB7XG5cdFx0XHQkKCdidXR0b24ud3Atc211c2gtc3RhcnQnKS5wYXJlbnQoKS5oaWRlKCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdCQoJ2J1dHRvbi53cC1zbXVzaC1zdGFydCcpLnNob3coKS5yZW1vdmVBdHRyKCdkaXNhYmxlZCcpO1xuXHRcdH1cblxuXHRcdC8vRW5hYmxlIENob29zZSBkaXJlY3RvcnkgYnV0dG9uXG5cdFx0JCgnYnV0dG9uLndwLXNtdXNoLWJyb3dzZScpLnNob3coKS5yZW1vdmVBdHRyKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuXG5cdFx0Ly9DbG9uZSBDaG9vc2UgRGlyZWN0b3J5IEJ1dHRvbiBhbmQgYWRkIGF0IHRoZSB0b3Bcblx0XHRhZGRfZGlyX2Jyb3dzZXJfYnV0dG9uKCk7XG5cblx0XHQvL0Nsb25lIGFuZCBhZGQgU211c2ggYnV0dG9uXG5cdFx0YWRkX3NtdXNoX2J1dHRvbigpO1xuXG5cdFx0aWYgKCcnID09IG5vdGljZV90eXBlKSB7XG5cdFx0XHQvL0dldCB0aGUgVG90YWwgYW5kIE9wdGltaXNlZCBpbWFnZSBjb3VudFxuXHRcdFx0dmFyIGltYWdlX2VsZSA9ICQoJ2xpLndwLXNtdXNoLWltYWdlLWVsZScpO1xuXHRcdFx0dmFyIHRvdGFsID0gaW1hZ2VfZWxlLmxlbmd0aDtcblx0XHRcdHZhciByZW1hbmluZyA9IGltYWdlX2VsZS5maWx0ZXIoJzpub3QoLm9wdGltaXNlZCknKS5sZW5ndGg7XG5cdFx0XHR2YXIgc211c2hlZCA9IHRvdGFsIC0gcmVtYW5pbmc7XG5cdFx0XHRpZiAocmVtYW5pbmcgPiAwKSB7XG5cdFx0XHRcdC8vQXBwZW5kIHRoZSBjb3VudFxuXHRcdFx0XHQkKCdzcGFuLndwLXNtdXNoLWRpci1yZW1haW5pbmcnKS5odG1sKHJlbWFuaW5nKTtcblx0XHRcdFx0JCgnc3Bhbi53cC1zbXVzaC1kaXItdG90YWwnKS5odG1sKHRvdGFsKTtcblx0XHRcdFx0JCgnc3Bhbi53cC1zbXVzaC1kaXItc211c2hlZCcpLmh0bWwoc211c2hlZCk7XG5cblx0XHRcdFx0Ly9TaG93IHJlbWFpbmluZyBpbWFnZSBub3RpY2Vcblx0XHRcdFx0JCgnLnN1aS1ub3RpY2Uud3Atc211c2gtZGlyLXJlbWFpbmluZycpLnNob3coKTtcblxuXHRcdFx0XHQvL1Nob3cgbm90aWNlIG9uIHRvcCBpZiByZXF1aXJlZFxuXHRcdFx0XHRhZGRfc211c2hfZGlyX25vdGljZSgpO1xuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHQvL1Nob3cgc3VjY2VzcyBpbWFnZSBub3RpY2Vcblx0XHRcdFx0dmFyIG1lc3NhZ2UgPSAkKCcuc3VpLW5vdGljZS53cC1zbXVzaC1kaXItYWxsLWRvbmUnKS5jbG9uZSgpLnNob3coKTtcblx0XHRcdFx0Ly8gSGlkZSBpbWFnZXMgbGlzdC5cblx0XHRcdFx0JCgnLndwLXNtdXNoLWltYWdlLWxpc3QgdGJvZHkgdHInKS5ub3QoJzpmaXJzdCcpLm5vdCgnOmxhc3QnKS5oaWRlKCk7XG5cdFx0XHRcdCQoJy53cC1zbXVzaC1pbWFnZS1saXN0IHRib2R5IHRyOmZpcnN0IHRkJykuaHRtbChtZXNzYWdlKS5yZW1vdmVDbGFzcygncGFydGlhbCBvcHRpbWlzZWQnKTtcblxuXHRcdFx0XHQvL1Nob3cgbm90aWNlIG9uIHRvcCBpZiByZXF1aXJlZFxuXHRcdFx0XHRhZGRfc211c2hfZGlyX25vdGljZSgnYWxsX2RvbmUnKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly9TaG93IEJ1bGsgTGltaXQgTm90aWNlXG5cdFx0XHQkKCcud3Atc211c2gtbm90aWNlLndwLXNtdXNoLWRpci1saW1pdCcpLnNob3coKTtcblx0XHRcdC8vU2hvdyBub3RpY2Ugb24gdG9wIGlmIHJlcXVpcmVkXG5cdFx0XHRhZGRfc211c2hfZGlyX25vdGljZSgnc211c2hfbGltaXQnKTtcblx0XHR9XG5cdH07XG5cblx0LyoqXG4gICogU3RhcnQgT3B0aW1pc2luZyBhbGwgdGhlIGltYWdlcyBsaXN0ZWQgaW4gbGFzdCBkaXJlY3Rvcnkgc2NhblxuICAqL1xuXHR2YXIgc211c2hfYWxsID0gZnVuY3Rpb24gc211c2hfYWxsKCkge1xuXG5cdFx0dmFyIHVucHJvY2Vzc2VkX2NoaWxkID0galF1ZXJ5KCcud3Atc211c2gtaW1hZ2UtbGlzdCAud3Atc211c2gtaW1hZ2UtZWxlOm5vdChcIi5vcHRpbWlzZWQsIC5wcm9jZXNzZWRcIiknKTtcblxuXHRcdC8vVXBkYXRlIHRoZSBPcHRpbWlzaW5nIHN0YXR1cyBmb3IgdGhlIGltYWdlXG5cdFx0dmFyIGZpcnN0X2NoaWxkID0gdW5wcm9jZXNzZWRfY2hpbGQuZmlyc3QoKTtcblxuXHRcdHZhciBpbWdfcHJvZ3Jlc3MgPSBmaXJzdF9jaGlsZC5maW5kKCcud3Atc211c2gtaW1hZ2UtZWxlLXByb2dyZXNzJyk7XG5cdFx0dmFyIHBhcmVudF90ciA9IGZpcnN0X2NoaWxkLmNsb3Nlc3QoJ3RyJykucHJldigndHInKTtcblx0XHR2YXIgZGlyX3Byb2dyZXNzID0gcGFyZW50X3RyLmZpbmQoJy53cC1zbXVzaC1pbWFnZS1kaXItcHJvZ3Jlc3MnKTtcblx0XHR2YXIgZXhjbHVkZV9idG4gPSBwYXJlbnRfdHIuZmluZCgnLndwLXNtdXNoLWV4Y2x1ZGUtZGlyJyk7XG5cdFx0dmFyIHByb2dyZXNzX3BlcmNlbnQgPSBwYXJlbnRfdHIuZmluZCgnLndwLXNtdXNoLWltYWdlLXByb2dyZXNzLXBlcmNlbnQnKTtcblxuXHRcdC8vQ2hlY2sgaWYgdGhlIHNlbGVjdGVkIGVsZW1lbnQgaXMgdW5kZXIgZXhwYW5kYWJsZSBsaVxuXHRcdGlmIChkaXJfcHJvZ3Jlc3MubGVuZ3RoID09IDEpIHtcblx0XHRcdGRpcl9wcm9ncmVzcy5hZGRDbGFzcygnc3VpLWljb24tbG9hZGVyIHN1aS1sb2FkaW5nJykucmVtb3ZlQ2xhc3MoJ3BhcnRpYWwgb3B0aW1pc2VkJyk7XG5cdFx0XHRleGNsdWRlX2J0bi5hZGRDbGFzcygnc3VpLWhpZGRlbicpLmhpZGUoKTtcblx0XHR9XG5cblx0XHQvLyBTaG93IHdhaXRpbmcgbWVzc2FnZS5cblx0XHQkKCcud3Atc211c2gtaW1hZ2UtcHJvZ3Jlc3MtcGVyY2VudCcpLm5vdCgnLm9wdGltaXNlZCcpLnJlbW92ZUNsYXNzKCdzdWktaGlkZGVuJyk7XG5cblx0XHQvL0FwcGVuZCBhbmQgc2hvdyBzcGlubmVyXG5cdFx0aW1nX3Byb2dyZXNzLmFkZENsYXNzKCdzdWktaWNvbi1sb2FkZXIgc3VpLWxvYWRpbmcnKTtcblxuXHRcdC8vSWYgYWxsIHRoZSBlbGVtZW50cyBhcmUgb3B0aW1pc2VkLCBObyBuZWVkIHRvIHNlbmQgYWpheCByZXF1ZXN0XG5cdFx0aWYgKGZpcnN0X2NoaWxkLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0ZGlyZWN0b3J5X3NtdXNoX2ZpbmlzaGVkKCcnKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvKiogQWpheCBSZXF1ZXN0IHRvIG9wdGltaXNlIGRpcmVjdG9yeSBpbWFnZXMgKi9cblx0XHR2YXIgcGFyYW0gPSB7XG5cdFx0XHRhY3Rpb246ICdvcHRpbWlzZScsXG5cdFx0XHRpbWFnZV9pZDogZmlyc3RfY2hpbGQuYXR0cignaWQnKSxcblx0XHRcdGdldF9zdGF0czogdW5wcm9jZXNzZWRfY2hpbGQubGVuZ3RoID4gMSA/IDAgOiAxLFxuXHRcdFx0bm9uY2U6ICQoJyN3cC1zbXVzaC1hbGwnKS52YWwoKVxuXHRcdH07XG5cblx0XHQvL1NlbmQgQWpheCByZXF1ZXN0XG5cdFx0JC5nZXQoYWpheHVybCwgcGFyYW0sIGZ1bmN0aW9uIChyZXMpIHtcblxuXHRcdFx0Ly9DaGVjaywgaWYgbGltaXQgaXMgZXhjZWVkZWQgZm9yIGZyZWUgdmVyc2lvblxuXHRcdFx0aWYgKHR5cGVvZiByZXMuZGF0YSAhPT0gXCJ1bmRlZmluZWRcIiAmJiByZXMuZGF0YS5lcnJvciA9PSAnZGlyX3NtdXNoX2xpbWl0X2V4Y2VlZGVkJykge1xuXHRcdFx0XHQvL0B0b2RvOiBDaGVjayBpZiB0aGlzIGlzIHJlcXVpcmVkIGFueW1vcmVcblx0XHRcdFx0Zmlyc3RfY2hpbGQucmVtb3ZlQ2xhc3MoJ3Byb2Nlc3NlZCcpO1xuXHRcdFx0XHQvL1Nob3cgZXJyb3IsIEJ1bGsgU211c2ggbGltaXQgZXhjZWVkZWRcblx0XHRcdFx0ZGlyZWN0b3J5X3NtdXNoX2ZpbmlzaGVkKCd3cC1zbXVzaC1kaXItbGltaXQnKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHQvL2FwcGVuZCBzdGF0cywgcmVtb3ZlIGxvYWRlciwgYWRkIGxvYWRlciB0byBuZXh0IGltYWdlLCBsb29wXG5cdFx0XHR2YXIgZGF0YSA9ICd1bmRlZmluZWQnICE9IHR5cGVvZiByZXMuZGF0YSA/IHJlcy5kYXRhIDogJyc7XG5cblx0XHRcdC8vSWYgaW1hZ2UgZWxlbWVudCBpcyB0aGVyZVxuXHRcdFx0aWYgKCd1bmRlZmluZWQnICE9IHR5cGVvZiBkYXRhLmltYWdlKSB7XG5cdFx0XHRcdC8vTWFyayBPcHRpbWlzZWRcblx0XHRcdFx0dmFyIGVsZSA9IGpRdWVyeShkb2N1bWVudC5nZXRFbGVtZW50QnlJZChkYXRhLmltYWdlLmlkKSk7XG5cdFx0XHRcdHZhciBlbGVfaW1nX3Byb2dyZXNzID0gZWxlLmZpbmQoJy53cC1zbXVzaC1pbWFnZS1lbGUtcHJvZ3Jlc3MnKTtcblxuXHRcdFx0XHRlbGUucmVtb3ZlQ2xhc3MoJ3BhcnRpYWwnKTtcblx0XHRcdFx0ZWxlX2ltZ19wcm9ncmVzcy5yZW1vdmVDbGFzcygnc3VpLWljb24tbG9hZGVyIHN1aS1sb2FkaW5nJyk7XG5cblx0XHRcdFx0aWYgKHJlcy5zdWNjZXNzKSB7XG5cblx0XHRcdFx0XHRlbGUuYWRkQ2xhc3MoJ29wdGltaXNlZCcpO1xuXHRcdFx0XHRcdGVsZV9pbWdfcHJvZ3Jlc3MuYWRkQ2xhc3MoJ29wdGltaXNlZCcpO1xuXG5cdFx0XHRcdFx0Ly9VcGRhdGUgRGlyZWN0b3J5IHByb2dyZXNzXG5cdFx0XHRcdFx0dXBkYXRlX2Rpcl9wcm9ncmVzcyhlbGUpO1xuXG5cdFx0XHRcdFx0Ly8gQHRvZG8gVXBkYXRlIHN0YXRzLlxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdC8vSWYgdGhlcmUgd2FzIGFuIGVycm9yIG9wdGltaXNpbmcgdGhlIGltYWdlXG5cdFx0XHRcdFx0ZWxlLmFkZENsYXNzKCdwcm9jZXNzZWQnKTtcblx0XHRcdFx0XHRlbGVfaW1nX3Byb2dyZXNzLmFkZENsYXNzKCdwYXJ0aWFsJyk7XG5cdFx0XHRcdFx0Ly9VcGRhdGUgRGlyZWN0b3J5IHByb2dyZXNzXG5cdFx0XHRcdFx0dXBkYXRlX2Rpcl9wcm9ncmVzcyhlbGUpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly9AdG9kbzogRml4ZWQgc3RhdHMgVUlcblx0XHRcdH1cblxuXHRcdFx0Ly9JZiB1c2VyIGhhdmVuJ3QgcGF1c2VkIHRoZSBTbXVzaGluZ1xuXHRcdFx0aWYgKDEgPT0gJCgnaW5wdXRbbmFtZT1cIndwLXNtdXNoLWNvbnRpbnVlLWFqYXhcIl0nKS52YWwoKSkge1xuXHRcdFx0XHQvL0xvb3Bcblx0XHRcdFx0c211c2hfYWxsKGZhbHNlKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vUmVzZXQgdGhlIEFqYXggZmxhZ1xuXHRcdFx0XHQkKCdpbnB1dC53cC1zbXVzaC1jb250aW51ZS1hamF4JykudmFsKDEpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9O1xuXG5cdC8vRmluZHMgeSB2YWx1ZSBvZiBnaXZlbiBvYmplY3Rcblx0ZnVuY3Rpb24gZmluZFBvcyhvYmopIHtcblx0XHR2YXIgY3VydG9wID0gMDtcblx0XHRpZiAob2JqLm9mZnNldFBhcmVudCkge1xuXHRcdFx0ZG8ge1xuXHRcdFx0XHRjdXJ0b3AgKz0gb2JqLm9mZnNldFRvcDtcblx0XHRcdH0gd2hpbGUgKG9iaiA9IG9iai5vZmZzZXRQYXJlbnQpO1xuXHRcdFx0cmV0dXJuIFtjdXJ0b3BdO1xuXHRcdH1cblx0fVxuXG5cdC8vU2Nyb2xsIHRoZSBlbGVtZW50IHRvIHRvcCBvZiB0aGUgcGFnZVxuXHR2YXIgZ29Ub0J5U2Nyb2xsID0gZnVuY3Rpb24gZ29Ub0J5U2Nyb2xsKHNlbGVjdG9yKSB7XG5cdFx0Ly8gU2Nyb2xsXG5cdFx0JCgnaHRtbCxib2R5JykuYW5pbWF0ZSh7XG5cdFx0XHRzY3JvbGxUb3A6ICQoc2VsZWN0b3IpLm9mZnNldCgpLnRvcCAtIDEwMFxuXHRcdH0sICdzbG93Jyk7XG5cdH07XG5cblx0dmFyIGRpc2FibGVfYnV0dG9ucyA9IGZ1bmN0aW9uIGRpc2FibGVfYnV0dG9ucyhzZWxmKSB7XG5cdFx0c2VsZi5hdHRyKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuXHRcdCQoJy53cC1zbXVzaC1icm93c2UnKS5hdHRyKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuXHR9O1xuXG5cdHZhciB1cGRhdGVfY3VtbXVsYXRpdmVfc3RhdHMgPSBmdW5jdGlvbiB1cGRhdGVfY3VtbXVsYXRpdmVfc3RhdHMoc3RhdHMpIHtcblx0XHQvL1VwZGF0ZSBEaXJlY3RvcnkgU211c2ggU3RhdHNcblx0XHRpZiAoJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIHN0YXRzLmRpcl9zbXVzaCkge1xuXHRcdFx0dmFyIHN0YXRzX2h1bWFuID0gJCgnbGkuc211c2gtZGlyLXNhdmluZ3Mgc3Bhbi53cC1zbXVzaC1zdGF0cyBzcGFuLndwLXNtdXNoLXN0YXRzLWh1bWFuJyk7XG5cdFx0XHR2YXIgc3RhdHNfcGVyY2VudCA9ICQoJ2xpLnNtdXNoLWRpci1zYXZpbmdzIHNwYW4ud3Atc211c2gtc3RhdHMgc3Bhbi53cC1zbXVzaC1zdGF0cy1wZXJjZW50Jyk7XG5cblx0XHRcdC8vIERvIG5vdCByZXBsYWNlIGlmIDAgc2F2aW5ncy5cblx0XHRcdGlmIChzdGF0cy5kaXJfc211c2guYnl0ZXMgPiAwKSB7XG5cdFx0XHRcdC8vIEhpZGUgc2VsZWN0b3IuXG5cdFx0XHRcdCQoJ2xpLnNtdXNoLWRpci1zYXZpbmdzIC53cC1zbXVzaC1zdGF0cy1sYWJlbC1tZXNzYWdlJykuaGlkZSgpO1xuXHRcdFx0XHQvL1VwZGF0ZSBTYXZpbmdzIGluIGJ5dGVzXG5cdFx0XHRcdGlmIChzdGF0c19odW1hbi5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0c3RhdHNfaHVtYW4uaHRtbChzdGF0cy5kaXJfc211c2guaHVtYW4pO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHZhciBzcGFuID0gJzxzcGFuIGNsYXNzPVwid3Atc211c2gtc3RhdHMtaHVtYW5cIj4nICsgc3RhdHMuZGlyX3NtdXNoLmJ5dGVzICsgJzwvc3Bhbj4nO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly9QZXJjZW50YWdlIHNlY3Rpb25cblx0XHRcdFx0aWYgKHN0YXRzLmRpcl9zbXVzaC5wZXJjZW50ID4gMCkge1xuXHRcdFx0XHRcdC8vIFNob3cgc2l6ZSBhbmQgcGVyY2VudGFnZSBzZXBhcmF0b3IuXG5cdFx0XHRcdFx0JCgnbGkuc211c2gtZGlyLXNhdmluZ3Mgc3Bhbi53cC1zbXVzaC1zdGF0cyBzcGFuLndwLXNtdXNoLXN0YXRzLXNlcCcpLnJlbW92ZUNsYXNzKCdzdWktaGlkZGVuJyk7XG5cdFx0XHRcdFx0Ly9VcGRhdGUgT3B0aW1pc2F0aW9uIHBlcmNlbnRhZ2Vcblx0XHRcdFx0XHRpZiAoc3RhdHNfcGVyY2VudC5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0XHRzdGF0c19wZXJjZW50Lmh0bWwoc3RhdHMuZGlyX3NtdXNoLnBlcmNlbnQgKyAnJScpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR2YXIgc3BhbiA9ICc8c3BhbiBjbGFzcz1cIndwLXNtdXNoLXN0YXRzLXBlcmNlbnRcIj4nICsgc3RhdHMuZGlyX3NtdXNoLnBlcmNlbnQgKyAnJScgKyAnPC9zcGFuPic7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly9VcGRhdGUgQ29tYmluZWQgc3RhdHNcblx0XHRpZiAoJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIHN0YXRzLmNvbWJpbmVkX3N0YXRzICYmIHN0YXRzLmNvbWJpbmVkX3N0YXRzLmxlbmd0aCA+IDApIHtcblx0XHRcdHZhciBjX3N0YXRzID0gc3RhdHMuY29tYmluZWRfc3RhdHM7XG5cblx0XHRcdHZhciBzbXVzaF9wZXJjZW50ID0gY19zdGF0cy5zbXVzaGVkIC8gY19zdGF0cy50b3RhbF9jb3VudCAqIDEwMDtcblx0XHRcdHNtdXNoX3BlcmNlbnQgPSBwcmVjaXNlX3JvdW5kKHNtdXNoX3BlcmNlbnQsIDEpO1xuXG5cdFx0XHQvL1NtdXNoZWQgUGVyY2VudFxuXHRcdFx0aWYgKHNtdXNoX3BlcmNlbnQpIHtcblx0XHRcdFx0JCgnZGl2LndwLXNtdXNoLWNvdW50LXRvdGFsIHNwYW4ud3Atc211c2gtaW1hZ2VzLXBlcmNlbnQnKS5odG1sKHNtdXNoX3BlcmNlbnQpO1xuXHRcdFx0fVxuXHRcdFx0Ly9VcGRhdGUgVG90YWwgQXR0YWNobWVudCBDb3VudFxuXHRcdFx0aWYgKGNfc3RhdHMudG90YWxfY291bnQpIHtcblx0XHRcdFx0JCgnc3Bhbi53cC1zbXVzaC1jb3VudC10b3RhbCBzcGFuLndwLXNtdXNoLXRvdGFsLW9wdGltaXNlZCcpLmh0bWwoY19zdGF0cy50b3RhbF9jb3VudCk7XG5cdFx0XHR9XG5cdFx0XHQvL1VwZGF0ZSBTYXZpbmdzIGFuZCBQZXJjZW50XG5cdFx0XHRpZiAoY19zdGF0cy5zYXZpbmdzKSB7XG5cdFx0XHRcdCQoJ3NwYW4ud3Atc211c2gtc2F2aW5ncyBzcGFuLndwLXNtdXNoLXN0YXRzLWh1bWFuJykuaHRtbChjX3N0YXRzLnNhdmluZ3MpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKGNfc3RhdHMucGVyY2VudCkge1xuXHRcdFx0XHQkKCdzcGFuLndwLXNtdXNoLXNhdmluZ3Mgc3Bhbi53cC1zbXVzaC1zdGF0cy1wZXJjZW50JykuaHRtbChjX3N0YXRzLnBlcmNlbnQpO1xuXHRcdFx0fVxuXHRcdH1cblx0fTtcblxuXHQvKipcbiAgKiBTaG93IGRpcmVjdG9yeSBsaXN0IHBvcHVwIGFuZCBmb3VjcyBvbiBjbG9zZSBidXR0b25cbiAgKi9cblx0dmFyIHNob3dEaWFsb2cgPSBmdW5jdGlvbiBzaG93RGlhbG9nKCkge1xuXHRcdC8vU2hvd3MgdGhlIGRpcmVjdG9yaWVzIGF2YWlsYWJsZVxuXHRcdCQoJy53cC1zbXVzaC1saXN0LWRpYWxvZycpLnNob3coKTtcblx0XHQkKCcud3Atc211c2gtbGlzdC1kaWFsb2cgZGl2LmNsb3NlJykuZm9jdXMoKTtcblx0fTtcblxuXHQvL1JlbW92ZSBzcGFuIHRhZyBmcm9tIFVSTFxuXHRmdW5jdGlvbiByZW1vdmVTcGFuKHVybCkge1xuXHRcdHZhciB1cmwgPSB1cmwuc2xpY2UodXJsLmluZGV4T2YoJz8nKSArIDEpLnNwbGl0KCcmJyk7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCB1cmwubGVuZ3RoOyBpKyspIHtcblx0XHRcdHZhciB1cmxwYXJhbSA9IGRlY29kZVVSSSh1cmxbaV0pLnNwbGl0KC89KC4rKS8pWzFdO1xuXHRcdFx0cmV0dXJuIHVybHBhcmFtLnJlcGxhY2UoLzwoPzoufFxcbikqPz4vZ20sICcnKTtcblx0XHR9XG5cdH1cblxuXHQvKipcbiAgKiBIYW5kbGUgdGhlIFNtdXNoIFN0YXRzIGxpbmsgY2xpY2tcbiAgKi9cblx0JCgnYm9keScpLm9uKCdjbGljaycsICdhLnNtdXNoLXN0YXRzLWRldGFpbHMnLCBmdW5jdGlvbiAoZSkge1xuXG5cdFx0Ly9JZiBkaXNhYmxlZFxuXHRcdGlmICgnZGlzYWJsZWQnID09ICQodGhpcykuYXR0cignZGlzYWJsZWQnKSkge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblxuXHRcdC8vIHByZXZlbnQgdGhlIGRlZmF1bHQgYWN0aW9uXG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdC8vUmVwbGFjZSB0aGUgYCtgIHdpdGggYSBgLWBcblx0XHR2YXIgc2xpZGVfc3ltYm9sID0gJCh0aGlzKS5maW5kKCcuc3RhdHMtdG9nZ2xlJyk7XG5cdFx0JCh0aGlzKS5wYXJlbnRzKCkuZXEoMSkuZmluZCgnLnNtdXNoLXN0YXRzLXdyYXBwZXInKS5zbGlkZVRvZ2dsZSgpO1xuXHRcdHNsaWRlX3N5bWJvbC50ZXh0KHNsaWRlX3N5bWJvbC50ZXh0KCkgPT0gJysnID8gJy0nIDogJysnKTtcblx0fSk7XG5cblx0LyoqIEhhbmRsZSBzbXVzaCBidXR0b24gY2xpY2sgKiovXG5cdCQoJ2JvZHknKS5vbignY2xpY2snLCAnLndwLXNtdXNoLXNlbmQ6bm90KC53cC1zbXVzaC1yZXNtdXNoKScsIGZ1bmN0aW9uIChlKSB7XG5cblx0XHQvLyBwcmV2ZW50IHRoZSBkZWZhdWx0IGFjdGlvblxuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRuZXcgV1BfU211c2guU211c2goJCh0aGlzKSwgZmFsc2UpO1xuXHR9KTtcblxuXHQvKiogSGFuZGxlIE5leHRHZW4gR2FsbGVyeSBzbXVzaCBidXR0b24gY2xpY2sgKiovXG5cdCQoJ2JvZHknKS5vbignY2xpY2snLCAnLndwLXNtdXNoLW5leHRnZW4tc2VuZCcsIGZ1bmN0aW9uIChlKSB7XG5cblx0XHQvLyBwcmV2ZW50IHRoZSBkZWZhdWx0IGFjdGlvblxuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRuZXcgV1BfU211c2guU211c2goJCh0aGlzKSwgZmFsc2UsICduZXh0Z2VuJyk7XG5cdH0pO1xuXG5cdC8qKiBIYW5kbGUgTmV4dEdlbiBHYWxsZXJ5IEJ1bGsgc211c2ggYnV0dG9uIGNsaWNrICoqL1xuXHQkKCdib2R5Jykub24oJ2NsaWNrJywgJy53cC1zbXVzaC1uZXh0Z2VuLWJ1bGsnLCBmdW5jdGlvbiAoZSkge1xuXG5cdFx0Ly8gcHJldmVudCB0aGUgZGVmYXVsdCBhY3Rpb25cblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHQvL0NoZWNrIGZvciBpZHMsIGlmIHRoZXJlIGlzIG5vbmUgKFVuc211c2hlZCBvciBsb3NzbGVzcyksIGRvbid0IGNhbGwgc211c2ggZnVuY3Rpb25cblx0XHRpZiAodHlwZW9mIHdwX3NtdXNoaXRfZGF0YSA9PSAndW5kZWZpbmVkJyB8fCB3cF9zbXVzaGl0X2RhdGEudW5zbXVzaGVkLmxlbmd0aCA9PSAwICYmIHdwX3NtdXNoaXRfZGF0YS5yZXNtdXNoLmxlbmd0aCA9PSAwKSB7XG5cblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRqUXVlcnkoJy53cC1zbXVzaC1idXR0b24sIC53cC1zbXVzaC1zY2FuJykuYXR0cignZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcblx0XHQkKFwiLndwLXNtdXNoLW5vdGljZS53cC1zbXVzaC1yZW1haW5pbmdcIikuaGlkZSgpO1xuXHRcdG5ldyBXUF9TbXVzaC5TbXVzaCgkKHRoaXMpLCB0cnVlLCAnbmV4dGdlbicpO1xuXHR9KTtcblxuXHQvKiogUmVzdG9yZTogTWVkaWEgTGlicmFyeSAqKi9cblx0JCgnYm9keScpLm9uKCdjbGljaycsICcud3Atc211c2gtYWN0aW9uLndwLXNtdXNoLXJlc3RvcmUnLCBmdW5jdGlvbiAoZSkge1xuXHRcdHZhciBjdXJyZW50X2J1dHRvbiA9ICQodGhpcyk7XG5cdFx0dmFyIHNtdXNoX2FjdGlvbiA9ICdzbXVzaF9yZXN0b3JlX2ltYWdlJztcblx0XHRwcm9jZXNzX3NtdXNoX2FjdGlvbihlLCBjdXJyZW50X2J1dHRvbiwgc211c2hfYWN0aW9uLCAncmVzdG9yZScpO1xuXHRcdC8vQ2hhbmdlIHRoZSBjbGFzcyBvYSBwYXJlbnQgZGl2ICggTGV2ZWwgMiApXG5cdFx0dmFyIHBhcmVudCA9IGN1cnJlbnRfYnV0dG9uLnBhcmVudHMoKS5lcSgxKTtcblx0XHRpZiAocGFyZW50Lmhhc0NsYXNzKCdzbXVzaGVkJykpIHtcblx0XHRcdHBhcmVudC5yZW1vdmVDbGFzcygnc211c2hlZCcpLmFkZENsYXNzKCd1bnNtdXNoZWQnKTtcblx0XHR9XG5cdH0pO1xuXG5cdC8qKiBSZXNtdXNoOiBNZWRpYSBMaWJyYXJ5ICoqL1xuXHQkKCdib2R5Jykub24oJ2NsaWNrJywgJy53cC1zbXVzaC1hY3Rpb24ud3Atc211c2gtcmVzbXVzaCcsIGZ1bmN0aW9uIChlKSB7XG5cdFx0dmFyIGN1cnJlbnRfYnV0dG9uID0gJCh0aGlzKTtcblx0XHR2YXIgc211c2hfYWN0aW9uID0gJ3NtdXNoX3Jlc211c2hfaW1hZ2UnO1xuXHRcdHByb2Nlc3Nfc211c2hfYWN0aW9uKGUsIGN1cnJlbnRfYnV0dG9uLCBzbXVzaF9hY3Rpb24sICdzbXVzaGluZycpO1xuXHR9KTtcblxuXHQvKiogUmVzdG9yZTogTmV4dEdlbiBHYWxsZXJ5ICoqL1xuXHQkKCdib2R5Jykub24oJ2NsaWNrJywgJy53cC1zbXVzaC1hY3Rpb24ud3Atc211c2gtbmV4dGdlbi1yZXN0b3JlJywgZnVuY3Rpb24gKGUpIHtcblx0XHR2YXIgY3VycmVudF9idXR0b24gPSAkKHRoaXMpO1xuXHRcdHZhciBzbXVzaF9hY3Rpb24gPSAnc211c2hfcmVzdG9yZV9uZXh0Z2VuX2ltYWdlJztcblx0XHRwcm9jZXNzX3NtdXNoX2FjdGlvbihlLCBjdXJyZW50X2J1dHRvbiwgc211c2hfYWN0aW9uLCAncmVzdG9yZScpO1xuXHR9KTtcblxuXHQvKiogUmVzbXVzaDogTmV4dEdlbiBHYWxsZXJ5ICoqL1xuXHQkKCdib2R5Jykub24oJ2NsaWNrJywgJy53cC1zbXVzaC1hY3Rpb24ud3Atc211c2gtbmV4dGdlbi1yZXNtdXNoJywgZnVuY3Rpb24gKGUpIHtcblx0XHR2YXIgY3VycmVudF9idXR0b24gPSAkKHRoaXMpO1xuXHRcdHZhciBzbXVzaF9hY3Rpb24gPSAnc211c2hfcmVzbXVzaF9uZXh0Z2VuX2ltYWdlJztcblx0XHRwcm9jZXNzX3NtdXNoX2FjdGlvbihlLCBjdXJyZW50X2J1dHRvbiwgc211c2hfYWN0aW9uLCAnc211c2hpbmcnKTtcblx0fSk7XG5cblx0Ly9TY2FuIEZvciByZXNtdXNoaW5nIGltYWdlc1xuXHQkKCdib2R5Jykub24oJ2NsaWNrJywgJy53cC1zbXVzaC1zY2FuJywgZnVuY3Rpb24gKGUpIHtcblxuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdC8vUnVuIHRoZSBSZS1jaGVja1xuXHRcdHJ1bl9yZV9jaGVjaygkKHRoaXMpLCBmYWxzZSk7XG5cdH0pO1xuXG5cdC8vRGlzbWlzcyBXZWxjb21lIG5vdGljZVxuXHQvL0B0b2RvOiBVc2UgaXQgZm9yIHBvcHVwXG5cdCQoJyN3cC1zbXVzaC13ZWxjb21lLWJveCAuc211c2gtZGlzbWlzcy13ZWxjb21lJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0dmFyICRlbCA9ICQodGhpcykucGFyZW50cygpLmVxKDEpO1xuXHRcdHJlbW92ZV9lbGVtZW50KCRlbCk7XG5cblx0XHQvL1NlbmQgYSBhamF4IHJlcXVlc3QgdG8gc2F2ZSB0aGUgZGlzbWlzc2VkIG5vdGljZSBvcHRpb25cblx0XHR2YXIgcGFyYW0gPSB7XG5cdFx0XHRhY3Rpb246ICdkaXNtaXNzX3dlbGNvbWVfbm90aWNlJ1xuXHRcdH07XG5cdFx0JC5wb3N0KGFqYXh1cmwsIHBhcmFtKTtcblx0fSk7XG5cblx0Ly9SZW1vdmUgTm90aWNlXG5cdCQoJ2JvZHknKS5vbignY2xpY2snLCAnLndwLXNtdXNoLW5vdGljZSAuaWNvbi1maS1jbG9zZScsIGZ1bmN0aW9uIChlKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdHZhciAkZWwgPSAkKHRoaXMpLnBhcmVudCgpO1xuXHRcdHJlbW92ZV9lbGVtZW50KCRlbCk7XG5cdH0pO1xuXG5cdC8vT24gQ2xpY2sgVXBkYXRlIFNldHRpbmdzLiBDaGVjayBmb3IgY2hhbmdlIGluIHNldHRpbmdzXG5cdCQoJ2lucHV0I3dwLXNtdXNoLXNhdmUtc2V0dGluZ3MnKS5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdHZhciBzZXR0aW5nX3R5cGUgPSAnJztcblx0XHR2YXIgc2V0dGluZ19pbnB1dCA9ICQoJ2lucHV0W25hbWU9XCJzZXR0aW5nLXR5cGVcIl0nKTtcblx0XHQvL0NoZWNrIGlmIHNldHRpbmcgdHlwZSBpcyBzZXQgaW4gdGhlIGZvcm1cblx0XHRpZiAoc2V0dGluZ19pbnB1dC5sZW5ndGggPiAwKSB7XG5cdFx0XHRzZXR0aW5nX3R5cGUgPSBzZXR0aW5nX2lucHV0LnZhbCgpO1xuXHRcdH1cblxuXHRcdC8vU2hvdyB0aGUgc3Bpbm5lclxuXHRcdHZhciBzZWxmID0gJCh0aGlzKTtcblx0XHRzZWxmLnBhcmVudCgpLmZpbmQoJ3NwYW4uc3VpLWljb24tbG9hZGVyLnN1aS1sb2FkaW5nJykucmVtb3ZlQ2xhc3MoJ3N1aS1oaWRkZW4nKTtcblxuXHRcdC8vU2F2ZSBzZXR0aW5ncyBpZiBpbiBuZXR3b3JrIGFkbWluXG5cdFx0aWYgKCcnICE9IHNldHRpbmdfdHlwZSAmJiAnbmV0d29yaycgPT0gc2V0dGluZ190eXBlKSB7XG5cdFx0XHQvL0FqYXggcGFyYW1cblx0XHRcdHZhciBwYXJhbSA9IHtcblx0XHRcdFx0YWN0aW9uOiAnc2F2ZV9zZXR0aW5ncycsXG5cdFx0XHRcdG5vbmNlOiAkKCcjd3Bfc211c2hfb3B0aW9uc19ub25jZScpLnZhbCgpXG5cdFx0XHR9O1xuXG5cdFx0XHRwYXJhbSA9IGpRdWVyeS5wYXJhbShwYXJhbSkgKyAnJicgKyBqUXVlcnkoJ2Zvcm0jd3Atc211c2gtc2V0dGluZ3MtZm9ybScpLnNlcmlhbGl6ZSgpO1xuXG5cdFx0XHQvL1NlbmQgYWpheCwgVXBkYXRlIFNldHRpbmdzLCBBbmQgQ2hlY2sgRm9yIHJlc211c2hcblx0XHRcdGpRdWVyeS5wb3N0KGFqYXh1cmwsIHBhcmFtKS5kb25lKGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0alF1ZXJ5KCdmb3JtI3dwLXNtdXNoLXNldHRpbmdzLWZvcm0nKS5zdWJtaXQoKTtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9KTtcblx0XHR9IGVsc2Uge1xuXG5cdFx0XHQvL0NoZWNrIGZvciBhbGwgdGhlIHNldHRpbmdzLCBhbmQgc2NhbiBmb3IgcmVzbXVzaFxuXHRcdFx0dmFyIHdyYXBwZXJfZGl2ID0gc2VsZi5wYXJlbnRzKCkuZXEoMSk7XG5cblx0XHRcdC8vR2V0IGFsbCB0aGUgbWFpbiBzZXR0aW5nc1xuXHRcdFx0dmFyIGtlZXBfZXhpZiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid3Atc211c2gta2VlcF9leGlmXCIpO1xuXHRcdFx0dmFyIHN1cGVyX3NtdXNoID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ3cC1zbXVzaC1sb3NzeVwiKTtcblx0XHRcdHZhciBzbXVzaF9vcmlnaW5hbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid3Atc211c2gtb3JpZ2luYWxcIik7XG5cdFx0XHR2YXIgcmVzaXplX2ltYWdlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid3Atc211c2gtcmVzaXplXCIpO1xuXHRcdFx0dmFyIHNtdXNoX3BuZ2pwZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid3Atc211c2gtcG5nX3RvX2pwZ1wiKTtcblxuXHRcdFx0dmFyIHVwZGF0ZV9idXR0b25fdHh0ID0gdHJ1ZTtcblxuXHRcdFx0JCgnLndwLXNtdXNoLWhleC1ub3RpY2UnKS5oaWRlKCk7XG5cblx0XHRcdC8vSWYgUHJlc2VydmUgRXhpZiBpcyBDaGVja2VkLCBhbmQgYWxsIG90aGVyIHNldHRpbmdzIGFyZSBvZmYsIGp1c3Qgc2F2ZSB0aGUgc2V0dGluZ3Ncblx0XHRcdGlmICgoa2VlcF9leGlmID09PSBudWxsIHx8IGtlZXBfZXhpZi5jaGVja2VkKSAmJiAoc3VwZXJfc211c2ggPT09IG51bGwgfHwgIXN1cGVyX3NtdXNoLmNoZWNrZWQpICYmIChzbXVzaF9vcmlnaW5hbCA9PT0gbnVsbCB8fCAhc211c2hfb3JpZ2luYWwuY2hlY2tlZCkgJiYgKHJlc2l6ZV9pbWFnZXMgPT09IG51bGwgfHwgIXJlc2l6ZV9pbWFnZXMuY2hlY2tlZCkgJiYgKHNtdXNoX3BuZ2pwZyA9PT0gbnVsbCB8fCAhc211c2hfcG5nanBnLmNoZWNrZWQpKSB7XG5cdFx0XHRcdHVwZGF0ZV9idXR0b25fdHh0ID0gZmFsc2U7XG5cdFx0XHR9XG5cblx0XHRcdC8vVXBkYXRlIHRleHRcblx0XHRcdHNlbGYuYXR0cignZGlzYWJsZWQnLCAnZGlzYWJsZWQnKS5hZGRDbGFzcygnYnV0dG9uLWdyZXknKTtcblxuXHRcdFx0aWYgKHVwZGF0ZV9idXR0b25fdHh0KSB7XG5cdFx0XHRcdHNlbGYudmFsKHdwX3NtdXNoX21zZ3MuY2hlY2tpbmcpO1xuXHRcdFx0fVxuXG5cdFx0XHQvL0NoZWNrIGlmIHR5cGUgaXMgc2V0IGluIGRhdGEgYXR0cmlidXRlc1xuXHRcdFx0dmFyIHNjYW5fdHlwZSA9IHNlbGYuZGF0YSgndHlwZScpO1xuXHRcdFx0c2Nhbl90eXBlID0gJ3VuZGVmaW5lZCcgPT0gdHlwZW9mIHNjYW5fdHlwZSA/ICdtZWRpYScgOiBzY2FuX3R5cGU7XG5cblx0XHRcdC8vQWpheCBwYXJhbVxuXHRcdFx0dmFyIHBhcmFtID0ge1xuXHRcdFx0XHRhY3Rpb246ICdzY2FuX2Zvcl9yZXNtdXNoJyxcblx0XHRcdFx0d3Bfc211c2hfb3B0aW9uc19ub25jZTogalF1ZXJ5KCcjd3Bfc211c2hfb3B0aW9uc19ub25jZScpLnZhbCgpLFxuXHRcdFx0XHRzY2FuX3R5cGU6IHNjYW5fdHlwZVxuXHRcdFx0fTtcblxuXHRcdFx0cGFyYW0gPSBqUXVlcnkucGFyYW0ocGFyYW0pICsgJyYnICsgalF1ZXJ5KCdmb3JtI3dwLXNtdXNoLXNldHRpbmdzLWZvcm0nKS5zZXJpYWxpemUoKTtcblxuXHRcdFx0Ly9TZW5kIGFqYXgsIFVwZGF0ZSBTZXR0aW5ncywgQW5kIENoZWNrIEZvciByZXNtdXNoXG5cdFx0XHRqUXVlcnkucG9zdChhamF4dXJsLCBwYXJhbSkuZG9uZShmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdGpRdWVyeSgnZm9ybSN3cC1zbXVzaC1zZXR0aW5ncy1mb3JtJykuc3VibWl0KCk7XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9KTtcblxuXHQvLyBPbiBSZXNtdXNoIGNsaWNrLlxuXHQkKCdib2R5Jykub24oJ2NsaWNrJywgJy53cC1zbXVzaC1za2lwLXJlc211c2gnLCBmdW5jdGlvbiAoZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHR2YXIgc2VsZiA9IGpRdWVyeSh0aGlzKTtcblx0XHR2YXIgY29udGFpbmVyID0gc2VsZi5wYXJlbnRzKCkuZXEoMSk7XG5cblx0XHQvLyBSZW1vdmUgUGFyZW50IGRpdi5cblx0XHR2YXIgJGVsID0gc2VsZi5wYXJlbnQoKTtcblx0XHRyZW1vdmVfZWxlbWVudCgkZWwpO1xuXG5cdFx0Ly8gUmVtb3ZlIFNldHRpbmdzIE5vdGljZS5cblx0XHQkKCcuc3VpLW5vdGljZS10b3Auc3VpLW5vdGljZS1zdWNjZXNzJykucmVtb3ZlKCk7XG5cblx0XHQvLyBTZXQgYnV0dG9uIGF0dHJpYnV0ZSB0byBza2lwIHJlLXNtdXNoIGlkcy5cblx0XHRjb250YWluZXIuZmluZCgnLndwLXNtdXNoLWFsbCcpLmF0dHIoJ2RhdGEtc211c2gnLCAnc2tpcF9yZXNtdXNoJyk7XG5cblx0XHQvLyBVcGRhdGUgU211c2hlZCBjb3VudC5cblx0XHR3cF9zbXVzaGl0X2RhdGEuY291bnRfc211c2hlZCA9IHBhcnNlSW50KHdwX3NtdXNoaXRfZGF0YS5jb3VudF9zbXVzaGVkKSArIHdwX3NtdXNoaXRfZGF0YS5yZXNtdXNoLmxlbmd0aDtcblx0XHR3cF9zbXVzaGl0X2RhdGEuY291bnRfc3VwZXJzbXVzaGVkID0gcGFyc2VJbnQod3Bfc211c2hpdF9kYXRhLmNvdW50X3N1cGVyc211c2hlZCkgKyB3cF9zbXVzaGl0X2RhdGEucmVzbXVzaC5sZW5ndGg7XG5cblx0XHQvLyBVcGRhdGUgU3RhdHMuXG5cdFx0aWYgKHdwX3NtdXNoaXRfZGF0YS5jb3VudF9zbXVzaGVkID09IHdwX3NtdXNoaXRfZGF0YS5jb3VudF90b3RhbCkge1xuXG5cdFx0XHQvLyBTaG93IGFsbCBkb25lIG5vdGljZS5cblx0XHRcdCQoJy53cC1zbXVzaC1ub3RpY2Uud3Atc211c2gtYWxsLWRvbmUsIC53cC1zbXVzaC1wYWdlc3BlZWQtcmVjb21tZW5kYXRpb24nKS5zaG93KCk7XG5cblx0XHRcdC8vIEhpZGUgU211c2ggYnV0dG9uLlxuXHRcdFx0JCgnLndwLXNtdXNoLWJ1bGstd3JhcHBlciAnKS5oaWRlKCk7XG5cdFx0fVxuXHRcdC8vUmVtb3ZlIFJlLVNtdXNoIE5vdGljZVxuXHRcdCQoJy53cC1zbXVzaC1yZXNtdXNoLW5vdGljZScpLnJlbW92ZSgpO1xuXG5cdFx0dmFyIHR5cGUgPSAkKCcud3Atc211c2gtc2NhbicpLmRhdGEoJ3R5cGUnKTtcblx0XHR0eXBlID0gJ3VuZGVmaW5lZCcgPT0gdHlwZW9mIHR5cGUgPyAnbWVkaWEnIDogdHlwZTtcblxuXHRcdHZhciBzbXVzaGVkX2NvdW50ID0gJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIHdwX3NtdXNoaXRfZGF0YS5jb3VudF9zbXVzaGVkID8gd3Bfc211c2hpdF9kYXRhLmNvdW50X3NtdXNoZWQgOiAwO1xuXG5cdFx0dmFyIHNtdXNoX3BlcmNlbnQgPSBzbXVzaGVkX2NvdW50IC8gd3Bfc211c2hpdF9kYXRhLmNvdW50X3RvdGFsICogMTAwO1xuXHRcdHNtdXNoX3BlcmNlbnQgPSBwcmVjaXNlX3JvdW5kKHNtdXNoX3BlcmNlbnQsIDEpO1xuXG5cdFx0JCgnLndwLXNtdXNoLWltYWdlcy1wZXJjZW50JykuaHRtbChzbXVzaF9wZXJjZW50KTtcblxuXHRcdC8vVXBkYXRlIHRoZSBQcm9ncmVzcyBCYXIgV2lkdGhcblx0XHQvLyBnZXQgdGhlIHByb2dyZXNzIGJhclxuXHRcdHZhciAkcHJvZ3Jlc3NfYmFyID0galF1ZXJ5KCcuYnVsay1zbXVzaC13cmFwcGVyIC53cC1zbXVzaC1wcm9ncmVzcy1pbm5lcicpO1xuXHRcdGlmICgkcHJvZ3Jlc3NfYmFyLmxlbmd0aCA8IDEpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBpbmNyZWFzZSBwcm9ncmVzc1xuXHRcdCRwcm9ncmVzc19iYXIuY3NzKCd3aWR0aCcsIHNtdXNoX3BlcmNlbnQgKyAnJScpO1xuXG5cdFx0Ly9TaG93IHRoZSBkZWZhdWx0IGJ1bGsgc211c2ggbm90aWNlXG5cdFx0JCgnLndwLXNtdXNoLWJ1bGstd3JhcHBlcicpLnNob3coKTtcblx0XHQkKCcud3Atc211c2gtYnVsay13cmFwcGVyIC5zdWktbm90aWNlJykuc2hvdygpO1xuXG5cdFx0dmFyIHBhcmFtcyA9IHtcblx0XHRcdGFjdGlvbjogJ2RlbGV0ZV9yZXNtdXNoX2xpc3QnLFxuXHRcdFx0dHlwZTogdHlwZVxuXHRcdH07XG5cdFx0Ly9EZWxldGUgcmVzbXVzaCBsaXN0LCBAdG9kbzogdXBkYXRlIHN0YXRzIGZyb20gdGhlIGFqYXggcmVzcG9uc2Vcblx0XHQkLnBvc3QoYWpheHVybCwgcGFyYW1zLCBmdW5jdGlvbiAocmVzKSB7XG5cdFx0XHQvL1JlbW92ZSB0aGUgd2hvbGUgbGkgZWxlbWVudCBvbiBzdWNjZXNzXG5cdFx0XHRpZiAocmVzLnN1Y2Nlc3MgJiYgJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIHJlcy5kYXRhLnN0YXRzKSB7XG5cdFx0XHRcdHZhciBzdGF0cyA9IHJlcy5kYXRhLnN0YXRzO1xuXHRcdFx0XHQvL1VwZGF0ZSB3cF9zbXVzaGl0X2RhdGEgKCBTbXVzaGVkIGNvdW50LCBTbXVzaGVkIFBlcmNlbnQsIEltYWdlIGNvdW50LCBTdXBlciBzbXVzaCBjb3VudCwgcmVzaXplIHNhdmluZ3MsIGNvbnZlcnNpb24gc2F2aW5ncyApXG5cdFx0XHRcdGlmICgndW5kZWZpbmllZCcgIT0gdHlwZW9mIHdwX3NtdXNoaXRfZGF0YSkge1xuXHRcdFx0XHRcdHdwX3NtdXNoaXRfZGF0YS5jb3VudF9pbWFnZXMgPSAndW5kZWZpbmVkJyAhPSB0eXBlb2Ygc3RhdHMuY291bnRfaW1hZ2VzID8gcGFyc2VJbnQod3Bfc211c2hpdF9kYXRhLmNvdW50X2ltYWdlcykgKyBzdGF0cy5jb3VudF9pbWFnZXMgOiB3cF9zbXVzaGl0X2RhdGEuY291bnRfaW1hZ2VzO1xuXHRcdFx0XHRcdHdwX3NtdXNoaXRfZGF0YS5zaXplX2JlZm9yZSA9ICd1bmRlZmluZWQnICE9IHR5cGVvZiBzdGF0cy5zaXplX2JlZm9yZSA/IHBhcnNlSW50KHdwX3NtdXNoaXRfZGF0YS5zaXplX2JlZm9yZSkgKyBzdGF0cy5zaXplX2JlZm9yZSA6IHdwX3NtdXNoaXRfZGF0YS5zaXplX2JlZm9yZTtcblx0XHRcdFx0XHR3cF9zbXVzaGl0X2RhdGEuc2l6ZV9hZnRlciA9ICd1bmRlZmluZWQnICE9IHR5cGVvZiBzdGF0cy5zaXplX2FmdGVyID8gcGFyc2VJbnQod3Bfc211c2hpdF9kYXRhLnNpemVfYWZ0ZXIpICsgc3RhdHMuc2l6ZV9hZnRlciA6IHdwX3NtdXNoaXRfZGF0YS5zaXplX2FmdGVyO1xuXHRcdFx0XHRcdHdwX3NtdXNoaXRfZGF0YS5zYXZpbmdzX3Jlc2l6ZSA9ICd1bmRlZmluZWQnICE9IHR5cGVvZiBzdGF0cy5zYXZpbmdzX3Jlc2l6ZSA/IHBhcnNlSW50KHdwX3NtdXNoaXRfZGF0YS5zYXZpbmdzX3Jlc2l6ZSkgKyBzdGF0cy5zYXZpbmdzX3Jlc2l6ZSA6IHdwX3NtdXNoaXRfZGF0YS5zYXZpbmdzX3Jlc2l6ZTtcblx0XHRcdFx0XHR3cF9zbXVzaGl0X2RhdGEuc2F2aW5nc19jb252ZXJzaW9uID0gJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIHN0YXRzLnNhdmluZ3NfY29udmVyc2lvbiA/IHBhcnNlSW50KHdwX3NtdXNoaXRfZGF0YS5zYXZpbmdzX2NvbnZlcnNpb24pICsgc3RhdHMuc2F2aW5nc19jb252ZXJzaW9uIDogd3Bfc211c2hpdF9kYXRhLnNhdmluZ3NfY29udmVyc2lvbjtcblx0XHRcdFx0XHQvL0FkZCBkaXJlY3Rvcnkgc211c2ggc3RhdHNcblx0XHRcdFx0XHRpZiAoJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIHdwX3NtdXNoaXRfZGF0YS5zYXZpbmdzX2Rpcl9zbXVzaCAmJiAndW5kZWZpbmVkJyAhPSB0eXBlb2Ygd3Bfc211c2hpdF9kYXRhLnNhdmluZ3NfZGlyX3NtdXNoLm9yaWdfc2l6ZSkge1xuXHRcdFx0XHRcdFx0d3Bfc211c2hpdF9kYXRhLnNpemVfYmVmb3JlID0gJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIHdwX3NtdXNoaXRfZGF0YS5zYXZpbmdzX2Rpcl9zbXVzaCA/IHBhcnNlSW50KHdwX3NtdXNoaXRfZGF0YS5zaXplX2JlZm9yZSkgKyBwYXJzZUludCh3cF9zbXVzaGl0X2RhdGEuc2F2aW5nc19kaXJfc211c2gub3JpZ19zaXplKSA6IHdwX3NtdXNoaXRfZGF0YS5zaXplX2JlZm9yZTtcblx0XHRcdFx0XHRcdHdwX3NtdXNoaXRfZGF0YS5zaXplX2FmdGVyID0gJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIHdwX3NtdXNoaXRfZGF0YS5zYXZpbmdzX2Rpcl9zbXVzaCA/IHBhcnNlSW50KHdwX3NtdXNoaXRfZGF0YS5zaXplX2FmdGVyKSArIHBhcnNlSW50KHdwX3NtdXNoaXRfZGF0YS5zYXZpbmdzX2Rpcl9zbXVzaC5pbWFnZV9zaXplKSA6IHdwX3NtdXNoaXRfZGF0YS5zaXplX2FmdGVyO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHdwX3NtdXNoaXRfZGF0YS5jb3VudF9yZXNpemUgPSAndW5kZWZpbmVkJyAhPSB0eXBlb2Ygc3RhdHMuY291bnRfcmVzaXplID8gcGFyc2VJbnQod3Bfc211c2hpdF9kYXRhLmNvdW50X3Jlc2l6ZSkgKyBzdGF0cy5jb3VudF9yZXNpemUgOiB3cF9zbXVzaGl0X2RhdGEuY291bnRfcmVzaXplO1xuXHRcdFx0XHR9XG5cdFx0XHRcdC8vU211c2ggTm90aWNlXG5cdFx0XHRcdGlmICgkKCcuYnVsay1zbXVzaC13cmFwcGVyIC53cC1zbXVzaC1yZW1haW5pbmctY291bnQnKS5sZW5ndGggJiYgJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIHdwX3NtdXNoaXRfZGF0YS51bnNtdXNoZWQpIHtcblx0XHRcdFx0XHQkKCcuYnVsay1zbXVzaC13cmFwcGVyIC53cC1zbXVzaC1yZW1haW5pbmctY291bnQnKS5odG1sKHdwX3NtdXNoaXRfZGF0YS51bnNtdXNoZWQubGVuZ3RoKTtcblx0XHRcdFx0fVxuXHRcdFx0XHR1cGRhdGVfc3RhdHMoKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fSk7XG5cblx0Ly9FbmFibGUgU3VwZXIgU211c2hcblx0JCgnYS53cC1zbXVzaC1sb3NzeS1lbmFibGUnKS5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdC8vRW5hYmxlIFN1cGVyIFNtdXNoXG5cdFx0JCgnI3dwLXNtdXNoLWxvc3N5JykucHJvcCgnY2hlY2tlZCcsIHRydWUpLmZvY3VzKCk7XG5cdFx0Z29Ub0J5U2Nyb2xsKFwiI2NvbHVtbi13cC1zbXVzaC1sb3NzeVwiKTtcblx0fSk7XG5cblx0Ly9FbmFibGUgUmVzaXplXG5cdCQoJy53cC1zbXVzaC1yZXNpemUtZW5hYmxlJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHQvL0VuYWJsZSBSZXNpemUsIFNob3cgcmVzaXplIHNldHRpbmdzXG5cdFx0JCgnI3dwLXNtdXNoLXJlc2l6ZScpLnByb3AoJ2NoZWNrZWQnLCB0cnVlKS5mb2N1cygpO1xuXHRcdCQoJ2Rpdi53cC1zbXVzaC1yZXNpemUtc2V0dGluZ3Mtd3JhcCcpLnNob3coKTtcblxuXHRcdC8vU2Nyb2xsIGRvd24gdG8gc2V0dGluZ3MgYXJlYVxuXHRcdGdvVG9CeVNjcm9sbChcIiNjb2x1bW4td3Atc211c2gtcmVzaXplXCIpO1xuXHR9KTtcblxuXHQvL1RyaWdnZXIgQnVsa1xuXHQkKCdib2R5Jykub24oJ2NsaWNrJywgJy53cC1zbXVzaC10cmlnZ2VyLWJ1bGsnLCBmdW5jdGlvbiAoZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHQvL0luZHVjZSBTZXR0aW5nIGJ1dHRvbiBzYXZlIGNsaWNrXG5cdFx0JCgnYnV0dG9uLndwLXNtdXNoLWFsbCcpLmNsaWNrKCk7XG5cdFx0JCgnc3Bhbi5zdWktbm90aWNlLWRpc21pc3MnKS5jbGljaygpO1xuXHR9KTtcblxuXHQvL0FsbG93IHRoZSBjaGVja2JveGVzIHRvIGJlIEtleWJvYXJkIEFjY2Vzc2libGVcblx0JCgnLndwLXNtdXNoLXNldHRpbmctcm93IC50b2dnbGUtY2hlY2tib3gnKS5mb2N1cyhmdW5jdGlvbiAoKSB7XG5cdFx0Ly9JZiBTcGFjZSBpcyBwcmVzc2VkXG5cdFx0JCh0aGlzKS5rZXlwcmVzcyhmdW5jdGlvbiAoZSkge1xuXHRcdFx0aWYgKGUua2V5Q29kZSA9PSAzMikge1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdCQodGhpcykuZmluZCgnLnRvZ2dsZS1jaGVja2JveCcpLmNsaWNrKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0pO1xuXG5cdC8vIFJlLVZhbGlkYXRlIFJlc2l6ZSBXaWR0aCBBbmQgSGVpZ2h0LlxuXHQkKCdib2R5Jykub24oJ2JsdXInLCAnLndwLXNtdXNoLXJlc2l6ZS1pbnB1dCcsIGZ1bmN0aW9uICgpIHtcblxuXHRcdHZhciBzZWxmID0gJCh0aGlzKTtcblxuXHRcdHZhciB3cmFwcGVyX2RpdiA9IHNlbGYucGFyZW50cygpLmVxKDQpO1xuXG5cdFx0Ly8gSW5pdGlhdGUgdGhlIGNoZWNrLlxuXHRcdHZhbGlkYXRlX3Jlc2l6ZV9zZXR0aW5ncyh3cmFwcGVyX2RpdiwgZmFsc2UsIGZhbHNlKTsgLy8gcnVuIHRoZSB2YWxpZGF0aW9uLlxuXHR9KTtcblxuXHQvLyBIYW5kbGUgUmVzaXplIENoZWNrYm94IHRvZ2dsZSwgdG8gc2hvdy9oaWRlIHdpZHRoLCBoZWlnaHQgc2V0dGluZ3MuXG5cdCQoJ2JvZHknKS5vbignY2xpY2snLCAnI3dwLXNtdXNoLXJlc2l6ZSwgI3dwLXNtdXNoLXJlc2l6ZS1xdWljay1zZXR1cCcsIGZ1bmN0aW9uICgpIHtcblx0XHR2YXIgc2VsZiA9ICQodGhpcyk7XG5cdFx0dmFyIHNldHRpbmdzX3dyYXAgPSAkKCcud3Atc211c2gtcmVzaXplLXNldHRpbmdzLXdyYXAnKTtcblxuXHRcdGlmIChzZWxmLmlzKCc6Y2hlY2tlZCcpKSB7XG5cdFx0XHRzZXR0aW5nc193cmFwLnNob3coKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0c2V0dGluZ3Nfd3JhcC5oaWRlKCk7XG5cdFx0fVxuXHR9KTtcblxuXHQvLyBIYW5kbGUgQXV0b21hdGljIFNtdXNoIENoZWNrYm94IHRvZ2dsZSwgdG8gc2hvdy9oaWRlIGltYWdlIHNpemUgc2V0dGluZ3MuXG5cdCQoJ2JvZHknKS5vbignY2xpY2snLCAnI3dwLXNtdXNoLWF1dG8nLCBmdW5jdGlvbiAoKSB7XG5cdFx0dmFyIHNlbGYgPSAkKHRoaXMpO1xuXHRcdHZhciBzZXR0aW5nc193cmFwID0gJCgnLndwLXNtdXNoLWltYWdlLXNpemUtbGlzdCcpO1xuXG5cdFx0aWYgKHNlbGYuaXMoJzpjaGVja2VkJykpIHtcblx0XHRcdHNldHRpbmdzX3dyYXAuc2hvdygpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRzZXR0aW5nc193cmFwLmhpZGUoKTtcblx0XHR9XG5cdH0pO1xuXG5cdC8vIEhhbmRsZSBhdXRvIGRldGVjdCBjaGVja2JveCB0b2dnbGUsIHRvIHNob3cvaGlkZSBoaWdobGlnaHRpbmcgbm90aWNlLlxuXHQkKCdib2R5Jykub24oJ2NsaWNrJywgJyN3cC1zbXVzaC1kZXRlY3Rpb24nLCBmdW5jdGlvbiAoKSB7XG5cdFx0dmFyIHNlbGYgPSAkKHRoaXMpO1xuXHRcdHZhciBub3RpY2Vfd3JhcCA9ICQoJy5zbXVzaC1oaWdobGlnaHRpbmctbm90aWNlJyk7XG5cblx0XHRpZiAoc2VsZi5pcygnOmNoZWNrZWQnKSkge1xuXHRcdFx0bm90aWNlX3dyYXAuc2hvdygpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRub3RpY2Vfd3JhcC5oaWRlKCk7XG5cdFx0fVxuXHR9KTtcblxuXHQvLyBIYW5kbGUgUE5HIHRvIEpQRyBDaGVja2JveCB0b2dnbGUsIHRvIHNob3cvaGlkZSBUcmFuc3BhcmVudCBpbWFnZSBjb252ZXJzaW9uIHNldHRpbmdzLlxuXHQkKCcjd3Atc211c2gtcG5nX3RvX2pwZycpLmNsaWNrKGZ1bmN0aW9uICgpIHtcblx0XHR2YXIgc2VsZiA9ICQodGhpcyk7XG5cdFx0dmFyIHNldHRpbmdzX3dyYXAgPSAkKCcud3Atc211c2gtcG5nX3RvX2pwZy13cmFwJyk7XG5cblx0XHRpZiAoc2VsZi5pcygnOmNoZWNrZWQnKSkge1xuXHRcdFx0c2V0dGluZ3Nfd3JhcC5zaG93KCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHNldHRpbmdzX3dyYXAuaGlkZSgpO1xuXHRcdH1cblx0fSk7XG5cblx0Ly9IYW5kbGUsIENoYW5nZSBldmVudCBpbiBFbmFibGUgTmV0d29ya3dpZGUgc2V0dGluZ3Ncblx0JCgnI3dwLXNtdXNoLW5ldHdvcmt3aWRlJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcblx0XHRpZiAoJCh0aGlzKS5pcygnOmNoZWNrZWQnKSkge1xuXHRcdFx0JCgnLm5ldHdvcmstc2V0dGluZ3Mtd3JhcHBlcicpLnNob3coKTtcblx0XHRcdCQoJy5zdWktdmVydGljYWwtdGFicyBsaScpLm5vdCgnLnNtdXNoLWJ1bGsnKS5lYWNoKGZ1bmN0aW9uIChuKSB7XG5cdFx0XHRcdCQodGhpcykucmVtb3ZlQ2xhc3MoJ3N1aS1oaWRkZW4nKTtcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQkKCcubmV0d29yay1zZXR0aW5ncy13cmFwcGVyJykuaGlkZSgpO1xuXHRcdFx0JCgnLnN1aS12ZXJ0aWNhbC10YWJzIGxpJykubm90KCcuc211c2gtYnVsaycpLmVhY2goZnVuY3Rpb24gKG4pIHtcblx0XHRcdFx0JCh0aGlzKS5hZGRDbGFzcygnc3VpLWhpZGRlbicpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9KTtcblxuXHQvL0hhbmRsZSBUd2l0dGVyIFNoYXJlXG5cdCQoJyN3cC1zbXVzaC10d2l0dGVyLXNoYXJlJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0dmFyIHVybCA9IHRoaXMuaHJlZjtcblx0XHR2YXIgdGV4dCA9IHJlbW92ZVNwYW4odXJsKTtcblx0XHQvL1VwZGF0ZSB0ZXh0IGluIFVSTFxuXHRcdHVybCA9IHVybC5yZXBsYWNlKC8odGV4dD0pW15cXCZdKy8sICckMScgKyB0ZXh0KTtcblx0XHR2YXIgd2lkdGggPSA1NTAsXG5cdFx0ICAgIGhlaWdodCA9IDQyMCxcblx0XHQgICAgbGVmdCA9ICgkKHdpbmRvdykud2lkdGgoKSAtIHdpZHRoKSAvIDIsXG5cdFx0ICAgIHRvcCA9ICgkKHdpbmRvdykuaGVpZ2h0KCkgLSBoZWlnaHQpIC8gMixcblx0XHQgICAgdXJsID0gdXJsLFxuXHRcdCAgICBvcHRzID0gJ3N0YXR1cz0xJyArICcsd2lkdGg9JyArIHdpZHRoICsgJyxoZWlnaHQ9JyArIGhlaWdodCArICcsdG9wPScgKyB0b3AgKyAnLGxlZnQ9JyArIGxlZnQ7XG5cblx0XHR3aW5kb3cub3Blbih1cmwsICd0d2l0dGVyJywgb3B0cyk7XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH0pO1xuXG5cdC8vSGFuZGxlIEZhY2Vib29rIFNoYXJlXG5cdCQoJyN3cC1zbXVzaC1mYWNlYm9vay1zaGFyZScpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdHZhciB3aWR0aCA9IDU1MCxcblx0XHQgICAgaGVpZ2h0ID0gNDIwLFxuXHRcdCAgICBsZWZ0ID0gKCQod2luZG93KS53aWR0aCgpIC0gd2lkdGgpIC8gMixcblx0XHQgICAgdG9wID0gKCQod2luZG93KS5oZWlnaHQoKSAtIGhlaWdodCkgLyAyLFxuXHRcdCAgICB1cmwgPSB0aGlzLmhyZWYsXG5cdFx0ICAgIG9wdHMgPSAnc3RhdHVzPTEnICsgJyx3aWR0aD0nICsgd2lkdGggKyAnLGhlaWdodD0nICsgaGVpZ2h0ICsgJyx0b3A9JyArIHRvcCArICcsbGVmdD0nICsgbGVmdDtcblxuXHRcdHdpbmRvdy5vcGVuKHVybCwgJ2ZhY2Vib29rJywgb3B0cyk7XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH0pO1xuXG5cdC8vSGFuZGxlIFJlLWNoZWNrIGJ1dHRvbiBmdW5jdGlvbmFsaXR5XG5cdCQoXCIjd3Atc211c2gtcmV2YWxpZGF0ZS1tZW1iZXJcIikub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0Ly9BamF4IFBhcmFtc1xuXHRcdHZhciBwYXJhbXMgPSB7XG5cdFx0XHRhY3Rpb246ICdzbXVzaF9zaG93X3dhcm5pbmcnXG5cdFx0fTtcblx0XHR2YXIgbGluayA9ICQodGhpcyk7XG5cdFx0dmFyIHBhcmVudCA9IGxpbmsucGFyZW50cygpLmVxKDEpO1xuXHRcdHBhcmVudC5hZGRDbGFzcygnbG9hZGluZy1ub3RpY2UnKTtcblx0XHQkLmdldChhamF4dXJsLCBwYXJhbXMsIGZ1bmN0aW9uIChyKSB7XG5cdFx0XHQvL3JlbW92ZSB0aGUgd2FybmluZ1xuXHRcdFx0cGFyZW50LnJlbW92ZUNsYXNzKCdsb2FkaW5nLW5vdGljZScpLmFkZENsYXNzKFwibG9hZGVkLW5vdGljZVwiKTtcblx0XHRcdGlmICgwID09IHIpIHtcblx0XHRcdFx0cGFyZW50LmF0dHIoJ2RhdGEtbWVzc2FnZScsIHdwX3NtdXNoX21zZ3MubWVtYmVyc2hpcF92YWxpZCk7XG5cdFx0XHRcdHJlbW92ZV9lbGVtZW50KHBhcmVudCwgMTAwMCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRwYXJlbnQuYXR0cignZGF0YS1tZXNzYWdlJywgd3Bfc211c2hfbXNncy5tZW1iZXJzaGlwX2ludmFsaWQpO1xuXHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uIHJlbW92ZV9sb2FkZXIoKSB7XG5cdFx0XHRcdFx0cGFyZW50LnJlbW92ZUNsYXNzKCdsb2FkZWQtbm90aWNlJyk7XG5cdFx0XHRcdH0sIDEwMDApO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9KTtcblxuXHQvL0luaXRpYXRlIFJlLWNoZWNrIGlmIHRoZSB2YXJpYWJsZSBpcyBzZXRcblx0aWYgKCd1bmRlZmluZWQnICE9IHR5cGVvZiB3cF9zbXVzaF9ydW5fcmVfY2hlY2sgJiYgMSA9PSB3cF9zbXVzaF9ydW5fcmVfY2hlY2sgJiYgJCgnLndwLXNtdXNoLXNjYW4nKS5sZW5ndGggPiAwKSB7XG5cdFx0Ly9SdW4gdGhlIFJlLWNoZWNrXG5cdFx0cnVuX3JlX2NoZWNrKCQoJy53cC1zbXVzaC1zY2FuJyksIGZhbHNlKTtcblx0fVxuXG5cdC8vU3RhdHMgU2VjdGlvbiBDaG9vc2UgRGlyZWN0b3J5IExpbmtcblx0JCgnYm9keScpLm9uKCdjbGljaycsICdhLndwLXNtdXNoLWRpci1saW5rJywgZnVuY3Rpb24gKGUpIHtcblx0XHRpZiAoJCgnZGl2LnN1aS13cmFwIGJ1dHRvbi53cC1zbXVzaC1icm93c2UnKS5sZW5ndGggPiAwKSB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRTVUkuZGlhbG9nc1tcIndwLXNtdXNoLWxpc3QtZGlhbG9nXCJdLnNob3coKTtcblx0XHRcdC8vRGlzcGxheSB0aGUgbG9hZGVyXG5cdFx0XHQkKCdidXR0b24uZGlyLXNtdXNoLWJ1dHRvbi13cmFwIHNwYW4uc3Bpbm5lcicpLmFkZENsYXNzKCdpcy1hY3RpdmUnKTtcblxuXHRcdFx0Ly9EaXNwbGF5IEZpbGUgdHJlZSBmb3IgRGlyZWN0b3J5IFNtdXNoXG5cdFx0XHQkKFwiLndwLXNtdXNoLWxpc3QtZGlhbG9nIC5jb250ZW50XCIpLmZpbGVUcmVlKHtcblx0XHRcdFx0c2NyaXB0OiBnZXREaXJlY3RvcnlMaXN0LFxuXHRcdFx0XHRtdWx0aUZvbGRlcjogZmFsc2Vcblx0XHRcdH0sIGZ1bmN0aW9uICgpIHt9KTtcblx0XHR9XG5cdH0pO1xuXG5cdC8vV1AgU211c2ggYWxsIDogU2NhbiBJbWFnZXNcblx0JCgnZGl2LnN1aS13cmFwJykub24oJ2NsaWNrJywgJ2J1dHRvbi53cC1zbXVzaC1icm93c2UnLCBmdW5jdGlvbiAoZSkge1xuXG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0Ly9IaWRlIGFsbCB0aGUgbm90aWNlc1xuXHRcdCQoJ2Rpdi53cC1zbXVzaC1zY2FuLXJlc3VsdCBkaXYud3Atc211c2gtbm90aWNlJykuaGlkZSgpO1xuXG5cdFx0Ly9JZiBkaXNhYmxlZCwgZG8gbm90IHByb2Nlc3Ncblx0XHRpZiAoJCh0aGlzKS5hdHRyKCdkaXNhYmxlZCcpKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vRGlzYWJsZSBCdXR0b25zXG5cdFx0XHQkKHRoaXMpLmF0dHIoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7XG5cdFx0XHQkKCdidXR0b24ud3Atc211c2gtcmVzdW1lJykuYXR0cignZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcblx0XHRcdCQoJ2Rpdi5kaXItc211c2gtYnV0dG9uLXdyYXAgc3Bhbi5zcGlubmVyJykuYWRkQ2xhc3MoJ2lzLWFjdGl2ZScpO1xuXHRcdH1cblxuXHRcdC8vUmVtb3ZlIE5vdGljZVxuXHRcdCQoJ2Rpdi53cC1zbXVzaC1pbmZvJykucmVtb3ZlKCk7XG5cblx0XHRzaG93RGlhbG9nKCk7XG5cblx0XHQvL0Rpc3BsYXkgdGhlIGxvYWRlclxuXHRcdCQoJ2J1dHRvbi5kaXItc211c2gtYnV0dG9uLXdyYXAgc3Bhbi5zcGlubmVyJykuYWRkQ2xhc3MoJ2lzLWFjdGl2ZScpO1xuXG5cdFx0Ly9EaXNwbGF5IEZpbGUgdHJlZSBmb3IgRGlyZWN0b3J5IFNtdXNoXG5cdFx0JChcIi53cC1zbXVzaC1saXN0LWRpYWxvZyAuY29udGVudFwiKS5maWxlVHJlZSh7XG5cdFx0XHRzY3JpcHQ6IGdldERpcmVjdG9yeUxpc3QsXG5cdFx0XHRtdWx0aUZvbGRlcjogZmFsc2Vcblx0XHR9LCBmdW5jdGlvbiAoKSB7fSk7XG5cdH0pO1xuXG5cdC8vIE9uIGRpYWxvZyBjbG9zZSBtYWtlIGJyb3dzZSBidHV0dG9uIGFjdGl2ZS5cblx0JCgnLnN1aS1kaWFsb2ctY2xvc2UnKS5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuXHRcdCQoJy53cC1zbXVzaC1icm93c2UnKS5yZW1vdmVBdHRyKCdkaXNhYmxlZCcpO1xuXHRcdGNsb3NlX2RpYWxvZygpO1xuXHR9KTtcblxuXHQvL0ltYWdlIERpcmVjdG9yaWVzOiBPbiBTZWxlY3QgYnV0dG9uIGNsaWNrXG5cdCQoJy53cC1zbXVzaC1zZWxlY3QtZGlyJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcblxuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdC8vSWYgZGlzYWJsZWQsIGRvIG5vdCBwcm9jZXNzXG5cdFx0aWYgKCQodGhpcykuYXR0cignZGlzYWJsZWQnKSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHZhciBidXR0b24gPSAkKHRoaXMpO1xuXG5cdFx0JCgnZGl2LndwLXNtdXNoLWxpc3QtZGlhbG9nIGRpdi5zdWktYm94LWJvZHknKS5jc3MoeyAnb3BhY2l0eSc6ICcwLjgnIH0pO1xuXHRcdCQoJ2Rpdi53cC1zbXVzaC1saXN0LWRpYWxvZyBkaXYuc3VpLWJveC1ib2R5IGEnKS51bmJpbmQoJ2NsaWNrJyk7XG5cblx0XHQvL1JlbW92ZSByZXN1bWUgYnV0dG9uXG5cdFx0JCgnYnV0dG9uLndwLXNtdXNoLXJlc3VtZScpLnJlbW92ZSgpO1xuXG5cdFx0Ly9EaXNhYmxlIEJ1dHRvblxuXHRcdGJ1dHRvbi5hdHRyKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuXG5cdFx0dmFyIHNwaW5uZXIgPSBidXR0b24ucGFyZW50KCkuZmluZCgnLmFkZC1kaXItbG9hZGVyJyk7XG5cdFx0Ly9EaXNwbGF5IHRoZSBzcGlubmVyXG5cdFx0c3Bpbm5lci5hZGRDbGFzcygnc3VpLWljb24tbG9hZGVyIHN1aS1sb2FkaW5nJyk7XG5cblx0XHQvL0dldCB0aGUgU2VsZWN0ZWQgZGlyZWN0b3J5IHBhdGhcblx0XHR2YXIgcGF0aCA9ICQoJy5qcXVlcnlGaWxlVHJlZSAuc2VsZWN0ZWQgYScpLmF0dHIoJ3JlbCcpO1xuXHRcdHBhdGggPSAndW5kZWZpbmVkJyA9PSB0eXBlb2YgcGF0aCA/ICcnIDogcGF0aDtcblxuXHRcdC8vQWJzb2x1dGUgcGF0aFxuXHRcdHZhciBhYnNfcGF0aCA9ICQoJ2lucHV0W25hbWU9XCJ3cC1zbXVzaC1iYXNlLXBhdGhcIl0nKS52YWwoKTtcblxuXHRcdC8vRmlsbCBpbiB0aGUgaW5wdXQgZmllbGRcblx0XHQkKCcud3Atc211c2gtZGlyLXBhdGgnKS52YWwoYWJzX3BhdGggKyAnLycgKyBwYXRoKTtcblxuXHRcdC8vU2VuZCBhIGFqYXggcmVxdWVzdCB0byBnZXQgYSBsaXN0IG9mIGFsbCB0aGUgaW1hZ2UgZmlsZXNcblx0XHR2YXIgcGFyYW0gPSB7XG5cdFx0XHRhY3Rpb246ICdpbWFnZV9saXN0Jyxcblx0XHRcdHNtdXNoX3BhdGg6ICQoJy53cC1zbXVzaC1kaXItcGF0aCcpLnZhbCgpLFxuXHRcdFx0aW1hZ2VfbGlzdF9ub25jZTogJCgnaW5wdXRbbmFtZT1cImltYWdlX2xpc3Rfbm9uY2VcIl0nKS52YWwoKVxuXHRcdH07XG5cblx0XHQvL0dldCB0aGUgTGlzdCBvZiBpbWFnZXNcblx0XHQkLmdldChhamF4dXJsLCBwYXJhbSwgZnVuY3Rpb24gKHJlcykge1xuXHRcdFx0aWYgKCFyZXMuc3VjY2VzcyAmJiAndW5kZWZpbmVkJyAhPT0gdHlwZW9mIHJlcy5kYXRhLm1lc3NhZ2UpIHtcblx0XHRcdFx0JCgnZGl2LndwLXNtdXNoLXNjYW4tcmVzdWx0IGRpdi5jb250ZW50JykuaHRtbChyZXMuZGF0YS5tZXNzYWdlKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdCQoJy53cC1zbXVzaC1zY2FuLXJlc3VsdCAuc211c2gtZGlyLXNtdXNoLWRvbmUnKS5hZGRDbGFzcygnc3VpLWhpZGRlbicpO1xuXHRcdFx0XHQkKCdkaXYud3Atc211c2gtc2Nhbi1yZXN1bHQgZGl2LmNvbnRlbnQnKS5odG1sKHJlcy5kYXRhKTtcblx0XHRcdFx0d3Bfc211c2hfZGlyX2ltYWdlX2lkcyA9IHJlcy5kYXRhLmlkcztcblx0XHRcdH1cblx0XHRcdHNldF9hY2NvcmRpb24oKTtcblx0XHRcdGNsb3NlX2RpYWxvZygpO1xuXG5cdFx0XHQvL1JlbW92ZSB0aGUgc3Bpbm5lclxuXHRcdFx0c3Bpbm5lci5yZW1vdmVDbGFzcygnc3VpLWljb24tbG9hZGVyIHN1aS1sb2FkaW5nJyk7XG5cblx0XHRcdC8vU2hvdyBTY2FuIHJlc3VsdFxuXHRcdFx0JCgnLndwLXNtdXNoLXNjYW4tcmVzdWx0JykucmVtb3ZlQ2xhc3MoJ3N1aS1oaWRkZW4nKS5zaG93KCk7XG5cdFx0fSkuZG9uZShmdW5jdGlvbiAocmVzKSB7XG5cblx0XHRcdC8vIFNob3cgc2VsZWN0IGRpcmVjdG9yeSBidXR0b24gb24gdG9wLlxuXHRcdFx0JCgnZGl2LnN1aS1ib3gtaGVhZGVyIGJ1dHRvbi53cC1zbXVzaC1icm93c2UnKS5yZW1vdmVDbGFzcygnc3VpLWhpZGRlbicpO1xuXG5cdFx0XHQvL0lmIHRoZXJlIHdhcyBubyBpbWFnZSBsaXN0LCByZXR1cm5cblx0XHRcdGlmICghcmVzLnN1Y2Nlc3MpIHtcblx0XHRcdFx0Ly9IaWRlIHRoZSBzbXVzaCBidXR0b25cblx0XHRcdFx0JCgnZGl2LndwLXNtdXNoLWFsbC1idXR0b24td3JhcC5ib3R0b20nKS5hZGRDbGFzcygnc3VpLWhpZGRlbicpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdC8vU2hvdyB0aGUgc211c2ggYnV0dG9uXG5cdFx0XHQkKCdkaXYud3Atc211c2gtYWxsLWJ1dHRvbi13cmFwLmJvdHRvbScpLnJlbW92ZUNsYXNzKCdzdWktaGlkZGVuJyk7XG5cblx0XHRcdC8vUmVtb3ZlIGRpc2FibGVkIGF0dHJpYnV0ZSBmb3IgdGhlIGJ1dHRvblxuXHRcdFx0JCgnYnV0dG9uLndwLXNtdXNoLXN0YXJ0JykucmVtb3ZlQXR0cignZGlzYWJsZWQnKTtcblxuXHRcdFx0Ly9BcHBlbmQgYSBEaXJlY3RvcnkgYnJvd3NlciBidXR0b24gYXQgdGhlIHRvcFxuXHRcdFx0YWRkX2Rpcl9icm93c2VyX2J1dHRvbigpO1xuXG5cdFx0XHQvL0Nsb25lIGFuZCBhZGQgU211c2ggYnV0dG9uXG5cdFx0XHRhZGRfc211c2hfYnV0dG9uKCk7XG5cblx0XHRcdHdpbmRvdy5sb2NhdGlvbi5oYXNoID0gJyN3cC1zbXVzaC1kaXItYnJvd3Nlcic7XG5cdFx0fSk7XG5cdH0pO1xuXG5cdC8qKlxuICAqIEhhbmRsZSB0aGUgU211c2ggTm93IGJ1dHRvbiBjbGlja1xuICAqL1xuXHQkKCcjd3Atc211c2gtZGlyLXdyYXAtYm94Jykub24oJ2NsaWNrJywgJ2J1dHRvbi53cC1zbXVzaC1zdGFydCcsIGZ1bmN0aW9uIChlKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0Ly9DaGVjayBpZiB3ZSBoYXZlIGltYWdlcyB0byBiZSBvcHRpbWlzZWRcblx0XHRpZiAoISQoJy53cC1zbXVzaC1pbWFnZS1lbGU6bm90KC5vcHRpbWlzZWQpJykubGVuZ3RoKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly9EaXNhYmxlIHRoaXMgYnV0dG9uXG5cdFx0dmFyIGJ1dHRvbiA9ICQoJy53cC1zbXVzaC1zdGFydCcpO1xuXHRcdHZhciBwYXJlbnQgPSBidXR0b24ucGFyZW50KCk7XG5cblx0XHQvL0hpZGUgYWxsIHRoZSBub3RpY2VzXG5cdFx0JCgnZGl2LndwLXNtdXNoLXNjYW4tcmVzdWx0IGRpdi5zdWktbm90aWNlJykuaGlkZSgpO1xuXG5cdFx0Ly9TZXQgdGhlIGJ1dHRvbiBzdGF0dXMgdG8gMCwgdG8gY2FuY2VsIG5leHQgYWpheCByZXF1ZXN0XG5cdFx0JCgnaW5wdXRbbmFtZT1cIndwLXNtdXNoLWNvbnRpbnVlLWFqYXhcIl0nKS52YWwoMSk7XG5cblx0XHQvL0hpZGUgRGlyZWN0b3J5IGJyb3dzZXIgYnV0dG9uXG5cdFx0JCgnYnV0dG9uLndwLXNtdXNoLWJyb3dzZScpLmhpZGUoKTtcblxuXHRcdC8vSGlkZSBFeGNsdWRlIGRpcmVjdG9yeSBidXR0b24gbGlua1xuXHRcdCQoJy53cC1zbXVzaC1leGNsdWRlLWRpcicpLmhpZGUoKTtcblxuXHRcdC8qKiBBbGwgdGhlIFN0eWxpbmcgY2hhbmdlcyAqKi9cblx0XHRidXR0b24uaGlkZSgpO1xuXHRcdHBhcmVudC5maW5kKCdidXR0b24ud3Atc211c2gtcGF1c2UnKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQgc3VpLWhpZGRlbicpLnJlbW92ZUF0dHIoJ2Rpc2FibGVkJyk7XG5cblx0XHQvL0Rpc2FibGUgU2VsZWN0IERpcmVjdG9yeSBidXR0b25cblx0XHQkKCdidXR0b24ud3Atc211c2gtYnJvd3NlJykuYXR0cignZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcblxuXHRcdC8vIEFkZCBwcm9ncmVzcyBpY29uIHRvIG5hdmJhci5cblx0XHQkKCcuc211c2gtbmF2LWljb24uZGlyZWN0b3J5JykuYWRkQ2xhc3MoJ3N1aS1pY29uLWxvYWRlciBzdWktbG9hZGluZycpO1xuXG5cdFx0Ly9Jbml0aWFsaXplIHRoZSBvcHRpbWlzYXRpb25cblx0XHRzbXVzaF9hbGwodHJ1ZSk7XG5cdH0pO1xuXG5cdC8vIEhhbmRsZSB0aGUgUGF1c2UgYnV0dG9uIGNsaWNrLlxuXHQkKCdkaXYud3Atc211c2gtc2Nhbi1yZXN1bHQnKS5vbignY2xpY2snLCAnYnV0dG9uLndwLXNtdXNoLXBhdXNlJywgZnVuY3Rpb24gKGUpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHR2YXIgcGF1c2VfYnV0dG9uID0gJCgnYnV0dG9uLndwLXNtdXNoLXBhdXNlJyk7XG5cdFx0Ly8gUmV0dXJuIGlmIHRoZSBsaW5rIGlzIGRpc2FibGVkLlxuXHRcdGlmIChwYXVzZV9idXR0b24uaGFzQ2xhc3MoJ2Rpc2FibGVkJykpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHQvLyBTZXQgdGhlIGJ1dHRvbiBzdGF0dXMgdG8gMCwgdG8gY2FuY2VsIG5leHQgYWpheCByZXF1ZXN0LlxuXHRcdCQoJ2lucHV0W25hbWU9XCJ3cC1zbXVzaC1jb250aW51ZS1hamF4XCJdJykudmFsKDApO1xuXG5cdFx0Ly8gRW5hYmxlIHRoZSBzbXVzaCBidXR0b24sIGRpc2FibGUgUGF1c2UgYnV0dG9uLlxuXHRcdHBhdXNlX2J1dHRvbi5hZGRDbGFzcygnc3VpLWhpZGRlbicpLmF0dHIoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7XG5cblx0XHQvLyBFbmFibGUgdGhlIHNtdXNoIGJ1dHRvbiwgaGlkZSB0aGUgc3Bpbm5lci5cblx0XHQkKCdidXR0b24ud3Atc211c2gtc3RhcnQsIGJ1dHRvbi53cC1zbXVzaC1icm93c2UnKS5zaG93KCkucmVtb3ZlQXR0cignZGlzYWJsZWQnKTtcblx0XHQkKCdzcGFuLndwLXNtdXNoLWltYWdlLWRpci1wcm9ncmVzcywgc3Bhbi53cC1zbXVzaC1pbWFnZS1lbGUtcHJvZ3Jlc3MnKS5yZW1vdmVDbGFzcygnc3VpLWljb24tbG9hZGVyIHN1aS1sb2FkaW5nJyk7XG5cblx0XHQvLyBIaWRlIHRoZSB3YWl0aW5nIG1lc3NhZ2UuXG5cdFx0JCgnLndwLXNtdXNoLWltYWdlLXByb2dyZXNzLXBlcmNlbnQnKS5hZGRDbGFzcygnc3VpLWhpZGRlbicpO1xuXG5cdFx0Ly8gU2hvdyBkaXJlY3RvcnkgZXhjbHVkZSBvcHRpb24uXG5cdFx0JCgnLndwLXNtdXNoLWV4Y2x1ZGUtZGlyJykuZWFjaChmdW5jdGlvbiAoKSB7XG5cdFx0XHRpZiAoJCh0aGlzKS5wYXJlbnQoKS5wcmV2QWxsKCcub3B0aW1pc2VkLCAucGFydGlhbCcpLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0XHQkKHRoaXMpLnNob3coKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIFJlbW92ZSBwcm9ncmVzcyBpY29uIGZyb20gbmF2YmFyLlxuXHRcdCQoJy5zbXVzaC1uYXYtaWNvbi5kaXJlY3RvcnknKS5yZW1vdmVDbGFzcygnc3VpLWljb24tbG9hZGVyIHN1aS1sb2FkaW5nJyk7XG5cdH0pO1xuXG5cdC8vRXhjbHVkZSBEaXJlY3RvcnkgZnJvbSBsaXN0IC0gSGFuZGxlIENsaWNrXG5cdCQoJ2Rpdi53cC1zbXVzaC1zY2FuLXJlc3VsdCcpLm9uKCdjbGljaycsICcud3Atc211c2gtZXhjbHVkZS1kaXInLCBmdW5jdGlvbiAoZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblxuXHRcdHZhciBzZWxmID0gJCh0aGlzKTtcblxuXHRcdC8vSGlkZSB0aGUgbGlua1xuXHRcdC8vc2VsZi5oaWRlKCk7XG5cblx0XHR2YXIgcGF0aCA9IHNlbGYuZGF0YSgncGF0aCcpO1xuXHRcdHZhciBwYXJhbSA9IHtcblx0XHRcdGFjdGlvbjogJ3NtdXNoX2V4Y2x1ZGVfcGF0aCcsXG5cdFx0XHRwYXRoOiBwYXRoLFxuXHRcdFx0bm9uY2U6ICQoJ2lucHV0W25hbWU9XCJleGNsdWRlLXBhdGgtbm9uY2VcIl0nKS52YWwoKVxuXHRcdH07XG5cblx0XHQvL1NlbmQgQWpheCByZXF1ZXN0IHRvIHJlbW92ZSBpbWFnZSBmb3IgdGhlIGdpdmVuIHBhdGggZnJvbSBkYlxuXHRcdCQucG9zdChhamF4dXJsLCBwYXJhbSwgZnVuY3Rpb24gKHJlcykge1xuXHRcdFx0Ly9SZW1vdmUgdGhlIHdob2xlIGxpIGVsZW1lbnQgb24gc3VjY2Vzc1xuXHRcdFx0aWYgKHJlcy5zdWNjZXNzKSB7XG5cdFx0XHRcdC8vIFJlbW92ZSBjb250ZW50IGFuZCBwYXJlbnQgcm93cy5cblx0XHRcdFx0c2VsZi5jbG9zZXN0KCd0ci5zdWktYWNjb3JkaW9uLWl0ZW0nKS5yZW1vdmUoKTtcblx0XHRcdFx0c2VsZi5jbG9zZXN0KCd0ci5zdWktYWNjb3JkaW9uLWl0ZW0nKS5uZXh0KCd0ci5zdWktYWNjb3JkaW9uLWl0ZW0tY29udGVudCcpLnJlbW92ZSgpO1xuXG5cdFx0XHRcdC8vUmVtb3ZlIHRoZSBib3R0b20gYnVsayBzbXN1aCBidXR0b24gaWYgdGhlcmUgYXJlIG5vIG1vcmUgZGlyZWN0b3JpZXMgbGVmdCBpbiBzY2FuIHJlc3VsdHNcblx0XHRcdFx0aWYgKDAgPT0gJCgnLndwLXNtdXNoLWltYWdlLWVsZTpub3QoLm9wdGltaXNlZCknKS5sZW5ndGgpIHtcblx0XHRcdFx0XHQkKCdkaXYud3Atc211c2gtYWxsLWJ1dHRvbi13cmFwLmJvdHRvbScpLmhpZGUoKTtcblx0XHRcdFx0XHQkKCdkaXYud3Atc211c2gtc2Nhbi1yZXN1bHQnKS5oaWRlKCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblx0fSk7XG5cblx0Ly9IYW5kbGUgQ2xpY2sgZm9yIFJlc3VtZSBMYXN0IHNjYW4gYnV0dG9uXG5cdCQoJ2J1dHRvbi53cC1zbXVzaC1yZXN1bWUnKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG5cblx0XHR2YXIgc2VsZiA9ICQodGhpcyk7XG5cblx0XHQvL0Rpc2FibGUgYnV0dG9uc1xuXHRcdGRpc2FibGVfYnV0dG9ucyhzZWxmKTtcblxuXHRcdC8vU2hvdyBTcGlubmVyXG5cdFx0JCgnc3Bhbi53cC1zbXVzaC1yZXN1bWUtbG9kZXInKS5yZW1vdmVDbGFzcygnc3VpLWhpZGRlbicpO1xuXG5cdFx0dmFyIHBhcmFtcyA9IHtcblx0XHRcdGFjdGlvbjogJ3Jlc3VtZV9zY2FuJ1xuXHRcdH07XG5cblx0XHQvL1NlbmQgQWpheCByZXF1ZXN0IHRvIGxvYWQgYSBsaXN0IG9mIGltYWdlc1xuXHRcdCQuZ2V0KGFqYXh1cmwsIHBhcmFtcywgZnVuY3Rpb24gKHIpIHtcblxuXHRcdFx0Ly9IaWRlIHRoZSBidXR0b25zXG5cdFx0XHQkKCdidXR0b24ud3Atc211c2gtcmVzdW1lJykucmVtb3ZlKCk7XG5cdFx0XHQvLyBBbGxvdyB0byBzZWxlY3QgYSBuZXcgZGlyZWN0b3J5XG5cdFx0XHQkKCdidXR0b24ud3Atc211c2gtYnJvd3NlJykucmVtb3ZlQXR0cignZGlzYWJsZWQnKTtcblx0XHRcdC8vQXBwZW5kIHRoZSByZXN1bHRzXG5cdFx0XHRpZiAoIXIuc3VjY2Vzcykge1xuXHRcdFx0XHQvL0FwcGVuZCB0aGUgZXJyb3IgbWVzc2FnZSBiZWZvcmUgdGhlIGJ1dHRvbnNcblx0XHRcdFx0JCgnZGl2LndwLXNtdXNoLWRpci1kZXNjJykuYWZ0ZXIoci5kYXRhLm1lc3NhZ2UpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly9BcHBlbmQgdGhlIGltYWdlIG1hcmt1cCBhZnRlciB0aGUgYnV0dG9uc1xuXHRcdFx0XHQkKCdkaXYud3Atc211c2gtc2Nhbi1yZXN1bHQgZGl2LmNvbnRlbnQnKS5odG1sKHIuZGF0YSk7XG5cdFx0XHRcdCQoJ2Rpdi53cC1zbXVzaC1zY2FuLXJlc3VsdCcpLnJlbW92ZUNsYXNzKCdzdWktaGlkZGVuJyk7XG5cblx0XHRcdFx0c2V0X2FjY29yZGlvbigpO1xuXHRcdFx0fVxuXHRcdH0pLmRvbmUoZnVuY3Rpb24gKCkge1xuXHRcdFx0Ly9BZGQgQ2hvb3NlIGRpciBicm93c2VyIGJ1dHRvblxuXHRcdFx0YWRkX2Rpcl9icm93c2VyX2J1dHRvbigpO1xuXG5cdFx0XHQvL0Nsb25lIGFuZCBhZGQgU211c2ggYnV0dG9uXG5cdFx0XHRhZGRfc211c2hfYnV0dG9uKCk7XG5cdFx0fSk7XG5cdH0pO1xuXG5cdGlmICgkKCdsaS5zbXVzaC1kaXItc2F2aW5ncycpLmxlbmd0aCA+IDApIHtcblx0XHQvL1VwZGF0ZSBEaXJlY3RvcnkgU211c2gsIGFzIHNvb24gYXMgdGhlIHBhZ2UgbG9hZHNcblx0XHR2YXIgc3RhdHNfcGFyYW0gPSB7XG5cdFx0XHRhY3Rpb246ICdnZXRfZGlyX3NtdXNoX3N0YXRzJ1xuXHRcdH07XG5cdFx0JC5nZXQoYWpheHVybCwgc3RhdHNfcGFyYW0sIGZ1bmN0aW9uIChyKSB7XG5cblx0XHRcdC8vSGlkZSB0aGUgc3Bpbm5lclxuXHRcdFx0JCgnbGkuc211c2gtZGlyLXNhdmluZ3MgLnN1aS1pY29uLWxvYWRlcicpLmhpZGUoKTtcblxuXHRcdFx0Ly9JZiB0aGVyZSBhcmUgbm8gZXJyb3JzLCBhbmQgd2UgaGF2ZSBhIG1lc3NhZ2UgdG8gZGlzcGxheVxuXHRcdFx0aWYgKCFyLnN1Y2Nlc3MgJiYgJ3VuZGVmaW5lZCcgIT0gdHlwZW9mIHIuZGF0YS5tZXNzYWdlKSB7XG5cdFx0XHRcdCQoJ2Rpdi53cC1zbXVzaC1zY2FuLXJlc3VsdCBkaXYuY29udGVudCcpLnByZXBlbmQoci5kYXRhLm1lc3NhZ2UpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdC8vSWYgdGhlcmUgaXMgbm8gdmFsdWUgaW4gclxuXHRcdFx0aWYgKCd1bmRlZmluZWQnID09IHR5cGVvZiByLmRhdGEgfHwgJ3VuZGVmaW5lZCcgPT0gdHlwZW9mIHIuZGF0YS5kaXJfc211c2gpIHtcblx0XHRcdFx0Ly9BcHBlbmQgdGhlIHRleHRcblx0XHRcdFx0JCgnbGkuc211c2gtZGlyLXNhdmluZ3Mgc3Bhbi53cC1zbXVzaC1zdGF0cycpLmFwcGVuZCh3cF9zbXVzaF9tc2dzLmFqYXhfZXJyb3IpO1xuXHRcdFx0XHQkKCdsaS5zbXVzaC1kaXItc2F2aW5ncyBzcGFuLndwLXNtdXNoLXN0YXRzIHNwYW4nKS5oaWRlKCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvL1VwZGF0ZSB0aGUgc3RhdHNcblx0XHRcdFx0dXBkYXRlX2N1bW11bGF0aXZlX3N0YXRzKHIuZGF0YSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblx0Ly9DbG9zZSBEaXJlY3Rvcnkgc211c2ggbW9kYWwsIGlmIHByZXNzZWQgZXNjXG5cdCQoZG9jdW1lbnQpLmtleXVwKGZ1bmN0aW9uIChlKSB7XG5cdFx0aWYgKGUua2V5Q29kZSA9PT0gMjcpIHtcblx0XHRcdHZhciBtb2RhbCA9ICQoJ2Rpdi5kZXYtb3ZlcmxheS53cC1zbXVzaC1saXN0LWRpYWxvZywgZGl2LmRldi1vdmVybGF5LndwLXNtdXNoLWdldC1wcm8nKTtcblx0XHRcdC8vSWYgdGhlIERpcmVjdG9yeSBkaWFsb2cgaXMgbm90IHZpc2libGVcblx0XHRcdGlmICghbW9kYWwuaXMoJzp2aXNpYmxlJykpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0bW9kYWwuZmluZCgnZGl2LmNsb3NlJykuY2xpY2soKTtcblx0XHR9XG5cdH0pO1xuXG5cdC8vUXVpY2sgU2V0dXAgLSBGb3JtIFN1Ym1pdFxuXHQkKCcjc211c2gtcXVpY2stc2V0dXAtc3VibWl0Jykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuXHRcdHZhciBzZWxmID0gJCh0aGlzKTtcblx0XHR2YXIgc3VibWl0X2J1dHRvbiA9IHNlbGYuZmluZCgnYnV0dG9uW3R5cGU9XCJzdWJtaXRcIl0nKTtcblx0XHQkLmFqYXgoe1xuXHRcdFx0dHlwZTogJ1BPU1QnLFxuXHRcdFx0dXJsOiBhamF4dXJsLFxuXHRcdFx0ZGF0YTogJCgnI3NtdXNoLXF1aWNrLXNldHVwLWZvcm0nKS5zZXJpYWxpemUoKSxcblx0XHRcdGJlZm9yZVNlbmQ6IGZ1bmN0aW9uIGJlZm9yZVNlbmQoKSB7XG5cdFx0XHRcdC8vU2hvdyBsb2FkZXJcblxuXHRcdFx0XHQvL0Rpc2FibGUgdGhlIGJ1dHRvblxuXHRcdFx0XHRzdWJtaXRfYnV0dG9uLmF0dHIoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7XG5cblx0XHRcdFx0Ly9TaG93IGxvYWRlclxuXHRcdFx0XHQkKCc8c3BhbiBjbGFzcz1cInN1aS1pY29uLWxvYWRlciBzdWktbG9hZGluZ1wiPjwvc3Bhbj4nKS5pbnNlcnRBZnRlcihzdWJtaXRfYnV0dG9uKTtcblx0XHRcdH0sXG5cdFx0XHRzdWNjZXNzOiBmdW5jdGlvbiBzdWNjZXNzKGRhdGEpIHtcblx0XHRcdFx0Ly9FbmFibGUgdGhlIGJ1dHRvblxuXHRcdFx0XHRzdWJtaXRfYnV0dG9uLnJlbW92ZUF0dHIoJ2Rpc2FibGVkJyk7XG5cdFx0XHRcdC8vUmVtb3ZlIHRoZSBsb2FkZXJcblx0XHRcdFx0c3VibWl0X2J1dHRvbi5wYXJlbnQoKS5maW5kKCdzcGFuLnNwaW5uZXInKS5yZW1vdmUoKTtcblxuXHRcdFx0XHRpZiAoZGF0YS5zdWNjZXNzID09IDEpIHtcblx0XHRcdFx0XHQvL3JlbW92ZSBza2lwIGJ1dHRvblxuXHRcdFx0XHRcdCQoJy5zbXVzaC1za2lwLXNldHVwJykuaGlkZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdC8vUmVsb2FkIHRoZSBQYWdlXG5cdFx0XHRcdC8vbG9jYXRpb24ucmVsb2FkKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9KTtcblx0Ly9RdWljayBTZXR1cCAtIFNraXAgYnV0dG9uXG5cdCQoJ2JvZHknKS5vbignc3VibWl0JywgJy5zbXVzaC1za2lwLXNldHVwJywgZnVuY3Rpb24gKCkge1xuXHRcdHZhciBzZWxmID0gJCh0aGlzKTtcblx0XHQkLmFqYXgoe1xuXHRcdFx0dHlwZTogJ1BPU1QnLFxuXHRcdFx0dXJsOiBhamF4dXJsLFxuXHRcdFx0ZGF0YTogc2VsZi5zZXJpYWxpemUoKSxcblx0XHRcdGJlZm9yZVNlbmQ6IGZ1bmN0aW9uIGJlZm9yZVNlbmQoKSB7XG5cdFx0XHRcdHNlbGYuZmluZCgnLmJ1dHRvbicpLmF0dHIoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7XG5cdFx0XHR9LFxuXHRcdFx0c3VjY2VzczogZnVuY3Rpb24gc3VjY2VzcyhkYXRhKSB7XG5cdFx0XHRcdGxvY2F0aW9uLnJlbG9hZCgpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdHJldHVybiBmYWxzZTtcblx0fSk7XG5cblx0Ly9EaXNtaXNzIFNtdXNoIHJlY29tbWVuZGF0aW9uXG5cdCQoJ3NwYW4uZGlzbWlzcy1yZWNvbW1lbmRhdGlvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdHZhciBwYXJlbnQgPSAkKHRoaXMpLnBhcmVudCgpO1xuXHRcdC8vcmVtb3ZlIGRpdiBhbmQgc2F2ZSBwcmVmZXJlbmNlIGluIGRiXG5cdFx0cGFyZW50LmhpZGUoJ3Nsb3cnLCBmdW5jdGlvbiAoKSB7XG5cdFx0XHRwYXJlbnQucmVtb3ZlKCk7XG5cdFx0fSk7XG5cdFx0JC5hamF4KHtcblx0XHRcdHR5cGU6ICdQT1NUJyxcblx0XHRcdHVybDogYWpheHVybCxcblx0XHRcdGRhdGE6IHtcblx0XHRcdFx0J2FjdGlvbic6ICdoaWRlX3BhZ2VzcGVlZF9zdWdnZXN0aW9uJ1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9KTtcblxuXHQvL1JlbW92ZSBBUEkgbWVzc2FnZVxuXHQkKCdkaXYud3Atc211c2gtYXBpLW1lc3NhZ2UgaS5pY29uLWZpLWNsb3NlJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0dmFyIHBhcmVudCA9ICQodGhpcykucGFyZW50KCk7XG5cdFx0Ly9yZW1vdmUgZGl2IGFuZCBzYXZlIHByZWZlcmVuY2UgaW4gZGJcblx0XHRwYXJlbnQuaGlkZSgnc2xvdycsIGZ1bmN0aW9uICgpIHtcblx0XHRcdHBhcmVudC5yZW1vdmUoKTtcblx0XHR9KTtcblx0XHQkLmFqYXgoe1xuXHRcdFx0dHlwZTogJ1BPU1QnLFxuXHRcdFx0dXJsOiBhamF4dXJsLFxuXHRcdFx0ZGF0YToge1xuXHRcdFx0XHQnYWN0aW9uJzogJ2hpZGVfYXBpX21lc3NhZ2UnXG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0pO1xufSk7XG4oZnVuY3Rpb24gKCQpIHtcblx0dmFyIFNtdXNoID0gZnVuY3Rpb24gU211c2goZWxlbWVudCwgb3B0aW9ucykge1xuXHRcdHZhciBlbGVtID0gJChlbGVtZW50KTtcblxuXHRcdHZhciBkZWZhdWx0cyA9IHtcblx0XHRcdGlzU2luZ2xlOiBmYWxzZSxcblx0XHRcdGFqYXh1cmw6ICcnLFxuXHRcdFx0bXNnczoge30sXG5cdFx0XHRtc2dDbGFzczogJ3dwLXNtdXNoLW1zZycsXG5cdFx0XHRpZHM6IFtdXG5cdFx0fTtcblx0fTtcblx0JC5mbi53cHNtdXNoID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHtcblx0XHRcdHZhciBlbGVtZW50ID0gJCh0aGlzKTtcblxuXHRcdFx0Ly8gUmV0dXJuIGVhcmx5IGlmIHRoaXMgZWxlbWVudCBhbHJlYWR5IGhhcyBhIHBsdWdpbiBpbnN0YW5jZVxuXHRcdFx0aWYgKGVsZW1lbnQuZGF0YSgnd3BzbXVzaCcpKSByZXR1cm47XG5cblx0XHRcdC8vIHBhc3Mgb3B0aW9ucyB0byBwbHVnaW4gY29uc3RydWN0b3IgYW5kIGNyZWF0ZSBhIG5ldyBpbnN0YW5jZVxuXHRcdFx0dmFyIHdwc211c2ggPSBuZXcgU211c2godGhpcywgb3B0aW9ucyk7XG5cblx0XHRcdC8vIFN0b3JlIHBsdWdpbiBvYmplY3QgaW4gdGhpcyBlbGVtZW50J3MgZGF0YVxuXHRcdFx0ZWxlbWVudC5kYXRhKCd3cHNtdXNoJywgd3BzbXVzaCk7XG5cdFx0fSk7XG5cdH07XG59KShqUXVlcnkpOyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./_src/js/modules/admin.js\n");

/***/ }),

/***/ "./_src/js/modules/bulk-smush.js":
/*!***************************************!*\
  !*** ./_src/js/modules/bulk-smush.js ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\njQuery(function ($) {\n\n\t// Remove dismissable notices\n\t$('.sui-wrap').on('click', '.sui-notice-dismiss', function (e) {\n\t\te.preventDefault();\n\n\t\t$(this).parent().stop().slideUp('slow');\n\t});\n\n\t$(window).on('load', function () {\n\t\t// If quick setup box is found, show.\n\t\tif ($('#smush-quick-setup-dialog').length > 0) {\n\t\t\t// Show the modal.\n\t\t\twindow.SUI.dialogs['smush-quick-setup-dialog'].show();\n\t\t}\n\t});\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9fc3JjL2pzL21vZHVsZXMvYnVsay1zbXVzaC5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL19zcmMvanMvbW9kdWxlcy9idWxrLXNtdXNoLmpzPzY5MTQiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5qUXVlcnkoZnVuY3Rpb24gKCQpIHtcblxuXHQvLyBSZW1vdmUgZGlzbWlzc2FibGUgbm90aWNlc1xuXHQkKCcuc3VpLXdyYXAnKS5vbignY2xpY2snLCAnLnN1aS1ub3RpY2UtZGlzbWlzcycsIGZ1bmN0aW9uIChlKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG5cdFx0JCh0aGlzKS5wYXJlbnQoKS5zdG9wKCkuc2xpZGVVcCgnc2xvdycpO1xuXHR9KTtcblxuXHQkKHdpbmRvdykub24oJ2xvYWQnLCBmdW5jdGlvbiAoKSB7XG5cdFx0Ly8gSWYgcXVpY2sgc2V0dXAgYm94IGlzIGZvdW5kLCBzaG93LlxuXHRcdGlmICgkKCcjc211c2gtcXVpY2stc2V0dXAtZGlhbG9nJykubGVuZ3RoID4gMCkge1xuXHRcdFx0Ly8gU2hvdyB0aGUgbW9kYWwuXG5cdFx0XHR3aW5kb3cuU1VJLmRpYWxvZ3NbJ3NtdXNoLXF1aWNrLXNldHVwLWRpYWxvZyddLnNob3coKTtcblx0XHR9XG5cdH0pO1xufSk7Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./_src/js/modules/bulk-smush.js\n");

/***/ }),

/***/ "./_src/js/modules/notice.js":
/*!***********************************!*\
  !*** ./_src/js/modules/notice.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\n/**\n * Created by umeshkumar on 12/05/16.\n */\njQuery(function () {\n\tvar el_notice = jQuery(\".smush-notice\"),\n\t    btn_act = el_notice.find(\".smush-notice-act\"),\n\t    btn_dismiss = el_notice.find(\".smush-notice-dismiss\");\n\tel_notice.fadeIn(500);\n\n\t// Hide the notice after a CTA button was clicked\n\tfunction remove_notice() {\n\t\tel_notice.fadeTo(100, 0, function () {\n\t\t\tel_notice.slideUp(100, function () {\n\t\t\t\tel_notice.remove();\n\t\t\t});\n\t\t});\n\t}\n\n\tbtn_act.click(function (ev) {\n\t\tremove_notice();\n\t\tnotify_wordpress(btn_act.data(\"msg\"));\n\t});\n\tbtn_dismiss.click(function (ev) {\n\t\tremove_notice();\n\t\tnotify_wordpress(btn_act.data(\"msg\"));\n\t});\n\n\t// Notify WordPress about the users choice and close the message.\n\tfunction notify_wordpress(message) {\n\t\tel_notice.attr(\"data-message\", message);\n\t\tel_notice.addClass(\"loading\");\n\n\t\t//Send a ajax request to save the dismissed notice option\n\t\tvar param = {\n\t\t\taction: 'dismiss_upgrade_notice'\n\t\t};\n\t\tjQuery.post(ajaxurl, param);\n\t}\n\n\t// Store the preference in db.\n\tfunction send_dismiss_request(action) {\n\t\tvar param = {\n\t\t\taction: action\n\t\t};\n\t\tjQuery.post(ajaxurl, param);\n\t}\n\n\t// Dismiss the update notice.\n\tjQuery('.wp-smush-update-info').on('click', '.notice-dismiss', function (e) {\n\t\te.preventDefault();\n\t\tel_notice = jQuery(this);\n\t\tremove_notice();\n\t\tsend_dismiss_request('dismiss_update_info');\n\t});\n\n\t// Dismiss S3 support alert.\n\tjQuery('div.wp-smush-s3support-alert').on('click', '.icon-fi-close', function (e) {\n\t\tel_notice = jQuery(this);\n\t\tremove_notice();\n\t\tsend_dismiss_request('dismiss_s3support_alert');\n\t});\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9fc3JjL2pzL21vZHVsZXMvbm90aWNlLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vX3NyYy9qcy9tb2R1bGVzL25vdGljZS5qcz9hZGM1Il0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG4vKipcbiAqIENyZWF0ZWQgYnkgdW1lc2hrdW1hciBvbiAxMi8wNS8xNi5cbiAqL1xualF1ZXJ5KGZ1bmN0aW9uICgpIHtcblx0dmFyIGVsX25vdGljZSA9IGpRdWVyeShcIi5zbXVzaC1ub3RpY2VcIiksXG5cdCAgICBidG5fYWN0ID0gZWxfbm90aWNlLmZpbmQoXCIuc211c2gtbm90aWNlLWFjdFwiKSxcblx0ICAgIGJ0bl9kaXNtaXNzID0gZWxfbm90aWNlLmZpbmQoXCIuc211c2gtbm90aWNlLWRpc21pc3NcIik7XG5cdGVsX25vdGljZS5mYWRlSW4oNTAwKTtcblxuXHQvLyBIaWRlIHRoZSBub3RpY2UgYWZ0ZXIgYSBDVEEgYnV0dG9uIHdhcyBjbGlja2VkXG5cdGZ1bmN0aW9uIHJlbW92ZV9ub3RpY2UoKSB7XG5cdFx0ZWxfbm90aWNlLmZhZGVUbygxMDAsIDAsIGZ1bmN0aW9uICgpIHtcblx0XHRcdGVsX25vdGljZS5zbGlkZVVwKDEwMCwgZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRlbF9ub3RpY2UucmVtb3ZlKCk7XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fVxuXG5cdGJ0bl9hY3QuY2xpY2soZnVuY3Rpb24gKGV2KSB7XG5cdFx0cmVtb3ZlX25vdGljZSgpO1xuXHRcdG5vdGlmeV93b3JkcHJlc3MoYnRuX2FjdC5kYXRhKFwibXNnXCIpKTtcblx0fSk7XG5cdGJ0bl9kaXNtaXNzLmNsaWNrKGZ1bmN0aW9uIChldikge1xuXHRcdHJlbW92ZV9ub3RpY2UoKTtcblx0XHRub3RpZnlfd29yZHByZXNzKGJ0bl9hY3QuZGF0YShcIm1zZ1wiKSk7XG5cdH0pO1xuXG5cdC8vIE5vdGlmeSBXb3JkUHJlc3MgYWJvdXQgdGhlIHVzZXJzIGNob2ljZSBhbmQgY2xvc2UgdGhlIG1lc3NhZ2UuXG5cdGZ1bmN0aW9uIG5vdGlmeV93b3JkcHJlc3MobWVzc2FnZSkge1xuXHRcdGVsX25vdGljZS5hdHRyKFwiZGF0YS1tZXNzYWdlXCIsIG1lc3NhZ2UpO1xuXHRcdGVsX25vdGljZS5hZGRDbGFzcyhcImxvYWRpbmdcIik7XG5cblx0XHQvL1NlbmQgYSBhamF4IHJlcXVlc3QgdG8gc2F2ZSB0aGUgZGlzbWlzc2VkIG5vdGljZSBvcHRpb25cblx0XHR2YXIgcGFyYW0gPSB7XG5cdFx0XHRhY3Rpb246ICdkaXNtaXNzX3VwZ3JhZGVfbm90aWNlJ1xuXHRcdH07XG5cdFx0alF1ZXJ5LnBvc3QoYWpheHVybCwgcGFyYW0pO1xuXHR9XG5cblx0Ly8gU3RvcmUgdGhlIHByZWZlcmVuY2UgaW4gZGIuXG5cdGZ1bmN0aW9uIHNlbmRfZGlzbWlzc19yZXF1ZXN0KGFjdGlvbikge1xuXHRcdHZhciBwYXJhbSA9IHtcblx0XHRcdGFjdGlvbjogYWN0aW9uXG5cdFx0fTtcblx0XHRqUXVlcnkucG9zdChhamF4dXJsLCBwYXJhbSk7XG5cdH1cblxuXHQvLyBEaXNtaXNzIHRoZSB1cGRhdGUgbm90aWNlLlxuXHRqUXVlcnkoJy53cC1zbXVzaC11cGRhdGUtaW5mbycpLm9uKCdjbGljaycsICcubm90aWNlLWRpc21pc3MnLCBmdW5jdGlvbiAoZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRlbF9ub3RpY2UgPSBqUXVlcnkodGhpcyk7XG5cdFx0cmVtb3ZlX25vdGljZSgpO1xuXHRcdHNlbmRfZGlzbWlzc19yZXF1ZXN0KCdkaXNtaXNzX3VwZGF0ZV9pbmZvJyk7XG5cdH0pO1xuXG5cdC8vIERpc21pc3MgUzMgc3VwcG9ydCBhbGVydC5cblx0alF1ZXJ5KCdkaXYud3Atc211c2gtczNzdXBwb3J0LWFsZXJ0Jykub24oJ2NsaWNrJywgJy5pY29uLWZpLWNsb3NlJywgZnVuY3Rpb24gKGUpIHtcblx0XHRlbF9ub3RpY2UgPSBqUXVlcnkodGhpcyk7XG5cdFx0cmVtb3ZlX25vdGljZSgpO1xuXHRcdHNlbmRfZGlzbWlzc19yZXF1ZXN0KCdkaXNtaXNzX3Mzc3VwcG9ydF9hbGVydCcpO1xuXHR9KTtcbn0pOyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./_src/js/modules/notice.js\n");

/***/ }),

/***/ "./node_modules/jqueryfiletree/src/jQueryFileTree.js":
/*!***********************************************************!*\
  !*** ./node_modules/jqueryfiletree/src/jQueryFileTree.js ***!
  \***********************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("\n/*\n  * jQueryFileTree Plugin\n  *\n  * @author - Cory S.N. LaViska - A Beautiful Site (http://abeautifulsite.net/) - 24 March 2008\n  * @author - Dave Rogers - (https://github.com/daverogers/)\n  *\n  * Usage: $('.fileTreeDemo').fileTree({ options }, callback )\n  *\n  * TERMS OF USE\n  *\n  * This plugin is dual-licensed under the GNU General Public License and the MIT License and\n  * is copyright 2008 A Beautiful Site, LLC.\n */\nvar bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\n\n(function($, window) {\n  var FileTree;\n  FileTree = (function() {\n    function FileTree(el, args, callback) {\n      this.onEvent = bind(this.onEvent, this);\n      var $el, _this, defaults;\n      $el = $(el);\n      _this = this;\n      defaults = {\n        root: '/',\n        script: '/files/filetree',\n        folderEvent: 'click',\n        expandSpeed: 500,\n        collapseSpeed: 500,\n        expandEasing: 'swing',\n        collapseEasing: 'swing',\n        multiFolder: true,\n        loadMessage: 'Loading...',\n        errorMessage: 'Unable to get file tree information',\n        multiSelect: false,\n        onlyFolders: false,\n        onlyFiles: false,\n        preventLinkAction: false\n      };\n      this.jqft = {\n        container: $el\n      };\n      this.options = $.extend(defaults, args);\n      this.callback = callback;\n      this.data = {};\n      $el.html('<ul class=\"jqueryFileTree start\"><li class=\"wait\">' + this.options.loadMessage + '<li></ul>');\n      _this.showTree($el, escape(this.options.root), function() {\n        return _this._trigger('filetreeinitiated', {});\n      });\n      $el.delegate(\"li a\", this.options.folderEvent, _this.onEvent);\n    }\n\n    FileTree.prototype.onEvent = function(event) {\n      var $ev, _this, callback, jqft, options, ref;\n      $ev = $(event.target);\n      options = this.options;\n      jqft = this.jqft;\n      _this = this;\n      callback = this.callback;\n      _this.data = {};\n      _this.data.li = $ev.closest('li');\n      _this.data.type = (ref = _this.data.li.hasClass('directory')) != null ? ref : {\n        'directory': 'file'\n      };\n      _this.data.value = $ev.text();\n      _this.data.rel = $ev.prop('rel');\n      _this.data.container = jqft.container;\n      if (options.preventLinkAction) {\n        event.preventDefault();\n      }\n      if ($ev.parent().hasClass('directory')) {\n        if ($ev.parent().hasClass('collapsed')) {\n          if (!options.multiFolder) {\n            $ev.parent().parent().find('UL').slideUp({\n              duration: options.collapseSpeed,\n              easing: options.collapseEasing\n            });\n            $ev.parent().parent().find('LI.directory').removeClass('expanded').addClass('collapsed');\n          }\n          $ev.parent().removeClass('collapsed').addClass('expanded');\n          $ev.parent().find('UL').remove();\n          return _this.showTree($ev.parent(), $ev.attr('rel'), function() {\n            _this._trigger('filetreeexpanded', _this.data);\n            return callback != null;\n          });\n        } else {\n          return $ev.parent().find('UL').slideUp({\n            duration: options.collapseSpeed,\n            easing: options.collapseEasing,\n            start: function() {\n              return _this._trigger('filetreecollapse', _this.data);\n            },\n            complete: function() {\n              $ev.parent().removeClass('expanded').addClass('collapsed');\n              _this._trigger('filetreecollapsed', _this.data);\n              return callback != null;\n            }\n          });\n        }\n      } else {\n        if (!options.multiSelect) {\n          jqft.container.find('li').removeClass('selected');\n          $ev.parent().addClass('selected');\n        } else {\n          if ($ev.parent().find('input').is(':checked')) {\n            $ev.parent().find('input').prop('checked', false);\n            $ev.parent().removeClass('selected');\n          } else {\n            $ev.parent().find('input').prop('checked', true);\n            $ev.parent().addClass('selected');\n          }\n        }\n        _this._trigger('filetreeclicked', _this.data);\n        return typeof callback === \"function\" ? callback($ev.attr('rel')) : void 0;\n      }\n    };\n\n    FileTree.prototype.showTree = function(el, dir, finishCallback) {\n      var $el, _this, data, handleFail, handleResult, options, result;\n      $el = $(el);\n      options = this.options;\n      _this = this;\n      $el.addClass('wait');\n      $(\".jqueryFileTree.start\").remove();\n      data = {\n        dir: dir,\n        onlyFolders: options.onlyFolders,\n        onlyFiles: options.onlyFiles,\n        multiSelect: options.multiSelect\n      };\n      handleResult = function(result) {\n        var li;\n        $el.find('.start').html('');\n        $el.removeClass('wait').append(result);\n        if (options.root === dir) {\n          $el.find('UL:hidden').show(typeof callback !== \"undefined\" && callback !== null);\n        } else {\n          if (jQuery.easing[options.expandEasing] === void 0) {\n            console.log('Easing library not loaded. Include jQueryUI or 3rd party lib.');\n            options.expandEasing = 'swing';\n          }\n          $el.find('UL:hidden').slideDown({\n            duration: options.expandSpeed,\n            easing: options.expandEasing,\n            start: function() {\n              return _this._trigger('filetreeexpand', _this.data);\n            },\n            complete: finishCallback\n          });\n        }\n        li = $('[rel=\"' + decodeURIComponent(dir) + '\"]').parent();\n        if (options.multiSelect && li.children('input').is(':checked')) {\n          li.find('ul li input').each(function() {\n            $(this).prop('checked', true);\n            return $(this).parent().addClass('selected');\n          });\n        }\n        return false;\n      };\n      handleFail = function() {\n        $el.find('.start').html('');\n        $el.removeClass('wait').append(\"<p>\" + options.errorMessage + \"</p>\");\n        return false;\n      };\n      if (typeof options.script === 'function') {\n        result = options.script(data);\n        if (typeof result === 'string' || result instanceof jQuery) {\n          return handleResult(result);\n        } else {\n          return handleFail();\n        }\n      } else {\n        return $.ajax({\n          url: options.script,\n          type: 'POST',\n          dataType: 'HTML',\n          data: data\n        }).done(function(result) {\n          return handleResult(result);\n        }).fail(function() {\n          return handleFail();\n        });\n      }\n    };\n\n    FileTree.prototype._trigger = function(eventType, data) {\n      var $el;\n      $el = this.jqft.container;\n      return $el.triggerHandler(eventType, data);\n    };\n\n    return FileTree;\n\n  })();\n  return $.fn.extend({\n    fileTree: function(args, callback) {\n      return this.each(function() {\n        var $this, data;\n        $this = $(this);\n        data = $this.data('fileTree');\n        if (!data) {\n          $this.data('fileTree', (data = new FileTree(this, args, callback)));\n        }\n        if (typeof args === 'string') {\n          return data[option].apply(data);\n        }\n      });\n    }\n  });\n})(window.jQuery, window);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvanF1ZXJ5ZmlsZXRyZWUvc3JjL2pRdWVyeUZpbGVUcmVlLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2pxdWVyeWZpbGV0cmVlL3NyYy9qUXVlcnlGaWxlVHJlZS5qcz85YjFiIl0sInNvdXJjZXNDb250ZW50IjpbIlxuLypcbiAgKiBqUXVlcnlGaWxlVHJlZSBQbHVnaW5cbiAgKlxuICAqIEBhdXRob3IgLSBDb3J5IFMuTi4gTGFWaXNrYSAtIEEgQmVhdXRpZnVsIFNpdGUgKGh0dHA6Ly9hYmVhdXRpZnVsc2l0ZS5uZXQvKSAtIDI0IE1hcmNoIDIwMDhcbiAgKiBAYXV0aG9yIC0gRGF2ZSBSb2dlcnMgLSAoaHR0cHM6Ly9naXRodWIuY29tL2RhdmVyb2dlcnMvKVxuICAqXG4gICogVXNhZ2U6ICQoJy5maWxlVHJlZURlbW8nKS5maWxlVHJlZSh7IG9wdGlvbnMgfSwgY2FsbGJhY2sgKVxuICAqXG4gICogVEVSTVMgT0YgVVNFXG4gICpcbiAgKiBUaGlzIHBsdWdpbiBpcyBkdWFsLWxpY2Vuc2VkIHVuZGVyIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhbmQgdGhlIE1JVCBMaWNlbnNlIGFuZFxuICAqIGlzIGNvcHlyaWdodCAyMDA4IEEgQmVhdXRpZnVsIFNpdGUsIExMQy5cbiAqL1xudmFyIGJpbmQgPSBmdW5jdGlvbihmbiwgbWUpeyByZXR1cm4gZnVuY3Rpb24oKXsgcmV0dXJuIGZuLmFwcGx5KG1lLCBhcmd1bWVudHMpOyB9OyB9O1xuXG4oZnVuY3Rpb24oJCwgd2luZG93KSB7XG4gIHZhciBGaWxlVHJlZTtcbiAgRmlsZVRyZWUgPSAoZnVuY3Rpb24oKSB7XG4gICAgZnVuY3Rpb24gRmlsZVRyZWUoZWwsIGFyZ3MsIGNhbGxiYWNrKSB7XG4gICAgICB0aGlzLm9uRXZlbnQgPSBiaW5kKHRoaXMub25FdmVudCwgdGhpcyk7XG4gICAgICB2YXIgJGVsLCBfdGhpcywgZGVmYXVsdHM7XG4gICAgICAkZWwgPSAkKGVsKTtcbiAgICAgIF90aGlzID0gdGhpcztcbiAgICAgIGRlZmF1bHRzID0ge1xuICAgICAgICByb290OiAnLycsXG4gICAgICAgIHNjcmlwdDogJy9maWxlcy9maWxldHJlZScsXG4gICAgICAgIGZvbGRlckV2ZW50OiAnY2xpY2snLFxuICAgICAgICBleHBhbmRTcGVlZDogNTAwLFxuICAgICAgICBjb2xsYXBzZVNwZWVkOiA1MDAsXG4gICAgICAgIGV4cGFuZEVhc2luZzogJ3N3aW5nJyxcbiAgICAgICAgY29sbGFwc2VFYXNpbmc6ICdzd2luZycsXG4gICAgICAgIG11bHRpRm9sZGVyOiB0cnVlLFxuICAgICAgICBsb2FkTWVzc2FnZTogJ0xvYWRpbmcuLi4nLFxuICAgICAgICBlcnJvck1lc3NhZ2U6ICdVbmFibGUgdG8gZ2V0IGZpbGUgdHJlZSBpbmZvcm1hdGlvbicsXG4gICAgICAgIG11bHRpU2VsZWN0OiBmYWxzZSxcbiAgICAgICAgb25seUZvbGRlcnM6IGZhbHNlLFxuICAgICAgICBvbmx5RmlsZXM6IGZhbHNlLFxuICAgICAgICBwcmV2ZW50TGlua0FjdGlvbjogZmFsc2VcbiAgICAgIH07XG4gICAgICB0aGlzLmpxZnQgPSB7XG4gICAgICAgIGNvbnRhaW5lcjogJGVsXG4gICAgICB9O1xuICAgICAgdGhpcy5vcHRpb25zID0gJC5leHRlbmQoZGVmYXVsdHMsIGFyZ3MpO1xuICAgICAgdGhpcy5jYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgICAgdGhpcy5kYXRhID0ge307XG4gICAgICAkZWwuaHRtbCgnPHVsIGNsYXNzPVwianF1ZXJ5RmlsZVRyZWUgc3RhcnRcIj48bGkgY2xhc3M9XCJ3YWl0XCI+JyArIHRoaXMub3B0aW9ucy5sb2FkTWVzc2FnZSArICc8bGk+PC91bD4nKTtcbiAgICAgIF90aGlzLnNob3dUcmVlKCRlbCwgZXNjYXBlKHRoaXMub3B0aW9ucy5yb290KSwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBfdGhpcy5fdHJpZ2dlcignZmlsZXRyZWVpbml0aWF0ZWQnLCB7fSk7XG4gICAgICB9KTtcbiAgICAgICRlbC5kZWxlZ2F0ZShcImxpIGFcIiwgdGhpcy5vcHRpb25zLmZvbGRlckV2ZW50LCBfdGhpcy5vbkV2ZW50KTtcbiAgICB9XG5cbiAgICBGaWxlVHJlZS5wcm90b3R5cGUub25FdmVudCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICB2YXIgJGV2LCBfdGhpcywgY2FsbGJhY2ssIGpxZnQsIG9wdGlvbnMsIHJlZjtcbiAgICAgICRldiA9ICQoZXZlbnQudGFyZ2V0KTtcbiAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7XG4gICAgICBqcWZ0ID0gdGhpcy5qcWZ0O1xuICAgICAgX3RoaXMgPSB0aGlzO1xuICAgICAgY2FsbGJhY2sgPSB0aGlzLmNhbGxiYWNrO1xuICAgICAgX3RoaXMuZGF0YSA9IHt9O1xuICAgICAgX3RoaXMuZGF0YS5saSA9ICRldi5jbG9zZXN0KCdsaScpO1xuICAgICAgX3RoaXMuZGF0YS50eXBlID0gKHJlZiA9IF90aGlzLmRhdGEubGkuaGFzQ2xhc3MoJ2RpcmVjdG9yeScpKSAhPSBudWxsID8gcmVmIDoge1xuICAgICAgICAnZGlyZWN0b3J5JzogJ2ZpbGUnXG4gICAgICB9O1xuICAgICAgX3RoaXMuZGF0YS52YWx1ZSA9ICRldi50ZXh0KCk7XG4gICAgICBfdGhpcy5kYXRhLnJlbCA9ICRldi5wcm9wKCdyZWwnKTtcbiAgICAgIF90aGlzLmRhdGEuY29udGFpbmVyID0ganFmdC5jb250YWluZXI7XG4gICAgICBpZiAob3B0aW9ucy5wcmV2ZW50TGlua0FjdGlvbikge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfVxuICAgICAgaWYgKCRldi5wYXJlbnQoKS5oYXNDbGFzcygnZGlyZWN0b3J5JykpIHtcbiAgICAgICAgaWYgKCRldi5wYXJlbnQoKS5oYXNDbGFzcygnY29sbGFwc2VkJykpIHtcbiAgICAgICAgICBpZiAoIW9wdGlvbnMubXVsdGlGb2xkZXIpIHtcbiAgICAgICAgICAgICRldi5wYXJlbnQoKS5wYXJlbnQoKS5maW5kKCdVTCcpLnNsaWRlVXAoe1xuICAgICAgICAgICAgICBkdXJhdGlvbjogb3B0aW9ucy5jb2xsYXBzZVNwZWVkLFxuICAgICAgICAgICAgICBlYXNpbmc6IG9wdGlvbnMuY29sbGFwc2VFYXNpbmdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJGV2LnBhcmVudCgpLnBhcmVudCgpLmZpbmQoJ0xJLmRpcmVjdG9yeScpLnJlbW92ZUNsYXNzKCdleHBhbmRlZCcpLmFkZENsYXNzKCdjb2xsYXBzZWQnKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgJGV2LnBhcmVudCgpLnJlbW92ZUNsYXNzKCdjb2xsYXBzZWQnKS5hZGRDbGFzcygnZXhwYW5kZWQnKTtcbiAgICAgICAgICAkZXYucGFyZW50KCkuZmluZCgnVUwnKS5yZW1vdmUoKTtcbiAgICAgICAgICByZXR1cm4gX3RoaXMuc2hvd1RyZWUoJGV2LnBhcmVudCgpLCAkZXYuYXR0cigncmVsJyksIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgX3RoaXMuX3RyaWdnZXIoJ2ZpbGV0cmVlZXhwYW5kZWQnLCBfdGhpcy5kYXRhKTtcbiAgICAgICAgICAgIHJldHVybiBjYWxsYmFjayAhPSBudWxsO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiAkZXYucGFyZW50KCkuZmluZCgnVUwnKS5zbGlkZVVwKHtcbiAgICAgICAgICAgIGR1cmF0aW9uOiBvcHRpb25zLmNvbGxhcHNlU3BlZWQsXG4gICAgICAgICAgICBlYXNpbmc6IG9wdGlvbnMuY29sbGFwc2VFYXNpbmcsXG4gICAgICAgICAgICBzdGFydDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIHJldHVybiBfdGhpcy5fdHJpZ2dlcignZmlsZXRyZWVjb2xsYXBzZScsIF90aGlzLmRhdGEpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgJGV2LnBhcmVudCgpLnJlbW92ZUNsYXNzKCdleHBhbmRlZCcpLmFkZENsYXNzKCdjb2xsYXBzZWQnKTtcbiAgICAgICAgICAgICAgX3RoaXMuX3RyaWdnZXIoJ2ZpbGV0cmVlY29sbGFwc2VkJywgX3RoaXMuZGF0YSk7XG4gICAgICAgICAgICAgIHJldHVybiBjYWxsYmFjayAhPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoIW9wdGlvbnMubXVsdGlTZWxlY3QpIHtcbiAgICAgICAgICBqcWZ0LmNvbnRhaW5lci5maW5kKCdsaScpLnJlbW92ZUNsYXNzKCdzZWxlY3RlZCcpO1xuICAgICAgICAgICRldi5wYXJlbnQoKS5hZGRDbGFzcygnc2VsZWN0ZWQnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoJGV2LnBhcmVudCgpLmZpbmQoJ2lucHV0JykuaXMoJzpjaGVja2VkJykpIHtcbiAgICAgICAgICAgICRldi5wYXJlbnQoKS5maW5kKCdpbnB1dCcpLnByb3AoJ2NoZWNrZWQnLCBmYWxzZSk7XG4gICAgICAgICAgICAkZXYucGFyZW50KCkucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRldi5wYXJlbnQoKS5maW5kKCdpbnB1dCcpLnByb3AoJ2NoZWNrZWQnLCB0cnVlKTtcbiAgICAgICAgICAgICRldi5wYXJlbnQoKS5hZGRDbGFzcygnc2VsZWN0ZWQnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMuX3RyaWdnZXIoJ2ZpbGV0cmVlY2xpY2tlZCcsIF90aGlzLmRhdGEpO1xuICAgICAgICByZXR1cm4gdHlwZW9mIGNhbGxiYWNrID09PSBcImZ1bmN0aW9uXCIgPyBjYWxsYmFjaygkZXYuYXR0cigncmVsJykpIDogdm9pZCAwO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBGaWxlVHJlZS5wcm90b3R5cGUuc2hvd1RyZWUgPSBmdW5jdGlvbihlbCwgZGlyLCBmaW5pc2hDYWxsYmFjaykge1xuICAgICAgdmFyICRlbCwgX3RoaXMsIGRhdGEsIGhhbmRsZUZhaWwsIGhhbmRsZVJlc3VsdCwgb3B0aW9ucywgcmVzdWx0O1xuICAgICAgJGVsID0gJChlbCk7XG4gICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zO1xuICAgICAgX3RoaXMgPSB0aGlzO1xuICAgICAgJGVsLmFkZENsYXNzKCd3YWl0Jyk7XG4gICAgICAkKFwiLmpxdWVyeUZpbGVUcmVlLnN0YXJ0XCIpLnJlbW92ZSgpO1xuICAgICAgZGF0YSA9IHtcbiAgICAgICAgZGlyOiBkaXIsXG4gICAgICAgIG9ubHlGb2xkZXJzOiBvcHRpb25zLm9ubHlGb2xkZXJzLFxuICAgICAgICBvbmx5RmlsZXM6IG9wdGlvbnMub25seUZpbGVzLFxuICAgICAgICBtdWx0aVNlbGVjdDogb3B0aW9ucy5tdWx0aVNlbGVjdFxuICAgICAgfTtcbiAgICAgIGhhbmRsZVJlc3VsdCA9IGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICB2YXIgbGk7XG4gICAgICAgICRlbC5maW5kKCcuc3RhcnQnKS5odG1sKCcnKTtcbiAgICAgICAgJGVsLnJlbW92ZUNsYXNzKCd3YWl0JykuYXBwZW5kKHJlc3VsdCk7XG4gICAgICAgIGlmIChvcHRpb25zLnJvb3QgPT09IGRpcikge1xuICAgICAgICAgICRlbC5maW5kKCdVTDpoaWRkZW4nKS5zaG93KHR5cGVvZiBjYWxsYmFjayAhPT0gXCJ1bmRlZmluZWRcIiAmJiBjYWxsYmFjayAhPT0gbnVsbCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKGpRdWVyeS5lYXNpbmdbb3B0aW9ucy5leHBhbmRFYXNpbmddID09PSB2b2lkIDApIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFYXNpbmcgbGlicmFyeSBub3QgbG9hZGVkLiBJbmNsdWRlIGpRdWVyeVVJIG9yIDNyZCBwYXJ0eSBsaWIuJyk7XG4gICAgICAgICAgICBvcHRpb25zLmV4cGFuZEVhc2luZyA9ICdzd2luZyc7XG4gICAgICAgICAgfVxuICAgICAgICAgICRlbC5maW5kKCdVTDpoaWRkZW4nKS5zbGlkZURvd24oe1xuICAgICAgICAgICAgZHVyYXRpb246IG9wdGlvbnMuZXhwYW5kU3BlZWQsXG4gICAgICAgICAgICBlYXNpbmc6IG9wdGlvbnMuZXhwYW5kRWFzaW5nLFxuICAgICAgICAgICAgc3RhcnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuX3RyaWdnZXIoJ2ZpbGV0cmVlZXhwYW5kJywgX3RoaXMuZGF0YSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY29tcGxldGU6IGZpbmlzaENhbGxiYWNrXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgbGkgPSAkKCdbcmVsPVwiJyArIGRlY29kZVVSSUNvbXBvbmVudChkaXIpICsgJ1wiXScpLnBhcmVudCgpO1xuICAgICAgICBpZiAob3B0aW9ucy5tdWx0aVNlbGVjdCAmJiBsaS5jaGlsZHJlbignaW5wdXQnKS5pcygnOmNoZWNrZWQnKSkge1xuICAgICAgICAgIGxpLmZpbmQoJ3VsIGxpIGlucHV0JykuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICQodGhpcykucHJvcCgnY2hlY2tlZCcsIHRydWUpO1xuICAgICAgICAgICAgcmV0dXJuICQodGhpcykucGFyZW50KCkuYWRkQ2xhc3MoJ3NlbGVjdGVkJyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfTtcbiAgICAgIGhhbmRsZUZhaWwgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgJGVsLmZpbmQoJy5zdGFydCcpLmh0bWwoJycpO1xuICAgICAgICAkZWwucmVtb3ZlQ2xhc3MoJ3dhaXQnKS5hcHBlbmQoXCI8cD5cIiArIG9wdGlvbnMuZXJyb3JNZXNzYWdlICsgXCI8L3A+XCIpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9O1xuICAgICAgaWYgKHR5cGVvZiBvcHRpb25zLnNjcmlwdCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICByZXN1bHQgPSBvcHRpb25zLnNjcmlwdChkYXRhKTtcbiAgICAgICAgaWYgKHR5cGVvZiByZXN1bHQgPT09ICdzdHJpbmcnIHx8IHJlc3VsdCBpbnN0YW5jZW9mIGpRdWVyeSkge1xuICAgICAgICAgIHJldHVybiBoYW5kbGVSZXN1bHQocmVzdWx0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gaGFuZGxlRmFpbCgpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJC5hamF4KHtcbiAgICAgICAgICB1cmw6IG9wdGlvbnMuc2NyaXB0LFxuICAgICAgICAgIHR5cGU6ICdQT1NUJyxcbiAgICAgICAgICBkYXRhVHlwZTogJ0hUTUwnLFxuICAgICAgICAgIGRhdGE6IGRhdGFcbiAgICAgICAgfSkuZG9uZShmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICByZXR1cm4gaGFuZGxlUmVzdWx0KHJlc3VsdCk7XG4gICAgICAgIH0pLmZhaWwoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGhhbmRsZUZhaWwoKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIEZpbGVUcmVlLnByb3RvdHlwZS5fdHJpZ2dlciA9IGZ1bmN0aW9uKGV2ZW50VHlwZSwgZGF0YSkge1xuICAgICAgdmFyICRlbDtcbiAgICAgICRlbCA9IHRoaXMuanFmdC5jb250YWluZXI7XG4gICAgICByZXR1cm4gJGVsLnRyaWdnZXJIYW5kbGVyKGV2ZW50VHlwZSwgZGF0YSk7XG4gICAgfTtcblxuICAgIHJldHVybiBGaWxlVHJlZTtcblxuICB9KSgpO1xuICByZXR1cm4gJC5mbi5leHRlbmQoe1xuICAgIGZpbGVUcmVlOiBmdW5jdGlvbihhcmdzLCBjYWxsYmFjaykge1xuICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyICR0aGlzLCBkYXRhO1xuICAgICAgICAkdGhpcyA9ICQodGhpcyk7XG4gICAgICAgIGRhdGEgPSAkdGhpcy5kYXRhKCdmaWxlVHJlZScpO1xuICAgICAgICBpZiAoIWRhdGEpIHtcbiAgICAgICAgICAkdGhpcy5kYXRhKCdmaWxlVHJlZScsIChkYXRhID0gbmV3IEZpbGVUcmVlKHRoaXMsIGFyZ3MsIGNhbGxiYWNrKSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgYXJncyA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICByZXR1cm4gZGF0YVtvcHRpb25dLmFwcGx5KGRhdGEpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xufSkod2luZG93LmpRdWVyeSwgd2luZG93KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/jqueryfiletree/src/jQueryFileTree.js\n");

/***/ })

/******/ });